
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Maxwell’s Equations &#8212; Theoretical Physics Reference 0.5 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Thermodynamics and Statistical Physics" href="../statmech/main.html" />
    <link rel="prev" title="Classical Electromagnetism" href="main.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head><body>
    <div style="display:none">
    \(
        \newcommand{\d}{\mathrm{d}}
        \newcommand{\bomega}{\vec\omega}
        \newcommand{\half}{ {1\over 2} }
        \def\mathnot#1{\text{"$#1$"}}

        %operators
        \newcommand{\diag}{\mathrm{diag}}
        \newcommand{\sinc}{\mathrm{sinc}}
        \newcommand{\Sh}{ {\large\style{font-family:Times}{\text{Ш}}} }
        \newcommand{\res}{\mathrm{Res}}
    \)
    </div>
    

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../statmech/main.html" title="Thermodynamics and Statistical Physics"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="main.html" title="Classical Electromagnetism"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" accesskey="U">Classical Electromagnetism</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="maxwell-s-equations">
<h1>Maxwell’s Equations<a class="headerlink" href="#maxwell-s-equations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="electromagnetic-field">
<h2>Electromagnetic Field<a class="headerlink" href="#electromagnetic-field" title="Permalink to this headline">¶</a></h2>
<p>The electromagnetic field is fully described by a vector field called the
4-potential <img class="math" src="../_images/math/5947b1c4889195efbab145bb11354375a1916cbe.svg" alt="A^\alpha"/>. It has four components that we can label any way we
want, the traditional way is to use:</p>
<div class="math">
<p><img src="../_images/math/afb2ba9005f65308957e67575da8b82ae4dc815a.svg" alt="A^\alpha = \left({\phi\over c}, {\bf A}\right)"/></p>
</div><p>where <img class="math" src="../_images/math/c3840070bf80f9ae1042948615aee7e95b959b25.svg" alt="\phi"/> is called the electrostatic scalar potential, <img class="math" src="../_images/math/3fa0b23c9f21553ceec99e369f494fe217788bd4.svg" alt="{\bf A}"/> is called
the vector potential and <img class="math" src="../_images/math/fbc61f23cc2b888220006641e38ddc9cf143e1d8.svg" alt="c"/> is the speed of light.
The Lagrangian density for the free (noninteracting) field is:</p>
<div class="math">
<p><img src="../_images/math/e934f26fc4065481a0b89c988cfd9ff504b71457.svg" alt="\L = -{1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta"/></p>
</div><p>The Lagrangian for a (charged) particle is:</p>
<div class="math">
<p><img src="../_images/math/670c7a204d03becd6b47ba77955aafb417d9f6dd.svg" alt="L(x^\mu, v^\mu) = -\half m v_\alpha v^\alpha"/></p>
</div><p>it produces the following charge density:</p>
<div class="math">
<p><img src="../_images/math/c522f8d3d4b1574af034b35f25f00b9829dd9cd3.svg" alt="\rho = q \delta({\bf r} - {\bf s})"/></p>
</div><p>The interaction between the charged particle (or in general any charged body)
with some charge density and the electromagnetic field is given by the
Lagrangian density (this follows from <a class="reference internal" href="../quantum/qed.html#local-gauge-invariance"><span class="std std-ref">Local Gauge Invariance</span></a>):</p>
<div class="math">
<p><img src="../_images/math/ae710278c4f13c4404d09da1a753c2e1441b84bb.svg" alt="\L = -j_\alpha A^\alpha"/></p>
</div><p>where:</p>
<div class="math">
<p><img src="../_images/math/64a0f91f9c3b21b3db5a1601cd5f6563cca2bc4f.svg" alt="j^\mu = \rho v^\mu = \gamma \rho (c, {\bf v})"/></p>
</div><p>All together, the Lagrangian of a charged particle and an electromagnetic field
is:</p>
<div class="math" id="equation-lagem">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-lagem" title="Permalink to this equation">¶</a></span><img src="../_images/math/687ca8ccf445f84a4ec889bb057ce45e0faf3c70.svg" alt="L(x^\mu, v^\mu, A^\mu, \partial_\nu A^\mu)
  =-\half m v_\alpha v^\alpha
    -\int {1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
        \d^3 x
        - \int j_\alpha A^\alpha \d^3 x =

  =-\half m v_\alpha v^\alpha
    -\int {1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
        \d^3 x
        - \int \rho v_\alpha A^\alpha \d^3 x =

  =-\half m v_\alpha v^\alpha
    -\int {1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
        \d^3 x
        - q v_\alpha A^\alpha"/></p>
</div><p>Note that:</p>
<div class="math">
<p><img src="../_images/math/54df1af1bcc4ab1e5cdd9f3c9db4dc644a18df0c.svg" alt="v_\alpha A^\alpha = - \gamma \phi + \gamma {\bf v} \cdot {\bf A}"/></p>
</div><p>There are several approaches how to obtain the above Lagrangian from some other
assumptions, but ultimately the exact form of the Lagrangians has to be given
by experiment. This Lagrangian is our only assumption and we derive everything
else from it.</p>
<p>The Euler-Lagrange equations for the electromagnetic field (in terms of <img class="math" src="../_images/math/eb4e41b91659bf372eab5fc718a2c7e02b4b61b7.svg" alt="A^\mu"/>
and <img class="math" src="../_images/math/4c30309cbc133357abd6c1d5e9527e48265dd8e2.svg" alt="\partial_\nu A^\mu"/>) are:</p>
<div class="math">
<p><img src="../_images/math/7a15c36c024620f18e9c78e847a1bb8061b253e1.svg" alt="\partial^\mu {\partial\over\partial (\partial^\mu A^\nu)}
\left(
    -{1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
           - j_\alpha A^\alpha
    \right)
={\partial\over\partial A^\nu}
    \left(
    -{1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
           - j_\alpha A^\alpha\right)

\partial^\mu {\partial\over\partial (\partial^\mu A^\nu)}
\left(
    {1\over 2\mu_0} g_{\delta\alpha} g_{\epsilon\beta}
    \partial^\delta A^\epsilon \partial^\alpha A^\beta
    \right)
={\partial\over\partial A^\nu} j_\alpha A^\alpha

{1\over 2\mu_0} \partial^\mu g_{\delta\alpha} g_{\epsilon\beta}
\left(
    \delta^\delta_\mu \delta^\epsilon_\nu \partial^\alpha A^\beta
    +
    \partial^\delta A^\epsilon \delta^\alpha_\mu \delta^\beta_\nu
    \right)
= j_\alpha \delta^\alpha_\nu

{1\over 2\mu_0} \partial^\mu
\left(  g_{\mu\alpha} g_{\nu\beta}
    \partial^\alpha A^\beta
    +g_{\delta\mu} g_{\epsilon\nu}
    \partial^\delta A^\epsilon
    \right)
= j_\nu

{1\over 2\mu_0} \partial^\mu
\left(\partial_\mu A_\nu + \partial_\mu A_\nu \right)
= j_\nu

{1\over \mu_0} \partial^\mu \partial_\mu A_\nu = j_\nu"/></p>
</div><div class="math" id="equation-aeq1">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-aeq1" title="Permalink to this equation">¶</a></span><img src="../_images/math/5a52199a8b9f851b81af3ec3e2816bcfdd7cf52f.svg" alt="\partial^\mu \partial_\mu A_\nu = \mu_0 j_\nu"/></p>
</div><p>Equations for the particle (in terms of <img class="math" src="../_images/math/37a7154325a0a36bcb39bc8285f8b3ffce56c05d.svg" alt="x^\mu"/> and <img class="math" src="../_images/math/4fc394fd7bfe10fbeab9122b55ef768f6931b701.svg" alt="v^\mu"/>) are:</p>
<div class="math">
<p><img src="../_images/math/5a23e8b47cf07acbcd1ca66bb73f9f0c03c0b1fd.svg" alt="{\d \over \d \tau} {\partial L\over \partial v_\mu}
     = {\partial L \over \partial x_\mu}

{\d \over \d \tau} {\partial \over \partial v_\mu}
    \left(\half m g^{\alpha\beta} v_\alpha v_\beta
        + q v_\alpha A^\alpha\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}

{\d \over \d \tau}
    \left(
        \half m g^{\alpha\beta} (\delta_{\alpha\mu} v_\beta
        + v_\alpha \delta_{\beta\mu})
        + q \delta_{\alpha\mu} A^\alpha\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}

{\d \over \d \tau}
    \left(
        \half m (g^{\mu\beta} v_\beta + g^{\alpha\mu} v_\alpha)
        + q A^\mu\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}

{\d \over \d \tau}
    \left(
        \half m (v^\mu + v^\mu)
        + q A^\mu\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}

{\d \over \d \tau}
    \left(m v^\mu + q A^\mu\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}

m {\d v^\mu \over \d \tau}
     = q \left(-{\d A^\mu\over\d\tau}
        + v_\alpha \partial^\mu A^\alpha\right)

m {\d v^\mu \over \d \tau}
     = q \left(-v_\alpha \partial^\alpha A^\mu
        + v_\alpha \partial^\mu A^\alpha\right)

m {\d v^\mu \over \d \tau}
     = q (\partial^\mu A^\alpha - \partial^\alpha A^\mu) v_\alpha"/></p>
</div><div class="math" id="equation-lorentz-rel">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-lorentz-rel" title="Permalink to this equation">¶</a></span><img src="../_images/math/296e8182e7851142b03a2907ad927bf6c40ccec7.svg" alt="m {\d v^\mu \over \d \tau}
     = q F^{\mu\alpha} v_\alpha"/></p>
</div><p>Where <img class="math" src="../_images/math/5d355bc903c74ffcabb25db8a32ec80c09b287f5.svg" alt="F^{\mu\nu}"/> is called the electromagnetic field strength tensor:</p>
<div class="math">
<p><img src="../_images/math/661e53405c6ce591a72bed6822d3fe8ca95043e3.svg" alt="F^{\mu\nu} =  \partial^\mu A^\nu - \partial^\nu A^\mu"/></p>
</div><p>The only way to measure the electric field is through its interaction with the
charge particle. As such, the actual physical field (that can be measured) is
<img class="math" src="../_images/math/5d355bc903c74ffcabb25db8a32ec80c09b287f5.svg" alt="F^{\mu\nu}"/>, which is invariant under any gauge transformation:</p>
<div class="math">
<p><img src="../_images/math/81678f308d150d5fbb140384b90fa74cfed58646.svg" alt="A^\alpha \to A^\alpha + \partial^\alpha \psi"/></p>
</div><p>where <img class="math" src="../_images/math/618880262d4d186b3ab349b49a37b3d500f34344.svg" alt="\psi"/> is a gauge function:</p>
<div class="math">
<p><img src="../_images/math/72af4c584114307c0e2ea5cce59296ea669c73ab.svg" alt="F^{\mu\nu} \to  \partial^\mu (A^\nu+\partial^\nu\psi)
     - \partial^\nu (A^\mu+\partial^\mu\psi)
    = \partial^\mu A^\nu - \partial^\nu A^\mu
        +\partial^\mu \partial^\nu\psi - \partial^\nu \partial^\mu\psi
    = \partial^\mu A^\nu - \partial^\nu A^\mu
    = F^{\mu\nu}"/></p>
</div><p>In other words, two different <img class="math" src="../_images/math/eb4e41b91659bf372eab5fc718a2c7e02b4b61b7.svg" alt="A^\mu"/> related by the gauge transformation
represent the exact same physical electromagnetic field (as given by the field
tensor). As such, we can modify the Lagrangian by applying the gauge
transformation to the field <img class="math" src="../_images/math/eb4e41b91659bf372eab5fc718a2c7e02b4b61b7.svg" alt="A^\mu"/>: this changes the equations of motion for
the field (thus the numerical values for <img class="math" src="../_images/math/eb4e41b91659bf372eab5fc718a2c7e02b4b61b7.svg" alt="A^\mu"/> will be different), but
doesn’t change the equation of motion for the particle, so the change will not
have any physical effect (cannot be measured).</p>
<p>By choosing <img class="math" src="../_images/math/618880262d4d186b3ab349b49a37b3d500f34344.svg" alt="\psi"/> as a solution to the equation
<img class="math" src="../_images/math/5e0f70996a54266208015bc6591e448eac46c133.svg" alt="\partial_\mu\partial^\mu\psi=-\partial_\mu A^\mu"/>, we get:</p>
<div class="math">
<p><img src="../_images/math/8a8eb1c2e429c0d662da50a0cb7eb5dcc0567836.svg" alt="\partial_\mu (A^\mu + \partial^\mu \psi)
    = \partial_\mu A^\mu + \partial_\mu\partial^\mu \psi
    = \partial_\mu A^\mu - \partial_\mu A^\mu
    = 0"/></p>
</div><p>So for any 4-potential we can find <img class="math" src="../_images/math/618880262d4d186b3ab349b49a37b3d500f34344.svg" alt="\psi"/> such that the transformed 4-potential
<img class="math" src="../_images/math/eb4e41b91659bf372eab5fc718a2c7e02b4b61b7.svg" alt="A^\mu"/> obeys the Lorenz gauge condition <img class="math" src="../_images/math/2fd5485394637db91bfd4d27361959d0479f7cf0.svg" alt="\partial_\mu A^\mu=0"/>.</p>
<p>In order to obtain a gauge
invariant Lagrangian, we need to express it using <img class="math" src="../_images/math/5d355bc903c74ffcabb25db8a32ec80c09b287f5.svg" alt="F^{\mu\nu}"/> using the
following identity:</p>
<div class="math">
<p><img src="../_images/math/1385e22a2a4dfc1ffec5f1ab8a634bd5b674ed1d.svg" alt="{1\over 4} F_{\alpha\beta} F^{\alpha\beta}
    ={1\over 4}(\partial_\alpha A_\beta - \partial_\beta A_\alpha)
        (\partial^\alpha A^\beta - \partial^\beta A^\alpha) =

    ={1\over 4}(
        \partial_\alpha A_\beta
        \partial^\alpha A^\beta
         - \partial_\beta A_\alpha
        \partial^\alpha A^\beta
        -\partial_\alpha A_\beta
         \partial^\beta A^\alpha
         + \partial_\beta A_\alpha
          \partial^\beta A^\alpha
        ) =

    ={1\over 2}(
        \partial_\alpha A_\beta
        \partial^\alpha A^\beta
         - \partial_\beta A_\alpha
        \partial^\alpha A^\beta
        ) =

    =\half \partial_\alpha A_\beta \partial^\alpha A^\beta
         - \half\partial_\beta A_\alpha \partial^\alpha A^\beta =

    =\half \partial_\alpha A_\beta \partial^\alpha A^\beta
           -\half (\partial^\alpha A_\alpha)^2
         - \half\partial_\beta (A_\alpha \partial^\alpha A^\beta
           -A^\beta\partial^\alpha A_\alpha)"/></p>
</div><p>The 4-divergence
<img class="math" src="../_images/math/ad0406e3827f2ddc8e489943c8db2f5da94421d5.svg" alt="\partial_\beta (A_\alpha \partial^\alpha A^\beta -A^\beta\partial^\alpha A_\alpha)"/>
doesn’t change Euler-Lagrange equations, so we can ignore it.
We can see, that in the Lorenz gauge <img class="math" src="../_images/math/056de9cdf2ab62d9419ec4d6891a4fbc5cd7c7b6.svg" alt="\partial^\alpha A_\alpha=0"/> the term
<img class="math" src="../_images/math/312697cdaf2bb2d7da85a0c23cc07492ac6fcfeb.svg" alt="{1\over 4} F_{\alpha\beta} F^{\alpha\beta}"/> (which is gauge invariant)
simplifies to the term <img class="math" src="../_images/math/1be9123121b5749545a9ae98aa17fab2b092ab2d.svg" alt="\partial_\alpha A_\beta \partial^\alpha A^\beta"/> in the
Lagrangian <a class="reference internal" href="#equation-lagem">(1)</a>. The gauge invariant Lagrangian is:</p>
<div class="math" id="equation-lagem2">
<p><span class="eqno">(4)<a class="headerlink" href="#equation-lagem2" title="Permalink to this equation">¶</a></span><img src="../_images/math/38b0f7938978a21f4df0cc02bfcbb860a657951d.svg" alt="L(x^\mu, v^\mu, A^\mu, \partial_\nu A^\mu)
  =-\half m v_\alpha v^\alpha
    -\int {1\over 4\mu_0} F_{\alpha\beta} F^{\alpha\beta} \d^3 x
        - \int j_\alpha A^\alpha \d^3 x"/></p>
</div><p>The E.-L. equation for the particle doesn’t change, the equation for the field
becomes:</p>
<div class="math">
<p><img src="../_images/math/5cf509476fb7647eebd88f319c1659af2dae1133.svg" alt="\partial^\mu (\partial_\mu A_\nu-\partial_\nu A_\mu) = \mu_0 j_\nu"/></p>
</div><div class="math" id="equation-feq1">
<p><span class="eqno">(5)<a class="headerlink" href="#equation-feq1" title="Permalink to this equation">¶</a></span><img src="../_images/math/838d551dbe03d65448571653a38eb84dbc1c315f.svg" alt="\partial^\mu F_{\mu\nu} = \mu_0 j_\nu"/></p>
</div><p>Which in Lorenz gauge simplifies to equation <a class="reference internal" href="#equation-aeq1">(2)</a>.
In order to write equations of motion in terms of <img class="math" src="../_images/math/5d355bc903c74ffcabb25db8a32ec80c09b287f5.svg" alt="F^{\mu\nu}"/> only, we
need another equation for it:</p>
<div class="math" id="equation-feq2">
<p><span class="eqno">(6)<a class="headerlink" href="#equation-feq2" title="Permalink to this equation">¶</a></span><img src="../_images/math/21e3122e96c4832f8c0ae4dc763bb2cc77ab8b3f.svg" alt="\epsilon^{\alpha\beta\gamma\delta}\partial_\gamma F_{\alpha\beta}
    = \epsilon^{\alpha\beta\gamma\delta}\partial_\gamma
        (\partial_\alpha A_\beta - \partial_\beta A_\alpha) =

    = \epsilon^{\alpha\beta\gamma\delta}\partial_\gamma
        \partial_\alpha A_\beta
        -\epsilon^{\alpha\beta\gamma\delta}\partial_\gamma
        \partial_\beta A_\alpha = 0"/></p>
</div><p>We used the fact, that the partial derivatives are symmetric in the indices
<img class="math" src="../_images/math/650285bc13a68c1c1758bbb2e5f9243465e754c9.svg" alt="\gamma\alpha"/> and <img class="math" src="../_images/math/e5af9bed00cab3ed350f19c6569a69f05f5de98d.svg" alt="\gamma\beta"/> while
<img class="math" src="../_images/math/7efe6121944cb5e5918b160760927af7d421d798.svg" alt="\epsilon^{\alpha\beta\gamma\delta}"/> is antisymmetric.</p>
</div>
<div class="section" id="id1">
<h2>Maxwell’s Equations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Maxwell’s equations are the equations for the electromagnetic field in terms of
the physical field strengh tensor, equations <a class="reference internal" href="#equation-feq1">(5)</a> and <a class="reference internal" href="#equation-feq2">(6)</a>:</p>
<div class="math">
<p><img src="../_images/math/8991f9439df8b2d6901b7754cbaf796cd6f35214.svg" alt="\partial^\mu F_{\mu\nu} = \mu_0 j_\nu

\epsilon^{\alpha\beta\gamma\delta}\partial_\gamma F_{\alpha\beta} = 0"/></p>
</div><p>The field strength tensor is antisymmetric, so it has 6 independent components
(we use metric tensor with signature -2):</p>
<div class="math">
<p><img src="../_images/math/e44a180d3b06ea9cbaffbb28ca0282d3dcaf5643.svg" alt="F^{0i} = \partial^0 A^i - \partial^i A^0
    = {1\over c}{\partial A^i\over \partial t} +
        {\partial\over\partial x_i} {\phi\over c}
    = -{1\over c}\left(-{\partial\phi\over\partial x_i}
            -{\partial A^i\over \partial t} \right)


F^{ij} = \partial^i A^j - \partial^j A^i
    = -{\partial A^j\over\partial x_i} +{\partial A^i\over\partial x_j}
    = -(\delta^i{}_l\delta^j{}_m - \delta^i{}_m\delta^j{}_l)
        {\partial A^m\over\partial x_l}
    = -\epsilon^{ij}{}_k\epsilon^k{}_{lm} {\partial A^m\over\partial x_l}"/></p>
</div><p>There is freedom in how we label the components. The standard way is to express
them using physical fields <img class="math" src="../_images/math/69aed678bfc9ed80917bc84476af1b107cb9e10e.svg" alt="{\bf E}"/> and <img class="math" src="../_images/math/f06fff000efa529593956559ade723e16aa36424.svg" alt="{\bf B}"/> that are introduced by:</p>
<div class="math">
<p><img src="../_images/math/906eee76c601ee24272b969be526cc351232a032.svg" alt="{\bf E} = -\nabla\phi - {\partial {\bf A}\over\partial t}

{\bf B} = \nabla\times{\bf A}"/></p>
</div><p>or in components:</p>
<div class="math">
<p><img src="../_images/math/7aef3b139b405b1b0070dc7a697dfb73e83ca539.svg" alt="E^i = -{\partial\phi\over\partial x_i}
            -{\partial A^i\over \partial t}

B^k = \epsilon^k{}_{lm} \nabla^l A^m"/></p>
</div><p>Comparing to the above, we get:</p>
<div class="math">
<p><img src="../_images/math/8488f93ccd689495338450da38df5a76fbabfd48.svg" alt="F^{0i} = -{E^i\over c}

F^{ij} = -\epsilon^{ij}{}_k B^k"/></p>
</div><p>In particular:</p>
<div class="math">
<p><img src="../_images/math/9d5dbba85c63940f6ea846e25631f66946da6cd2.svg" alt="F^{12} = -\epsilon^{12}{}_k B^k = -\epsilon^{12}{}_3 B^3 = - B^3

F^{13} = -\epsilon^{13}{}_k B^k = -\epsilon^{13}{}_2 B^2 = + B^2

F^{23} = -\epsilon^{23}{}_k B^k = -\epsilon^{23}{}_1 B^1 = - B^1"/></p>
</div><p>so we get:</p>
<div class="math">
<p><img src="../_images/math/25514c92606a274a48f14b13261dc776e7e4d174.svg" alt="F^{\mu\nu} = \left(\begin{array}{cccc}
0 &amp; -{E^1\over c} &amp; -{E^2\over c} &amp; -{E^3\over c} \\
{E^1\over c} &amp; 0 &amp; -B^3 &amp; B^2 \\
{E^2\over c} &amp; B^3 &amp; 0 &amp; -B^1 \\
{E^3\over c} &amp; -B^2 &amp; B^1 &amp; 0 \\
\end{array}\right)

F_{\mu\nu} = g_{\mu\alpha}g_{\nu\beta}F^{\alpha\beta}
    = \left(\begin{array}{cccc}
0 &amp; {E^1\over c} &amp; {E^2\over c} &amp; {E^3\over c} \\
-{E^1\over c} &amp; 0 &amp; -B^3 &amp; B^2 \\
-{E^2\over c} &amp; B^3 &amp; 0 &amp; -B^1 \\
-{E^3\over c} &amp; -B^2 &amp; B^1 &amp; 0 \\
\end{array}\right)"/></p>
</div><p>In terms of <img class="math" src="../_images/math/a52e78896a07f5da462bdf07e1a8c4a692d17d3e.svg" alt="\bf E"/> and <img class="math" src="../_images/math/0010f6cc6bdc25cf79746b6c3a2c4b8a4dbb5339.svg" alt="\bf B"/> fields, the Maxwell’s equations become:</p>
<div class="math">
<p><img src="../_images/math/dfb1523f91c507bcfb6488b4cb0122aa2241d069.svg" alt="\nabla\cdot{\bf E} = c^2\mu_0 \rho

\nabla\times{\bf B} = \mu_0 {\bf j} + {1\over c^2}{\partial{\bf E}
    \over \partial t}

\nabla\cdot{\bf B} = 0

\nabla\times{\bf E} = -{\partial{\bf B}\over\partial t}"/></p>
</div><p>In Lorenz gauge, the equation for the 4-potential is <a class="reference internal" href="#equation-aeq1">(2)</a>:</p>
<div class="math">
<p><img src="../_images/math/5a52199a8b9f851b81af3ec3e2816bcfdd7cf52f.svg" alt="\partial^\mu \partial_\mu A_\nu = \mu_0 j_\nu"/></p>
</div><p>The solution to this equation is:</p>
<div class="math">
<p><img src="../_images/math/3001eb7ca1ab7b709e636549a7f2d9e60c206fdc.svg" alt="A^\beta({\bf x}, t) = {\mu_0\over 4\pi}\int
     {j^\beta({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y"/></p>
</div><p>For scalar potential (<img class="math" src="../_images/math/0f9ab95891c48274ce5e6e630d2e103627a92557.svg" alt="\beta=0"/>) we get:</p>
<div class="math">
<p><img src="../_images/math/561b9d57f3c5609e0b2912036e559081fe0a701e.svg" alt="{\phi({\bf x}, t)\over c} = {\mu_0\over 4\pi}\int
     {c \rho({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y"/></p>
</div><div class="math" id="equation-ascal-sol">
<p><span class="eqno">(7)<a class="headerlink" href="#equation-ascal-sol" title="Permalink to this equation">¶</a></span><img src="../_images/math/f0b06eaa847320a3b2ed8b14cfcaea8cf92537f9.svg" alt="\phi({\bf x}, t) = {\mu_0 c^2\over 4\pi}\int
     {\rho({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y
    = {1\over 4\pi\epsilon_0}\int
     {\rho({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y"/></p>
</div><p>And for vector potential (<img class="math" src="../_images/math/edc33c139fbf8947a4b8d62ec938f181d6b23d84.svg" alt="\beta=i"/>) we get:</p>
<div class="math" id="equation-avec-sol">
<p><span class="eqno">(8)<a class="headerlink" href="#equation-avec-sol" title="Permalink to this equation">¶</a></span><img src="../_images/math/20cdfd3209a9c02861bfacfc37d317c182034ba5.svg" alt="{\bf A}({\bf x}, t) = {\mu_0\over 4\pi}\int
     {{\bf j}({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y"/></p>
</div></div>
<div class="section" id="lorentz-force">
<h2>Lorentz Force<a class="headerlink" href="#lorentz-force" title="Permalink to this headline">¶</a></h2>
<p>The equation for the charge particle <a class="reference internal" href="#equation-lorentz-rel">(3)</a> is:</p>
<div class="math">
<p><img src="../_images/math/296e8182e7851142b03a2907ad927bf6c40ccec7.svg" alt="m {\d v^\mu \over \d \tau}
     = q F^{\mu\alpha} v_\alpha"/></p>
</div><p>In components:</p>
<div class="math">
<p><img src="../_images/math/215266f018742d045ef71686fc78ff2ffdcfd65f.svg" alt="m {\d v^0 \over \d \tau}
     = q F^{0\alpha} v_\alpha
     = -q {E^i\over c} \gamma v_i

m {\d v^i \over \d \tau}
     = q F^{i\alpha} v_\alpha
     = q \left(-{E^i\over c} v_0 - \epsilon^{ij}{}_k B^k v_j\right)
     = q \left({E^i\over c} v^0 + \epsilon^i{}_{jk} B^k v^j\right)
     = q\gamma \left(E^i + ({\bf v}\times{\bf B})^i\right)"/></p>
</div><p>Using coordinate time <img class="math" src="../_images/math/7ad51d6d459e9bbdf9868b0129b30fbf89d35c09.svg" alt="t"/> and coordinates <img class="math" src="../_images/math/bd379d76154aa25ae8d397923e27bf9581f1e57c.svg" alt="{\bf x}"/> instead of the proper time
<img class="math" src="../_images/math/2492400c920539ebb8fac56dc6fe48dc6864abe9.svg" alt="\tau"/> and 4-vector <img class="math" src="../_images/math/37a7154325a0a36bcb39bc8285f8b3ffce56c05d.svg" alt="x^\mu"/>, we need to rewrite the action:</p>
<div class="math">
<p><img src="../_images/math/5fae0177aaf9a0c35d22100f042edc478cfddbe5.svg" alt="S = \int L(x^\mu, v^\mu) \d \tau
  = \int {1\over\gamma}L(x^\mu, v^\mu) \d t
  = \int L_{coord}({\bf x}, {\bf v}) \d t"/></p>
</div><p>where <img class="math" src="../_images/math/9528422804a4b93a7246cdbc7ff76a2a62269029.svg" alt="L_{coord}({\bf x}, {\bf v})"/> is the Lagrangian expressed in coordinates
<img class="math" src="../_images/math/bd379d76154aa25ae8d397923e27bf9581f1e57c.svg" alt="{\bf x}"/> and <img class="math" src="../_images/math/1c74f5c0909916fc0090a8adec74663baabbe757.svg" alt="{\bf v}"/> (and thus is not Lorentz invariant):</p>
<div class="math">
<p><img src="../_images/math/58e1c616aaadde9d8356cf84c911cfd1f6d8b1a3.svg" alt="L_{coord}({\bf x}, {\bf v}) = {1\over\gamma}L(x^\mu, v^\mu) =

     = -{m c^2\over\gamma} + {e\over\gamma}v_\alpha A^\alpha =

     = -{m c^2\over\gamma} + {e\over\gamma}(-c\gamma A^0 +\gamma v_i A^i) =

     = -m c^2\sqrt{1-{v^2\over c^2}} - e\phi + e{\bf v}\cdot {\bf A}"/></p>
</div><p>the particle’s canonical momentum <img class="math" src="../_images/math/47e6fabe09dba0a5de313352611d7bb8194a75b3.svg" alt="{\bf P}"/> is:</p>
<div class="math">
<p><img src="../_images/math/e79c5fdae748c232b5365584e4090691dc9096ee.svg" alt="P_i = {\partial L(t)\over\partial v_i}
    =-mc^2 {1\over 2\sqrt{1-{v^2\over c^2}}}\left(-2v_i\over c^2\right)
         + e A_i
    ={m v_i\over\sqrt{1-{v^2\over c^2}}} + e A_i

{\bf P} = {m{\bf v}\over\sqrt{1-{v^2\over c^2}}} + e{\bf A}
    = \gamma m{\bf v} + e{\bf A}
    = {\bf p} + e{\bf A}"/></p>
</div><p>where <img class="math" src="../_images/math/e5307cda0fe21d78e6feb366a9780da42888bb85.svg" alt="{\bf p} = {\bf P}-e{\bf A} = \gamma m{\bf v}"/> is the kinetic momentum.
Euler-Lagrange equations are:</p>
<div class="math">
<p><img src="../_images/math/4ed709620345e644a9f897c6d62b03eab35b8c73.svg" alt="{\d \over \d t} {\partial L_{coord}\over \partial v_i}
     = {\partial L_{coord} \over \partial x_i}

{\d \over \d t} P_i = {\partial L_{coord} \over \partial x_i}

{\d \over \d t} \left({m v_i\over\sqrt{1-{v^2\over c^2}}} + e A_i\right)
     = {\partial \over \partial x_i}\left(-m c^2\sqrt{1-{v^2\over c^2}}
         - e\phi + e{\bf v}\cdot {\bf A}\right)

{\d \over \d t} \left({m v_i\over\sqrt{1-{v^2\over c^2}}}\right)
     + e {\d A_i\over \d t}
     = -e{\partial \phi\over \partial x_i}
       +e{\bf v}\cdot{\partial {\bf A}\over \partial x_i}

{\d \over \d t} \left({m v_i\over\sqrt{1-{v^2\over c^2}}}\right)
     = e\left(-{\partial \phi\over \partial x_i}
       -{\d A_i\over \d t}
       +v_j{\partial A_j\over \partial x_i}\right)

{\d \over \d t} \left({m v_i\over\sqrt{1-{v^2\over c^2}}}\right)
     = e\left(-{\partial \phi\over \partial x_i}
       -{\partial A_i\over \partial t}-v_j{\partial A_i\over\partial x_j}
       +v_j{\partial A_j\over \partial x_i}\right)

{\d \over \d t} \left({m {\bf v}\over\sqrt{1-{v^2\over c^2}}}\right)
     = e\left({\bf E} + {\bf v}\times {\bf B}\right)"/></p>
</div><p>For continuous case (current), the force due to the magnetic field is:</p>
<div class="math">
<p><img src="../_images/math/bf52fa5009bafea92ab28fa0e1b3137e46d28854.svg" alt="{\bf F} = \int {\bf j}\times {\bf B} \d^3 x
    = I \int \d {\bf l}\times {\bf B}"/></p>
</div></div>
<div class="section" id="hamiltonian">
<h2>Hamiltonian<a class="headerlink" href="#hamiltonian" title="Permalink to this headline">¶</a></h2>
<p>Expressing <img class="math" src="../_images/math/1c74f5c0909916fc0090a8adec74663baabbe757.svg" alt="{\bf v}"/> in terms of <img class="math" src="../_images/math/47e6fabe09dba0a5de313352611d7bb8194a75b3.svg" alt="{\bf P}"/> we get:</p>
<div class="math">
<p><img src="../_images/math/1958cdc0e07d71bfc88e4edfadab00a9e2b6063a.svg" alt="{\bf P} = {m{\bf v}\over\sqrt{1-{v^2\over c^2}}} + e{\bf A}

{\bf P} - e{\bf A} = {m{\bf v}\over\sqrt{1-{v^2\over c^2}}}

P_i - e A_i = {m v_i\over\sqrt{1-{v^2\over c^2}}}

(P_i - e A_i)^2\left(1-{v^2\over c^2}\right) = m^2 v_i^2

(P_i - e A_i)^2\left(1-{(v_1^2 + v_2^2 + v_3^3)^2\over c^2}\right)
    = m^2 v_i^2

v_i^2 = {(P_i - e A_i)^2 c^2 \over m c^2 + ({\bf P} - e{\bf A})^2}

|v_i| = {|P_i - e A_i| \over \sqrt {m + {1\over c^2 } ({\bf P} - e{\bf A})^2}}

v_i = {P_i - e A_i \over \sqrt {m + {1\over c^2 } ({\bf P} - e{\bf A})^2}}

{\bf v} = {{\bf P} - e{\bf A}\over\sqrt{m^2 +
    {1\over c^2}({\bf P} - e{\bf A})^2}}

{\bf v} = {c({\bf P} - e{\bf A})\over\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}}"/></p>
</div><p>The system of equations was solved for <img class="math" src="../_images/math/12d0e1ed904e996401e1f18bc9dc4bd7e790ffc8.svg" alt="v_i"/> using the code
(in there <img class="math" src="../_images/math/f748a7907b025ca2f9c17637bdc9388240b7b794.svg" alt="v1s = v_1^2"/>, <img class="math" src="../_images/math/68c4a700b8742aac4e46c26d45e073023f0ce7dd.svg" alt="vs=v^2"/> and <img class="math" src="../_images/math/308cf3314123fe9040816011f48e654ff3632954.svg" alt="P1 = P_1 - eA_1"/>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">solve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;P1 P2 P3 m c v1s v2s v3s&quot;</span><span class="p">)</span>
<span class="go">(P1, P2, P3, m, c, v1s, v2s, v3s)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vs</span> <span class="o">=</span> <span class="n">v1s</span><span class="o">+</span><span class="n">v2s</span><span class="o">+</span><span class="n">v3s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">([</span><span class="n">P1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">vs</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="n">v1s</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">P2</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">vs</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="n">v2s</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">P3</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">vs</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="n">v3s</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">v1s</span><span class="p">,</span> <span class="n">v2s</span><span class="p">,</span> <span class="n">v3s</span><span class="p">])</span>
<span class="go">{v1s: P1**2*c**2/(P1**2 + P2**2 + P3**2 + c**2*m**2),</span>
<span class="go"> v2s: P2**2*c**2/(P1**2 + P2**2 + P3**2 + c**2*m**2),</span>
<span class="go"> v3s: P3**2*c**2/(P1**2 + P2**2 + P3**2 + c**2*m**2)}</span>
</pre></div>
</div>
<p>And the absolute value was removed by using the fact, that <img class="math" src="../_images/math/12d0e1ed904e996401e1f18bc9dc4bd7e790ffc8.svg" alt="v_i"/> has the same
sign as <img class="math" src="../_images/math/5ef0a587383be7b72e37eeb74900b6ce2fd0be1c.svg" alt="p_i = P_i - e A_i"/> which follows from the second equation.</p>
<p>The Hamiltonian is:</p>
<div class="math">
<p><img src="../_images/math/8ba16c72761b8564efe156d120176e3398333a12.svg" alt="H({\bf x}, {\bf P}, t) = {\bf v} \cdot {\bf P} - L =

    = {\bf v} \cdot {\bf P}
    +m c^2\sqrt{1-{v^2\over c^2}} + e\phi - e{\bf v}\cdot {\bf A} =

    = {\bf v} \cdot ({\bf P}-e{\bf A})
    +m c^2\sqrt{1-{v^2\over c^2}} + e\phi =

    = {c({\bf P} - e{\bf A})\cdot({\bf P}-e{\bf A})\over\sqrt{m^2c^2 +
    ({\bf P} - e{\bf A})^2}}
    +m c^2\sqrt{1-{1\over c^2}\left({c({\bf P} - e{\bf A})\over\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}}\right)^2} + e\phi =

    = {c({\bf P} - e{\bf A})^2\over\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}}
    +m c^2\sqrt{1-{({\bf P} - e{\bf A})^2\over m^2c^2 + ({\bf P} - e{\bf A})^2}} + e\phi =

    = {c({\bf P} - e{\bf A})^2\over\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}}
    +m c^2\sqrt{m^2 c^2 \over m^2c^2 + ({\bf P} - e{\bf A})^2} + e\phi =

    = {c\left(({\bf P} - e{\bf A})^2+m^2c^2\right)\over
        \sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}} + e\phi =

    = c\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2} + e\phi"/></p>
</div></div>
<div class="section" id="electromagnetic-stress-tensor">
<h2>Electromagnetic Stress Tensor<a class="headerlink" href="#electromagnetic-stress-tensor" title="Permalink to this headline">¶</a></h2>
<p>The stress tensor is calculated from the Lagrangian:</p>
<div class="math">
<p><img src="../_images/math/a1a11d63404d2b17c0000fe0b98f0b28e1332320.svg" alt="\L = -{1\over 4\mu_0} F_{\alpha\beta} F^{\alpha\beta}
    =-{1\over 2\mu_0}(\partial_\alpha A_\beta \partial^\alpha A^\beta
        -\partial_\beta A_\alpha \partial^\alpha A^\beta)"/></p>
</div><p>using the Noether formula:</p>
<div class="math">
<p><img src="../_images/math/72eb42405a1a70a445a1b3f78313165ca5bf72b6.svg" alt="T^\mu{}_\nu = {\partial\L\over\partial(\partial_\mu A_\alpha)}
                \partial_\nu A_\alpha
                -\delta^\mu{}_\nu \L =

    = -{1\over\mu_0} F^{\mu\alpha}
        \partial_\nu A_\alpha+{1\over 4\mu_0}\delta^\mu{}_\nu
            F_{\alpha\beta} F^{\alpha\beta}"/></p>
</div><p>We raise the <img class="math" src="../_images/math/704fb4977ea13f062f302dbd515de73872aa4f16.svg" alt="\nu"/> index:</p>
<div class="math">
<p><img src="../_images/math/e799a615022d7e928945b673bd173077827d8b61.svg" alt="T^{\mu\nu} = g^{\nu\lambda} T^\mu{}_\lambda
    = -{1\over\mu_0} F^{\mu\alpha}
        \partial^\nu A_\alpha+{1\over 4\mu_0}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta}"/></p>
</div><p>This tensor is not symmetric under the exchange of the <img class="math" src="../_images/math/4c94ac6db16bd0574365f32fed9ca53a95fc5911.svg" alt="\mu\nu"/> indices. To
make it symmetric, we add a total derivative term
<img class="math" src="../_images/math/3edf7d6f28302f44037e02359d123778fac4390b.svg" alt="\partial_\alpha K^{\alpha\mu\nu}"/>, where <img class="math" src="../_images/math/da5a3a0142ab9dd266735671781eb5adb872e9fa.svg" alt="K^{\alpha\mu\nu}"/> is antisymmetric
in its first two indices. This guarantees that
<img class="math" src="../_images/math/67318427ad9ebc157b3a52dd336bad5505d4cf60.svg" alt="\partial_\mu \partial_\alpha K^{\alpha\mu\nu}=0"/> so that the new stress energy
tensor is still conserved. We choose
<img class="math" src="../_images/math/7d660503ae459c2f72280772ce16d1830b59a7dd.svg" alt="K^{\alpha\mu\nu}={1\over\mu_0} F^{\mu\alpha} A^\nu"/> and get:</p>
<div class="math">
<p><img src="../_images/math/36042d4671306fb5952762e1de8f20a5c1771b83.svg" alt="T^{\mu\nu} +\partial_\alpha K^{\alpha\mu\nu}
    = -{1\over\mu_0} F^{\mu\alpha}
        \partial^\nu A_\alpha+{1\over 4\mu_0}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta}
            +{1\over\mu_0}\partial_\alpha ( F^{\mu\alpha} A^\nu) =

    = {1\over\mu_0}F^{\mu\alpha}
            (\partial_\alpha A^\nu - \partial^\nu A_\alpha)
        +{1\over 4\mu_0}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta}
            +{1\over\mu_0}(\partial_\alpha F^{\mu\alpha}) A^\nu =

    = {1\over\mu_0}F^{\mu\alpha} F_\alpha{}^\nu
        +{1\over 4\mu_0}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta} =

    = -{1\over\mu_0}\left(F^{\mu\alpha} F^\nu{}_\alpha
        -{1\over 4}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta}\right)"/></p>
</div><p>where we used <img class="math" src="../_images/math/e1321b47024da0d42dfa598d0254c4965a17fc83.svg" alt="\partial_\alpha F^{\mu\alpha} = 0"/>.</p>
<p>Another way to derive the stress energy tensor is from general relativity using
the formula:</p>
<div class="math">
<p><img src="../_images/math/1fb5c535d1b56d7964601c4a13e65168e8c1d32b.svg" alt="T_{\mu\nu} = - {2\over\sqrt{ |\det g| }}{\delta S_{EM}\over
        \delta g^{\mu\nu}}"/></p>
</div><p>So we write the action:</p>
<div class="math">
<p><img src="../_images/math/166cd25a0dca00ff35289f97edb6ea2cc9a7058b.svg" alt="S_{EM} = -\int {1\over 4\mu_0} F_{\alpha\beta} F^{\alpha\beta}
    \sqrt{ |\det g| }\d^4 x
    = -\int {1\over 4\mu_0} g^{\alpha\lambda} g^{\beta\rho} F_{\alpha\beta}
        F_{\lambda\rho}
    \sqrt{ |\det g| }\d^4 x"/></p>
</div><p>And vary with respect to <img class="math" src="../_images/math/91fad7dc69021895861eb233510c6c3d057f8e0f.svg" alt="g^{\mu\nu}"/>:</p>
<div class="math">
<p><img src="../_images/math/c7dd18220075046a849b81dcdc5cd9dc6ceaebad.svg" alt="\delta S_{EM}
    = -\delta \int {1\over 4\mu_0} g^{\alpha\lambda} g^{\beta\rho}
        F_{\alpha\beta} F_{\lambda\rho} \sqrt{ |\det g| }\d^4 x =

    = -{1\over 4\mu_0} \int  \left(\delta (g^{\alpha\lambda} g^{\beta\rho})
        F_{\alpha\beta} F_{\lambda\rho} \sqrt{ |\det g| }
        + g^{\alpha\mu} g^{\beta\rho}
        F_{\alpha\beta} F_{\lambda\rho} \left(\delta \sqrt{ |\det g| }
        \right)
        \right)\d^4 x =

    = -{1\over 4\mu_0} \int  \left(2(\delta g^{\alpha\lambda}) g^{\beta\rho}
        F_{\alpha\beta} F_{\lambda\rho} \sqrt{ |\det g| }
        + g^{\alpha\lambda} g^{\beta\rho}
        F_{\alpha\beta} F_{\lambda\rho} \left(-\half \sqrt{ |\det g| }
        g_{\mu\nu} (\delta g^{\mu\nu})
        \right)
        \right)\d^4 x =

    = -{1\over 4\mu_0} \int  \left(2(\delta g^{\alpha\lambda})
        F_{\alpha\beta} F_\lambda{}^\beta
        -\half F_{\alpha\beta} F^{\alpha\beta}
        g_{\mu\nu} (\delta g^{\mu\nu})
        \right) \sqrt{ |\det g| } \d^4 x =

    = -{1\over 2\mu_0} \int  \left(
        F_{\mu\beta} F_\nu{}^\beta
        -{1\over 4} F_{\alpha\beta} F^{\alpha\beta}
        g_{\mu\nu}
        \right) (\delta g^{\mu\nu}) \sqrt{ |\det g| } \d^4 x"/></p>
</div><p>And we get:</p>
<div class="math">
<p><img src="../_images/math/e6b4e2cdfb8c8edc67e8a9853249c0cf46a84f4b.svg" alt="T_{\mu\nu} = {1\over \mu_0} \left(
        F_{\mu\beta} F_\nu{}^\beta
        -{1\over 4} F_{\alpha\beta} F^{\alpha\beta}
        g_{\mu\nu} \right)"/></p>
</div></div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="coulomb-law">
<h3>Coulomb Law<a class="headerlink" href="#coulomb-law" title="Permalink to this headline">¶</a></h3>
<p>Maxwell’s equations in Lorenz gauge <a class="reference internal" href="#equation-aeq1">(2)</a>:</p>
<div class="math">
<p><img src="../_images/math/1b327e054b15159c299d1b5978cf2245381bfec1.svg" alt="\partial_\alpha\partial^\alpha A^\beta = \mu_0 j^\beta"/></p>
</div><p>have the solution for the scalar potential <a class="reference internal" href="#equation-ascal-sol">(7)</a>:</p>
<div class="math">
<p><img src="../_images/math/4292f2640ccba08738929c24766d842366765312.svg" alt="\phi({\bf x}, t)
    = {1\over 4\pi\epsilon_0}\int
     {\rho({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y"/></p>
</div><p>Assuming <img class="math" src="../_images/math/bdbdff7b30bc034fd98dbfc2023f68bca60f2054.svg" alt="{ |{\bf x} - {\bf y}| \over c} \ll t"/>:</p>
<div class="math">
<p><img src="../_images/math/6f8214d8fd18f2f01987fecda0c6f71dee895f9e.svg" alt="\phi({\bf x}, t)
    = {1\over 4\pi\epsilon_0}\int {\rho({\bf y},t)
        \over |{\bf x} - {\bf y}| }\d^3 y"/></p>
</div><p>Assuming the vector potential <img class="math" src="../_images/math/bd581394a175c1f02e32bf730fbf13880613058e.svg" alt="{\bf A}({\bf x}, t)={\bf A}({\bf x})"/>
is time independent, we get for the electric field:</p>
<div class="math">
<p><img src="../_images/math/e06aef0e337a5f830e8f148f63bc7c9cfbb88b0f.svg" alt="{\bf E}({\bf x}, t) = -\nabla\phi({\bf x}, t)
        - {\partial {\bf A}({\bf x}, t)\over\partial t}
    = -\nabla\phi({\bf x}, t)
    = -\nabla {1\over 4\pi\epsilon_0}\int {\rho({\bf y},t)
        \over |{\bf x} - {\bf y}| }\d^3 y =

    = - {1\over 4\pi\epsilon_0}\int \rho({\bf y},t) \nabla {1
        \over |{\bf x} - {\bf y}| }\d^3 y =

    = {1\over 4\pi\epsilon_0}\int \rho({\bf y},t)
    {{\bf x} - {\bf y} \over | {\bf x} - {\bf y}|^3 } \d^3 y"/></p>
</div><p>If the charge distribution can be approximated by an infinitely-narrow wire
with linear charge density <img class="math" src="../_images/math/713fa32c68f5456b0a0ca0e2aca9646c3d3d990c.svg" alt="\lambda(y, t) = {\d Q(t)\over\d y}"/>, we get:</p>
<div class="math">
<p><img src="../_images/math/4714899e4a1881ad185d2113045c0459b92afef1.svg" alt="\rho({\bf y},t) \d^3 y = \lambda({\bf y}, t) \d l"/></p>
</div><p>and:</p>
<div class="math">
<p><img src="../_images/math/9f340dc0c6f9835158c67e2e62363eff554540f9.svg" alt="{\bf E}({\bf x}, t)
    = {1\over 4\pi\epsilon_0}\int \lambda({\bf l}, t)
    {{\bf x} - {\bf l} \over | {\bf x} - {\bf l}|^3 } \d l"/></p>
</div><div class="section" id="example-straight-wire">
<h4>Example: Straight Wire<a class="headerlink" href="#example-straight-wire" title="Permalink to this headline">¶</a></h4>
<p>Let’s assume infinite straight wire with constant linear charge
density <img class="math" src="../_images/math/61fb852c48771d1bde8fe37cf1ea56342b588515.svg" alt="\lambda"/>:</p>
<div class="math">
<p><img src="../_images/math/3ae4715aa5cc27e54bfd4495a69f2a7ced3abb3b.svg" alt="{\bf l} = (0, 0, l)

\d {\bf l} = (0, 0, 1)\d l

{\bf x} = (x, y, z)

{\bf x}-{\bf l} = (x, y, z-l)

{\bf E}({\bf x})
     ={\lambda\over 4\pi\epsilon_0}\int_{-\infty}^\infty
        {{\bf x} - {\bf l} \over |{\bf x} - {\bf l}|^3 } \d l =

     ={\lambda\over 4\pi\epsilon_0} \int_{-\infty}^\infty
         {(x, y, z-l) \d l
            \over (x^2 + y^2 + (z-l)^2)^{3\over 2} } =

     ={\lambda\over 4\pi\epsilon_0} \int_{-\infty}^\infty
         {(x, y, 0) \d l
            \over (x^2 + y^2 + (z-l)^2)^{3\over 2} } =

     =(x, y, 0) {\lambda\over 4\pi\epsilon_0} \int_{-\infty}^\infty
         {\d u \over (x^2 + y^2 + u^2)^{3\over 2} } =

     =(x, y, 0) {\lambda\over 4\pi\epsilon_0} {2\over x^2 + y^2 } =

     =(x, y, 0) {\lambda\over 2\pi\epsilon_0} {1\over x^2 + y^2 }"/></p>
</div><p>For <img class="math" src="../_images/math/d0ae27d61bf54627f00990479d1a9f6dc13d872d.svg" alt="y=0"/>:</p>
<div class="math">
<p><img src="../_images/math/473d6bc6a3d8fb5f90adf1e6f589e62de2193c8f.svg" alt="{\bf E}(x, 0, z)
     =(x, 0, 0) {\lambda\over 2\pi\epsilon_0} {1\over x^2 }
     =(1, 0, 0) {\lambda\over 2\pi\epsilon_0 x}"/></p>
</div><p>We can also calculate the scalar potential as follows:</p>
<div class="math">
<p><img src="../_images/math/511889fe2ac95398cccc40d90805557607543658.svg" alt="\phi({\bf x})
    = {\lambda\over 4\pi\epsilon_0}\int_{-\infty}^\infty { \d l
        \over |{\bf x} - {\bf l}| } =

    = {\lambda\over 4\pi\epsilon_0}\int_{-\infty}^\infty { \d l
        \over (x^2 + y^2 + (z-l)^2)^{1\over 2} } =

    = {\lambda\over 4\pi\epsilon_0}\int_{-\infty}^\infty { \d u
        \over \sqrt{x^2 + y^2 + u^2} } =

    = \infty"/></p>
</div><p>Note that in the radial direction (let’s set for example <img class="math" src="../_images/math/d0ae27d61bf54627f00990479d1a9f6dc13d872d.svg" alt="y=0"/>) the result is
scale (translation) invariant, i.e. <img class="math" src="../_images/math/d18cb1d575cd0c4006b251e3d708197d47bb53ee.svg" alt="\phi(kx) = \phi(x)"/>.</p>
<p>In order to calculate with <img class="math" src="../_images/math/78bfb738a213fc7b022530310f5df6e2e20a4283.svg" alt="\phi({\bf x})"/>, we need to regularize it first.
Cutoff regularization is:</p>
<div class="math">
<p><img src="../_images/math/7c194181688d280c59b37fdef0af73053e22cdac.svg" alt="\phi({\bf x})
    = {\lambda\over 4\pi\epsilon_0}\int_{-L}^L { \d u
        \over \sqrt{x^2 + y^2 + u^2} } =

    = {\lambda\over 4\pi\epsilon_0}
        \log {\sqrt{x^2+y^2+L^2} + L \over
            \sqrt{x^2+y^2+L^2} - L}"/></p>
</div><p>where <img class="math" src="../_images/math/467d2501c4c7e34af5b55619b31c59a48951310c.svg" alt="L"/> is the regulator and also an auxiliary scale.
In this regularization, we lost the translational symmetry. The physical
quantities don’t depend on <img class="math" src="../_images/math/467d2501c4c7e34af5b55619b31c59a48951310c.svg" alt="L"/> in the limit <img class="math" src="../_images/math/86bd60db2f6de94a855b6777f65d2a30955475f2.svg" alt="L\to\infty"/>:</p>
<div class="math">
<p><img src="../_images/math/bb96255b7023ee1b6ffd061048e1ef425b549c8c.svg" alt="E_x = -{\partial \over \partial x} \phi(x)
= {\lambda\over 2\pi\epsilon_0 x} {L\over\sqrt{L^2+x^2}}
\to {\lambda\over 2\pi\epsilon_0 x}"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/7eb76130190f280c107526fd7f483b59beae20b0.svg" alt="\Delta \phi = \phi(x_2) - \phi(x_1) =
    {\lambda\over 4\pi\epsilon_0}
        \log {\sqrt{x_2^2+L^2} + L \over
            \sqrt{x_2^2+L^2} - L}
        {\sqrt{x_1^2+L^2} - L \over
            \sqrt{x_1^2+L^2} + L}
\to
{\lambda\over 4\pi\epsilon_0} \log {x_1^2\over x_2^2}"/></p>
</div><p>Dimensional regularization expresses the integral in the dimension
<img class="math" src="../_images/math/8394934cc3f27e66411d3fa9cd23c90553c59732.svg" alt="n=1-2\epsilon"/> as follows:</p>
<div class="math">
<p><img src="../_images/math/67d370240dfe269a1e5dd2533f49a66856d383ff.svg" alt="\phi({\bf x})
    = {\lambda\over 4\pi\epsilon_0}
        \int \d \Omega_n
        \int_0^\infty {u^{n-1}\over \Lambda^{n-1}}
        { \d u \over \sqrt{x^2 + y^2 + u^2} } =

    = {\lambda\over 4\pi\epsilon_0}
    {\Gamma\left(1-n\over2\right) \over \left({\sqrt{x^2+y^2}\over\Lambda}
    \sqrt\pi\right)^{1-n}} =

    = {\lambda\over 4\pi\epsilon_0}
    {\Gamma(\epsilon) \over \left({\sqrt{x^2+y^2}\over\Lambda}
        \right)^{2\epsilon} \pi^\epsilon } =

    = {\lambda\over 4\pi\epsilon_0}
    \left[{1\over\epsilon} -\gamma-\log\pi
        + \log{\Lambda^2\over x^2 + y^2} + O(\epsilon)\right]"/></p>
</div><p>Here <img class="math" src="../_images/math/422ee3c2ea1c100e366b972f43531e0f6f25a60c.svg" alt="\epsilon"/> is the regulator and <img class="math" src="../_images/math/ca824cfd34d9f0b9ea546477e00aa2af52fd92a3.svg" alt="\Lambda"/> is the auxiliary scale.
This regularization preserves the translational symmetry.
Now we can renormalize the integral. The minimal subtraction (MS)
renormalization is:</p>
<div class="math">
<p><img src="../_images/math/34ed3ecd7fe3f6dda9b1f436620959882a35d864.svg" alt="\phi_{{\rm MS}}({\bf x})
    = {\lambda\over 4\pi\epsilon_0}
    \left[-\gamma-\log\pi + \log{\Lambda^2\over x^2 + y^2}\right]"/></p>
</div><p>Another option is
the modified minimal subtraction (<img class="math" src="../_images/math/3321fb3664411ee0552d50e0c63a856a8eddf221.svg" alt="\overline{\rm MS}"/>) renormalization is:</p>
<div class="math">
<p><img src="../_images/math/41ba8bcef0b4ee873bdca34da9a451128131e74c.svg" alt="\phi_{\overline{\rm MS}}({\bf x})
    = {\lambda\over 4\pi\epsilon_0} \log{\Lambda^2\over x^2 + y^2}"/></p>
</div><p>Once we choose a renormalization scheme, we can calculate the electric field as
follows:</p>
<div class="math">
<p><img src="../_images/math/84019dcb7af08f3bd80bd885c24bd700f381c3cf.svg" alt="E_x = -{\partial \over \partial x} \phi_{\overline{\mathrm{MS}}}(x)
= -{\partial \over \partial x}
    {\lambda\over 4\pi\epsilon_0} \log{\Lambda^2\over
    x^2}=

= - {\lambda\over 4\pi\epsilon_0} {x^2\over\Lambda^2} \Lambda^2
    \left(-{2\over x^3}\right) =

= {\lambda\over 2\pi\epsilon_0} {1\over x}"/></p>
</div><p>and the potential difference as:</p>
<div class="math">
<p><img src="../_images/math/164bcdc6999675063f57e202f0250753410d4b98.svg" alt="\Delta \phi = \phi_{\overline{\mathrm{MS}}}(x_2)
    - \phi_{\overline{\mathrm{MS}}}(x_1) =
    {\lambda\over 4\pi\epsilon_0}
        \log {\Lambda^2\over x_2^2}{x_1^2\over \Lambda^2}
=
{\lambda\over 4\pi\epsilon_0} \log {x_1^2\over x_2^2}"/></p>
</div><p>In agreement with the previous result. The final results don’t depend on the
auxiliary scale <img class="math" src="../_images/math/ca824cfd34d9f0b9ea546477e00aa2af52fd92a3.svg" alt="\Lambda"/> and we are not doing any limits.</p>
</div>
</div>
<div class="section" id="biot-savart-law">
<h3>Biot-Savart Law<a class="headerlink" href="#biot-savart-law" title="Permalink to this headline">¶</a></h3>
<p>Maxwell’s equations in Lorenz gauge <a class="reference internal" href="#equation-aeq1">(2)</a>:</p>
<div class="math">
<p><img src="../_images/math/1b327e054b15159c299d1b5978cf2245381bfec1.svg" alt="\partial_\alpha\partial^\alpha A^\beta = \mu_0 j^\beta"/></p>
</div><p>have the solution for the vector potential <a class="reference internal" href="#equation-avec-sol">(8)</a>:</p>
<div class="math">
<p><img src="../_images/math/20cdfd3209a9c02861bfacfc37d317c182034ba5.svg" alt="{\bf A}({\bf x}, t) = {\mu_0\over 4\pi}\int
     {{\bf j}({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y"/></p>
</div><p>Assuming <img class="math" src="../_images/math/bdbdff7b30bc034fd98dbfc2023f68bca60f2054.svg" alt="{ |{\bf x} - {\bf y}| \over c} \ll t"/>:</p>
<div class="math">
<p><img src="../_images/math/de23c81866de620981bed758ba74f948fc9bf2a9.svg" alt="{\bf A}({\bf x}, t) = {\mu_0\over 4\pi}\int
     {{\bf j}({\bf y},t) \over |{\bf x} - {\bf y}| }\d^3 y"/></p>
</div><p>The magnetic field is then:</p>
<div class="math">
<p><img src="../_images/math/97c0f1a7cf932b71fbbdb96e479bf6f72a7e2797.svg" alt="{\bf B}({\bf x}, t) = \nabla \times {\bf A}({\bf x}, t)
     =\nabla \times {\mu_0\over 4\pi}\int
     {{\bf j}({\bf y},t) \over |{\bf x} - {\bf y}| }\d^3 y =

     ={\mu_0\over 4\pi}\int \left(\nabla {1\over
             |{\bf x} - {\bf y}| }\right)\times {\bf j}({\bf y},t)\d^3 y =

     ={\mu_0\over 4\pi}\int \left(-{{\bf x} - {\bf y}\over
             |{\bf x} - {\bf y}|^3 }\right)\times {\bf j}({\bf y},t)\d^3 y =

     ={\mu_0\over 4\pi}\int {\bf j}({\bf y},t) \times {{\bf x} - {\bf y}
            \over |{\bf x} - {\bf y}|^3 } \d^3 y"/></p>
</div><p>If the current can be approximated by an infinitely-narrow wire, we get:</p>
<div class="math">
<p><img src="../_images/math/5accf9f0d85dd72fb7774ba573ac18b99bfe21e5.svg" alt="{\bf j}({\bf y},t) \d^3 y = I(t) \d {\bf l}"/></p>
</div><p>and:</p>
<div class="math">
<p><img src="../_images/math/9c29d6302859be7610304204f85c2c14d79985d0.svg" alt="{\bf B}({\bf x}, t)
     ={\mu_0\over 4\pi}\int I(t)\d{\bf l} \times {{\bf x} - {\bf l}
            \over |{\bf x} - {\bf l}|^3 }"/></p>
</div><div class="section" id="id2">
<h4>Example: Straight Wire<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Let’s assume infinite straight wire carrying constant current <img class="math" src="../_images/math/12c28dc4bde9d63671497835d5c9601580f8724a.svg" alt="I"/>:</p>
<div class="math">
<p><img src="../_images/math/3442b9f7d151e0a1b3e9eceea67b44a1d9eed605.svg" alt="{\bf l} = (0, 0, l)

\d {\bf l} = (0, 0, 1)\d l

{\bf x} = (x, y, z)

{\bf x}-{\bf l} = (x, y, z-l)

{\bf B}({\bf x})
     ={\mu_0 I\over 4\pi}\int \d{\bf l} \times {{\bf x} - {\bf l}
            \over |{\bf x} - {\bf l}|^3 } =

     ={\mu_0 I\over 4\pi} \int_{-\infty}^\infty (0, 0, 1) \times
         {(x, y, z-l) \d l
            \over (x^2 + y^2 + (z-l)^2)^{3\over 2} } =

     =(y, -x, 0) {\mu_0 I \over 4\pi}\int_{-\infty}^\infty {\d l
            \over (x^2 + y^2 + (z-l)^2)^{3\over 2} } =

     =(y, -x, 0) {\mu_0 I \over 4\pi} {2\over x^2+y^2} =

     =(y, -x, 0) {\mu_0 I \over 2\pi} {1\over x^2+y^2}"/></p>
</div><p>Where we used the value of the folowing integral:</p>
<div class="math">
<p><img src="../_images/math/8e813770b74540547640b943c6d87f28aa1a5690.svg" alt="\int_{-\infty}^\infty {\d l \over (x^2+y^2 + (z - l)^2)^{3\over 2} }
    = \int_{-\infty}^\infty {\d u \over (x^2+y^2 + u^2)^{3\over 2} } =

    = \left[u\over (x^2+y^2) \sqrt{x^2+y^2 + u^2}\right]_{-\infty}^\infty
    = \left[\sign u\over (x^2+y^2) \sqrt{
        \left(x\over u\right)^2 + \left(y\over u\right)^2 + 1}
        \right]_{-\infty}^\infty =

    = {1\over x^2+y^2} - \left(-{1\over x^2+y^2}\right) = {2\over x^2+y^2}"/></p>
</div><p>For <img class="math" src="../_images/math/d0ae27d61bf54627f00990479d1a9f6dc13d872d.svg" alt="y=0"/>:</p>
<div class="math">
<p><img src="../_images/math/de29135d9751540b639b1dd339fedae7f77002a4.svg" alt="{\bf B}(x, 0, z)
     =(0, -x, 0) {\mu_0 I \over 2\pi} {1\over x^2}
     =(0, -1, 0) {\mu_0 I \over 2\pi x}"/></p>
</div></div>
<div class="section" id="example-circular-loop">
<h4>Example: Circular Loop<a class="headerlink" href="#example-circular-loop" title="Permalink to this headline">¶</a></h4>
<p>Let’s assume a circular loop:</p>
<div class="math">
<p><img src="../_images/math/f2abfab7127f0c7ee80d86bd374626e7aa99f91f.svg" alt="{\bf l} = (r\cos\phi, r\sin\phi, 0)

{\d {\bf l}\over\d \phi} = (-r\sin\phi, r\cos\phi, 0)

{\bf x} = (x, y, z)

{\bf x}-{\bf l} = (x-r\cos\phi, y-r\sin\phi, z)

{\bf B}({\bf x})
     ={\mu_0 I\over 4\pi}\int \d{\bf l} \times {{\bf x} - {\bf l}
            \over |{\bf x} - {\bf l}|^3 } =

     ={\mu_0 I\over 4\pi} \int_0^{2\pi} (-r\sin\phi, r\cos\phi, 0) \times
         {(x-r\cos\phi, y-r\sin\phi, z) \d \phi
            \over ((x-r\cos\phi)^2 + (y-r\sin\phi)^2 + z^2)^{3\over 2} } =

     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, -z\sin\phi, (x-r\cos\phi)\cos\phi+
                (y-r\sin\phi)\sin\phi)
         r\d \phi
            \over ((x-r\cos\phi)^2 + (y-r\sin\phi)^2 + z^2)^{3\over 2} } =

     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, -z\sin\phi, x\cos\phi+y\sin\phi-r)
         r\d \phi
            \over (x^2+y^2+z^2+r^2-2xr\cos\phi-2yr\sin\phi)^{3\over 2} }"/></p>
</div><p>Due to the symmetry of the problem, we can set <img class="math" src="../_images/math/d0ae27d61bf54627f00990479d1a9f6dc13d872d.svg" alt="y=0"/>:</p>
<div class="math">
<p><img src="../_images/math/a6c543043a0b864c946506eb30dd63a1a4c4791a.svg" alt="{\bf B}(x, 0, z)
     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, -z\sin\phi, x\cos\phi-r)
         r\d \phi
            \over (x^2+z^2+r^2-2xr\cos\phi)^{3\over 2} } =

     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, 0, x\cos\phi-r)
         r\d \phi
            \over (x^2+z^2+r^2-2xr\cos\phi)^{3\over 2} }"/></p>
</div><p>In the last equation we used the fact, that <img class="math" src="../_images/math/7fb859183e1f777bf2b453f215b8b99eddee2506.svg" alt="\sin\phi"/> is odd and <img class="math" src="../_images/math/bd62956ade890bbd327be842d8bdfe2514a99875.svg" alt="\cos\phi"/> is
even on the interval <img class="math" src="../_images/math/555fbc0936abb214bf737c94bc7e063018efc372.svg" alt="(0, 2\pi)"/>.
For <img class="math" src="../_images/math/0493837b443e56f379c3c9b7168bc3540ac5483d.svg" alt="x=y=0"/> we get:</p>
<div class="math">
<p><img src="../_images/math/bdb7c6f4915be04bdeddc7cfaf2d3bec39c8d86e.svg" alt="{\bf B}(0, 0, z)
     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, 0, -r)
         r\d \phi
            \over (r^2 + z^2)^{3\over 2} } =

     =(0, 0, -1) {\mu_0 I\over 4\pi} \int_0^{2\pi} {
         r^2\d \phi
            \over (r^2 + z^2)^{3\over 2} } =

     =(0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + z^2)^{3\over 2} }"/></p>
</div></div>
<div class="section" id="helmholtz-coil">
<h4>Helmholtz Coil<a class="headerlink" href="#helmholtz-coil" title="Permalink to this headline">¶</a></h4>
<p>Helmholtz coil is a set of two circular loops of radius <img class="math" src="../_images/math/c3d0937ae47b2f52cec7965ba469ca54a3403a43.svg" alt="r"/>, that are <img class="math" src="../_images/math/be2dd9d27b966f0b791025bf0dcb014e85baa448.svg" alt="d"/>
apart, where <img class="math" src="../_images/math/046bfb5b4fa647d996bd7b8871d25f890fb79fba.svg" alt="d=r"/>. Let’s calculate the magnetic field on the axis.
Magnetic field of the first coil is (see the previous example):</p>
<div class="math">
<p><img src="../_images/math/b270e463d5207d563ea9c2cd1227e3cfe3017292.svg" alt="{\bf B}_1(0, 0, z) = (0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + z^2)^{3\over 2} }"/></p>
</div><p>Second coil is positioned <img class="math" src="../_images/math/be2dd9d27b966f0b791025bf0dcb014e85baa448.svg" alt="d"/> above the first one:</p>
<div class="math">
<p><img src="../_images/math/381a23b51234e5fd1b8bcb7038c3a5e867ff6b75.svg" alt="{\bf B}_2(0, 0, z) = (0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + (z-d)^2)^{3\over 2} }"/></p>
</div><p>The total magnetic field is:</p>
<div class="math">
<p><img src="../_images/math/8cf4bd8938730b905e3f54114a5b4f11f664b7b9.svg" alt="{\bf B}(0, 0, z) = {\bf B}_1(0, 0, z) + {\bf B}_2(0, 0, z) =

= (0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + z^2)^{3\over 2} }
+ (0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + (z-d)^2)^{3\over 2} } =

= (0, 0, -1) {\mu_0 I r^2\over 2} \left(
         {1 \over (r^2 + z^2)^{3\over 2} } +
         {1 \over (r^2 + (z-d)^2)^{3\over 2} }\right)"/></p>
</div><p>The field in the middle:</p>
<div class="math">
<p><img src="../_images/math/af4cbe38886d290f6f580ceee979b5da46e7f5b7.svg" alt="{\bf B}(0, 0, {d\over 2})
= (0, 0, -1) {\mu_0 I r^2\over 2} \left(
         {1 \over (r^2 + \left(d\over 2\right)^2)^{3\over 2} } +
         {1 \over (r^2 + \left(d\over 2\right)^2)^{3\over 2} }\right) =

= (0, 0, -1) {\mu_0 I r^2
         \over (r^2 + \left(d\over 2\right)^2)^{3\over 2} }"/></p>
</div><p>For <img class="math" src="../_images/math/b309b94c510fcf8efaadda2811b825469e945a20.svg" alt="r=d"/> we get:</p>
<div class="math">
<p><img src="../_images/math/4d26fa0bae768bef4fadf26de5edba80d05ff43d.svg" alt="{\bf B}(0, 0, {d\over 2})
= (0, 0, -1) {\mu_0 I r^2
         \over (r^2 + \left(r\over 2\right)^2)^{3\over 2} } =

= (0, 0, -1) {\mu_0 I
         \over r (1 + \left(1\over 2\right)^2)^{3\over 2} } =

= (0, 0, -1) {\mu_0 I 4^{3\over 2}
         \over r 5^{3\over 2} } =

= (0, 0, -1) {8 \over 5 \sqrt 5} {\mu_0 I \over r} =

= (0, 0, -1) B"/></p>
</div><p>where the magnitude of <img class="math" src="../_images/math/f06fff000efa529593956559ade723e16aa36424.svg" alt="{\bf B}"/> is:</p>
<div class="math">
<p><img src="../_images/math/144195bb05260cefbccf300202076b9580f01f85.svg" alt="B = {8 \over 5 \sqrt 5} {\mu_0 I \over r}"/></p>
</div><p>For <img class="math" src="../_images/math/6a1296de242d1aa3a8b8345079694c34b2e52238.svg" alt="r=0.15\rm\, m"/> and <img class="math" src="../_images/math/46243df5fe6a73884f165df1f56591b3c35edf77.svg" alt="N=130"/> turns we get the magnitude of the field as
(we use SI units, so <img class="math" src="../_images/math/12c28dc4bde9d63671497835d5c9601580f8724a.svg" alt="I"/> is in <img class="math" src="../_images/math/8118ffcbaf4ae98a9fae25d800a304a342eedb8d.svg" alt="A"/> and <img class="math" src="../_images/math/8eb7c8af84dc3945487fc2588e930f59b4aa574c.svg" alt="B"/> in tesla):</p>
<div class="math">
<p><img src="../_images/math/4b7aa4659089661a7a0f03c2851acaaaaf042b54.svg" alt="B = {8 \over 5 \sqrt 5} {\mu_0 N I \over r}
  = {8 \over 5 \sqrt 5} {4\pi 10^{-7} \cdot 130 I \over 0.15}
  = 7.79\cdot 10^{-4} I"/></p>
</div><p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;</span><span class="si">%e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e-7</span><span class="o">*</span><span class="mi">130</span> <span class="o">/</span> <span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mf">0.15</span><span class="p">))</span>
<span class="go">&#39;7.792861e-04&#39;</span>
</pre></div>
</div>
<p>Equation of motion for an electron in this field is:</p>
<div class="math">
<p><img src="../_images/math/8bfdcf9b1b6fc22f6df46d496501ca76a3bee585.svg" alt="m {\d^2 {\bf x}\over \d t^2} = e\left({\bf v} \times {\bf B}\right)

m {\d^2 {\bf x}\over \d t^2} = eB\, (v_y, -v_x, 0)"/></p>
</div><p>The general solution is:</p>
<div class="math">
<p><img src="../_images/math/d7708f87c5f618604d0f90c0f699e98143de9009.svg" alt="{\bf x} = {v m\over eB} \left(x + \cos {eB\over m} (t-t_0),
            y -\sin {eB\over m} (t-t_0),
            z\right)"/></p>
</div><p>So the electron is moving in a circle with a center <img class="math" src="../_images/math/8491327b6e605396094cbdfab9e140b0fdf51abe.svg" alt="(x, y, z)"/>,
<img class="math" src="../_images/math/77c719419fd16d185abc4675c8e73222c9fe7b96.svg" alt="t_0"/> depends on the initial direction of the velocity and <img class="math" src="../_images/math/2fe790b55be86dd7c6ff2555da33da82b08f8c9d.svg" alt="v"/> is the magnitude
of the initial velocity. There can also be a possible movement in the <img class="math" src="../_images/math/56e3821daac476e92ff7e7e1fb9469c400bf42ab.svg" alt="z"/>
direction, but for the following initial conditions there is none:</p>
<div class="math">
<p><img src="../_images/math/e3a991c9f004080284b993c15fadcb3503b13c34.svg" alt="{\bf x}_0 = (0, 0, 0)

{\bf v}_0 = (0, -v, 0)"/></p>
</div><p>Then we get:</p>
<div class="math">
<p><img src="../_images/math/2087ccb9c51115828d028ffdbb406b26762c97d5.svg" alt="{\bf x} = {v m\over eB} \left(-1+\cos {eB\over m} t,
            -\sin {eB\over m} t,
            0\right)

{\bf v} = v \left(-\sin {eB\over m} t,
            -\cos {eB\over m} t,
            0\right)"/></p>
</div><p>So the radius of the circle is <img class="math" src="../_images/math/53764adecae1bdda7b2dd944a6033fcb5e7e727f.svg" alt="R = {v m\over eB}"/>.
Let the electrons by accelerated by the electric potential <img class="math" src="../_images/math/d2eeb453d8cdb59f1e536084a98b1b40d1bc123f.svg" alt="V"/>:</p>
<div class="math">
<p><img src="../_images/math/d6ba616fc400110624b3423afc95dfdd9766d8e4.svg" alt="\half m v^2 = e V"/></p>
</div><p>So the initial velocity is:</p>
<div class="math">
<p><img src="../_images/math/acb7e102d1f6ed72d78f192daaffe689a9ce86e3.svg" alt="v = \sqrt{2eV\over m}"/></p>
</div><p>and we get for the radius:</p>
<div class="math">
<p><img src="../_images/math/f882d92d7efee7bee10907ce3d5c978d4a17aeba.svg" alt="R = {v m\over eB}
    = {m\over eB} \sqrt{2eV\over m}
    = {1\over B} \sqrt{2mV\over e}"/></p>
</div><p>from which the electron charge versus mass ratio is:</p>
<div class="math">
<p><img src="../_images/math/832261dac1e92b7d756ab5d60b8107a83a62ba05.svg" alt="{e\over m} = {2V \over R^2 B^2}
    = {2V \over R^2\left({8 \over 5 \sqrt 5} {\mu_0 N I \over r}\right)^2}=

    = {125 V r^2 \over 32 \mu_0^2 R^2 N^2 I^2}"/></p>
</div><p>For <img class="math" src="../_images/math/6a1296de242d1aa3a8b8345079694c34b2e52238.svg" alt="r=0.15\rm\, m"/>, <img class="math" src="../_images/math/46243df5fe6a73884f165df1f56591b3c35edf77.svg" alt="N=130"/>, <img class="math" src="../_images/math/fe566ffee573be559a6e00a1fdca749d793eee2a.svg" alt="V=300\rm\,V"/>, <img class="math" src="../_images/math/6508dae8150b36a27777032cfb0dd8c7ac2dc06f.svg" alt="R=0.05\rm\,m"/>, <img class="math" src="../_images/math/fbc82897a86781d852ea1804ce7fa66354c30097.svg" alt="I=1.48\rm\,A"/>
we get:</p>
<div class="math">
<p><img src="../_images/math/a2607d3a333a210ada991e2e8b16c8ba43098ba7.svg" alt="{e\over m} = 1.80 \cdot 10^{11}\rm\,C\cdot kg^{-1}"/></p>
</div><p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">130</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span> <span class="o">=</span> <span class="mf">1.48</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu0</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e-7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;</span><span class="si">%e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">125</span> <span class="o">*</span> <span class="n">V</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">32</span> <span class="o">*</span> <span class="n">mu0</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">I</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="go">&#39;1.804238e+11&#39;</span>
</pre></div>
</div>
<p>Reference value is:</p>
<div class="math">
<p><img src="../_images/math/37122e38dfe0b6174167e5557393594cd20c632e.svg" alt="{e\over m} = 1.7588 \cdot 10^{11}\rm\,C\cdot kg^{-1}"/></p>
</div><p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="mf">1.6021766e-19</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="mi">299792458</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eV</span> <span class="o">=</span> <span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">KeV</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">eV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="mf">510.998910</span> <span class="o">*</span> <span class="n">KeV</span> <span class="o">/</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span>
<span class="go">9.109382795192204e-31</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;</span><span class="si">%e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">e</span> <span class="o">/</span> <span class="n">m</span><span class="p">)</span>
<span class="go">&#39;1.758820e+11&#39;</span>
</pre></div>
</div>
<p>or even simpler (we do not actually need the value of the electron charge
<img class="math" src="../_images/math/dbd8f4c70b4bb981a710f0e5cc40808cd1523cfc.svg" alt="e"/>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="mi">299792458</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">KeV</span> <span class="o">=</span> <span class="mf">1e3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="mf">510.998910</span> <span class="o">*</span> <span class="n">KeV</span> <span class="o">/</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;</span><span class="si">%e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span>
<span class="go">&#39;1.758820e+11&#39;</span>
</pre></div>
</div>
<p>We can use the experimental value to calculate the electron rest mass energy:</p>
<div class="math">
<p><img src="../_images/math/9231b27950ce3e25dd9e3fff4000a2ab2f705a36.svg" alt="m c^2 = {c^2 \over 1.804238\cdot 10^{11}}{\rm\, eV}
    = 498.1356 {\rm\, KeV}"/></p>
</div></div>
</div>
<div class="section" id="ampere-s-force-law">
<h3>Ampère’s Force Law<a class="headerlink" href="#ampere-s-force-law" title="Permalink to this headline">¶</a></h3>
<p>The force on a wire 1 due to a magnetic field of a wire 2 is:</p>
<div class="math">
<p><img src="../_images/math/f514dc5ce9a91861b0bdf5521b5646ca2926b947.svg" alt="{\bf F} = I_1 \int \d {\bf l}_1 \times {\bf B}({\bf l}_1)

{\bf B}({\bf x})
     ={\mu_0\over 4\pi}\int I_2(t)\d{\bf l}_2 \times {{\bf x} - {\bf l}_2
            \over |{\bf x} - {\bf l}_2|^3 }"/></p>
</div><p>Where <img class="math" src="../_images/math/861214b60d2b01bc1d65627a8c2c380916ec460b.svg" alt="{\bf B}({\bf x})"/> is the magnetic field produced by the wire 2.
Combining these two equations we get:</p>
<div class="math">
<p><img src="../_images/math/fd8bd316a2a4dbcc51d4b0340a1f026e67c10291.svg" alt="{\bf F} = I_1 \int \d {\bf l}_1 \times {\bf B}({\bf l}_1) =

    = I_1 \int \d {\bf l}_1 \times \left(
     {\mu_0\over 4\pi}\int I_2(t)\d{\bf l}_2 \times {{\bf l}_1 - {\bf l}_2
            \over |{\bf l}_1 - {\bf l}_2|^3 }\right) =

    = {\mu_o I_1 I_2\over 4\pi} \int \int {\d {\bf l}_1 \times (
     \d{\bf l}_2 \times ({\bf l}_1 - {\bf l}_2))
            \over |{\bf l}_1 - {\bf l}_2|^3 } =

    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        \d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
        ({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
            \over |{\bf l}_1 - {\bf l}_2|^3 }"/></p>
</div><div class="section" id="parallel-straight-wires">
<h4>Parallel Straight Wires<a class="headerlink" href="#parallel-straight-wires" title="Permalink to this headline">¶</a></h4>
<p>We calculate the force between two parallel straight infinite wires:</p>
<div class="math">
<p><img src="../_images/math/348b1180a7314f8f4853f0cdd9bedb0ccc2c2008.svg" alt="{\bf l}_1 = ({d\over 2}, 0, l_1)

\d{\bf l}_1 = (0, 0, \d l_1)

{\bf l}_2 = (-{d\over 2}, 0, l_2)

\d{\bf l}_2 = (0, 0, \d l_2)

{\bf l}_1 - {\bf l}_2 = (d, 0, l_1-l_2)

\d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
    = (0, 0, \d l_2) (l_1-l_2)\d l_1 - (d, 0, l_1-l_2)\d l_2 \d l_1
    = (-d, 0, 0)\d l_1 \d l_2

{\bf F}
    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        \d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
        ({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
            \over |{\bf l}_1 - {\bf l}_2|^3 } =

    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        (-d, 0, 0)\d l_1 \d l_2
            \over (d^2 + (l_1 - l_2)^2)^{3\over 2} } =

    = (-1, 0, 0){\mu_o I_1 I_2\over 4\pi} \int \d l_1
        \int_{-\infty}^\infty \d l_2 {
        d
            \over (d^2 + (l_1 - l_2)^2)^{3\over 2} } =

    = (-1, 0, 0){\mu_o I_1 I_2\over 4\pi} \int \d l_1
        {2\over d} =

    = (-1, 0, 0){\mu_o I_1 I_2\over 2\pi d} \int \d l_1"/></p>
</div><p>Where we used the value of the folowing integral:</p>
<div class="math">
<p><img src="../_images/math/3624910c9905e131b5eadf51dce4d1ea5b626fb0.svg" alt="\int_{-\infty}^\infty \d l_2 {d \over (d^2 + (l_1 - l_2)^2)^{3\over 2} }
    = \int_{-\infty}^\infty \d x {d \over (d^2 + x^2)^{3\over 2} } =

    = \left[x\over d \sqrt{d^2 + x^2}\right]_{-\infty}^\infty
    = \left[\sign x\over d \sqrt{\left(d\over x\right)^2 + 1}
        \right]_{-\infty}^\infty =

    = {1\over d} - \left(-{1\over d}\right) = {2\over d}"/></p>
</div><p>As such, the direction of the force on the first wire (at coordinates <img class="math" src="../_images/math/eb51b07c95443d36dcd01e687810bc6471f2e802.svg" alt="({d\over
2}, 0, 0)"/> going in the <img class="math" src="../_images/math/56e3821daac476e92ff7e7e1fb9469c400bf42ab.svg" alt="z"/> direction) will be to the left and the force per
unit length is:</p>
<div class="math">
<p><img src="../_images/math/457a01e5c3023d71555a88d5547b382ed017aa72.svg" alt="F_m = {\mu_o I_1 I_2\over 2\pi d}"/></p>
</div><p>Because the second wire is at the coordinates <img class="math" src="../_images/math/ad9b4e1bfe58d1d676b3e2a56ed85422973276fb.svg" alt="(-{d\over
2}, 0, 0)"/> and the force on the first wire is in the direction
<img class="math" src="../_images/math/3ce03229aad30ec0167020b7976c858cc4cb30f7.svg" alt="(-1, 0, 0)"/>, the force between the wires is attractive, as long as <img class="math" src="../_images/math/f88234fcc0eb49f19dc647ce73dbdfdf3c5fa863.svg" alt="I_1"/> and
<img class="math" src="../_images/math/8af935143eea035c060e2c21e091d42ad4ec6d6a.svg" alt="I_2"/> have the same sign (either both currents go up, or both down)
and repulsive if <img class="math" src="../_images/math/f88234fcc0eb49f19dc647ce73dbdfdf3c5fa863.svg" alt="I_1"/> and <img class="math" src="../_images/math/8af935143eea035c060e2c21e091d42ad4ec6d6a.svg" alt="I_2"/> have opposite signs.</p>
<p>Let <img class="math" src="../_images/math/ff91b3ac54a5f28126b7d96f67f082e8e383984d.svg" alt="d=1\rm\,m"/>, <img class="math" src="../_images/math/84fdc7a0c71941d47d3c0c56187c06e829556aa2.svg" alt="I_1 = I_2 = 1\rm\, A"/>, then the force is attractive and
(we also use <img class="math" src="../_images/math/4a84b4672c3725eb84ed5ae8a9ecf521ef1a3e72.svg" alt="\mu_0 = 4\pi \cdot 10^{-7}"/>):</p>
<div class="math">
<p><img src="../_images/math/fb501b5256863ced41dc937eedd6c28b26b17aee.svg" alt="F_m = {4\pi \cdot 10^{-7} \over 2\pi} {\rm\, N \cdot m^{-1}}
    = 2 \cdot 10^{-7} {\rm\, N \cdot m^{-1}}"/></p>
</div></div>
<div class="section" id="perpendicular-straight-wires">
<h4>Perpendicular Straight Wires<a class="headerlink" href="#perpendicular-straight-wires" title="Permalink to this headline">¶</a></h4>
<p>We calculate the force between two perpendicular straight infinite wires:</p>
<div class="math">
<p><img src="../_images/math/f7934831636d531a10335865e338be4da18bc6ca.svg" alt="{\bf l}_1 = ({d\over 2}, 0, l_1)

\d{\bf l}_1 = (0, 0, \d l_1)

{\bf l}_2 = (-{d\over 2}, l_2, 0)

\d{\bf l}_2 = (0, \d l_2, 0)

{\bf l}_1 - {\bf l}_2 = (d, -l_2, l_1)

\d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
    = (0, \d l_2, 0) l_1\d l_1
    = (0, l_1, 0)\d l_1 \d l_2

{\bf F}
    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        \d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
        ({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
            \over |{\bf l}_1 - {\bf l}_2|^3 } =

    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        (0, l_1, 0)\d l_1 \d l_2
            \over (d^2 + l_1^2 + l_2^2)^{3\over 2} } =

    = (0, 1, 0){\mu_o I_1 I_2\over 4\pi} \int_{-\infty}^\infty \d l_1
        \int_{-\infty}^\infty \d l_2 {
        l_1
            \over (d^2 + l_1^2 +l_2^2)^{3\over 2} } =

    = (-1, 0, 0){\mu_o I_1 I_2\over 4\pi} \int_{-\infty}^\infty \d l_1
        {2 l_1\over d^2 + l_1^2}
        =

    = 0"/></p>
</div><p>The integral is an odd functin of <img class="math" src="../_images/math/0b804ba77044f877c28aba6339e58187515a8305.svg" alt="l_1"/>, so it is zero.  We used the value of
the folowing integral (but in fact it is already seen before this integral is
needed that the double integral must be zero):</p>
<div class="math">
<p><img src="../_images/math/0fee9f85e145e5563d1d46adb7b378b81e564431.svg" alt="\int_{-\infty}^\infty \d l_2 {l_1 \over (d^2 + l_1^2 + l_2^2)^{3\over 2} }

    = \left[l_1 l_2\over (d^2+l_1^2) \sqrt{d^2 +l_1^2 + l_2^2}
        \right]_{-\infty}^\infty
    = \left[l_1 \sign l_2\over (d^2+l_1^2)
        \sqrt{\left(d\over l_2\right)^2 + \left(l_1\over l_2\right)^2 + 1}
        \right]_{-\infty}^\infty =

    = {l_1\over d^2+l_1^2} - \left(-{l_1\over d^2 + l_1^2}\right)
    = {2 l_1\over d^2 + l_1^2}"/></p>
</div><p>As such, there will be no net force.</p>
</div>
<div class="section" id="infinitely-long-wire-and-a-square-loop">
<h4>Infinitely Long Wire and a Square Loop<a class="headerlink" href="#infinitely-long-wire-and-a-square-loop" title="Permalink to this headline">¶</a></h4>
<p>We calculate the net force on a square loop with current <img class="math" src="../_images/math/f88234fcc0eb49f19dc647ce73dbdfdf3c5fa863.svg" alt="I_1"/> of side <img class="math" src="../_images/math/ff066e4162ecea3b1eeadcc4c6fa8ced9cfaf575.svg" alt="a"/>,
whose center is <img class="math" src="../_images/math/be2dd9d27b966f0b791025bf0dcb014e85baa448.svg" alt="d"/> far from an infinitely long wire with current <img class="math" src="../_images/math/8af935143eea035c060e2c21e091d42ad4ec6d6a.svg" alt="I_2"/>:</p>
<p>The wire has coordinates <img class="math" src="../_images/math/29766e68c9a8ae0b17b39c9d290575818f9ea168.svg" alt="(0, 0, z)"/> and the magnetic field from it is (see the
example above):</p>
<div class="math">
<p><img src="../_images/math/b1b9f3dd831cc323d6eb0e164b08937f029bb96c.svg" alt="{\bf B}(x, 0, z) = (0, -1, 0) {\mu_0 I \over 2\pi x}"/></p>
</div><p>The four sides of the loop are (<img class="math" src="../_images/math/3ec61b5fdd2ed50382ca03b9287c0fef815e99d8.svg" alt="0 \le l_1 \le a"/>):</p>
<div class="math">
<p><img src="../_images/math/effcc1a9c7c6c590fc1befa1ba47bc8ba59cb3fe.svg" alt="{\bf l}_1 = (d-{a\over 2}+l_1, 0, {a\over2})

{\bf l}_1 = (d+{a\over 2}, 0, {a\over2}-l_1)

{\bf l}_1 = (d+{a\over 2}-l_1, 0, -{a\over2})

{\bf l}_1 = (d-{a\over 2}, 0, -{a\over2}+l_1)"/></p>
</div><p>and the differentials are:</p>
<div class="math">
<p><img src="../_images/math/1c5147eadd82c10d5095bf9540c8ad7b82b5a9a1.svg" alt="\d {\bf l}_1 = (1, 0, 0) \d l_1

\d {\bf l}_1 = (0, 0, -1) \d l_1

\d {\bf l}_1 = (-1, 0, 0) \d l_1

\d {\bf l}_1 = (0, 0, 1) \d l_1"/></p>
</div><p>The net force on the loop is:</p>
<div class="math">
<p><img src="../_images/math/f24e8e7dab66e87d814efff99823316d0961446e.svg" alt="{\bf F} = I_1 \int \d {\bf l}_1 \times {\bf B}
    = I_1 \int \d {\bf l}_1 \times (0, -1, 0) {\mu_0 I_2 \over 2\pi
        ({\bf l}_1)_x} =

    = {\mu_0 I_1 I_2\over 2\pi}\left(
        \int_0^a {(0, 0, 1)\d l_1\over d-{a\over 2} + l_1}
        +\int_0^a {(1, 0, 0)\d l_1\over d+{a\over 2}}
        +\int_0^a {(0, 0, -1)\d l_1\over d+{a\over 2}-l_1}
        +\int_0^a {(-1, 0, 0)\d l_1\over d-{a\over 2}}
        \right) =

    = {\mu_0 I_1 I_2\over 2\pi}\left(
        (0, 0, 1)\left[\log \left| d-{a\over 2} + l_1 \right|
            -\log \left|d + {a\over 2} - l_1\right| \right]_0^a
        +(1, 0, 0)\left({a\over d + {a\over 2}}-{a\over d - {a\over 2}}
            \right)\right) =

    = {\mu_0 I_1 I_2\over 2\pi}\left(
        (0, 0, 1) \cdot 0 +
        (1, 0, 0){a^2\over d^2 - \left({a\over 2}\right)^2}
            \right) =

    = (1, 0, 0){\mu_0 I_1 I_2\over 2\pi}
        {a^2\over d^2 - \left({a\over 2}\right)^2}"/></p>
</div></div>
</div>
<div class="section" id="magnetic-dipole">
<h3>Magnetic Dipole<a class="headerlink" href="#magnetic-dipole" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="../_images/math/44b889bf302be195fa9508881a7431f19d384d81.svg" alt="{\bf A}({\bf r}) = {\mu_0\over 4\pi} {{\bf m}\times{\bf r}\over r^3}

{\bf B}({\bf r}) = \nabla\times {\bf A}
= {\mu_0\over 4\pi} \nabla\times
    \left({{\bf m}\times{\bf r}\over r^3}\right) =

= {\mu_0\over 4\pi} \left({\bf m}\nabla\cdot\left({\bf r}\over r^3\right)
    -{\bf m}\cdot\nabla\left({\bf r}\over r^3\right)
    \right) =

= {\mu_0\over 4\pi} \left({\bf m}\left(\left(\nabla{1\over r^3}\right)
        \cdot{\bf r}+{1\over r^3}\nabla\cdot{\bf r}\right)
    -{\bf m}\cdot\left(\left(\nabla{1\over r^3}\right)
        {\bf r}+{1\over r^3}\nabla{\bf r}\right)\right)
    =

= {\mu_0\over 4\pi} \left({\bf m}\left(\left(-{3{\bf r}\over r^5}\right)
        \cdot{\bf r}+{1\over r^3}3\right)
    -{\bf m}\cdot\left(\left(-{3{\bf r}\over r^5}\right)
        {\bf r}+{1\over r^3}\one\right)\right)
    =

= {\mu_0\over 4\pi} \left({\bf m}\left(-{3\over r^3}+{3\over r^3}\right)
    +{\bf m}\cdot\left({3{\bf r}{\bf r}\over r^5}-{\one\over r^3}\right)
    \right)
    =

= {\mu_0\over 4\pi} \left({3{\bf r}({\bf m}\cdot{\bf r})\over r^5}
    -{{\bf m}\over r^3}\right)"/></p>
</div></div>
<div class="section" id="bar-magnet">
<h3>Bar Magnet<a class="headerlink" href="#bar-magnet" title="Permalink to this headline">¶</a></h3>
<p>A good model of a bar magnet of the length <img class="math" src="../_images/math/467d2501c4c7e34af5b55619b31c59a48951310c.svg" alt="L"/> and width <img class="math" src="../_images/math/69d777bf93d65c44f97d80e69361d2e806b421a8.svg" alt="W"/> is a combination
of two magnetic monopoles (that sit inside the magnet, so one cannot actually
see them, just their behavior outside the magnet):</p>
<div class="math">
<p><img src="../_images/math/72cd882b69eea04f1c2a0a23fa03198c88eb172f.svg" alt="{\bf B}({\bf x}) = {\mu_0 Q_m\over 4\pi} \left(
    {{\bf x}-{\bf p}_1 \over |{\bf x}-{\bf p}_1|^3}
    -
    {{\bf x}-{\bf p}_2 \over |{\bf x}-{\bf p}_2|^3}
    \right)"/></p>
</div><p>where:</p>
<div class="math">
<p><img src="../_images/math/48a9359ad32a45b22e732c2bae38b63bfc8e12e6.svg" alt="{\bf p}_1 = (0, 0, d)

{\bf p}_2 = (0, 0, -d)

d = {L-W\over 2}"/></p>
</div><p>The magnetic moment vector is:</p>
<div class="math">
<p><img src="../_images/math/e38f3ec1009997b038a6e5275c476f8881ec5c99.svg" alt="{\bf m} = Q_m ({\bf p}_1 - {\bf p}_2)"/></p>
</div><p>and its magnitude then is:</p>
<div class="math">
<p><img src="../_images/math/7742e2990e77a9f69549df0b4bd4415386e82d59.svg" alt="m = 2 Q_m d"/></p>
</div><p>The permeability is:</p>
<div class="math">
<p><img src="../_images/math/ac9f45c56f3863e5988f41ed78a2dd79916b9648.svg" alt="\mu_0 = 4\pi \cdot 10^{-7}{\rm\,H\cdot m^{-1}}
    = 4\pi \cdot 10^{-7}{\rm\,V\cdot s\cdot A^{-1}\cdot m^{-1}}"/></p>
</div><p>For a typical bar magnet, we have for example:</p>
<div class="math">
<p><img src="../_images/math/7428fcae1c5f2c2d8d4ad0753602d6a36f91fe2a.svg" alt="L &amp;= 5{\rm\,cm} \\
W &amp;= 1{\rm\,cm} \\
Q_m &amp;= 3.3{\rm\,A\cdot m} \\
d &amp;= {L-W\over2} = 0.02{\rm\,m} \\
m &amp;= 2 Q_m d = 2\times 3.3\times 0.02{\rm\,A\cdot m^2}
    = 0.132 {\rm\,A\cdot m^2}"/></p>
</div><p>The unit of <img class="math" src="../_images/math/f06fff000efa529593956559ade723e16aa36424.svg" alt="{\bf B}"/> is Tesla: <img class="math" src="../_images/math/712fb6c930e89f7dddec03e1b10673cba9ea8aa9.svg" alt="\rm 1 T = V\cdot s \cdot m^{-2}"/>.</p>
</div>
<div class="section" id="bar-magnet-in-a-coil">
<h3>Bar Magnet in a Coil<a class="headerlink" href="#bar-magnet-in-a-coil" title="Permalink to this headline">¶</a></h3>
<p>We throw a magnet through a coil and calculate the voltage on the coil.
We use two model of the bar magnet: a magnetic dipole and two monopoles <img class="math" src="../_images/math/a3cc90517f994f879d7735bc02942349b84a10b3.svg" alt="2d"/>
apart.</p>
<p>Geometry:</p>
<div class="math">
<p><img src="../_images/math/2a3fd0ba3223e59bd08c2d261e0f761e860579f8.svg" alt="{\bf v} = (0, 0, v)

{\bf l} = (a\cos\phi, a\sin\phi, z)

{\d{\bf l}\over \d\phi} = (-a\sin\phi, a\cos\phi, 0)"/></p>
</div><p>Field of the dipole:</p>
<div class="math">
<p><img src="../_images/math/175acfbb3b3d0899984eb7a3d3dc3d5feabbfbbc.svg" alt="{\bf E} = 0

{\bf B}({\bf r}) = {\mu_0\over 4\pi} \left({3{\bf r}({\bf m}\cdot{\bf r})\over r^5}
    -{{\bf m}\over r^3}\right)

{\bf m} = (0, 0, m)"/></p>
</div><p>we will need:</p>
<div class="math">
<p><img src="../_images/math/d5de4116429a8823dec1428953fcadd7c2f5515a.svg" alt="{\bf v}\times{\bf B}({\bf l})
= {\mu_0\over 4\pi}{\bf v}\times
    \left({3{\bf l}({\bf m}\cdot{\bf l})\over l^5}
-{{\bf m}\over l^3}\right) =

= {\mu_0\over 4\pi}
    \left({3({\bf v}\times{\bf l})({\bf m}\cdot{\bf l})\over l^5}
-{{\bf v}\times{\bf m}\over l^3}\right) =

= {\mu_0\over 4\pi}
    {3({\bf v}\times{\bf l})({\bf m}\cdot{\bf l})\over l^5}
    =

= {\mu_0\over 4\pi}
    {3(va\sin\theta, -va\cos\theta, 0)mz\over (a^2 + z^2)^{5\over2}} =

= {3\mu_0 m\over 4\pi}
    {a v z\over (a^2 + z^2)^{5\over2}} (\sin\theta, -\cos\theta, 0)"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/bf7866a6425d01e9e7e2be8766f1fee7ec2870b2.svg" alt="{\bf v}\times{\bf B}\cdot{\d{\bf l}\over \d\phi} =

= {3\mu_0 m\over 4\pi}
    {a v z\over (a^2 + z^2)^{5\over2}} (\sin\theta, -\cos\theta, 0)
    \cdot
(-a\sin\phi, a\cos\phi, 0) =

= -{3\mu_0 m\over 4\pi}
    {a^2 v z\over (a^2 + z^2)^{5\over2}}"/></p>
</div><p>Field of two monopoles:</p>
<div class="math">
<p><img src="../_images/math/c422833ff8b0a5eeae11084d43715f7a7fbec1a3.svg" alt="{\bf E} = 0

{\bf B}({\bf x}) = {\mu_0 Q_m\over 4\pi} \left(
    {{\bf x}-{\bf p}_1 \over |{\bf x}-{\bf p}_1|^3}
    -
    {{\bf x}-{\bf p}_2 \over |{\bf x}-{\bf p}_2|^3}
    \right)

{\bf p}_1 = (0, 0, d)

{\bf p}_2 = (0, 0, -d)

d = {L-W\over 2}"/></p>
</div><p>we will need:</p>
<div class="math">
<p><img src="../_images/math/a8eb7baa6185561cfa50543363f927f63397a69b.svg" alt="{\bf v}\times{\bf B}({\bf l})
    = {\mu_0 Q_m\over 4\pi} \left(
    {{\bf v}\times({\bf l}-{\bf p}_1) \over |{\bf l}-{\bf p}_1|^3}
    -
    {{\bf v}\times({\bf l}-{\bf p}_2) \over |{\bf l}-{\bf p}_2|^3}
    \right) =

    = {\mu_0 Q_m\over 4\pi} \left(
    {(0, 0, v)\times(a\cos\phi, a\sin\phi, z-d) \over
        (a^2+(z-d)^2)^{3\over2}}
    -
    {(0, 0, v)\times(a\cos\phi, a\sin\phi, z+d) \over
        (a^2+(z+d)^2)^{3\over2}}
    \right) =

    = {\mu_0 Q_m a v \over 4\pi} \left(
    {1 \over (a^2+(z-d)^2)^{3\over2}}
    -
    {1 \over (a^2+(z+d)^2)^{3\over2}}
    \right) (\sin\phi, -\cos\phi, 0)"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/76c1e81812bff370bd74011c3e41aa84fc0a0f87.svg" alt="{\bf v}\times{\bf B}\cdot{\d{\bf l}\over \d\phi} =

= {\mu_0 Q_m a v \over 4\pi} \left(
{1 \over (a^2+(z-d)^2)^{3\over2}}
-
{1 \over (a^2+(z+d)^2)^{3\over2}}
\right) (\sin\phi, -\cos\phi, 0)
    \cdot
(-a\sin\phi, a\cos\phi, 0) =

= -{\mu_0 Q_m a^2 v \over 4\pi} \left(
{1 \over (a^2+(z-d)^2)^{3\over2}}
-
{1 \over (a^2+(z+d)^2)^{3\over2}}
\right)"/></p>
</div><p>Now we can calculate the voltage:</p>
<div class="math">
<p><img src="../_images/math/2c02afa6f8ee9ea8d90d69e52715d4d74d15a181.svg" alt="V = \oint \left({\bf E} + {\bf v}\times{\bf B}\right) \cdot {\d{\bf l}} =

    = \oint {\bf v}\times{\bf B} \cdot {\d{\bf l}} =

    = \int_0^{2\pi} {\bf v}\times{\bf B} \cdot {\d{\bf l}\over \d\phi}
        \d\phi"/></p>
</div><p>for the dipole we get</p>
<div class="math">
<p><img src="../_images/math/1c2ff21a35951d92bec8977e70142224a50a81e2.svg" alt="V = \cdots
= -\int_0^{2\pi} {3\mu_0 m\over 4\pi}
{a^2 v z\over (a^2 + z^2)^{5\over2}}
    \d\phi =

= -{3\mu_0 m\over 2}
{a^2 v z\over (a^2 + z^2)^{5\over2}}"/></p>
</div><p>For two monopoles we get</p>
<div class="math">
<p><img src="../_images/math/a9e45a4eeb743723b3640e3dc7623b10277ccdd5.svg" alt="V = \cdots
= -\int_0^{2\pi} {\mu_0 Q_m a^2 v \over 4\pi} \left(
    {1 \over (a^2+(z-d)^2)^{3\over2}}
    -
    {1 \over (a^2+(z+d)^2)^{3\over2}}
    \right)
    \d\phi =

= -{\mu_0 Q_m a^2 v \over 2} \left(
    {1 \over (a^2+(z-d)^2)^{3\over2}}
    -
    {1 \over (a^2+(z+d)^2)^{3\over2}}
    \right)"/></p>
</div><p>For the dipole, the function</p>
<div class="math">
<p><img src="../_images/math/27da76ba1b40b9cc73a294b1dea448ef50e68569.svg" alt="{z\over(a^2+z^2)^{5\over 2}}"/></p>
</div><p>has a maximum and minimum for:</p>
<div class="math">
<p><img src="../_images/math/812b8b4c9db82aa3979de95c203fd845fa256138.svg" alt="z = \pm{a\over 2}"/></p>
</div><p>with the max value:</p>
<div class="math">
<p><img src="../_images/math/22d41529010f9ba238238a871c2c30d065c48b77.svg" alt="{z\over(a^2+z^2)^{5\over 2}} =
{{a\over 2}\over(a^2+\left({a\over 2}\right)^2)^{5\over 2}} =
{16\sqrt 5 \over 125 a^4}"/></p>
</div><p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">solve</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">refine</span><span class="p">,</span> <span class="n">Q</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;a z&quot;</span><span class="p">)</span>
<span class="go">(a, z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">z</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[-a/2, a/2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">16*sqrt(5)*a/(125*(a**2)**(5/2))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refine</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">16*sqrt(5)/(125*a**4)</span>
</pre></div>
</div>
<p>So the maximum voltage is:</p>
<div class="math">
<p><img src="../_images/math/a8fb3a5256c53018a4e4854ee6efcd6ee5cdf77d.svg" alt="V = {\mu_0\over 2} {3va^2mz\over (a^2 + z^2)^{5\over2}}
    = {\mu_0\over 2} {3mva^2 {16\sqrt 5 \over 125 a^4}} =

    = {24\sqrt 5\over125} {\mu_0 m v\over a^2}"/></p>
</div><p>If we drop the magnet from height <img class="math" src="../_images/math/0b043f7a352c706fb702c01f04a66e2643b79eda.svg" alt="h"/> above the coil into it, then its speed
will be <img class="math" src="../_images/math/d707942746721c7be67e32e65ff5974fdb65fb49.svg" alt="v_0 = \sqrt{2hg}"/> in the middle of the coil, when <img class="math" src="../_images/math/f5cd04984bf04605720eacb31675b63c64e875cb.svg" alt="t=0"/>. Then:</p>
<div class="math">
<p><img src="../_images/math/f3395a74948b38921f005ae63ec3bdc507ed33f7.svg" alt="z = v_0 t + \half g t^2

v = v_0 + g t"/></p>
</div><p>And we get for the voltage dependence for dipole:</p>
<div class="math">
<p><img src="../_images/math/dd99f21e4702dd0b56d490cc6bde1466c50608fe.svg" alt="V = - {\mu_0\over 2} {3va^2mz\over (a^2 + z^2)^{5\over2}}
    =- {\mu_0\over 2} {3(v_0+gt)a^2m(v_0 t + \half g t^2)\over
         (a^2 + (v_0 t + \half g t^2)^2)^{5\over2}}"/></p>
</div><p>The time difference between the maximum and minimum is the time difference
between <img class="math" src="../_images/math/01250b7763890d4ab052ea0adfc1ab76b167d360.svg" alt="z=-{a\over2}"/> and <img class="math" src="../_images/math/ea68287df4ca63de93a5c72bbff3084956813b08.svg" alt="z=+{a\over2}"/>, so:</p>
<div class="math">
<p><img src="../_images/math/fbf54e87b53029de4ac05fd38033b16dba3278be.svg" alt="\Delta t = \sqrt{2h+a\over g} - \sqrt{2h-a\over g}"/></p>
</div><p>The total flux doesn’t depend on the particular dependence of <img class="math" src="../_images/math/eed784ee88226b273350488bedb90daea7afd3ae.svg" alt="z(t)"/> and
<img class="math" src="../_images/math/3604dcd99211550fe115be9c53393337bdf4e577.svg" alt="v(t)"/>:</p>
<div class="math">
<p><img src="../_images/math/64ad74e6fe4ff6a1884ec2a002857d12c025d96b.svg" alt="\Phi = \int_0^\infty V(t) \d t =

    = - {3\mu_0 m\over 2} \int_0^\infty{v(t)a^2z(t)
            \over (a^2 + z(t)^2)^{5\over2}} \d t =

    = - {3\mu_0 m\over 2} \int_0^\infty{{\d z\over\d t}a^2z(t)
            \over (a^2 + z(t)^2)^{5\over2}} \d t =

    = - {3\mu_0 m\over 2} \int_0^\infty{a^2z
            \over (a^2 + z^2)^{5\over2}} \d z =

    = - {3\mu_0 m\over 4} \int_{a^2}^\infty{a^2
            \over u^{5\over2}} \d u =

    = - {3\mu_0 m a^2\over 4} \left(-{2\over 3}\right)
        \left[1\over u^{3\over2}\right]_{a^2}^\infty =

    = - {3\mu_0 m a^2\over 4} \left(-{2\over 3}\right)
        \left[-1\over a^3\right] =

    = - {\mu_0 m \over 2a}"/></p>
</div><p>For the voltage dependence of two monopoles, we get:</p>
<div class="math">
<p><img src="../_images/math/5b7c32381aa2d4501527a1f87e4fd5bd7697dd73.svg" alt="V = -{\mu_0 Q_m a^2 v \over 2} \left(
        {1 \over (a^2+(z-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(z+d)^2)^{3\over2}}
        \right) =

= -{\mu_0 Q_m a^2 (v_0+gt) \over 2} \left(
        {1 \over (a^2+(v_0 t + \half g t^2-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(v_0 t + \half g t^2+d)^2)^{3\over2}}
        \right)"/></p>
</div><p>The total flux doesn’t depend on the particular dependence of <img class="math" src="../_images/math/eed784ee88226b273350488bedb90daea7afd3ae.svg" alt="z(t)"/> and
<img class="math" src="../_images/math/3604dcd99211550fe115be9c53393337bdf4e577.svg" alt="v(t)"/>:</p>
<div class="math">
<p><img src="../_images/math/4ec8c533b29ec64ac65f908f068b1822a9c219ef.svg" alt="\Phi = \int_0^\infty V(t) \d t =

    =-\int_0^\infty {\mu_0 Q_m a^2 v(t) \over 2} \left(
        {1 \over (a^2+(z(t)-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(z(t)+d)^2)^{3\over2}}
        \right)
        \d t =

    =-\int_0^\infty {\mu_0 Q_m a^2 {\d z\over \d t} \over 2} \left(
        {1 \over (a^2+(z(t)-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(z(t)+d)^2)^{3\over2}}
        \right)
        \d t =

    =-\int_0^\infty {\mu_0 Q_m a^2 \over 2} \left(
        {1 \over (a^2+(z-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(z+d)^2)^{3\over2}}
        \right)
        \d z =

    =- {\mu_0 Q_m a^2 \over 2} \left(
        \int_0^\infty{1 \over (a^2+(z-d)^2)^{3\over2}} \d z
        -
        \int_0^\infty{1 \over (a^2+(z+d)^2)^{3\over2}} \d z
        \right) =

    =- {\mu_0 Q_m a^2 \over 2} \left(
        {1\over a^2}\left(1 + {d\over\sqrt{a^2 + d^2}}\right)
        -
        {1\over a^2}\left(1 - {d\over\sqrt{a^2 + d^2}}\right)
        \right) =

    =- {\mu_0 Q_m d\over\sqrt{a^2 + d^2}}"/></p>
</div><p>Note that in the limit <img class="math" src="../_images/math/9b9fef50d791a188bfb4f658ebdaa348cb9c4d84.svg" alt="d\to 0"/>, we get the magnetic moment <img class="math" src="../_images/math/98a9ebf0d98e2e07278c58d75bd9aa14eb5198da.svg" alt="m = 2 d Q_m"/> and
the last formula for two monopoles flux becomes the dipole flux.</p>
<p>As a particular example, consider a coil with <img class="math" src="../_images/math/2c9827084af8774b302b631f849064072096dae1.svg" alt="N=500"/> loops, <img class="math" src="../_images/math/f327a4df77ad7c4f9967d42d5408bef8a4cac991.svg" alt="a=1.4\rm\,cm"/>,
<img class="math" src="../_images/math/7d560e9cec48b26c68c9b399cb9f6e34cce52cff.svg" alt="d=1.8\rm\,cm"/>, <img class="math" src="../_images/math/dd4d65f3e3beafd079d2661edc297bcb24317dff.svg" alt="Q_m=43\rm\,A\cdot m"/>. Then the total flux from the second peak
is:</p>
<div class="math">
<p><img src="../_images/math/9eacb85929daac1bbf0fa5c480cd8dde0cbb1bfb.svg" alt="\Phi =- {N\mu_0 Q_m d\over\sqrt{a^2 + d^2}} = -0.021 \rm\, V\cdot s"/></p>
</div><p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu0</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e-7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q_m</span> <span class="o">=</span> <span class="mf">43.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">1.4</span><span class="o">*</span><span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="n">N</span><span class="o">*</span><span class="n">mu0</span><span class="o">*</span><span class="n">Q_m</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-0.02132647889395681</span>
</pre></div>
</div>
<p>For a single loop with <img class="math" src="../_images/math/1a12c665a8a4e6a08132f9c0d84559c28a86bfe9.svg" alt="a=1.25\rm\,cm"/> we get:</p>
<div class="math">
<p><img src="../_images/math/c99e663dca60d51485393acb5ae8135250ac45b3.svg" alt="\Phi =- {\mu_0 Q_m d\over\sqrt{a^2 + d^2}} = -4.44\times 10^{-5}
    \rm\, V\cdot s"/></p>
</div><p>and for a single loop with <img class="math" src="../_images/math/f1c7e22da9ac8a43489fb817fc47ade15d2bb521.svg" alt="a=1.8\rm\,cm"/> we get:</p>
<div class="math">
<p><img src="../_images/math/cef85ae2d4305a0c81ad5ec81a9170264981bf8f.svg" alt="\Phi =- {\mu_0 Q_m d\over\sqrt{a^2 + d^2}} = -3.82\times 10^{-5}
    \rm\, V\cdot s"/></p>
</div><p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">1.25</span><span class="o">*</span><span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="n">mu0</span><span class="o">*</span><span class="n">Q_m</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-4.438304942066266e-05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="n">mu0</span><span class="o">*</span><span class="n">Q_m</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-3.820879326816195e-05</span>
</pre></div>
</div>
</div>
<div class="section" id="rc-circuit">
<h3>RC Circuit<a class="headerlink" href="#rc-circuit" title="Permalink to this headline">¶</a></h3>
<p>Let’s consider resistor (with voltage <img class="math" src="../_images/math/5ecbb4a3534ade057932d7295a88b04a612af554.svg" alt="V=RI"/>) and capacitor (with voltage
<img class="math" src="../_images/math/49c2e8a6f08e64477257d9c6b7180050199c5b76.svg" alt="V={Q\over C}"/> and current <img class="math" src="../_images/math/1f9f3d3a333435727ee28b15d55545628253d1fb.svg" alt="I(t) = Q'(t)"/>) in a series. Voltage on the battery
is <img class="math" src="../_images/math/d2eeb453d8cdb59f1e536084a98b1b40d1bc123f.svg" alt="V"/>, then the equation for the circuit is:</p>
<div class="math">
<p><img src="../_images/math/a13efbba933203f39927f7637df489000cf34620.svg" alt="RI(t) + {Q(t)\over C} = V"/></p>
</div><p>with initial condition <img class="math" src="../_images/math/2371418e625bb7eec82b643f5a1234e38763720f.svg" alt="Q(0) = 0"/>. We differentiate it:</p>
<div class="math">
<p><img src="../_images/math/48f89d99ec6b4801bb08a2a9c12a197682050d1a.svg" alt="RI'(t) + {I(t)\over C} = 0"/></p>
</div><p>and the initial condition follows from the first equation <img class="math" src="../_images/math/00d721dc4141c9b30b7d65816310fd1d42c2e845.svg" alt="I(0) = {V\over R}"/>.
The solution is:</p>
<div class="math">
<p><img src="../_images/math/48372bfdd93f05132c09443c066fcbcc867d4851.svg" alt="I(t) = {V\over R} e^{-{t\over RC}}"/></p>
</div><p>Now we calculate the charge (using the initial condition for the charge above
for the lower bound of the integral):</p>
<div class="math">
<p><img src="../_images/math/db69b1965b95fc571a54a41433d0d1c348e71dbf.svg" alt="Q(t) = \int_0^t I(t') \d t'
     = {V\over R} \int_0^t e^{-{t'\over RC}} \d t'
     = {V\over R} \left[-RC e^{-{t'\over RC}}\right]_0^t =

     = {V\over R} \left[-RC e^{-{t\over RC}}+RC\right]
     = VC \left(1-e^{-{t\over RC}}\right)"/></p>
</div><p>The voltage on the resistor is:</p>
<div class="math">
<p><img src="../_images/math/c646889db210024a2184ec861ccc702c91e7d639.svg" alt="R I(t) = R {V\over R} e^{-{t\over RC}} = V e^{-{t\over RC}}"/></p>
</div><p>The voltage on the capacitor is:</p>
<div class="math">
<p><img src="../_images/math/b8df7038d93287ca40976a85b6c1dca7fdebde40.svg" alt="{Q(t)\over C} = {VC \left(1-e^{-{t\over RC}}\right) \over C}
    = V \left(1-e^{-{t\over RC}}\right)"/></p>
</div><p>Half life of the capacitor is defined as the time <img class="math" src="../_images/math/2492400c920539ebb8fac56dc6fe48dc6864abe9.svg" alt="\tau"/> so that the charge is
half of the total charge, and we get:</p>
<div class="math">
<p><img src="../_images/math/6cbf8059fa322a9d7f45ebc5d91a6388da3e769b.svg" alt="Q(\tau) = \half Q(\infty)

VC \left(1-e^{-{\tau\over RC}}\right) = \half VC

1-e^{-{\tau\over RC}} = \half

\half = e^{-{\tau\over RC}}

\log \half = -{\tau\over RC}

\tau = -RC \log \half = RC\log 2"/></p>
</div></div>
</div>
</div>
<div class="section" id="semiconductor-device-physics">
<h1>Semiconductor Device Physics<a class="headerlink" href="#semiconductor-device-physics" title="Permalink to this headline">¶</a></h1>
<p>In general, the task is to find the five quantities:</p>
<div class="math">
<p><img src="../_images/math/949cedc184f04cf6bcb5fc7c14b8e36fe9e44ebc.svg" alt="n({\bf x}, t),
p({\bf x}, t),
{\bf J}_n({\bf x}, t),
{\bf J}_h({\bf x}, t),
{\bf E}({\bf x}, t)"/></p>
</div><p>where <img class="math" src="../_images/math/fbcc38c1860a75469d635199ce378ced98a95236.svg" alt="n"/> (<img class="math" src="../_images/math/e5d1ed584f05b4f69e8cd56b95e144968e3e8544.svg" alt="p"/>) is the electron (hole) concentration, <img class="math" src="../_images/math/a8457a72a8160e44632511f202862ce8a830ab19.svg" alt="{\bf J}_n"/>
(<img class="math" src="../_images/math/e5ccb0492aa36aa224bf788af2a240eaa69a0b67.svg" alt="{\bf J}_p"/>) is the electron (hole) current density, <img class="math" src="../_images/math/69aed678bfc9ed80917bc84476af1b107cb9e10e.svg" alt="{\bf E}"/> is the
electric field.</p>
<p>And we have five equations that relate them. We start with the continuity
equation:</p>
<div class="math">
<p><img src="../_images/math/9cf45edae4a72ba55392376bb666c65e7196f301.svg" alt="\nabla\cdot{\bf J} +{\partial\rho\over\partial t} = 0"/></p>
</div><p>where the current density <img class="math" src="../_images/math/c38e5d455dd57bccd7bb113d1fbaec01d66e9804.svg" alt="{\bf J}"/> is composed of electron and hole current
densities:</p>
<div class="math">
<p><img src="../_images/math/bb30ed80b1fa1762f3b5af30f7338520cce77d9a.svg" alt="{\bf J} = {\bf J}_n + {\bf J}_p"/></p>
</div><p>and the charge density <img class="math" src="../_images/math/a717f9a06abf6e51f23a3b75f9785db5b2cc4d3b.svg" alt="\rho"/> is composed of mobile (electrons and holes) and
fixed charges (ionized donors and acceptors):</p>
<div class="math">
<p><img src="../_images/math/0f05a12199df0c09f4303f852a5ac34c5a4e473b.svg" alt="\rho = q(p-n+C)"/></p>
</div><p>where <img class="math" src="../_images/math/fbcc38c1860a75469d635199ce378ced98a95236.svg" alt="n"/> and <img class="math" src="../_images/math/e5d1ed584f05b4f69e8cd56b95e144968e3e8544.svg" alt="p"/> is the electron and hole concetration, <img class="math" src="../_images/math/6e7e2a5448a5278e14f22e7184aba8f70c6d0c58.svg" alt="C"/> is the net
doping concetration (<img class="math" src="../_images/math/1a3008196a456ea383ee8dc4da08bf90316af7ad.svg" alt="C=p_D-n_A"/> where <img class="math" src="../_images/math/32867bc752e00e0620bf8ee30b9fd496b706c3b8.svg" alt="p_D"/> is the concentration of ionized
donors, charged positive, and <img class="math" src="../_images/math/708166d0f7839f87fb78aac7fd1a3d08b7a6bbdf.svg" alt="n_A"/> is the concentration of ionized acceptors,
charged negative) and <img class="math" src="../_images/math/b3b33120dca43a6a9be28a013eb95f50583e5f5c.svg" alt="q"/> is the electron charge (positive). We get:</p>
<div class="math">
<p><img src="../_images/math/f408b57e1fb52809ade28712267066b988316213.svg" alt="\nabla\cdot{\bf J}_n + \nabla\cdot{\bf J}_p + q\left(
    {\partial p\over\partial t}
    -{\partial n\over\partial t}
    +{\partial C\over\partial t}
    \right) = 0"/></p>
</div><p>Assuming the fixed charges <img class="math" src="../_images/math/6e7e2a5448a5278e14f22e7184aba8f70c6d0c58.svg" alt="C"/> are time invariant, we get:</p>
<div class="math">
<p><img src="../_images/math/3875f6eee2527c5cfe64ac14785db2f535ef4d55.svg" alt="\nabla\cdot{\bf J}_n - q {\partial n\over\partial t} =
    -\left( \nabla\cdot{\bf J}_p + q{\partial p\over\partial t}
    \right) \equiv qR"/></p>
</div><p>where <img class="math" src="../_images/math/a15901c03c5ae8e9a3a2b70b19fd6551c65d850e.svg" alt="R"/> is the net recombination rate for electrons and holes (a positive
value means recombination, a negative value generation of carriers). We get the
carrier continuity equations:</p>
<div class="math" id="equation-continuity">
<p><span class="eqno">(9)<a class="headerlink" href="#equation-continuity" title="Permalink to this equation">¶</a></span><img src="../_images/math/66160d1229ef3da1db07da5024f3abc40e951f9a.svg" alt="{\partial n\over\partial t} = -R + {1\over q} \nabla\cdot {\bf J}_n

{\partial p\over\partial t} = -R - {1\over q} \nabla\cdot {\bf J}_p"/></p>
</div><p>Then we need material relations that express how the current <img class="math" src="../_images/math/c38e5d455dd57bccd7bb113d1fbaec01d66e9804.svg" alt="{\bf J}"/> is
generated using <img class="math" src="../_images/math/69aed678bfc9ed80917bc84476af1b107cb9e10e.svg" alt="{\bf E}"/> and <img class="math" src="../_images/math/fbcc38c1860a75469d635199ce378ced98a95236.svg" alt="n"/> and <img class="math" src="../_images/math/e5d1ed584f05b4f69e8cd56b95e144968e3e8544.svg" alt="p"/>. A drift-diffusion model is to assume
a drift current (<img class="math" src="../_images/math/f4174af01d1acc05892fc6087bd3840dc6437ce4.svg" alt="q\mu_n n {\bf E}"/>) and a diffusion (<img class="math" src="../_images/math/16e2439da8dd397ca6644c9364a3511dbec7f24b.svg" alt="q D_n \nabla n"/>),
which gives:</p>
<div class="math" id="equation-drift">
<p><span class="eqno">(10)<a class="headerlink" href="#equation-drift" title="Permalink to this equation">¶</a></span><img src="../_images/math/da58061475a89becd65fcc554d390dad4bec587f.svg" alt="{\bf J}_n = q\mu_n n {\bf E} + q D_n \nabla n

{\bf J}_p = q\mu_p p {\bf E} - q D_p \nabla p"/></p>
</div><p>where <img class="math" src="../_images/math/ba31dd2c514aa59ebe7d3da6644f5a5e6b9346d5.svg" alt="\mu_n"/>, <img class="math" src="../_images/math/3c910f2f7fe78914bec3a1b0157fbc2ea7b83e1f.svg" alt="\mu_p"/>, <img class="math" src="../_images/math/b523c6619aa889eb6f802183a97b335525012106.svg" alt="D_n"/>, <img class="math" src="../_images/math/ab252d526c240e70d504c5edce6be6eccaa6dd12.svg" alt="D_p"/> are the carrier mobilities and
diffusivities.</p>
<p>Final equation is the Gauss’s law:</p>
<div class="math">
<p><img src="../_images/math/5dfaf88d9c3235a7dd724654c7a2f60d376e8805.svg" alt="\nabla\cdot (\varepsilon{\bf E}) = \rho"/></p>
</div><div class="math" id="equation-gauss">
<p><span class="eqno">(11)<a class="headerlink" href="#equation-gauss" title="Permalink to this equation">¶</a></span><img src="../_images/math/b07da59485ef9b8c886edff5cdaa6f82d77b863d.svg" alt="\nabla\cdot(\varepsilon {\bf E}) = q(p-n + C)"/></p>
</div><div class="section" id="equations">
<h2>Equations<a class="headerlink" href="#equations" title="Permalink to this headline">¶</a></h2>
<p>Combining <a class="reference internal" href="#equation-drift">(10)</a> and <a class="reference internal" href="#equation-continuity">(9)</a> we get the following three
equations for three unknowns <img class="math" src="../_images/math/fbcc38c1860a75469d635199ce378ced98a95236.svg" alt="n"/>, <img class="math" src="../_images/math/e5d1ed584f05b4f69e8cd56b95e144968e3e8544.svg" alt="p"/> and <img class="math" src="../_images/math/69aed678bfc9ed80917bc84476af1b107cb9e10e.svg" alt="{\bf E}"/>:</p>
<div class="math">
<p><img src="../_images/math/d2c740bf7f2dc7d09098dc8eeb15b3bcf4c25b0d.svg" alt="{\partial n\over\partial t} = -R + \nabla\cdot (\mu_n n {\bf E})
    +\nabla\cdot (D_n \nabla n)

{\partial p\over\partial t} = -R - \nabla\cdot (\mu_p p {\bf E})
    +\nabla\cdot (D_p \nabla p)

\nabla\cdot(\varepsilon {\bf E}) = q(p-n + C)"/></p>
</div><p>And it is usually assumed that the magnetic field is time independent, so
<img class="math" src="../_images/math/1f54d02dc286c74cf53bae8eaf5424b4371965fb.svg" alt="{\bf E}=-\nabla\phi"/> and we get:</p>
<div class="math" id="equation-semicond-eq">
<p><span class="eqno">(12)<a class="headerlink" href="#equation-semicond-eq" title="Permalink to this equation">¶</a></span><img src="../_images/math/f416ead911d89ed6ed1768d288d4dccfad599e88.svg" alt="{\partial n\over\partial t} = -R - \nabla\cdot (\mu_n n \nabla\phi)
    +\nabla\cdot (D_n \nabla n)

{\partial p\over\partial t} = -R + \nabla\cdot (\mu_p p \nabla\phi)
    +\nabla\cdot (D_p \nabla p)

\nabla\cdot(\varepsilon \nabla\phi) = -q(p-n + C)"/></p>
</div><p>These are three nonlinear (due to the terms <img class="math" src="../_images/math/bea8139839bdb96856a26970a6d231d97cc1c962.svg" alt="\mu_n n \nabla\phi"/> and
<img class="math" src="../_images/math/840150b3d3fd6e2116c3db2b7b4f0d9f961c201f.svg" alt="\mu_p p \nabla\phi"/>) equations for three unknown functions <img class="math" src="../_images/math/fbcc38c1860a75469d635199ce378ced98a95236.svg" alt="n"/>, <img class="math" src="../_images/math/e5d1ed584f05b4f69e8cd56b95e144968e3e8544.svg" alt="p"/> and <img class="math" src="../_images/math/c3840070bf80f9ae1042948615aee7e95b959b25.svg" alt="\phi"/>.</p>
<div class="section" id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h3>
<p>We can substract the first two
equations and we get:</p>
<div class="math">
<p><img src="../_images/math/8ee77ba2280822062fa618cda81a711f51d19401.svg" alt="{\partial q(p-n)\over\partial t} = - q\nabla\cdot ((\mu_p p+\mu_n n){\bf E})
    +q\nabla\cdot(D_p \nabla p-D_n\nabla n)

\nabla\cdot(\varepsilon {\bf E}) = q(p-n+C)"/></p>
</div><p>and using <img class="math" src="../_images/math/667130fe148058ad81a34c9ce17d7fe1fdcd3b84.svg" alt="\rho=q(p-n+C)"/> and <img class="math" src="../_images/math/335088016b80a5abbca41c0f16a16236ef5f16a3.svg" alt="\sigma=q(\mu_p p+\mu_n n)"/>, we get:</p>
<div class="math">
<p><img src="../_images/math/ffe021c99d0dba2fafea6c8417094e62dfb703f1.svg" alt="{\partial \rho\over\partial t} -q{\partial C\over\partial t} =
    - \nabla\cdot (\sigma {\bf E})
    +q\nabla\cdot(D_p \nabla p-D_n\nabla n)

\nabla\cdot(\varepsilon {\bf E}) = \rho"/></p>
</div><p>So far we didn’t make any assumptions. Most of the times the net doping
concetration <img class="math" src="../_images/math/6e7e2a5448a5278e14f22e7184aba8f70c6d0c58.svg" alt="C"/> is time independent, which gives:</p>
<div class="math">
<p><img src="../_images/math/47731f0263158f58eaf958f405643f20d2258765.svg" alt="{\partial \rho\over\partial t} =
    - \nabla\cdot (\sigma {\bf E})
    +q\nabla\cdot(D_p \nabla p-D_n\nabla n)

\nabla\cdot(\varepsilon {\bf E}) = \rho"/></p>
</div><p>Assuming further <img class="math" src="../_images/math/f4d735705a0967594636c16f4c100f9d35c29051.svg" alt="D_p \nabla p-D_n\nabla n=0"/>, we just get the equation of
continuity and the Gauss law:</p>
<div class="math">
<p><img src="../_images/math/a0fe6b8272187c68517e1d8a8f5edabeb0dd6e8d.svg" alt="{\partial \rho\over\partial t} + \nabla\cdot (\sigma {\bf E}) = 0

\nabla\cdot(\varepsilon {\bf E}) = \rho"/></p>
</div><p>Finally, assuming also that that <img class="math" src="../_images/math/a717f9a06abf6e51f23a3b75f9785db5b2cc4d3b.svg" alt="\rho"/> doesn’t depend on
time, we get:</p>
<div class="math">
<p><img src="../_images/math/ba1eed2b8977b1a33b9146e9423cc52673c7542d.svg" alt="\nabla\cdot (\sigma {\bf E}) = 0

\nabla\cdot(\varepsilon {\bf E}) = \rho"/></p>
</div></div>
<div class="section" id="example-2">
<h3>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h3>
<p>As a simple model, assume <img class="math" src="../_images/math/b523c6619aa889eb6f802183a97b335525012106.svg" alt="D_n"/>, <img class="math" src="../_images/math/ab252d526c240e70d504c5edce6be6eccaa6dd12.svg" alt="D_p"/>, <img class="math" src="../_images/math/ba31dd2c514aa59ebe7d3da6644f5a5e6b9346d5.svg" alt="\mu_n"/>, <img class="math" src="../_images/math/3c910f2f7fe78914bec3a1b0157fbc2ea7b83e1f.svg" alt="\mu_p"/> and <img class="math" src="../_images/math/aadff434f64150bd757efb35f827819180bd88fd.svg" alt="\varepsilon"/>
are position independent and <img class="math" src="../_images/math/924f76382938b26e5825b13a19e6fedd40dcbe6a.svg" alt="C=0"/>, <img class="math" src="../_images/math/ff1835e8bf54ae13df92aa59d8a556a52af3778f.svg" alt="R=0"/>:</p>
<div class="math">
<p><img src="../_images/math/32c4e916048091bd6dc2263fb48b818d74353968.svg" alt="{\partial n\over\partial t} =
    +\mu_n n \nabla\cdot {\bf E}
    +\mu_n {\bf E}\cdot\nabla n
    +D_n \nabla^2 n

{\partial p\over\partial t} =
    -\mu_p p \nabla\cdot {\bf E}
    -\mu_p {\bf E}\cdot\nabla p
    +D_p \nabla^2 p

\varepsilon\nabla\cdot {\bf E} = q(p-n)"/></p>
</div><p>Using <img class="math" src="../_images/math/7093431fe82f873610f36e0235642df17de4d098.svg" alt="{\bf E} = -\nabla \phi"/> we get:</p>
<div class="math">
<p><img src="../_images/math/30978a7f5a6e4a6eefd6beca6a7d7804be432b71.svg" alt="{\partial n\over\partial t} =
    -\mu_n n \nabla^2\phi
    -\mu_n \nabla\phi\cdot\nabla n
    +D_n \nabla^2 n

{\partial p\over\partial t} =
    +\mu_p p \nabla^2\phi
    +\mu_p \nabla\phi\cdot\nabla p
    +D_p \nabla^2 p

\varepsilon\nabla^2\phi = -q(p-n)"/></p>
</div></div>
</div>
<div class="section" id="example-3">
<h2>Example 3<a class="headerlink" href="#example-3" title="Permalink to this headline">¶</a></h2>
<p>Let’s calculate the 1D pn-junction. We take the equations <a class="reference internal" href="#equation-semicond-eq">(12)</a> and
write them in 1D for the stationary state
(<img class="math" src="../_images/math/2714ecad2e607b45e3a956c9854e965ea0d43719.svg" alt="{\partial n\over\partial t}={\partial p\over\partial t}=0"/>):</p>
<div class="math">
<p><img src="../_images/math/39177fee1c43e89120a6189c7041629538900b75.svg" alt="0 = -R - (\mu_n n \phi')' + (D_n n')'

0 = -R + (\mu_p p \phi')' + (D_p p')'

(\varepsilon \phi')' = -q(p-n + C)"/></p>
</div><p>We expand the derivatives and assume that <img class="math" src="../_images/math/7f3979c488322e962c38ddef2a5f452ac8df645f.svg" alt="\mu"/> and <img class="math" src="../_images/math/3fd412c6c80b7a76e8c86d2dfa89ac65668ae1f6.svg" alt="D"/> is constant:</p>
<div class="math">
<p><img src="../_images/math/1dce907d9034d21f4601e974c950ab00bebbc407.svg" alt="0 = -R - \mu_n n' \phi' - \mu_n n \phi'' + D_n n''

0 = -R + \mu_p p' \phi' + \mu_p p \phi'' + D_p p''

\varepsilon \phi'' = -q(p-n + C)"/></p>
</div><p>and we put the second derivatives on the left hand side:</p>
<div class="math" id="equation-1d-pn-junction1">
<p><span class="eqno">(13)<a class="headerlink" href="#equation-1d-pn-junction1" title="Permalink to this equation">¶</a></span><img src="../_images/math/40771847ad9695aca3551f0a8f7002d06d75bd50.svg" alt="n'' = {1\over D_n}(R + \mu_n n' \phi' + \mu_n n \phi'')

p'' = {1\over D_p}(R - \mu_p p' \phi' - \mu_p p \phi'')

\phi'' = -{q\over\varepsilon} (p-n + C)"/></p>
</div><p>now we introduce the variables <img class="math" src="../_images/math/1e081cf2df857b4eb534f98fe090880397a72998.svg" alt="y_i"/>:</p>
<div class="math">
<p><img src="../_images/math/b5ee3ebf683897b01845530b65ef2ba57dd50495.svg" alt="y_0 = n

y_1 = y_0' = n'

y_2 = p

y_3 = y_2' = p'

y_4 = \phi

y_5 = y_4' = \phi'"/></p>
</div><p>and rewrite <a class="reference internal" href="#equation-1d-pn-junction1">(13)</a>:</p>
<div class="math">
<p><img src="../_images/math/69c7bfbcb4822162bfd9cf16d071a4174fc9017a.svg" alt="y_1' = {1\over D_n}(R + \mu_n y_1 y_5 + \mu_n y_0 y_5')

y_3' = {1\over D_p}(R - \mu_p y_3 y_5 - \mu_p y_2 y_5')

y_5' = -{q\over\varepsilon} (y_2-y_0 + C)"/></p>
</div><p>So we are solving the following six nonlinear first order ODE:</p>
<div class="math" id="equation-1d-pn-junction2">
<p><span class="eqno">(14)<a class="headerlink" href="#equation-1d-pn-junction2" title="Permalink to this equation">¶</a></span><img src="../_images/math/f273ed82c8f8c1c32333c170e4814e93eb38e866.svg" alt="y_5' = -{q\over\varepsilon} (y_2-y_0 + C)

y_0' = y_1

y_1' = {1\over D_n}(R + \mu_n y_1 y_5 + \mu_n y_0 y_5')

y_2' = y_3

y_3' = {1\over D_p}(R - \mu_p y_3 y_5 - \mu_p y_2 y_5')

y_4' = y_5"/></p>
</div></div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Maxwell’s Equations</a><ul>
<li><a class="reference internal" href="#electromagnetic-field">Electromagnetic Field</a></li>
<li><a class="reference internal" href="#id1">Maxwell’s Equations</a></li>
<li><a class="reference internal" href="#lorentz-force">Lorentz Force</a></li>
<li><a class="reference internal" href="#hamiltonian">Hamiltonian</a></li>
<li><a class="reference internal" href="#electromagnetic-stress-tensor">Electromagnetic Stress Tensor</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#coulomb-law">Coulomb Law</a><ul>
<li><a class="reference internal" href="#example-straight-wire">Example: Straight Wire</a></li>
</ul>
</li>
<li><a class="reference internal" href="#biot-savart-law">Biot-Savart Law</a><ul>
<li><a class="reference internal" href="#id2">Example: Straight Wire</a></li>
<li><a class="reference internal" href="#example-circular-loop">Example: Circular Loop</a></li>
<li><a class="reference internal" href="#helmholtz-coil">Helmholtz Coil</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ampere-s-force-law">Ampère’s Force Law</a><ul>
<li><a class="reference internal" href="#parallel-straight-wires">Parallel Straight Wires</a></li>
<li><a class="reference internal" href="#perpendicular-straight-wires">Perpendicular Straight Wires</a></li>
<li><a class="reference internal" href="#infinitely-long-wire-and-a-square-loop">Infinitely Long Wire and a Square Loop</a></li>
</ul>
</li>
<li><a class="reference internal" href="#magnetic-dipole">Magnetic Dipole</a></li>
<li><a class="reference internal" href="#bar-magnet">Bar Magnet</a></li>
<li><a class="reference internal" href="#bar-magnet-in-a-coil">Bar Magnet in a Coil</a></li>
<li><a class="reference internal" href="#rc-circuit">RC Circuit</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#semiconductor-device-physics">Semiconductor Device Physics</a><ul>
<li><a class="reference internal" href="#equations">Equations</a><ul>
<li><a class="reference internal" href="#example-1">Example 1</a></li>
<li><a class="reference internal" href="#example-2">Example 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-3">Example 3</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="main.html"
                        title="previous chapter">Classical Electromagnetism</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../statmech/main.html"
                        title="next chapter">Thermodynamics and Statistical Physics</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/elmag/elmag.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../statmech/main.html" title="Thermodynamics and Statistical Physics"
             >next</a> |</li>
        <li class="right" >
          <a href="main.html" title="Classical Electromagnetism"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" >Classical Electromagnetism</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>