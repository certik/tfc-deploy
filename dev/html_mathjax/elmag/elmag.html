
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Maxwell’s Equations &#8212; Theoretical Physics Reference 0.5 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Thermodynamics and Statistical Physics" href="../statmech/main.html" />
    <link rel="prev" title="Classical Electromagnetism" href="main.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head><body>
    <div style="display:none">
    \(
        \newcommand{\d}{\mathrm{d}}
        \newcommand{\bomega}{\vec\omega}
        \newcommand{\half}{ {1\over 2} }
        \def\mathnot#1{\text{"$#1$"}}

        %operators
        \newcommand{\diag}{\mathrm{diag}}
        \newcommand{\sinc}{\mathrm{sinc}}
        \newcommand{\Sh}{ {\large\style{font-family:Times}{\text{Ш}}} }
        \newcommand{\res}{\mathrm{Res}}
    \)
    </div>
    

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../statmech/main.html" title="Thermodynamics and Statistical Physics"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="main.html" title="Classical Electromagnetism"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" accesskey="U">Classical Electromagnetism</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="maxwell-s-equations">
<h1>Maxwell’s Equations<a class="headerlink" href="#maxwell-s-equations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="electromagnetic-field">
<h2>Electromagnetic Field<a class="headerlink" href="#electromagnetic-field" title="Permalink to this headline">¶</a></h2>
<p>The electromagnetic field is fully described by a vector field called the
4-potential <span class="math notranslate nohighlight">\(A^\alpha\)</span>. It has four components that we can label any way we
want, the traditional way is to use:</p>
<div class="math notranslate nohighlight">
\[A^\alpha = \left({\phi\over c}, {\bf A}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi\)</span> is called the electrostatic scalar potential, <span class="math notranslate nohighlight">\({\bf A}\)</span> is called
the vector potential and <span class="math notranslate nohighlight">\(c\)</span> is the speed of light.
The Lagrangian density for the free (noninteracting) field is:</p>
<div class="math notranslate nohighlight">
\[\L = -{1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta\]</div>
<p>The Lagrangian for a (charged) particle is:</p>
<div class="math notranslate nohighlight">
\[L(x^\mu, v^\mu) = -\half m v_\alpha v^\alpha\]</div>
<p>it produces the following charge density:</p>
<div class="math notranslate nohighlight">
\[\rho = q \delta({\bf r} - {\bf s})\]</div>
<p>The interaction between the charged particle (or in general any charged body)
with some charge density and the electromagnetic field is given by the
Lagrangian density (this follows from <a class="reference internal" href="../quantum/qed.html#local-gauge-invariance"><span class="std std-ref">Local Gauge Invariance</span></a>):</p>
<div class="math notranslate nohighlight">
\[\L = -j_\alpha A^\alpha\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[j^\mu = \rho v^\mu = \gamma \rho (c, {\bf v})\]</div>
<p>All together, the Lagrangian of a charged particle and an electromagnetic field
is:</p>
<div class="math notranslate nohighlight" id="equation-lagem">
<span class="eqno">(1)<a class="headerlink" href="#equation-lagem" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}L(x^\mu, v^\mu, A^\mu, \partial_\nu A^\mu)
  =-\half m v_\alpha v^\alpha
    -\int {1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
        \d^3 x
        - \int j_\alpha A^\alpha \d^3 x =\\  =-\half m v_\alpha v^\alpha
    -\int {1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
        \d^3 x
        - \int \rho v_\alpha A^\alpha \d^3 x =\\  =-\half m v_\alpha v^\alpha
    -\int {1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
        \d^3 x
        - q v_\alpha A^\alpha\end{aligned}\end{align} \]</div>
<p>Note that:</p>
<div class="math notranslate nohighlight">
\[v_\alpha A^\alpha = - \gamma \phi + \gamma {\bf v} \cdot {\bf A}\]</div>
<p>There are several approaches how to obtain the above Lagrangian from some other
assumptions, but ultimately the exact form of the Lagrangians has to be given
by experiment. This Lagrangian is our only assumption and we derive everything
else from it.</p>
<p>The Euler-Lagrange equations for the electromagnetic field (in terms of <span class="math notranslate nohighlight">\(A^\mu\)</span>
and <span class="math notranslate nohighlight">\(\partial_\nu A^\mu\)</span>) are:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\partial^\mu {\partial\over\partial (\partial^\mu A^\nu)}
\left(
    -{1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
           - j_\alpha A^\alpha
    \right)
={\partial\over\partial A^\nu}
    \left(
    -{1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
           - j_\alpha A^\alpha\right)\\\partial^\mu {\partial\over\partial (\partial^\mu A^\nu)}
\left(
    {1\over 2\mu_0} g_{\delta\alpha} g_{\epsilon\beta}
    \partial^\delta A^\epsilon \partial^\alpha A^\beta
    \right)
={\partial\over\partial A^\nu} j_\alpha A^\alpha\\{1\over 2\mu_0} \partial^\mu g_{\delta\alpha} g_{\epsilon\beta}
\left(
    \delta^\delta_\mu \delta^\epsilon_\nu \partial^\alpha A^\beta
    +
    \partial^\delta A^\epsilon \delta^\alpha_\mu \delta^\beta_\nu
    \right)
= j_\alpha \delta^\alpha_\nu\\{1\over 2\mu_0} \partial^\mu
\left(  g_{\mu\alpha} g_{\nu\beta}
    \partial^\alpha A^\beta
    +g_{\delta\mu} g_{\epsilon\nu}
    \partial^\delta A^\epsilon
    \right)
= j_\nu\\{1\over 2\mu_0} \partial^\mu
\left(\partial_\mu A_\nu + \partial_\mu A_\nu \right)
= j_\nu\\{1\over \mu_0} \partial^\mu \partial_\mu A_\nu = j_\nu\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight" id="equation-aeq1">
<span class="eqno">(2)<a class="headerlink" href="#equation-aeq1" title="Permalink to this equation">¶</a></span>\[\partial^\mu \partial_\mu A_\nu = \mu_0 j_\nu\]</div>
<p>Equations for the particle (in terms of <span class="math notranslate nohighlight">\(x^\mu\)</span> and <span class="math notranslate nohighlight">\(v^\mu\)</span>) are:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\d \over \d \tau} {\partial L\over \partial v_\mu}
     = {\partial L \over \partial x_\mu}\\{\d \over \d \tau} {\partial \over \partial v_\mu}
    \left(\half m g^{\alpha\beta} v_\alpha v_\beta
        + q v_\alpha A^\alpha\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}\\{\d \over \d \tau}
    \left(
        \half m g^{\alpha\beta} (\delta_{\alpha\mu} v_\beta
        + v_\alpha \delta_{\beta\mu})
        + q \delta_{\alpha\mu} A^\alpha\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}\\{\d \over \d \tau}
    \left(
        \half m (g^{\mu\beta} v_\beta + g^{\alpha\mu} v_\alpha)
        + q A^\mu\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}\\{\d \over \d \tau}
    \left(
        \half m (v^\mu + v^\mu)
        + q A^\mu\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}\\{\d \over \d \tau}
    \left(m v^\mu + q A^\mu\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}\\m {\d v^\mu \over \d \tau}
     = q \left(-{\d A^\mu\over\d\tau}
        + v_\alpha \partial^\mu A^\alpha\right)\\m {\d v^\mu \over \d \tau}
     = q \left(-v_\alpha \partial^\alpha A^\mu
        + v_\alpha \partial^\mu A^\alpha\right)\\m {\d v^\mu \over \d \tau}
     = q (\partial^\mu A^\alpha - \partial^\alpha A^\mu) v_\alpha\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight" id="equation-lorentz-rel">
<span class="eqno">(3)<a class="headerlink" href="#equation-lorentz-rel" title="Permalink to this equation">¶</a></span>\[m {\d v^\mu \over \d \tau}
     = q F^{\mu\alpha} v_\alpha\]</div>
<p>Where <span class="math notranslate nohighlight">\(F^{\mu\nu}\)</span> is called the electromagnetic field strength tensor:</p>
<div class="math notranslate nohighlight">
\[F^{\mu\nu} =  \partial^\mu A^\nu - \partial^\nu A^\mu\]</div>
<p>The only way to measure the electric field is through its interaction with the
charge particle. As such, the actual physical field (that can be measured) is
<span class="math notranslate nohighlight">\(F^{\mu\nu}\)</span>, which is invariant under any gauge transformation:</p>
<div class="math notranslate nohighlight">
\[A^\alpha \to A^\alpha + \partial^\alpha \psi\]</div>
<p>where <span class="math notranslate nohighlight">\(\psi\)</span> is a gauge function:</p>
<div class="math notranslate nohighlight">
\[F^{\mu\nu} \to  \partial^\mu (A^\nu+\partial^\nu\psi)
     - \partial^\nu (A^\mu+\partial^\mu\psi)
    = \partial^\mu A^\nu - \partial^\nu A^\mu
        +\partial^\mu \partial^\nu\psi - \partial^\nu \partial^\mu\psi
    = \partial^\mu A^\nu - \partial^\nu A^\mu
    = F^{\mu\nu}\]</div>
<p>In other words, two different <span class="math notranslate nohighlight">\(A^\mu\)</span> related by the gauge transformation
represent the exact same physical electromagnetic field (as given by the field
tensor). As such, we can modify the Lagrangian by applying the gauge
transformation to the field <span class="math notranslate nohighlight">\(A^\mu\)</span>: this changes the equations of motion for
the field (thus the numerical values for <span class="math notranslate nohighlight">\(A^\mu\)</span> will be different), but
doesn’t change the equation of motion for the particle, so the change will not
have any physical effect (cannot be measured).</p>
<p>By choosing <span class="math notranslate nohighlight">\(\psi\)</span> as a solution to the equation
<span class="math notranslate nohighlight">\(\partial_\mu\partial^\mu\psi=-\partial_\mu A^\mu\)</span>, we get:</p>
<div class="math notranslate nohighlight">
\[\partial_\mu (A^\mu + \partial^\mu \psi)
    = \partial_\mu A^\mu + \partial_\mu\partial^\mu \psi
    = \partial_\mu A^\mu - \partial_\mu A^\mu
    = 0\]</div>
<p>So for any 4-potential we can find <span class="math notranslate nohighlight">\(\psi\)</span> such that the transformed 4-potential
<span class="math notranslate nohighlight">\(A^\mu\)</span> obeys the Lorenz gauge condition <span class="math notranslate nohighlight">\(\partial_\mu A^\mu=0\)</span>.</p>
<p>In order to obtain a gauge
invariant Lagrangian, we need to express it using <span class="math notranslate nohighlight">\(F^{\mu\nu}\)</span> using the
following identity:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{1\over 4} F_{\alpha\beta} F^{\alpha\beta}
    ={1\over 4}(\partial_\alpha A_\beta - \partial_\beta A_\alpha)
        (\partial^\alpha A^\beta - \partial^\beta A^\alpha) =\\    ={1\over 4}(
        \partial_\alpha A_\beta
        \partial^\alpha A^\beta
         - \partial_\beta A_\alpha
        \partial^\alpha A^\beta
        -\partial_\alpha A_\beta
         \partial^\beta A^\alpha
         + \partial_\beta A_\alpha
          \partial^\beta A^\alpha
        ) =\\    ={1\over 2}(
        \partial_\alpha A_\beta
        \partial^\alpha A^\beta
         - \partial_\beta A_\alpha
        \partial^\alpha A^\beta
        ) =\\    =\half \partial_\alpha A_\beta \partial^\alpha A^\beta
         - \half\partial_\beta A_\alpha \partial^\alpha A^\beta =\\    =\half \partial_\alpha A_\beta \partial^\alpha A^\beta
           -\half (\partial^\alpha A_\alpha)^2
         - \half\partial_\beta (A_\alpha \partial^\alpha A^\beta
           -A^\beta\partial^\alpha A_\alpha)\end{aligned}\end{align} \]</div>
<p>The 4-divergence
<span class="math notranslate nohighlight">\(\partial_\beta (A_\alpha \partial^\alpha A^\beta -A^\beta\partial^\alpha A_\alpha)\)</span>
doesn’t change Euler-Lagrange equations, so we can ignore it.
We can see, that in the Lorenz gauge <span class="math notranslate nohighlight">\(\partial^\alpha A_\alpha=0\)</span> the term
<span class="math notranslate nohighlight">\({1\over 4} F_{\alpha\beta} F^{\alpha\beta}\)</span> (which is gauge invariant)
simplifies to the term <span class="math notranslate nohighlight">\(\partial_\alpha A_\beta \partial^\alpha A^\beta\)</span> in the
Lagrangian <a class="reference internal" href="#equation-lagem">(1)</a>. The gauge invariant Lagrangian is:</p>
<div class="math notranslate nohighlight" id="equation-lagem2">
<span class="eqno">(4)<a class="headerlink" href="#equation-lagem2" title="Permalink to this equation">¶</a></span>\[L(x^\mu, v^\mu, A^\mu, \partial_\nu A^\mu)
  =-\half m v_\alpha v^\alpha
    -\int {1\over 4\mu_0} F_{\alpha\beta} F^{\alpha\beta} \d^3 x
        - \int j_\alpha A^\alpha \d^3 x\]</div>
<p>The E.-L. equation for the particle doesn’t change, the equation for the field
becomes:</p>
<div class="math notranslate nohighlight">
\[\partial^\mu (\partial_\mu A_\nu-\partial_\nu A_\mu) = \mu_0 j_\nu\]</div>
<div class="math notranslate nohighlight" id="equation-feq1">
<span class="eqno">(5)<a class="headerlink" href="#equation-feq1" title="Permalink to this equation">¶</a></span>\[\partial^\mu F_{\mu\nu} = \mu_0 j_\nu\]</div>
<p>Which in Lorenz gauge simplifies to equation <a class="reference internal" href="#equation-aeq1">(2)</a>.
In order to write equations of motion in terms of <span class="math notranslate nohighlight">\(F^{\mu\nu}\)</span> only, we
need another equation for it:</p>
<div class="math notranslate nohighlight" id="equation-feq2">
<span class="eqno">(6)<a class="headerlink" href="#equation-feq2" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}\epsilon^{\alpha\beta\gamma\delta}\partial_\gamma F_{\alpha\beta}
    = \epsilon^{\alpha\beta\gamma\delta}\partial_\gamma
        (\partial_\alpha A_\beta - \partial_\beta A_\alpha) =\\    = \epsilon^{\alpha\beta\gamma\delta}\partial_\gamma
        \partial_\alpha A_\beta
        -\epsilon^{\alpha\beta\gamma\delta}\partial_\gamma
        \partial_\beta A_\alpha = 0\end{aligned}\end{align} \]</div>
<p>We used the fact, that the partial derivatives are symmetric in the indices
<span class="math notranslate nohighlight">\(\gamma\alpha\)</span> and <span class="math notranslate nohighlight">\(\gamma\beta\)</span> while
<span class="math notranslate nohighlight">\(\epsilon^{\alpha\beta\gamma\delta}\)</span> is antisymmetric.</p>
</div>
<div class="section" id="id1">
<h2>Maxwell’s Equations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Maxwell’s equations are the equations for the electromagnetic field in terms of
the physical field strengh tensor, equations <a class="reference internal" href="#equation-feq1">(5)</a> and <a class="reference internal" href="#equation-feq2">(6)</a>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\partial^\mu F_{\mu\nu} = \mu_0 j_\nu\\\epsilon^{\alpha\beta\gamma\delta}\partial_\gamma F_{\alpha\beta} = 0\end{aligned}\end{align} \]</div>
<p>The field strength tensor is antisymmetric, so it has 6 independent components
(we use metric tensor with signature -2):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}F^{0i} = \partial^0 A^i - \partial^i A^0
    = {1\over c}{\partial A^i\over \partial t} +
        {\partial\over\partial x_i} {\phi\over c}
    = -{1\over c}\left(-{\partial\phi\over\partial x_i}
            -{\partial A^i\over \partial t} \right)\\
F^{ij} = \partial^i A^j - \partial^j A^i
    = -{\partial A^j\over\partial x_i} +{\partial A^i\over\partial x_j}
    = -(\delta^i{}_l\delta^j{}_m - \delta^i{}_m\delta^j{}_l)
        {\partial A^m\over\partial x_l}
    = -\epsilon^{ij}{}_k\epsilon^k{}_{lm} {\partial A^m\over\partial x_l}\end{aligned}\end{align} \]</div>
<p>There is freedom in how we label the components. The standard way is to express
them using physical fields <span class="math notranslate nohighlight">\({\bf E}\)</span> and <span class="math notranslate nohighlight">\({\bf B}\)</span> that are introduced by:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf E} = -\nabla\phi - {\partial {\bf A}\over\partial t}\\{\bf B} = \nabla\times{\bf A}\end{aligned}\end{align} \]</div>
<p>or in components:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}E^i = -{\partial\phi\over\partial x_i}
            -{\partial A^i\over \partial t}\\B^k = \epsilon^k{}_{lm} \nabla^l A^m\end{aligned}\end{align} \]</div>
<p>Comparing to the above, we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}F^{0i} = -{E^i\over c}\\F^{ij} = -\epsilon^{ij}{}_k B^k\end{aligned}\end{align} \]</div>
<p>In particular:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}F^{12} = -\epsilon^{12}{}_k B^k = -\epsilon^{12}{}_3 B^3 = - B^3\\F^{13} = -\epsilon^{13}{}_k B^k = -\epsilon^{13}{}_2 B^2 = + B^2\\F^{23} = -\epsilon^{23}{}_k B^k = -\epsilon^{23}{}_1 B^1 = - B^1\end{aligned}\end{align} \]</div>
<p>so we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}F^{\mu\nu} = \left(\begin{array}{cccc}
0 &amp; -{E^1\over c} &amp; -{E^2\over c} &amp; -{E^3\over c} \\
{E^1\over c} &amp; 0 &amp; -B^3 &amp; B^2 \\
{E^2\over c} &amp; B^3 &amp; 0 &amp; -B^1 \\
{E^3\over c} &amp; -B^2 &amp; B^1 &amp; 0 \\
\end{array}\right)\end{split}\\\begin{split}F_{\mu\nu} = g_{\mu\alpha}g_{\nu\beta}F^{\alpha\beta}
    = \left(\begin{array}{cccc}
0 &amp; {E^1\over c} &amp; {E^2\over c} &amp; {E^3\over c} \\
-{E^1\over c} &amp; 0 &amp; -B^3 &amp; B^2 \\
-{E^2\over c} &amp; B^3 &amp; 0 &amp; -B^1 \\
-{E^3\over c} &amp; -B^2 &amp; B^1 &amp; 0 \\
\end{array}\right)\end{split}\end{aligned}\end{align} \]</div>
<p>In terms of <span class="math notranslate nohighlight">\(\bf E\)</span> and <span class="math notranslate nohighlight">\(\bf B\)</span> fields, the Maxwell’s equations become:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\nabla\cdot{\bf E} = c^2\mu_0 \rho\\\nabla\times{\bf B} = \mu_0 {\bf j} + {1\over c^2}{\partial{\bf E}
    \over \partial t}\\\nabla\cdot{\bf B} = 0\\\nabla\times{\bf E} = -{\partial{\bf B}\over\partial t}\end{aligned}\end{align} \]</div>
<p>In Lorenz gauge, the equation for the 4-potential is <a class="reference internal" href="#equation-aeq1">(2)</a>:</p>
<div class="math notranslate nohighlight">
\[\partial^\mu \partial_\mu A_\nu = \mu_0 j_\nu\]</div>
<p>The solution to this equation is:</p>
<div class="math notranslate nohighlight">
\[A^\beta({\bf x}, t) = {\mu_0\over 4\pi}\int
     {j^\beta({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y\]</div>
<p>For scalar potential (<span class="math notranslate nohighlight">\(\beta=0\)</span>) we get:</p>
<div class="math notranslate nohighlight">
\[{\phi({\bf x}, t)\over c} = {\mu_0\over 4\pi}\int
     {c \rho({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y\]</div>
<div class="math notranslate nohighlight" id="equation-ascal-sol">
<span class="eqno">(7)<a class="headerlink" href="#equation-ascal-sol" title="Permalink to this equation">¶</a></span>\[\phi({\bf x}, t) = {\mu_0 c^2\over 4\pi}\int
     {\rho({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y
    = {1\over 4\pi\epsilon_0}\int
     {\rho({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y\]</div>
<p>And for vector potential (<span class="math notranslate nohighlight">\(\beta=i\)</span>) we get:</p>
<div class="math notranslate nohighlight" id="equation-avec-sol">
<span class="eqno">(8)<a class="headerlink" href="#equation-avec-sol" title="Permalink to this equation">¶</a></span>\[{\bf A}({\bf x}, t) = {\mu_0\over 4\pi}\int
     {{\bf j}({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y\]</div>
</div>
<div class="section" id="lorentz-force">
<h2>Lorentz Force<a class="headerlink" href="#lorentz-force" title="Permalink to this headline">¶</a></h2>
<p>The equation for the charge particle <a class="reference internal" href="#equation-lorentz-rel">(3)</a> is:</p>
<div class="math notranslate nohighlight">
\[m {\d v^\mu \over \d \tau}
     = q F^{\mu\alpha} v_\alpha\]</div>
<p>In components:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}m {\d v^0 \over \d \tau}
     = q F^{0\alpha} v_\alpha
     = -q {E^i\over c} \gamma v_i\\m {\d v^i \over \d \tau}
     = q F^{i\alpha} v_\alpha
     = q \left(-{E^i\over c} v_0 - \epsilon^{ij}{}_k B^k v_j\right)
     = q \left({E^i\over c} v^0 + \epsilon^i{}_{jk} B^k v^j\right)
     = q\gamma \left(E^i + ({\bf v}\times{\bf B})^i\right)\end{aligned}\end{align} \]</div>
<p>Using coordinate time <span class="math notranslate nohighlight">\(t\)</span> and coordinates <span class="math notranslate nohighlight">\({\bf x}\)</span> instead of the proper time
<span class="math notranslate nohighlight">\(\tau\)</span> and 4-vector <span class="math notranslate nohighlight">\(x^\mu\)</span>, we need to rewrite the action:</p>
<div class="math notranslate nohighlight">
\[S = \int L(x^\mu, v^\mu) \d \tau
  = \int {1\over\gamma}L(x^\mu, v^\mu) \d t
  = \int L_{coord}({\bf x}, {\bf v}) \d t\]</div>
<p>where <span class="math notranslate nohighlight">\(L_{coord}({\bf x}, {\bf v})\)</span> is the Lagrangian expressed in coordinates
<span class="math notranslate nohighlight">\({\bf x}\)</span> and <span class="math notranslate nohighlight">\({\bf v}\)</span> (and thus is not Lorentz invariant):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}L_{coord}({\bf x}, {\bf v}) = {1\over\gamma}L(x^\mu, v^\mu) =\\     = -{m c^2\over\gamma} + {e\over\gamma}v_\alpha A^\alpha =\\     = -{m c^2\over\gamma} + {e\over\gamma}(-c\gamma A^0 +\gamma v_i A^i) =\\     = -m c^2\sqrt{1-{v^2\over c^2}} - e\phi + e{\bf v}\cdot {\bf A}\end{aligned}\end{align} \]</div>
<p>the particle’s canonical momentum <span class="math notranslate nohighlight">\({\bf P}\)</span> is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P_i = {\partial L(t)\over\partial v_i}
    =-mc^2 {1\over 2\sqrt{1-{v^2\over c^2}}}\left(-2v_i\over c^2\right)
         + e A_i
    ={m v_i\over\sqrt{1-{v^2\over c^2}}} + e A_i\\{\bf P} = {m{\bf v}\over\sqrt{1-{v^2\over c^2}}} + e{\bf A}
    = \gamma m{\bf v} + e{\bf A}
    = {\bf p} + e{\bf A}\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\({\bf p} = {\bf P}-e{\bf A} = \gamma m{\bf v}\)</span> is the kinetic momentum.
Euler-Lagrange equations are:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\d \over \d t} {\partial L_{coord}\over \partial v_i}
     = {\partial L_{coord} \over \partial x_i}\\{\d \over \d t} P_i = {\partial L_{coord} \over \partial x_i}\\{\d \over \d t} \left({m v_i\over\sqrt{1-{v^2\over c^2}}} + e A_i\right)
     = {\partial \over \partial x_i}\left(-m c^2\sqrt{1-{v^2\over c^2}}
         - e\phi + e{\bf v}\cdot {\bf A}\right)\\{\d \over \d t} \left({m v_i\over\sqrt{1-{v^2\over c^2}}}\right)
     + e {\d A_i\over \d t}
     = -e{\partial \phi\over \partial x_i}
       +e{\bf v}\cdot{\partial {\bf A}\over \partial x_i}\\{\d \over \d t} \left({m v_i\over\sqrt{1-{v^2\over c^2}}}\right)
     = e\left(-{\partial \phi\over \partial x_i}
       -{\d A_i\over \d t}
       +v_j{\partial A_j\over \partial x_i}\right)\\{\d \over \d t} \left({m v_i\over\sqrt{1-{v^2\over c^2}}}\right)
     = e\left(-{\partial \phi\over \partial x_i}
       -{\partial A_i\over \partial t}-v_j{\partial A_i\over\partial x_j}
       +v_j{\partial A_j\over \partial x_i}\right)\\{\d \over \d t} \left({m {\bf v}\over\sqrt{1-{v^2\over c^2}}}\right)
     = e\left({\bf E} + {\bf v}\times {\bf B}\right)\end{aligned}\end{align} \]</div>
<p>For continuous case (current), the force due to the magnetic field is:</p>
<div class="math notranslate nohighlight">
\[{\bf F} = \int {\bf j}\times {\bf B} \d^3 x
    = I \int \d {\bf l}\times {\bf B}\]</div>
</div>
<div class="section" id="hamiltonian">
<h2>Hamiltonian<a class="headerlink" href="#hamiltonian" title="Permalink to this headline">¶</a></h2>
<p>Expressing <span class="math notranslate nohighlight">\({\bf v}\)</span> in terms of <span class="math notranslate nohighlight">\({\bf P}\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf P} = {m{\bf v}\over\sqrt{1-{v^2\over c^2}}} + e{\bf A}\\{\bf P} - e{\bf A} = {m{\bf v}\over\sqrt{1-{v^2\over c^2}}}\\P_i - e A_i = {m v_i\over\sqrt{1-{v^2\over c^2}}}\\(P_i - e A_i)^2\left(1-{v^2\over c^2}\right) = m^2 v_i^2\\(P_i - e A_i)^2\left(1-{(v_1^2 + v_2^2 + v_3^3)^2\over c^2}\right)
    = m^2 v_i^2\\v_i^2 = {(P_i - e A_i)^2 c^2 \over m c^2 + ({\bf P} - e{\bf A})^2}\\|v_i| = {|P_i - e A_i| \over \sqrt {m + {1\over c^2 } ({\bf P} - e{\bf A})^2}}\\v_i = {P_i - e A_i \over \sqrt {m + {1\over c^2 } ({\bf P} - e{\bf A})^2}}\\{\bf v} = {{\bf P} - e{\bf A}\over\sqrt{m^2 +
    {1\over c^2}({\bf P} - e{\bf A})^2}}\\{\bf v} = {c({\bf P} - e{\bf A})\over\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}}\end{aligned}\end{align} \]</div>
<p>The system of equations was solved for <span class="math notranslate nohighlight">\(v_i\)</span> using the code
(in there <span class="math notranslate nohighlight">\(v1s = v_1^2\)</span>, <span class="math notranslate nohighlight">\(vs=v^2\)</span> and <span class="math notranslate nohighlight">\(P1 = P_1 - eA_1\)</span>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">solve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;P1 P2 P3 m c v1s v2s v3s&quot;</span><span class="p">)</span>
<span class="go">(P1, P2, P3, m, c, v1s, v2s, v3s)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vs</span> <span class="o">=</span> <span class="n">v1s</span><span class="o">+</span><span class="n">v2s</span><span class="o">+</span><span class="n">v3s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">([</span><span class="n">P1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">vs</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="n">v1s</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">P2</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">vs</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="n">v2s</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">P3</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">vs</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="n">v3s</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">v1s</span><span class="p">,</span> <span class="n">v2s</span><span class="p">,</span> <span class="n">v3s</span><span class="p">])</span>
<span class="go">{v1s: P1**2*c**2/(P1**2 + P2**2 + P3**2 + c**2*m**2),</span>
<span class="go"> v2s: P2**2*c**2/(P1**2 + P2**2 + P3**2 + c**2*m**2),</span>
<span class="go"> v3s: P3**2*c**2/(P1**2 + P2**2 + P3**2 + c**2*m**2)}</span>
</pre></div>
</div>
<p>And the absolute value was removed by using the fact, that <span class="math notranslate nohighlight">\(v_i\)</span> has the same
sign as <span class="math notranslate nohighlight">\(p_i = P_i - e A_i\)</span> which follows from the second equation.</p>
<p>The Hamiltonian is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}H({\bf x}, {\bf P}, t) = {\bf v} \cdot {\bf P} - L =\\    = {\bf v} \cdot {\bf P}
    +m c^2\sqrt{1-{v^2\over c^2}} + e\phi - e{\bf v}\cdot {\bf A} =\\    = {\bf v} \cdot ({\bf P}-e{\bf A})
    +m c^2\sqrt{1-{v^2\over c^2}} + e\phi =\\    = {c({\bf P} - e{\bf A})\cdot({\bf P}-e{\bf A})\over\sqrt{m^2c^2 +
    ({\bf P} - e{\bf A})^2}}
    +m c^2\sqrt{1-{1\over c^2}\left({c({\bf P} - e{\bf A})\over\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}}\right)^2} + e\phi =\\    = {c({\bf P} - e{\bf A})^2\over\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}}
    +m c^2\sqrt{1-{({\bf P} - e{\bf A})^2\over m^2c^2 + ({\bf P} - e{\bf A})^2}} + e\phi =\\    = {c({\bf P} - e{\bf A})^2\over\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}}
    +m c^2\sqrt{m^2 c^2 \over m^2c^2 + ({\bf P} - e{\bf A})^2} + e\phi =\\    = {c\left(({\bf P} - e{\bf A})^2+m^2c^2\right)\over
        \sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}} + e\phi =\\    = c\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2} + e\phi\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="electromagnetic-stress-tensor">
<h2>Electromagnetic Stress Tensor<a class="headerlink" href="#electromagnetic-stress-tensor" title="Permalink to this headline">¶</a></h2>
<p>The stress tensor is calculated from the Lagrangian:</p>
<div class="math notranslate nohighlight">
\[\L = -{1\over 4\mu_0} F_{\alpha\beta} F^{\alpha\beta}
    =-{1\over 2\mu_0}(\partial_\alpha A_\beta \partial^\alpha A^\beta
        -\partial_\beta A_\alpha \partial^\alpha A^\beta)\]</div>
<p>using the Noether formula:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}T^\mu{}_\nu = {\partial\L\over\partial(\partial_\mu A_\alpha)}
                \partial_\nu A_\alpha
                -\delta^\mu{}_\nu \L =\\    = -{1\over\mu_0} F^{\mu\alpha}
        \partial_\nu A_\alpha+{1\over 4\mu_0}\delta^\mu{}_\nu
            F_{\alpha\beta} F^{\alpha\beta}\end{aligned}\end{align} \]</div>
<p>We raise the <span class="math notranslate nohighlight">\(\nu\)</span> index:</p>
<div class="math notranslate nohighlight">
\[T^{\mu\nu} = g^{\nu\lambda} T^\mu{}_\lambda
    = -{1\over\mu_0} F^{\mu\alpha}
        \partial^\nu A_\alpha+{1\over 4\mu_0}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta}\]</div>
<p>This tensor is not symmetric under the exchange of the <span class="math notranslate nohighlight">\(\mu\nu\)</span> indices. To
make it symmetric, we add a total derivative term
<span class="math notranslate nohighlight">\(\partial_\alpha K^{\alpha\mu\nu}\)</span>, where <span class="math notranslate nohighlight">\(K^{\alpha\mu\nu}\)</span> is antisymmetric
in its first two indices. This guarantees that
<span class="math notranslate nohighlight">\(\partial_\mu \partial_\alpha K^{\alpha\mu\nu}=0\)</span> so that the new stress energy
tensor is still conserved. We choose
<span class="math notranslate nohighlight">\(K^{\alpha\mu\nu}={1\over\mu_0} F^{\mu\alpha} A^\nu\)</span> and get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}T^{\mu\nu} +\partial_\alpha K^{\alpha\mu\nu}
    = -{1\over\mu_0} F^{\mu\alpha}
        \partial^\nu A_\alpha+{1\over 4\mu_0}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta}
            +{1\over\mu_0}\partial_\alpha ( F^{\mu\alpha} A^\nu) =\\    = {1\over\mu_0}F^{\mu\alpha}
            (\partial_\alpha A^\nu - \partial^\nu A_\alpha)
        +{1\over 4\mu_0}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta}
            +{1\over\mu_0}(\partial_\alpha F^{\mu\alpha}) A^\nu =\\    = {1\over\mu_0}F^{\mu\alpha} F_\alpha{}^\nu
        +{1\over 4\mu_0}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta} =\\    = -{1\over\mu_0}\left(F^{\mu\alpha} F^\nu{}_\alpha
        -{1\over 4}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta}\right)\end{aligned}\end{align} \]</div>
<p>where we used <span class="math notranslate nohighlight">\(\partial_\alpha F^{\mu\alpha} = 0\)</span>.</p>
<p>Another way to derive the stress energy tensor is from general relativity using
the formula:</p>
<div class="math notranslate nohighlight">
\[T_{\mu\nu} = - {2\over\sqrt{ |\det g| }}{\delta S_{EM}\over
        \delta g^{\mu\nu}}\]</div>
<p>So we write the action:</p>
<div class="math notranslate nohighlight">
\[S_{EM} = -\int {1\over 4\mu_0} F_{\alpha\beta} F^{\alpha\beta}
    \sqrt{ |\det g| }\d^4 x
    = -\int {1\over 4\mu_0} g^{\alpha\lambda} g^{\beta\rho} F_{\alpha\beta}
        F_{\lambda\rho}
    \sqrt{ |\det g| }\d^4 x\]</div>
<p>And vary with respect to <span class="math notranslate nohighlight">\(g^{\mu\nu}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\delta S_{EM}
    = -\delta \int {1\over 4\mu_0} g^{\alpha\lambda} g^{\beta\rho}
        F_{\alpha\beta} F_{\lambda\rho} \sqrt{ |\det g| }\d^4 x =\\    = -{1\over 4\mu_0} \int  \left(\delta (g^{\alpha\lambda} g^{\beta\rho})
        F_{\alpha\beta} F_{\lambda\rho} \sqrt{ |\det g| }
        + g^{\alpha\mu} g^{\beta\rho}
        F_{\alpha\beta} F_{\lambda\rho} \left(\delta \sqrt{ |\det g| }
        \right)
        \right)\d^4 x =\\    = -{1\over 4\mu_0} \int  \left(2(\delta g^{\alpha\lambda}) g^{\beta\rho}
        F_{\alpha\beta} F_{\lambda\rho} \sqrt{ |\det g| }
        + g^{\alpha\lambda} g^{\beta\rho}
        F_{\alpha\beta} F_{\lambda\rho} \left(-\half \sqrt{ |\det g| }
        g_{\mu\nu} (\delta g^{\mu\nu})
        \right)
        \right)\d^4 x =\\    = -{1\over 4\mu_0} \int  \left(2(\delta g^{\alpha\lambda})
        F_{\alpha\beta} F_\lambda{}^\beta
        -\half F_{\alpha\beta} F^{\alpha\beta}
        g_{\mu\nu} (\delta g^{\mu\nu})
        \right) \sqrt{ |\det g| } \d^4 x =\\    = -{1\over 2\mu_0} \int  \left(
        F_{\mu\beta} F_\nu{}^\beta
        -{1\over 4} F_{\alpha\beta} F^{\alpha\beta}
        g_{\mu\nu}
        \right) (\delta g^{\mu\nu}) \sqrt{ |\det g| } \d^4 x\end{aligned}\end{align} \]</div>
<p>And we get:</p>
<div class="math notranslate nohighlight">
\[T_{\mu\nu} = {1\over \mu_0} \left(
        F_{\mu\beta} F_\nu{}^\beta
        -{1\over 4} F_{\alpha\beta} F^{\alpha\beta}
        g_{\mu\nu} \right)\]</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="coulomb-law">
<h3>Coulomb Law<a class="headerlink" href="#coulomb-law" title="Permalink to this headline">¶</a></h3>
<p>Maxwell’s equations in Lorenz gauge <a class="reference internal" href="#equation-aeq1">(2)</a>:</p>
<div class="math notranslate nohighlight">
\[\partial_\alpha\partial^\alpha A^\beta = \mu_0 j^\beta\]</div>
<p>have the solution for the scalar potential <a class="reference internal" href="#equation-ascal-sol">(7)</a>:</p>
<div class="math notranslate nohighlight">
\[\phi({\bf x}, t)
    = {1\over 4\pi\epsilon_0}\int
     {\rho({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y\]</div>
<p>Assuming <span class="math notranslate nohighlight">\({ |{\bf x} - {\bf y}| \over c} \ll t\)</span>:</p>
<div class="math notranslate nohighlight">
\[\phi({\bf x}, t)
    = {1\over 4\pi\epsilon_0}\int {\rho({\bf y},t)
        \over |{\bf x} - {\bf y}| }\d^3 y\]</div>
<p>Assuming the vector potential <span class="math notranslate nohighlight">\({\bf A}({\bf x}, t)={\bf A}({\bf x})\)</span>
is time independent, we get for the electric field:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf E}({\bf x}, t) = -\nabla\phi({\bf x}, t)
        - {\partial {\bf A}({\bf x}, t)\over\partial t}
    = -\nabla\phi({\bf x}, t)
    = -\nabla {1\over 4\pi\epsilon_0}\int {\rho({\bf y},t)
        \over |{\bf x} - {\bf y}| }\d^3 y =\\    = - {1\over 4\pi\epsilon_0}\int \rho({\bf y},t) \nabla {1
        \over |{\bf x} - {\bf y}| }\d^3 y =\\    = {1\over 4\pi\epsilon_0}\int \rho({\bf y},t)
    {{\bf x} - {\bf y} \over | {\bf x} - {\bf y}|^3 } \d^3 y\end{aligned}\end{align} \]</div>
<p>If the charge distribution can be approximated by an infinitely-narrow wire
with linear charge density <span class="math notranslate nohighlight">\(\lambda(y, t) = {\d Q(t)\over\d y}\)</span>, we get:</p>
<div class="math notranslate nohighlight">
\[\rho({\bf y},t) \d^3 y = \lambda({\bf y}, t) \d l\]</div>
<p>and:</p>
<div class="math notranslate nohighlight">
\[{\bf E}({\bf x}, t)
    = {1\over 4\pi\epsilon_0}\int \lambda({\bf l}, t)
    {{\bf x} - {\bf l} \over | {\bf x} - {\bf l}|^3 } \d l\]</div>
<div class="section" id="example-straight-wire">
<h4>Example: Straight Wire<a class="headerlink" href="#example-straight-wire" title="Permalink to this headline">¶</a></h4>
<p>Let’s assume infinite straight wire with constant linear charge
density <span class="math notranslate nohighlight">\(\lambda\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf l} = (0, 0, l)\\\d {\bf l} = (0, 0, 1)\d l\\{\bf x} = (x, y, z)\\{\bf x}-{\bf l} = (x, y, z-l)\\{\bf E}({\bf x})
     ={\lambda\over 4\pi\epsilon_0}\int_{-\infty}^\infty
        {{\bf x} - {\bf l} \over |{\bf x} - {\bf l}|^3 } \d l =\\     ={\lambda\over 4\pi\epsilon_0} \int_{-\infty}^\infty
         {(x, y, z-l) \d l
            \over (x^2 + y^2 + (z-l)^2)^{3\over 2} } =\\     ={\lambda\over 4\pi\epsilon_0} \int_{-\infty}^\infty
         {(x, y, 0) \d l
            \over (x^2 + y^2 + (z-l)^2)^{3\over 2} } =\\     =(x, y, 0) {\lambda\over 4\pi\epsilon_0} \int_{-\infty}^\infty
         {\d u \over (x^2 + y^2 + u^2)^{3\over 2} } =\\     =(x, y, 0) {\lambda\over 4\pi\epsilon_0} {2\over x^2 + y^2 } =\\     =(x, y, 0) {\lambda\over 2\pi\epsilon_0} {1\over x^2 + y^2 }\end{aligned}\end{align} \]</div>
<p>For <span class="math notranslate nohighlight">\(y=0\)</span>:</p>
<div class="math notranslate nohighlight">
\[{\bf E}(x, 0, z)
     =(x, 0, 0) {\lambda\over 2\pi\epsilon_0} {1\over x^2 }
     =(1, 0, 0) {\lambda\over 2\pi\epsilon_0 x}\]</div>
<p>We can also calculate the scalar potential as follows:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\phi({\bf x})
    = {\lambda\over 4\pi\epsilon_0}\int_{-\infty}^\infty { \d l
        \over |{\bf x} - {\bf l}| } =\\    = {\lambda\over 4\pi\epsilon_0}\int_{-\infty}^\infty { \d l
        \over (x^2 + y^2 + (z-l)^2)^{1\over 2} } =\\    = {\lambda\over 4\pi\epsilon_0}\int_{-\infty}^\infty { \d u
        \over \sqrt{x^2 + y^2 + u^2} } =\\    = \infty\end{aligned}\end{align} \]</div>
<p>Note that in the radial direction (let’s set for example <span class="math notranslate nohighlight">\(y=0\)</span>) the result is
scale (translation) invariant, i.e. <span class="math notranslate nohighlight">\(\phi(kx) = \phi(x)\)</span>.</p>
<p>In order to calculate with <span class="math notranslate nohighlight">\(\phi({\bf x})\)</span>, we need to regularize it first.
Cutoff regularization is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\phi({\bf x})
    = {\lambda\over 4\pi\epsilon_0}\int_{-L}^L { \d u
        \over \sqrt{x^2 + y^2 + u^2} } =\\    = {\lambda\over 4\pi\epsilon_0}
        \log {\sqrt{x^2+y^2+L^2} + L \over
            \sqrt{x^2+y^2+L^2} - L}\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(L\)</span> is the regulator and also an auxiliary scale.
In this regularization, we lost the translational symmetry. The physical
quantities don’t depend on <span class="math notranslate nohighlight">\(L\)</span> in the limit <span class="math notranslate nohighlight">\(L\to\infty\)</span>:</p>
<div class="math notranslate nohighlight">
\[E_x = -{\partial \over \partial x} \phi(x)
= {\lambda\over 2\pi\epsilon_0 x} {L\over\sqrt{L^2+x^2}}
\to {\lambda\over 2\pi\epsilon_0 x}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\Delta \phi = \phi(x_2) - \phi(x_1) =
    {\lambda\over 4\pi\epsilon_0}
        \log {\sqrt{x_2^2+L^2} + L \over
            \sqrt{x_2^2+L^2} - L}
        {\sqrt{x_1^2+L^2} - L \over
            \sqrt{x_1^2+L^2} + L}
\to
{\lambda\over 4\pi\epsilon_0} \log {x_1^2\over x_2^2}\]</div>
<p>Dimensional regularization expresses the integral in the dimension
<span class="math notranslate nohighlight">\(n=1-2\epsilon\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\phi({\bf x})
    = {\lambda\over 4\pi\epsilon_0}
        \int \d \Omega_n
        \int_0^\infty {u^{n-1}\over \Lambda^{n-1}}
        { \d u \over \sqrt{x^2 + y^2 + u^2} } =\\    = {\lambda\over 4\pi\epsilon_0}
    {\Gamma\left(1-n\over2\right) \over \left({\sqrt{x^2+y^2}\over\Lambda}
    \sqrt\pi\right)^{1-n}} =\\    = {\lambda\over 4\pi\epsilon_0}
    {\Gamma(\epsilon) \over \left({\sqrt{x^2+y^2}\over\Lambda}
        \right)^{2\epsilon} \pi^\epsilon } =\\    = {\lambda\over 4\pi\epsilon_0}
    \left[{1\over\epsilon} -\gamma-\log\pi
        + \log{\Lambda^2\over x^2 + y^2} + O(\epsilon)\right]\end{aligned}\end{align} \]</div>
<p>Here <span class="math notranslate nohighlight">\(\epsilon\)</span> is the regulator and <span class="math notranslate nohighlight">\(\Lambda\)</span> is the auxiliary scale.
This regularization preserves the translational symmetry.
Now we can renormalize the integral. The minimal subtraction (MS)
renormalization is:</p>
<div class="math notranslate nohighlight">
\[\phi_{{\rm MS}}({\bf x})
    = {\lambda\over 4\pi\epsilon_0}
    \left[-\gamma-\log\pi + \log{\Lambda^2\over x^2 + y^2}\right]\]</div>
<p>Another option is
the modified minimal subtraction (<span class="math notranslate nohighlight">\(\overline{\rm MS}\)</span>) renormalization is:</p>
<div class="math notranslate nohighlight">
\[\phi_{\overline{\rm MS}}({\bf x})
    = {\lambda\over 4\pi\epsilon_0} \log{\Lambda^2\over x^2 + y^2}\]</div>
<p>Once we choose a renormalization scheme, we can calculate the electric field as
follows:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}E_x = -{\partial \over \partial x} \phi_{\overline{\mathrm{MS}}}(x)
= -{\partial \over \partial x}
    {\lambda\over 4\pi\epsilon_0} \log{\Lambda^2\over
    x^2}=\\= - {\lambda\over 4\pi\epsilon_0} {x^2\over\Lambda^2} \Lambda^2
    \left(-{2\over x^3}\right) =\\= {\lambda\over 2\pi\epsilon_0} {1\over x}\end{aligned}\end{align} \]</div>
<p>and the potential difference as:</p>
<div class="math notranslate nohighlight">
\[\Delta \phi = \phi_{\overline{\mathrm{MS}}}(x_2)
    - \phi_{\overline{\mathrm{MS}}}(x_1) =
    {\lambda\over 4\pi\epsilon_0}
        \log {\Lambda^2\over x_2^2}{x_1^2\over \Lambda^2}
=
{\lambda\over 4\pi\epsilon_0} \log {x_1^2\over x_2^2}\]</div>
<p>In agreement with the previous result. The final results don’t depend on the
auxiliary scale <span class="math notranslate nohighlight">\(\Lambda\)</span> and we are not doing any limits.</p>
</div>
</div>
<div class="section" id="biot-savart-law">
<h3>Biot-Savart Law<a class="headerlink" href="#biot-savart-law" title="Permalink to this headline">¶</a></h3>
<p>Maxwell’s equations in Lorenz gauge <a class="reference internal" href="#equation-aeq1">(2)</a>:</p>
<div class="math notranslate nohighlight">
\[\partial_\alpha\partial^\alpha A^\beta = \mu_0 j^\beta\]</div>
<p>have the solution for the vector potential <a class="reference internal" href="#equation-avec-sol">(8)</a>:</p>
<div class="math notranslate nohighlight">
\[{\bf A}({\bf x}, t) = {\mu_0\over 4\pi}\int
     {{\bf j}({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y\]</div>
<p>Assuming <span class="math notranslate nohighlight">\({ |{\bf x} - {\bf y}| \over c} \ll t\)</span>:</p>
<div class="math notranslate nohighlight">
\[{\bf A}({\bf x}, t) = {\mu_0\over 4\pi}\int
     {{\bf j}({\bf y},t) \over |{\bf x} - {\bf y}| }\d^3 y\]</div>
<p>The magnetic field is then:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf B}({\bf x}, t) = \nabla \times {\bf A}({\bf x}, t)
     =\nabla \times {\mu_0\over 4\pi}\int
     {{\bf j}({\bf y},t) \over |{\bf x} - {\bf y}| }\d^3 y =\\     ={\mu_0\over 4\pi}\int \left(\nabla {1\over
             |{\bf x} - {\bf y}| }\right)\times {\bf j}({\bf y},t)\d^3 y =\\     ={\mu_0\over 4\pi}\int \left(-{{\bf x} - {\bf y}\over
             |{\bf x} - {\bf y}|^3 }\right)\times {\bf j}({\bf y},t)\d^3 y =\\     ={\mu_0\over 4\pi}\int {\bf j}({\bf y},t) \times {{\bf x} - {\bf y}
            \over |{\bf x} - {\bf y}|^3 } \d^3 y\end{aligned}\end{align} \]</div>
<p>If the current can be approximated by an infinitely-narrow wire, we get:</p>
<div class="math notranslate nohighlight">
\[{\bf j}({\bf y},t) \d^3 y = I(t) \d {\bf l}\]</div>
<p>and:</p>
<div class="math notranslate nohighlight">
\[{\bf B}({\bf x}, t)
     ={\mu_0\over 4\pi}\int I(t)\d{\bf l} \times {{\bf x} - {\bf l}
            \over |{\bf x} - {\bf l}|^3 }\]</div>
<div class="section" id="id2">
<h4>Example: Straight Wire<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Let’s assume infinite straight wire carrying constant current <span class="math notranslate nohighlight">\(I\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf l} = (0, 0, l)\\\d {\bf l} = (0, 0, 1)\d l\\{\bf x} = (x, y, z)\\{\bf x}-{\bf l} = (x, y, z-l)\\{\bf B}({\bf x})
     ={\mu_0 I\over 4\pi}\int \d{\bf l} \times {{\bf x} - {\bf l}
            \over |{\bf x} - {\bf l}|^3 } =\\     ={\mu_0 I\over 4\pi} \int_{-\infty}^\infty (0, 0, 1) \times
         {(x, y, z-l) \d l
            \over (x^2 + y^2 + (z-l)^2)^{3\over 2} } =\\     =(y, -x, 0) {\mu_0 I \over 4\pi}\int_{-\infty}^\infty {\d l
            \over (x^2 + y^2 + (z-l)^2)^{3\over 2} } =\\     =(y, -x, 0) {\mu_0 I \over 4\pi} {2\over x^2+y^2} =\\     =(y, -x, 0) {\mu_0 I \over 2\pi} {1\over x^2+y^2}\end{aligned}\end{align} \]</div>
<p>Where we used the value of the folowing integral:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\int_{-\infty}^\infty {\d l \over (x^2+y^2 + (z - l)^2)^{3\over 2} }
    = \int_{-\infty}^\infty {\d u \over (x^2+y^2 + u^2)^{3\over 2} } =\\    = \left[u\over (x^2+y^2) \sqrt{x^2+y^2 + u^2}\right]_{-\infty}^\infty
    = \left[\sign u\over (x^2+y^2) \sqrt{
        \left(x\over u\right)^2 + \left(y\over u\right)^2 + 1}
        \right]_{-\infty}^\infty =\\    = {1\over x^2+y^2} - \left(-{1\over x^2+y^2}\right) = {2\over x^2+y^2}\end{aligned}\end{align} \]</div>
<p>For <span class="math notranslate nohighlight">\(y=0\)</span>:</p>
<div class="math notranslate nohighlight">
\[{\bf B}(x, 0, z)
     =(0, -x, 0) {\mu_0 I \over 2\pi} {1\over x^2}
     =(0, -1, 0) {\mu_0 I \over 2\pi x}\]</div>
</div>
<div class="section" id="example-circular-loop">
<h4>Example: Circular Loop<a class="headerlink" href="#example-circular-loop" title="Permalink to this headline">¶</a></h4>
<p>Let’s assume a circular loop:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf l} = (r\cos\phi, r\sin\phi, 0)\\{\d {\bf l}\over\d \phi} = (-r\sin\phi, r\cos\phi, 0)\\{\bf x} = (x, y, z)\\{\bf x}-{\bf l} = (x-r\cos\phi, y-r\sin\phi, z)\\{\bf B}({\bf x})
     ={\mu_0 I\over 4\pi}\int \d{\bf l} \times {{\bf x} - {\bf l}
            \over |{\bf x} - {\bf l}|^3 } =\\     ={\mu_0 I\over 4\pi} \int_0^{2\pi} (-r\sin\phi, r\cos\phi, 0) \times
         {(x-r\cos\phi, y-r\sin\phi, z) \d \phi
            \over ((x-r\cos\phi)^2 + (y-r\sin\phi)^2 + z^2)^{3\over 2} } =\\     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, -z\sin\phi, (x-r\cos\phi)\cos\phi+
                (y-r\sin\phi)\sin\phi)
         r\d \phi
            \over ((x-r\cos\phi)^2 + (y-r\sin\phi)^2 + z^2)^{3\over 2} } =\\     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, -z\sin\phi, x\cos\phi+y\sin\phi-r)
         r\d \phi
            \over (x^2+y^2+z^2+r^2-2xr\cos\phi-2yr\sin\phi)^{3\over 2} }\end{aligned}\end{align} \]</div>
<p>Due to the symmetry of the problem, we can set <span class="math notranslate nohighlight">\(y=0\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf B}(x, 0, z)
     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, -z\sin\phi, x\cos\phi-r)
         r\d \phi
            \over (x^2+z^2+r^2-2xr\cos\phi)^{3\over 2} } =\\     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, 0, x\cos\phi-r)
         r\d \phi
            \over (x^2+z^2+r^2-2xr\cos\phi)^{3\over 2} }\end{aligned}\end{align} \]</div>
<p>In the last equation we used the fact, that <span class="math notranslate nohighlight">\(\sin\phi\)</span> is odd and <span class="math notranslate nohighlight">\(\cos\phi\)</span> is
even on the interval <span class="math notranslate nohighlight">\((0, 2\pi)\)</span>.
For <span class="math notranslate nohighlight">\(x=y=0\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf B}(0, 0, z)
     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, 0, -r)
         r\d \phi
            \over (r^2 + z^2)^{3\over 2} } =\\     =(0, 0, -1) {\mu_0 I\over 4\pi} \int_0^{2\pi} {
         r^2\d \phi
            \over (r^2 + z^2)^{3\over 2} } =\\     =(0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + z^2)^{3\over 2} }\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="helmholtz-coil">
<h4>Helmholtz Coil<a class="headerlink" href="#helmholtz-coil" title="Permalink to this headline">¶</a></h4>
<p>Helmholtz coil is a set of two circular loops of radius <span class="math notranslate nohighlight">\(r\)</span>, that are <span class="math notranslate nohighlight">\(d\)</span>
apart, where <span class="math notranslate nohighlight">\(d=r\)</span>. Let’s calculate the magnetic field on the axis.
Magnetic field of the first coil is (see the previous example):</p>
<div class="math notranslate nohighlight">
\[{\bf B}_1(0, 0, z) = (0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + z^2)^{3\over 2} }\]</div>
<p>Second coil is positioned <span class="math notranslate nohighlight">\(d\)</span> above the first one:</p>
<div class="math notranslate nohighlight">
\[{\bf B}_2(0, 0, z) = (0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + (z-d)^2)^{3\over 2} }\]</div>
<p>The total magnetic field is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf B}(0, 0, z) = {\bf B}_1(0, 0, z) + {\bf B}_2(0, 0, z) =\\= (0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + z^2)^{3\over 2} }
+ (0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + (z-d)^2)^{3\over 2} } =\\= (0, 0, -1) {\mu_0 I r^2\over 2} \left(
         {1 \over (r^2 + z^2)^{3\over 2} } +
         {1 \over (r^2 + (z-d)^2)^{3\over 2} }\right)\end{aligned}\end{align} \]</div>
<p>The field in the middle:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf B}(0, 0, {d\over 2})
= (0, 0, -1) {\mu_0 I r^2\over 2} \left(
         {1 \over (r^2 + \left(d\over 2\right)^2)^{3\over 2} } +
         {1 \over (r^2 + \left(d\over 2\right)^2)^{3\over 2} }\right) =\\= (0, 0, -1) {\mu_0 I r^2
         \over (r^2 + \left(d\over 2\right)^2)^{3\over 2} }\end{aligned}\end{align} \]</div>
<p>For <span class="math notranslate nohighlight">\(r=d\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf B}(0, 0, {d\over 2})
= (0, 0, -1) {\mu_0 I r^2
         \over (r^2 + \left(r\over 2\right)^2)^{3\over 2} } =\\= (0, 0, -1) {\mu_0 I
         \over r (1 + \left(1\over 2\right)^2)^{3\over 2} } =\\= (0, 0, -1) {\mu_0 I 4^{3\over 2}
         \over r 5^{3\over 2} } =\\= (0, 0, -1) {8 \over 5 \sqrt 5} {\mu_0 I \over r} =\\= (0, 0, -1) B\end{aligned}\end{align} \]</div>
<p>where the magnitude of <span class="math notranslate nohighlight">\({\bf B}\)</span> is:</p>
<div class="math notranslate nohighlight">
\[B = {8 \over 5 \sqrt 5} {\mu_0 I \over r}\]</div>
<p>For <span class="math notranslate nohighlight">\(r=0.15\rm\, m\)</span> and <span class="math notranslate nohighlight">\(N=130\)</span> turns we get the magnitude of the field as
(we use SI units, so <span class="math notranslate nohighlight">\(I\)</span> is in <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> in tesla):</p>
<div class="math notranslate nohighlight">
\[B = {8 \over 5 \sqrt 5} {\mu_0 N I \over r}
  = {8 \over 5 \sqrt 5} {4\pi 10^{-7} \cdot 130 I \over 0.15}
  = 7.79\cdot 10^{-4} I\]</div>
<p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;</span><span class="si">%e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e-7</span><span class="o">*</span><span class="mi">130</span> <span class="o">/</span> <span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mf">0.15</span><span class="p">))</span>
<span class="go">&#39;7.792861e-04&#39;</span>
</pre></div>
</div>
<p>Equation of motion for an electron in this field is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}m {\d^2 {\bf x}\over \d t^2} = e\left({\bf v} \times {\bf B}\right)\\m {\d^2 {\bf x}\over \d t^2} = eB\, (v_y, -v_x, 0)\end{aligned}\end{align} \]</div>
<p>The general solution is:</p>
<div class="math notranslate nohighlight">
\[{\bf x} = {v m\over eB} \left(x + \cos {eB\over m} (t-t_0),
            y -\sin {eB\over m} (t-t_0),
            z\right)\]</div>
<p>So the electron is moving in a circle with a center <span class="math notranslate nohighlight">\((x, y, z)\)</span>,
<span class="math notranslate nohighlight">\(t_0\)</span> depends on the initial direction of the velocity and <span class="math notranslate nohighlight">\(v\)</span> is the magnitude
of the initial velocity. There can also be a possible movement in the <span class="math notranslate nohighlight">\(z\)</span>
direction, but for the following initial conditions there is none:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf x}_0 = (0, 0, 0)\\{\bf v}_0 = (0, -v, 0)\end{aligned}\end{align} \]</div>
<p>Then we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf x} = {v m\over eB} \left(-1+\cos {eB\over m} t,
            -\sin {eB\over m} t,
            0\right)\\{\bf v} = v \left(-\sin {eB\over m} t,
            -\cos {eB\over m} t,
            0\right)\end{aligned}\end{align} \]</div>
<p>So the radius of the circle is <span class="math notranslate nohighlight">\(R = {v m\over eB}\)</span>.
Let the electrons by accelerated by the electric potential <span class="math notranslate nohighlight">\(V\)</span>:</p>
<div class="math notranslate nohighlight">
\[\half m v^2 = e V\]</div>
<p>So the initial velocity is:</p>
<div class="math notranslate nohighlight">
\[v = \sqrt{2eV\over m}\]</div>
<p>and we get for the radius:</p>
<div class="math notranslate nohighlight">
\[R = {v m\over eB}
    = {m\over eB} \sqrt{2eV\over m}
    = {1\over B} \sqrt{2mV\over e}\]</div>
<p>from which the electron charge versus mass ratio is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{e\over m} = {2V \over R^2 B^2}
    = {2V \over R^2\left({8 \over 5 \sqrt 5} {\mu_0 N I \over r}\right)^2}=\\    = {125 V r^2 \over 32 \mu_0^2 R^2 N^2 I^2}\end{aligned}\end{align} \]</div>
<p>For <span class="math notranslate nohighlight">\(r=0.15\rm\, m\)</span>, <span class="math notranslate nohighlight">\(N=130\)</span>, <span class="math notranslate nohighlight">\(V=300\rm\,V\)</span>, <span class="math notranslate nohighlight">\(R=0.05\rm\,m\)</span>, <span class="math notranslate nohighlight">\(I=1.48\rm\,A\)</span>
we get:</p>
<div class="math notranslate nohighlight">
\[{e\over m} = 1.80 \cdot 10^{11}\rm\,C\cdot kg^{-1}\]</div>
<p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">130</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span> <span class="o">=</span> <span class="mf">1.48</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu0</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e-7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;</span><span class="si">%e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">125</span> <span class="o">*</span> <span class="n">V</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">32</span> <span class="o">*</span> <span class="n">mu0</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">I</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="go">&#39;1.804238e+11&#39;</span>
</pre></div>
</div>
<p>Reference value is:</p>
<div class="math notranslate nohighlight">
\[{e\over m} = 1.7588 \cdot 10^{11}\rm\,C\cdot kg^{-1}\]</div>
<p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="mf">1.6021766e-19</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="mi">299792458</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eV</span> <span class="o">=</span> <span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">KeV</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">eV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="mf">510.998910</span> <span class="o">*</span> <span class="n">KeV</span> <span class="o">/</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span>
<span class="go">9.109382795192204e-31</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;</span><span class="si">%e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">e</span> <span class="o">/</span> <span class="n">m</span><span class="p">)</span>
<span class="go">&#39;1.758820e+11&#39;</span>
</pre></div>
</div>
<p>or even simpler (we do not actually need the value of the electron charge
<span class="math notranslate nohighlight">\(e\)</span>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="mi">299792458</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">KeV</span> <span class="o">=</span> <span class="mf">1e3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="mf">510.998910</span> <span class="o">*</span> <span class="n">KeV</span> <span class="o">/</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;</span><span class="si">%e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span>
<span class="go">&#39;1.758820e+11&#39;</span>
</pre></div>
</div>
<p>We can use the experimental value to calculate the electron rest mass energy:</p>
<div class="math notranslate nohighlight">
\[m c^2 = {c^2 \over 1.804238\cdot 10^{11}}{\rm\, eV}
    = 498.1356 {\rm\, KeV}\]</div>
</div>
</div>
<div class="section" id="ampere-s-force-law">
<h3>Ampère’s Force Law<a class="headerlink" href="#ampere-s-force-law" title="Permalink to this headline">¶</a></h3>
<p>The force on a wire 1 due to a magnetic field of a wire 2 is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf F} = I_1 \int \d {\bf l}_1 \times {\bf B}({\bf l}_1)\\{\bf B}({\bf x})
     ={\mu_0\over 4\pi}\int I_2(t)\d{\bf l}_2 \times {{\bf x} - {\bf l}_2
            \over |{\bf x} - {\bf l}_2|^3 }\end{aligned}\end{align} \]</div>
<p>Where <span class="math notranslate nohighlight">\({\bf B}({\bf x})\)</span> is the magnetic field produced by the wire 2.
Combining these two equations we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf F} = I_1 \int \d {\bf l}_1 \times {\bf B}({\bf l}_1) =\\    = I_1 \int \d {\bf l}_1 \times \left(
     {\mu_0\over 4\pi}\int I_2(t)\d{\bf l}_2 \times {{\bf l}_1 - {\bf l}_2
            \over |{\bf l}_1 - {\bf l}_2|^3 }\right) =\\    = {\mu_o I_1 I_2\over 4\pi} \int \int {\d {\bf l}_1 \times (
     \d{\bf l}_2 \times ({\bf l}_1 - {\bf l}_2))
            \over |{\bf l}_1 - {\bf l}_2|^3 } =\\    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        \d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
        ({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
            \over |{\bf l}_1 - {\bf l}_2|^3 }\end{aligned}\end{align} \]</div>
<div class="section" id="parallel-straight-wires">
<h4>Parallel Straight Wires<a class="headerlink" href="#parallel-straight-wires" title="Permalink to this headline">¶</a></h4>
<p>We calculate the force between two parallel straight infinite wires:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf l}_1 = ({d\over 2}, 0, l_1)\\\d{\bf l}_1 = (0, 0, \d l_1)\\{\bf l}_2 = (-{d\over 2}, 0, l_2)\\\d{\bf l}_2 = (0, 0, \d l_2)\\{\bf l}_1 - {\bf l}_2 = (d, 0, l_1-l_2)\\\d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
    = (0, 0, \d l_2) (l_1-l_2)\d l_1 - (d, 0, l_1-l_2)\d l_2 \d l_1
    = (-d, 0, 0)\d l_1 \d l_2\\{\bf F}
    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        \d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
        ({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
            \over |{\bf l}_1 - {\bf l}_2|^3 } =\\    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        (-d, 0, 0)\d l_1 \d l_2
            \over (d^2 + (l_1 - l_2)^2)^{3\over 2} } =\\    = (-1, 0, 0){\mu_o I_1 I_2\over 4\pi} \int \d l_1
        \int_{-\infty}^\infty \d l_2 {
        d
            \over (d^2 + (l_1 - l_2)^2)^{3\over 2} } =\\    = (-1, 0, 0){\mu_o I_1 I_2\over 4\pi} \int \d l_1
        {2\over d} =\\    = (-1, 0, 0){\mu_o I_1 I_2\over 2\pi d} \int \d l_1\end{aligned}\end{align} \]</div>
<p>Where we used the value of the folowing integral:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\int_{-\infty}^\infty \d l_2 {d \over (d^2 + (l_1 - l_2)^2)^{3\over 2} }
    = \int_{-\infty}^\infty \d x {d \over (d^2 + x^2)^{3\over 2} } =\\    = \left[x\over d \sqrt{d^2 + x^2}\right]_{-\infty}^\infty
    = \left[\sign x\over d \sqrt{\left(d\over x\right)^2 + 1}
        \right]_{-\infty}^\infty =\\    = {1\over d} - \left(-{1\over d}\right) = {2\over d}\end{aligned}\end{align} \]</div>
<p>As such, the direction of the force on the first wire (at coordinates <span class="math notranslate nohighlight">\(({d\over
2}, 0, 0)\)</span> going in the <span class="math notranslate nohighlight">\(z\)</span> direction) will be to the left and the force per
unit length is:</p>
<div class="math notranslate nohighlight">
\[F_m = {\mu_o I_1 I_2\over 2\pi d}\]</div>
<p>Because the second wire is at the coordinates <span class="math notranslate nohighlight">\((-{d\over
2}, 0, 0)\)</span> and the force on the first wire is in the direction
<span class="math notranslate nohighlight">\((-1, 0, 0)\)</span>, the force between the wires is attractive, as long as <span class="math notranslate nohighlight">\(I_1\)</span> and
<span class="math notranslate nohighlight">\(I_2\)</span> have the same sign (either both currents go up, or both down)
and repulsive if <span class="math notranslate nohighlight">\(I_1\)</span> and <span class="math notranslate nohighlight">\(I_2\)</span> have opposite signs.</p>
<p>Let <span class="math notranslate nohighlight">\(d=1\rm\,m\)</span>, <span class="math notranslate nohighlight">\(I_1 = I_2 = 1\rm\, A\)</span>, then the force is attractive and
(we also use <span class="math notranslate nohighlight">\(\mu_0 = 4\pi \cdot 10^{-7}\)</span>):</p>
<div class="math notranslate nohighlight">
\[F_m = {4\pi \cdot 10^{-7} \over 2\pi} {\rm\, N \cdot m^{-1}}
    = 2 \cdot 10^{-7} {\rm\, N \cdot m^{-1}}\]</div>
</div>
<div class="section" id="perpendicular-straight-wires">
<h4>Perpendicular Straight Wires<a class="headerlink" href="#perpendicular-straight-wires" title="Permalink to this headline">¶</a></h4>
<p>We calculate the force between two perpendicular straight infinite wires:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf l}_1 = ({d\over 2}, 0, l_1)\\\d{\bf l}_1 = (0, 0, \d l_1)\\{\bf l}_2 = (-{d\over 2}, l_2, 0)\\\d{\bf l}_2 = (0, \d l_2, 0)\\{\bf l}_1 - {\bf l}_2 = (d, -l_2, l_1)\\\d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
    = (0, \d l_2, 0) l_1\d l_1
    = (0, l_1, 0)\d l_1 \d l_2\\{\bf F}
    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        \d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
        ({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
            \over |{\bf l}_1 - {\bf l}_2|^3 } =\\    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        (0, l_1, 0)\d l_1 \d l_2
            \over (d^2 + l_1^2 + l_2^2)^{3\over 2} } =\\    = (0, 1, 0){\mu_o I_1 I_2\over 4\pi} \int_{-\infty}^\infty \d l_1
        \int_{-\infty}^\infty \d l_2 {
        l_1
            \over (d^2 + l_1^2 +l_2^2)^{3\over 2} } =\\    = (-1, 0, 0){\mu_o I_1 I_2\over 4\pi} \int_{-\infty}^\infty \d l_1
        {2 l_1\over d^2 + l_1^2}
        =\\    = 0\end{aligned}\end{align} \]</div>
<p>The integral is an odd functin of <span class="math notranslate nohighlight">\(l_1\)</span>, so it is zero.  We used the value of
the folowing integral (but in fact it is already seen before this integral is
needed that the double integral must be zero):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\int_{-\infty}^\infty \d l_2 {l_1 \over (d^2 + l_1^2 + l_2^2)^{3\over 2} }\\    = \left[l_1 l_2\over (d^2+l_1^2) \sqrt{d^2 +l_1^2 + l_2^2}
        \right]_{-\infty}^\infty
    = \left[l_1 \sign l_2\over (d^2+l_1^2)
        \sqrt{\left(d\over l_2\right)^2 + \left(l_1\over l_2\right)^2 + 1}
        \right]_{-\infty}^\infty =\\    = {l_1\over d^2+l_1^2} - \left(-{l_1\over d^2 + l_1^2}\right)
    = {2 l_1\over d^2 + l_1^2}\end{aligned}\end{align} \]</div>
<p>As such, there will be no net force.</p>
</div>
<div class="section" id="infinitely-long-wire-and-a-square-loop">
<h4>Infinitely Long Wire and a Square Loop<a class="headerlink" href="#infinitely-long-wire-and-a-square-loop" title="Permalink to this headline">¶</a></h4>
<p>We calculate the net force on a square loop with current <span class="math notranslate nohighlight">\(I_1\)</span> of side <span class="math notranslate nohighlight">\(a\)</span>,
whose center is <span class="math notranslate nohighlight">\(d\)</span> far from an infinitely long wire with current <span class="math notranslate nohighlight">\(I_2\)</span>:</p>
<p>The wire has coordinates <span class="math notranslate nohighlight">\((0, 0, z)\)</span> and the magnetic field from it is (see the
example above):</p>
<div class="math notranslate nohighlight">
\[{\bf B}(x, 0, z) = (0, -1, 0) {\mu_0 I \over 2\pi x}\]</div>
<p>The four sides of the loop are (<span class="math notranslate nohighlight">\(0 \le l_1 \le a\)</span>):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf l}_1 = (d-{a\over 2}+l_1, 0, {a\over2})\\{\bf l}_1 = (d+{a\over 2}, 0, {a\over2}-l_1)\\{\bf l}_1 = (d+{a\over 2}-l_1, 0, -{a\over2})\\{\bf l}_1 = (d-{a\over 2}, 0, -{a\over2}+l_1)\end{aligned}\end{align} \]</div>
<p>and the differentials are:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\d {\bf l}_1 = (1, 0, 0) \d l_1\\\d {\bf l}_1 = (0, 0, -1) \d l_1\\\d {\bf l}_1 = (-1, 0, 0) \d l_1\\\d {\bf l}_1 = (0, 0, 1) \d l_1\end{aligned}\end{align} \]</div>
<p>The net force on the loop is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf F} = I_1 \int \d {\bf l}_1 \times {\bf B}
    = I_1 \int \d {\bf l}_1 \times (0, -1, 0) {\mu_0 I_2 \over 2\pi
        ({\bf l}_1)_x} =\\    = {\mu_0 I_1 I_2\over 2\pi}\left(
        \int_0^a {(0, 0, 1)\d l_1\over d-{a\over 2} + l_1}
        +\int_0^a {(1, 0, 0)\d l_1\over d+{a\over 2}}
        +\int_0^a {(0, 0, -1)\d l_1\over d+{a\over 2}-l_1}
        +\int_0^a {(-1, 0, 0)\d l_1\over d-{a\over 2}}
        \right) =\\    = {\mu_0 I_1 I_2\over 2\pi}\left(
        (0, 0, 1)\left[\log \left| d-{a\over 2} + l_1 \right|
            -\log \left|d + {a\over 2} - l_1\right| \right]_0^a
        +(1, 0, 0)\left({a\over d + {a\over 2}}-{a\over d - {a\over 2}}
            \right)\right) =\\    = {\mu_0 I_1 I_2\over 2\pi}\left(
        (0, 0, 1) \cdot 0 +
        (1, 0, 0){a^2\over d^2 - \left({a\over 2}\right)^2}
            \right) =\\    = (1, 0, 0){\mu_0 I_1 I_2\over 2\pi}
        {a^2\over d^2 - \left({a\over 2}\right)^2}\end{aligned}\end{align} \]</div>
</div>
</div>
<div class="section" id="magnetic-dipole">
<h3>Magnetic Dipole<a class="headerlink" href="#magnetic-dipole" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf A}({\bf r}) = {\mu_0\over 4\pi} {{\bf m}\times{\bf r}\over r^3}\\{\bf B}({\bf r}) = \nabla\times {\bf A}
= {\mu_0\over 4\pi} \nabla\times
    \left({{\bf m}\times{\bf r}\over r^3}\right) =\\= {\mu_0\over 4\pi} \left({\bf m}\nabla\cdot\left({\bf r}\over r^3\right)
    -{\bf m}\cdot\nabla\left({\bf r}\over r^3\right)
    \right) =\\= {\mu_0\over 4\pi} \left({\bf m}\left(\left(\nabla{1\over r^3}\right)
        \cdot{\bf r}+{1\over r^3}\nabla\cdot{\bf r}\right)
    -{\bf m}\cdot\left(\left(\nabla{1\over r^3}\right)
        {\bf r}+{1\over r^3}\nabla{\bf r}\right)\right)
    =\\= {\mu_0\over 4\pi} \left({\bf m}\left(\left(-{3{\bf r}\over r^5}\right)
        \cdot{\bf r}+{1\over r^3}3\right)
    -{\bf m}\cdot\left(\left(-{3{\bf r}\over r^5}\right)
        {\bf r}+{1\over r^3}\one\right)\right)
    =\\= {\mu_0\over 4\pi} \left({\bf m}\left(-{3\over r^3}+{3\over r^3}\right)
    +{\bf m}\cdot\left({3{\bf r}{\bf r}\over r^5}-{\one\over r^3}\right)
    \right)
    =\\= {\mu_0\over 4\pi} \left({3{\bf r}({\bf m}\cdot{\bf r})\over r^5}
    -{{\bf m}\over r^3}\right)\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="bar-magnet">
<h3>Bar Magnet<a class="headerlink" href="#bar-magnet" title="Permalink to this headline">¶</a></h3>
<p>A good model of a bar magnet of the length <span class="math notranslate nohighlight">\(L\)</span> and width <span class="math notranslate nohighlight">\(W\)</span> is a combination
of two magnetic monopoles (that sit inside the magnet, so one cannot actually
see them, just their behavior outside the magnet):</p>
<div class="math notranslate nohighlight">
\[{\bf B}({\bf x}) = {\mu_0 Q_m\over 4\pi} \left(
    {{\bf x}-{\bf p}_1 \over |{\bf x}-{\bf p}_1|^3}
    -
    {{\bf x}-{\bf p}_2 \over |{\bf x}-{\bf p}_2|^3}
    \right)\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf p}_1 = (0, 0, d)\\{\bf p}_2 = (0, 0, -d)\\d = {L-W\over 2}\end{aligned}\end{align} \]</div>
<p>The magnetic moment vector is:</p>
<div class="math notranslate nohighlight">
\[{\bf m} = Q_m ({\bf p}_1 - {\bf p}_2)\]</div>
<p>and its magnitude then is:</p>
<div class="math notranslate nohighlight">
\[m = 2 Q_m d\]</div>
<p>The permeability is:</p>
<div class="math notranslate nohighlight">
\[\mu_0 = 4\pi \cdot 10^{-7}{\rm\,H\cdot m^{-1}}
    = 4\pi \cdot 10^{-7}{\rm\,V\cdot s\cdot A^{-1}\cdot m^{-1}}\]</div>
<p>For a typical bar magnet, we have for example:</p>
<div class="math notranslate nohighlight">
\[\begin{split}L &amp;= 5{\rm\,cm} \\
W &amp;= 1{\rm\,cm} \\
Q_m &amp;= 3.3{\rm\,A\cdot m} \\
d &amp;= {L-W\over2} = 0.02{\rm\,m} \\
m &amp;= 2 Q_m d = 2\times 3.3\times 0.02{\rm\,A\cdot m^2}
    = 0.132 {\rm\,A\cdot m^2}\end{split}\]</div>
<p>The unit of <span class="math notranslate nohighlight">\({\bf B}\)</span> is Tesla: <span class="math notranslate nohighlight">\(\rm 1 T = V\cdot s \cdot m^{-2}\)</span>.</p>
</div>
<div class="section" id="bar-magnet-in-a-coil">
<h3>Bar Magnet in a Coil<a class="headerlink" href="#bar-magnet-in-a-coil" title="Permalink to this headline">¶</a></h3>
<p>We throw a magnet through a coil and calculate the voltage on the coil.
We use two model of the bar magnet: a magnetic dipole and two monopoles <span class="math notranslate nohighlight">\(2d\)</span>
apart.</p>
<p>Geometry:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf v} = (0, 0, v)\\{\bf l} = (a\cos\phi, a\sin\phi, z)\\{\d{\bf l}\over \d\phi} = (-a\sin\phi, a\cos\phi, 0)\end{aligned}\end{align} \]</div>
<p>Field of the dipole:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf E} = 0\\{\bf B}({\bf r}) = {\mu_0\over 4\pi} \left({3{\bf r}({\bf m}\cdot{\bf r})\over r^5}
    -{{\bf m}\over r^3}\right)\\{\bf m} = (0, 0, m)\end{aligned}\end{align} \]</div>
<p>we will need:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf v}\times{\bf B}({\bf l})
= {\mu_0\over 4\pi}{\bf v}\times
    \left({3{\bf l}({\bf m}\cdot{\bf l})\over l^5}
-{{\bf m}\over l^3}\right) =\\= {\mu_0\over 4\pi}
    \left({3({\bf v}\times{\bf l})({\bf m}\cdot{\bf l})\over l^5}
-{{\bf v}\times{\bf m}\over l^3}\right) =\\= {\mu_0\over 4\pi}
    {3({\bf v}\times{\bf l})({\bf m}\cdot{\bf l})\over l^5}
    =\\= {\mu_0\over 4\pi}
    {3(va\sin\theta, -va\cos\theta, 0)mz\over (a^2 + z^2)^{5\over2}} =\\= {3\mu_0 m\over 4\pi}
    {a v z\over (a^2 + z^2)^{5\over2}} (\sin\theta, -\cos\theta, 0)\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf v}\times{\bf B}\cdot{\d{\bf l}\over \d\phi} =\\= {3\mu_0 m\over 4\pi}
    {a v z\over (a^2 + z^2)^{5\over2}} (\sin\theta, -\cos\theta, 0)
    \cdot
(-a\sin\phi, a\cos\phi, 0) =\\= -{3\mu_0 m\over 4\pi}
    {a^2 v z\over (a^2 + z^2)^{5\over2}}\end{aligned}\end{align} \]</div>
<p>Field of two monopoles:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf E} = 0\\{\bf B}({\bf x}) = {\mu_0 Q_m\over 4\pi} \left(
    {{\bf x}-{\bf p}_1 \over |{\bf x}-{\bf p}_1|^3}
    -
    {{\bf x}-{\bf p}_2 \over |{\bf x}-{\bf p}_2|^3}
    \right)\\{\bf p}_1 = (0, 0, d)\\{\bf p}_2 = (0, 0, -d)\\d = {L-W\over 2}\end{aligned}\end{align} \]</div>
<p>we will need:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf v}\times{\bf B}({\bf l})
    = {\mu_0 Q_m\over 4\pi} \left(
    {{\bf v}\times({\bf l}-{\bf p}_1) \over |{\bf l}-{\bf p}_1|^3}
    -
    {{\bf v}\times({\bf l}-{\bf p}_2) \over |{\bf l}-{\bf p}_2|^3}
    \right) =\\    = {\mu_0 Q_m\over 4\pi} \left(
    {(0, 0, v)\times(a\cos\phi, a\sin\phi, z-d) \over
        (a^2+(z-d)^2)^{3\over2}}
    -
    {(0, 0, v)\times(a\cos\phi, a\sin\phi, z+d) \over
        (a^2+(z+d)^2)^{3\over2}}
    \right) =\\    = {\mu_0 Q_m a v \over 4\pi} \left(
    {1 \over (a^2+(z-d)^2)^{3\over2}}
    -
    {1 \over (a^2+(z+d)^2)^{3\over2}}
    \right) (\sin\phi, -\cos\phi, 0)\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf v}\times{\bf B}\cdot{\d{\bf l}\over \d\phi} =\\= {\mu_0 Q_m a v \over 4\pi} \left(
{1 \over (a^2+(z-d)^2)^{3\over2}}
-
{1 \over (a^2+(z+d)^2)^{3\over2}}
\right) (\sin\phi, -\cos\phi, 0)
    \cdot
(-a\sin\phi, a\cos\phi, 0) =\\= -{\mu_0 Q_m a^2 v \over 4\pi} \left(
{1 \over (a^2+(z-d)^2)^{3\over2}}
-
{1 \over (a^2+(z+d)^2)^{3\over2}}
\right)\end{aligned}\end{align} \]</div>
<p>Now we can calculate the voltage:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}V = \oint \left({\bf E} + {\bf v}\times{\bf B}\right) \cdot {\d{\bf l}} =\\    = \oint {\bf v}\times{\bf B} \cdot {\d{\bf l}} =\\    = \int_0^{2\pi} {\bf v}\times{\bf B} \cdot {\d{\bf l}\over \d\phi}
        \d\phi\end{aligned}\end{align} \]</div>
<p>for the dipole we get</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}V = \cdots
= -\int_0^{2\pi} {3\mu_0 m\over 4\pi}
{a^2 v z\over (a^2 + z^2)^{5\over2}}
    \d\phi =\\= -{3\mu_0 m\over 2}
{a^2 v z\over (a^2 + z^2)^{5\over2}}\end{aligned}\end{align} \]</div>
<p>For two monopoles we get</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}V = \cdots
= -\int_0^{2\pi} {\mu_0 Q_m a^2 v \over 4\pi} \left(
    {1 \over (a^2+(z-d)^2)^{3\over2}}
    -
    {1 \over (a^2+(z+d)^2)^{3\over2}}
    \right)
    \d\phi =\\= -{\mu_0 Q_m a^2 v \over 2} \left(
    {1 \over (a^2+(z-d)^2)^{3\over2}}
    -
    {1 \over (a^2+(z+d)^2)^{3\over2}}
    \right)\end{aligned}\end{align} \]</div>
<p>For the dipole, the function</p>
<div class="math notranslate nohighlight">
\[{z\over(a^2+z^2)^{5\over 2}}\]</div>
<p>has a maximum and minimum for:</p>
<div class="math notranslate nohighlight">
\[z = \pm{a\over 2}\]</div>
<p>with the max value:</p>
<div class="math notranslate nohighlight">
\[{z\over(a^2+z^2)^{5\over 2}} =
{{a\over 2}\over(a^2+\left({a\over 2}\right)^2)^{5\over 2}} =
{16\sqrt 5 \over 125 a^4}\]</div>
<p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">solve</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">refine</span><span class="p">,</span> <span class="n">Q</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;a z&quot;</span><span class="p">)</span>
<span class="go">(a, z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">z</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[-a/2, a/2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">16*sqrt(5)*a/(125*(a**2)**(5/2))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refine</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">16*sqrt(5)/(125*a**4)</span>
</pre></div>
</div>
<p>So the maximum voltage is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}V = {\mu_0\over 2} {3va^2mz\over (a^2 + z^2)^{5\over2}}
    = {\mu_0\over 2} {3mva^2 {16\sqrt 5 \over 125 a^4}} =\\    = {24\sqrt 5\over125} {\mu_0 m v\over a^2}\end{aligned}\end{align} \]</div>
<p>If we drop the magnet from height <span class="math notranslate nohighlight">\(h\)</span> above the coil into it, then its speed
will be <span class="math notranslate nohighlight">\(v_0 = \sqrt{2hg}\)</span> in the middle of the coil, when <span class="math notranslate nohighlight">\(t=0\)</span>. Then:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}z = v_0 t + \half g t^2\\v = v_0 + g t\end{aligned}\end{align} \]</div>
<p>And we get for the voltage dependence for dipole:</p>
<div class="math notranslate nohighlight">
\[V = - {\mu_0\over 2} {3va^2mz\over (a^2 + z^2)^{5\over2}}
    =- {\mu_0\over 2} {3(v_0+gt)a^2m(v_0 t + \half g t^2)\over
         (a^2 + (v_0 t + \half g t^2)^2)^{5\over2}}\]</div>
<p>The time difference between the maximum and minimum is the time difference
between <span class="math notranslate nohighlight">\(z=-{a\over2}\)</span> and <span class="math notranslate nohighlight">\(z=+{a\over2}\)</span>, so:</p>
<div class="math notranslate nohighlight">
\[\Delta t = \sqrt{2h+a\over g} - \sqrt{2h-a\over g}\]</div>
<p>The total flux doesn’t depend on the particular dependence of <span class="math notranslate nohighlight">\(z(t)\)</span> and
<span class="math notranslate nohighlight">\(v(t)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\Phi = \int_0^\infty V(t) \d t =\\    = - {3\mu_0 m\over 2} \int_0^\infty{v(t)a^2z(t)
            \over (a^2 + z(t)^2)^{5\over2}} \d t =\\    = - {3\mu_0 m\over 2} \int_0^\infty{{\d z\over\d t}a^2z(t)
            \over (a^2 + z(t)^2)^{5\over2}} \d t =\\    = - {3\mu_0 m\over 2} \int_0^\infty{a^2z
            \over (a^2 + z^2)^{5\over2}} \d z =\\    = - {3\mu_0 m\over 4} \int_{a^2}^\infty{a^2
            \over u^{5\over2}} \d u =\\    = - {3\mu_0 m a^2\over 4} \left(-{2\over 3}\right)
        \left[1\over u^{3\over2}\right]_{a^2}^\infty =\\    = - {3\mu_0 m a^2\over 4} \left(-{2\over 3}\right)
        \left[-1\over a^3\right] =\\    = - {\mu_0 m \over 2a}\end{aligned}\end{align} \]</div>
<p>For the voltage dependence of two monopoles, we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}V = -{\mu_0 Q_m a^2 v \over 2} \left(
        {1 \over (a^2+(z-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(z+d)^2)^{3\over2}}
        \right) =\\= -{\mu_0 Q_m a^2 (v_0+gt) \over 2} \left(
        {1 \over (a^2+(v_0 t + \half g t^2-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(v_0 t + \half g t^2+d)^2)^{3\over2}}
        \right)\end{aligned}\end{align} \]</div>
<p>The total flux doesn’t depend on the particular dependence of <span class="math notranslate nohighlight">\(z(t)\)</span> and
<span class="math notranslate nohighlight">\(v(t)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\Phi = \int_0^\infty V(t) \d t =\\    =-\int_0^\infty {\mu_0 Q_m a^2 v(t) \over 2} \left(
        {1 \over (a^2+(z(t)-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(z(t)+d)^2)^{3\over2}}
        \right)
        \d t =\\    =-\int_0^\infty {\mu_0 Q_m a^2 {\d z\over \d t} \over 2} \left(
        {1 \over (a^2+(z(t)-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(z(t)+d)^2)^{3\over2}}
        \right)
        \d t =\\    =-\int_0^\infty {\mu_0 Q_m a^2 \over 2} \left(
        {1 \over (a^2+(z-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(z+d)^2)^{3\over2}}
        \right)
        \d z =\\    =- {\mu_0 Q_m a^2 \over 2} \left(
        \int_0^\infty{1 \over (a^2+(z-d)^2)^{3\over2}} \d z
        -
        \int_0^\infty{1 \over (a^2+(z+d)^2)^{3\over2}} \d z
        \right) =\\    =- {\mu_0 Q_m a^2 \over 2} \left(
        {1\over a^2}\left(1 + {d\over\sqrt{a^2 + d^2}}\right)
        -
        {1\over a^2}\left(1 - {d\over\sqrt{a^2 + d^2}}\right)
        \right) =\\    =- {\mu_0 Q_m d\over\sqrt{a^2 + d^2}}\end{aligned}\end{align} \]</div>
<p>Note that in the limit <span class="math notranslate nohighlight">\(d\to 0\)</span>, we get the magnetic moment <span class="math notranslate nohighlight">\(m = 2 d Q_m\)</span> and
the last formula for two monopoles flux becomes the dipole flux.</p>
<p>As a particular example, consider a coil with <span class="math notranslate nohighlight">\(N=500\)</span> loops, <span class="math notranslate nohighlight">\(a=1.4\rm\,cm\)</span>,
<span class="math notranslate nohighlight">\(d=1.8\rm\,cm\)</span>, <span class="math notranslate nohighlight">\(Q_m=43\rm\,A\cdot m\)</span>. Then the total flux from the second peak
is:</p>
<div class="math notranslate nohighlight">
\[\Phi =- {N\mu_0 Q_m d\over\sqrt{a^2 + d^2}} = -0.021 \rm\, V\cdot s\]</div>
<p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu0</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e-7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q_m</span> <span class="o">=</span> <span class="mf">43.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">1.4</span><span class="o">*</span><span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="n">N</span><span class="o">*</span><span class="n">mu0</span><span class="o">*</span><span class="n">Q_m</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-0.02132647889395681</span>
</pre></div>
</div>
<p>For a single loop with <span class="math notranslate nohighlight">\(a=1.25\rm\,cm\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[\Phi =- {\mu_0 Q_m d\over\sqrt{a^2 + d^2}} = -4.44\times 10^{-5}
    \rm\, V\cdot s\]</div>
<p>and for a single loop with <span class="math notranslate nohighlight">\(a=1.8\rm\,cm\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[\Phi =- {\mu_0 Q_m d\over\sqrt{a^2 + d^2}} = -3.82\times 10^{-5}
    \rm\, V\cdot s\]</div>
<p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">1.25</span><span class="o">*</span><span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="n">mu0</span><span class="o">*</span><span class="n">Q_m</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-4.438304942066266e-05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="n">mu0</span><span class="o">*</span><span class="n">Q_m</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-3.820879326816195e-05</span>
</pre></div>
</div>
</div>
<div class="section" id="rc-circuit">
<h3>RC Circuit<a class="headerlink" href="#rc-circuit" title="Permalink to this headline">¶</a></h3>
<p>Let’s consider resistor (with voltage <span class="math notranslate nohighlight">\(V=RI\)</span>) and capacitor (with voltage
<span class="math notranslate nohighlight">\(V={Q\over C}\)</span> and current <span class="math notranslate nohighlight">\(I(t) = Q'(t)\)</span>) in a series. Voltage on the battery
is <span class="math notranslate nohighlight">\(V\)</span>, then the equation for the circuit is:</p>
<div class="math notranslate nohighlight">
\[RI(t) + {Q(t)\over C} = V\]</div>
<p>with initial condition <span class="math notranslate nohighlight">\(Q(0) = 0\)</span>. We differentiate it:</p>
<div class="math notranslate nohighlight">
\[RI'(t) + {I(t)\over C} = 0\]</div>
<p>and the initial condition follows from the first equation <span class="math notranslate nohighlight">\(I(0) = {V\over R}\)</span>.
The solution is:</p>
<div class="math notranslate nohighlight">
\[I(t) = {V\over R} e^{-{t\over RC}}\]</div>
<p>Now we calculate the charge (using the initial condition for the charge above
for the lower bound of the integral):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}Q(t) = \int_0^t I(t') \d t'
     = {V\over R} \int_0^t e^{-{t'\over RC}} \d t'
     = {V\over R} \left[-RC e^{-{t'\over RC}}\right]_0^t =\\     = {V\over R} \left[-RC e^{-{t\over RC}}+RC\right]
     = VC \left(1-e^{-{t\over RC}}\right)\end{aligned}\end{align} \]</div>
<p>The voltage on the resistor is:</p>
<div class="math notranslate nohighlight">
\[R I(t) = R {V\over R} e^{-{t\over RC}} = V e^{-{t\over RC}}\]</div>
<p>The voltage on the capacitor is:</p>
<div class="math notranslate nohighlight">
\[{Q(t)\over C} = {VC \left(1-e^{-{t\over RC}}\right) \over C}
    = V \left(1-e^{-{t\over RC}}\right)\]</div>
<p>Half life of the capacitor is defined as the time <span class="math notranslate nohighlight">\(\tau\)</span> so that the charge is
half of the total charge, and we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}Q(\tau) = \half Q(\infty)\\VC \left(1-e^{-{\tau\over RC}}\right) = \half VC\\1-e^{-{\tau\over RC}} = \half\\\half = e^{-{\tau\over RC}}\\\log \half = -{\tau\over RC}\\\tau = -RC \log \half = RC\log 2\end{aligned}\end{align} \]</div>
</div>
</div>
</div>
<div class="section" id="semiconductor-device-physics">
<h1>Semiconductor Device Physics<a class="headerlink" href="#semiconductor-device-physics" title="Permalink to this headline">¶</a></h1>
<p>In general, the task is to find the five quantities:</p>
<div class="math notranslate nohighlight">
\[n({\bf x}, t),
p({\bf x}, t),
{\bf J}_n({\bf x}, t),
{\bf J}_h({\bf x}, t),
{\bf E}({\bf x}, t)\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> (<span class="math notranslate nohighlight">\(p\)</span>) is the electron (hole) concentration, <span class="math notranslate nohighlight">\({\bf J}_n\)</span>
(<span class="math notranslate nohighlight">\({\bf J}_p\)</span>) is the electron (hole) current density, <span class="math notranslate nohighlight">\({\bf E}\)</span> is the
electric field.</p>
<p>And we have five equations that relate them. We start with the continuity
equation:</p>
<div class="math notranslate nohighlight">
\[\nabla\cdot{\bf J} +{\partial\rho\over\partial t} = 0\]</div>
<p>where the current density <span class="math notranslate nohighlight">\({\bf J}\)</span> is composed of electron and hole current
densities:</p>
<div class="math notranslate nohighlight">
\[{\bf J} = {\bf J}_n + {\bf J}_p\]</div>
<p>and the charge density <span class="math notranslate nohighlight">\(\rho\)</span> is composed of mobile (electrons and holes) and
fixed charges (ionized donors and acceptors):</p>
<div class="math notranslate nohighlight">
\[\rho = q(p-n+C)\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(p\)</span> is the electron and hole concetration, <span class="math notranslate nohighlight">\(C\)</span> is the net
doping concetration (<span class="math notranslate nohighlight">\(C=p_D-n_A\)</span> where <span class="math notranslate nohighlight">\(p_D\)</span> is the concentration of ionized
donors, charged positive, and <span class="math notranslate nohighlight">\(n_A\)</span> is the concentration of ionized acceptors,
charged negative) and <span class="math notranslate nohighlight">\(q\)</span> is the electron charge (positive). We get:</p>
<div class="math notranslate nohighlight">
\[\nabla\cdot{\bf J}_n + \nabla\cdot{\bf J}_p + q\left(
    {\partial p\over\partial t}
    -{\partial n\over\partial t}
    +{\partial C\over\partial t}
    \right) = 0\]</div>
<p>Assuming the fixed charges <span class="math notranslate nohighlight">\(C\)</span> are time invariant, we get:</p>
<div class="math notranslate nohighlight">
\[\nabla\cdot{\bf J}_n - q {\partial n\over\partial t} =
    -\left( \nabla\cdot{\bf J}_p + q{\partial p\over\partial t}
    \right) \equiv qR\]</div>
<p>where <span class="math notranslate nohighlight">\(R\)</span> is the net recombination rate for electrons and holes (a positive
value means recombination, a negative value generation of carriers). We get the
carrier continuity equations:</p>
<div class="math notranslate nohighlight" id="equation-continuity">
<span class="eqno">(9)<a class="headerlink" href="#equation-continuity" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}{\partial n\over\partial t} = -R + {1\over q} \nabla\cdot {\bf J}_n\\{\partial p\over\partial t} = -R - {1\over q} \nabla\cdot {\bf J}_p\end{aligned}\end{align} \]</div>
<p>Then we need material relations that express how the current <span class="math notranslate nohighlight">\({\bf J}\)</span> is
generated using <span class="math notranslate nohighlight">\({\bf E}\)</span> and <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(p\)</span>. A drift-diffusion model is to assume
a drift current (<span class="math notranslate nohighlight">\(q\mu_n n {\bf E}\)</span>) and a diffusion (<span class="math notranslate nohighlight">\(q D_n \nabla n\)</span>),
which gives:</p>
<div class="math notranslate nohighlight" id="equation-drift">
<span class="eqno">(10)<a class="headerlink" href="#equation-drift" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}{\bf J}_n = q\mu_n n {\bf E} + q D_n \nabla n\\{\bf J}_p = q\mu_p p {\bf E} - q D_p \nabla p\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_n\)</span>, <span class="math notranslate nohighlight">\(\mu_p\)</span>, <span class="math notranslate nohighlight">\(D_n\)</span>, <span class="math notranslate nohighlight">\(D_p\)</span> are the carrier mobilities and
diffusivities.</p>
<p>Final equation is the Gauss’s law:</p>
<div class="math notranslate nohighlight">
\[\nabla\cdot (\varepsilon{\bf E}) = \rho\]</div>
<div class="math notranslate nohighlight" id="equation-gauss">
<span class="eqno">(11)<a class="headerlink" href="#equation-gauss" title="Permalink to this equation">¶</a></span>\[\nabla\cdot(\varepsilon {\bf E}) = q(p-n + C)\]</div>
<div class="section" id="equations">
<h2>Equations<a class="headerlink" href="#equations" title="Permalink to this headline">¶</a></h2>
<p>Combining <a class="reference internal" href="#equation-drift">(10)</a> and <a class="reference internal" href="#equation-continuity">(9)</a> we get the following three
equations for three unknowns <span class="math notranslate nohighlight">\(n\)</span>, <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\({\bf E}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial n\over\partial t} = -R + \nabla\cdot (\mu_n n {\bf E})
    +\nabla\cdot (D_n \nabla n)\\{\partial p\over\partial t} = -R - \nabla\cdot (\mu_p p {\bf E})
    +\nabla\cdot (D_p \nabla p)\\\nabla\cdot(\varepsilon {\bf E}) = q(p-n + C)\end{aligned}\end{align} \]</div>
<p>And it is usually assumed that the magnetic field is time independent, so
<span class="math notranslate nohighlight">\({\bf E}=-\nabla\phi\)</span> and we get:</p>
<div class="math notranslate nohighlight" id="equation-semicond-eq">
<span class="eqno">(12)<a class="headerlink" href="#equation-semicond-eq" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}{\partial n\over\partial t} = -R - \nabla\cdot (\mu_n n \nabla\phi)
    +\nabla\cdot (D_n \nabla n)\\{\partial p\over\partial t} = -R + \nabla\cdot (\mu_p p \nabla\phi)
    +\nabla\cdot (D_p \nabla p)\\\nabla\cdot(\varepsilon \nabla\phi) = -q(p-n + C)\end{aligned}\end{align} \]</div>
<p>These are three nonlinear (due to the terms <span class="math notranslate nohighlight">\(\mu_n n \nabla\phi\)</span> and
<span class="math notranslate nohighlight">\(\mu_p p \nabla\phi\)</span>) equations for three unknown functions <span class="math notranslate nohighlight">\(n\)</span>, <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>.</p>
<div class="section" id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h3>
<p>We can substract the first two
equations and we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial q(p-n)\over\partial t} = - q\nabla\cdot ((\mu_p p+\mu_n n){\bf E})
    +q\nabla\cdot(D_p \nabla p-D_n\nabla n)\\\nabla\cdot(\varepsilon {\bf E}) = q(p-n+C)\end{aligned}\end{align} \]</div>
<p>and using <span class="math notranslate nohighlight">\(\rho=q(p-n+C)\)</span> and <span class="math notranslate nohighlight">\(\sigma=q(\mu_p p+\mu_n n)\)</span>, we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial \rho\over\partial t} -q{\partial C\over\partial t} =
    - \nabla\cdot (\sigma {\bf E})
    +q\nabla\cdot(D_p \nabla p-D_n\nabla n)\\\nabla\cdot(\varepsilon {\bf E}) = \rho\end{aligned}\end{align} \]</div>
<p>So far we didn’t make any assumptions. Most of the times the net doping
concetration <span class="math notranslate nohighlight">\(C\)</span> is time independent, which gives:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial \rho\over\partial t} =
    - \nabla\cdot (\sigma {\bf E})
    +q\nabla\cdot(D_p \nabla p-D_n\nabla n)\\\nabla\cdot(\varepsilon {\bf E}) = \rho\end{aligned}\end{align} \]</div>
<p>Assuming further <span class="math notranslate nohighlight">\(D_p \nabla p-D_n\nabla n=0\)</span>, we just get the equation of
continuity and the Gauss law:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial \rho\over\partial t} + \nabla\cdot (\sigma {\bf E}) = 0\\\nabla\cdot(\varepsilon {\bf E}) = \rho\end{aligned}\end{align} \]</div>
<p>Finally, assuming also that that <span class="math notranslate nohighlight">\(\rho\)</span> doesn’t depend on
time, we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\nabla\cdot (\sigma {\bf E}) = 0\\\nabla\cdot(\varepsilon {\bf E}) = \rho\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="example-2">
<h3>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h3>
<p>As a simple model, assume <span class="math notranslate nohighlight">\(D_n\)</span>, <span class="math notranslate nohighlight">\(D_p\)</span>, <span class="math notranslate nohighlight">\(\mu_n\)</span>, <span class="math notranslate nohighlight">\(\mu_p\)</span> and <span class="math notranslate nohighlight">\(\varepsilon\)</span>
are position independent and <span class="math notranslate nohighlight">\(C=0\)</span>, <span class="math notranslate nohighlight">\(R=0\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial n\over\partial t} =
    +\mu_n n \nabla\cdot {\bf E}
    +\mu_n {\bf E}\cdot\nabla n
    +D_n \nabla^2 n\\{\partial p\over\partial t} =
    -\mu_p p \nabla\cdot {\bf E}
    -\mu_p {\bf E}\cdot\nabla p
    +D_p \nabla^2 p\\\varepsilon\nabla\cdot {\bf E} = q(p-n)\end{aligned}\end{align} \]</div>
<p>Using <span class="math notranslate nohighlight">\({\bf E} = -\nabla \phi\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial n\over\partial t} =
    -\mu_n n \nabla^2\phi
    -\mu_n \nabla\phi\cdot\nabla n
    +D_n \nabla^2 n\\{\partial p\over\partial t} =
    +\mu_p p \nabla^2\phi
    +\mu_p \nabla\phi\cdot\nabla p
    +D_p \nabla^2 p\\\varepsilon\nabla^2\phi = -q(p-n)\end{aligned}\end{align} \]</div>
</div>
</div>
<div class="section" id="example-3">
<h2>Example 3<a class="headerlink" href="#example-3" title="Permalink to this headline">¶</a></h2>
<p>Let’s calculate the 1D pn-junction. We take the equations <a class="reference internal" href="#equation-semicond-eq">(12)</a> and
write them in 1D for the stationary state
(<span class="math notranslate nohighlight">\({\partial n\over\partial t}={\partial p\over\partial t}=0\)</span>):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}0 = -R - (\mu_n n \phi')' + (D_n n')'\\0 = -R + (\mu_p p \phi')' + (D_p p')'\\(\varepsilon \phi')' = -q(p-n + C)\end{aligned}\end{align} \]</div>
<p>We expand the derivatives and assume that <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(D\)</span> is constant:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}0 = -R - \mu_n n' \phi' - \mu_n n \phi'' + D_n n''\\0 = -R + \mu_p p' \phi' + \mu_p p \phi'' + D_p p''\\\varepsilon \phi'' = -q(p-n + C)\end{aligned}\end{align} \]</div>
<p>and we put the second derivatives on the left hand side:</p>
<div class="math notranslate nohighlight" id="equation-1d-pn-junction1">
<span class="eqno">(13)<a class="headerlink" href="#equation-1d-pn-junction1" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}n'' = {1\over D_n}(R + \mu_n n' \phi' + \mu_n n \phi'')\\p'' = {1\over D_p}(R - \mu_p p' \phi' - \mu_p p \phi'')\\\phi'' = -{q\over\varepsilon} (p-n + C)\end{aligned}\end{align} \]</div>
<p>now we introduce the variables <span class="math notranslate nohighlight">\(y_i\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}y_0 = n\\y_1 = y_0' = n'\\y_2 = p\\y_3 = y_2' = p'\\y_4 = \phi\\y_5 = y_4' = \phi'\end{aligned}\end{align} \]</div>
<p>and rewrite <a class="reference internal" href="#equation-1d-pn-junction1">(13)</a>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}y_1' = {1\over D_n}(R + \mu_n y_1 y_5 + \mu_n y_0 y_5')\\y_3' = {1\over D_p}(R - \mu_p y_3 y_5 - \mu_p y_2 y_5')\\y_5' = -{q\over\varepsilon} (y_2-y_0 + C)\end{aligned}\end{align} \]</div>
<p>So we are solving the following six nonlinear first order ODE:</p>
<div class="math notranslate nohighlight" id="equation-1d-pn-junction2">
<span class="eqno">(14)<a class="headerlink" href="#equation-1d-pn-junction2" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}y_5' = -{q\over\varepsilon} (y_2-y_0 + C)\\y_0' = y_1\\y_1' = {1\over D_n}(R + \mu_n y_1 y_5 + \mu_n y_0 y_5')\\y_2' = y_3\\y_3' = {1\over D_p}(R - \mu_p y_3 y_5 - \mu_p y_2 y_5')\\y_4' = y_5\end{aligned}\end{align} \]</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Maxwell’s Equations</a><ul>
<li><a class="reference internal" href="#electromagnetic-field">Electromagnetic Field</a></li>
<li><a class="reference internal" href="#id1">Maxwell’s Equations</a></li>
<li><a class="reference internal" href="#lorentz-force">Lorentz Force</a></li>
<li><a class="reference internal" href="#hamiltonian">Hamiltonian</a></li>
<li><a class="reference internal" href="#electromagnetic-stress-tensor">Electromagnetic Stress Tensor</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#coulomb-law">Coulomb Law</a><ul>
<li><a class="reference internal" href="#example-straight-wire">Example: Straight Wire</a></li>
</ul>
</li>
<li><a class="reference internal" href="#biot-savart-law">Biot-Savart Law</a><ul>
<li><a class="reference internal" href="#id2">Example: Straight Wire</a></li>
<li><a class="reference internal" href="#example-circular-loop">Example: Circular Loop</a></li>
<li><a class="reference internal" href="#helmholtz-coil">Helmholtz Coil</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ampere-s-force-law">Ampère’s Force Law</a><ul>
<li><a class="reference internal" href="#parallel-straight-wires">Parallel Straight Wires</a></li>
<li><a class="reference internal" href="#perpendicular-straight-wires">Perpendicular Straight Wires</a></li>
<li><a class="reference internal" href="#infinitely-long-wire-and-a-square-loop">Infinitely Long Wire and a Square Loop</a></li>
</ul>
</li>
<li><a class="reference internal" href="#magnetic-dipole">Magnetic Dipole</a></li>
<li><a class="reference internal" href="#bar-magnet">Bar Magnet</a></li>
<li><a class="reference internal" href="#bar-magnet-in-a-coil">Bar Magnet in a Coil</a></li>
<li><a class="reference internal" href="#rc-circuit">RC Circuit</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#semiconductor-device-physics">Semiconductor Device Physics</a><ul>
<li><a class="reference internal" href="#equations">Equations</a><ul>
<li><a class="reference internal" href="#example-1">Example 1</a></li>
<li><a class="reference internal" href="#example-2">Example 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-3">Example 3</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="main.html"
                        title="previous chapter">Classical Electromagnetism</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../statmech/main.html"
                        title="next chapter">Thermodynamics and Statistical Physics</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/elmag/elmag.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../statmech/main.html" title="Thermodynamics and Statistical Physics"
             >next</a> |</li>
        <li class="right" >
          <a href="main.html" title="Classical Electromagnetism"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" >Classical Electromagnetism</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>