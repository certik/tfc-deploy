<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Differential Geometry &mdash; Theoretical Physics Reference 0.5 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Theoretical Physics Reference 0.5 documentation" href="../index.html" />
    <link rel="up" title="Mathematics" href="main.html" />
    <link rel="next" title="Operators" href="operators.html" />
    <link rel="prev" title="Linear Algebra" href="la.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head>
  <body>
    <div style="display:none">
    \(
        \newcommand{\d}{\mathrm{d}}
        \newcommand{\bomega}{\vec\omega}
        \newcommand{\half}{ {1\over 2} }
        \def\mathnot#1{\text{"$#1$"}}

        %operators
        \newcommand{\diag}{\mathrm{diag}}
        \newcommand{\sinc}{\mathrm{sinc}}
        \newcommand{\Sh}{ {\large\style{font-family:Times}{\text{Ш}}} }
        \newcommand{\res}{\mathrm{Res}}
    \)
    </div>
    

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="operators.html" title="Operators"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="la.html" title="Linear Algebra"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &raquo;</li>
          <li><a href="main.html" accesskey="U">Mathematics</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="differential-geometry">
<h1>Differential Geometry<a class="headerlink" href="#differential-geometry" title="Permalink to this headline">¶</a></h1>
<div class="section" id="manifolds">
<span id="index-0"></span><h2>Manifolds<a class="headerlink" href="#manifolds" title="Permalink to this headline">¶</a></h2>
<div class="section" id="scalars-vectors-tensors">
<span id="index-1"></span><h3>Scalars, Vectors, Tensors<a class="headerlink" href="#scalars-vectors-tensors" title="Permalink to this headline">¶</a></h3>
<p>Differentiable manifold <span class="math">\(U\)</span> is a space covered by an atlas of maps, each map
covers part of the manifold and is a one to one mapping to an euclidean space
<span class="math">\(\R^n\)</span>:</p>
<div class="math">
\[\phi:U\to \R^n\]</div>
<p>Let&#8217;s have a one-to-one transformation between <span class="math">\(x^\mu\)</span> and <span class="math">\(x'^\mu\)</span> coordinates
(we simply write <span class="math">\(x\equiv x^\mu\)</span>, etc.):</p>
<div class="math">
\[x' = x'(x)\]</div>
<div class="math">
\[x = x(x')\]</div>
<p>Scalar <span class="math">\(\phi(x)\)</span> is such a field that transforms as (<span class="math">\(\phi'(x')\)</span> is it&#8217;s value
in <span class="math">\(x'\)</span> coordinates):</p>
<div class="math">
\[\phi'(x')=\phi(x)\]</div>
<p>One form <span class="math">\(p_\alpha(x)\)</span> is such a field that transforms the same as the
gradient <span class="math">\(\partial\phi(x)\over\partial x^\mu\)</span> of a scalar, that transforms as
(<span class="math">\(\partial\phi'(x')\over\partial x'^\mu\)</span> is it&#8217;s value in <span class="math">\(x'\)</span> coordinates):</p>
<div class="math">
\[{\partial\phi'(x')\over\partial x'^\mu} ={\partial x^\nu\over\partial x'^\mu} {\partial\phi'(x')\over\partial x^\nu} ={\partial x^\nu\over\partial x'^\mu} {\partial\phi(x)\over\partial x^\nu}\]</div>
<p>so</p>
<div class="math">
\[p'_\mu(x') ={\partial x^\nu\over\partial x'^\mu} p_\nu(x)\]</div>
<p>Vector <span class="math">\(V^\alpha\)</span> is such a field that produces a scalar <span class="math">\(\phi=V^\alpha
p_\alpha\)</span> when contracted with a one form and this fact is used to deduce how it
transforms:</p>
<div class="math">
\[\phi' = V'^\alpha p'_\alpha  = V'^\alpha {\partial x^\beta\over\partial x'^\alpha} p_\beta =\phi = V^\beta p_\beta\]</div>
<p>so we have</p>
<div class="math">
\[V'^\alpha {\partial x^\beta\over\partial x'^\alpha} = V^\beta\]</div>
<p>multiplying by <span class="math">\({\partial x'^\mu\over\partial x^\beta}\)</span> and using the fact that
<span class="math">\({\partial x^\beta\over\partial x'^\alpha} {\partial x'^\mu\over\partial x^\beta} = {\partial x'^\mu\over\partial x'^\alpha} =\delta^\mu_\alpha\)</span> we get</p>
<div class="math">
\[V'^\mu = {\partial x'^\mu\over\partial x^\beta} V^\beta\]</div>
<p>Higher tensors are build up and their transformation properties derived from
the fact, that by contracting with either a vector or a form we get a lower
rank tensor that we already know how it transforms.</p>
<p>Having now defined scalar, vector and tensor fields, one may then choose a
basis at each point for each field, the only requirement being that the basis
is not singular. For example for vectors, each point in <span class="math">\(U\)</span> has a basis <span class="math">\(\vec e_\alpha\)</span>, so a vector (field)
<span class="math">\(\vec V\)</span> has components <span class="math">\(V^\alpha\)</span> with respect to this basis:</p>
<div class="math">
\[\vec V = V^\alpha\vec e_\alpha\]</div>
</div>
<div class="section" id="covariant-differentiation">
<span id="index-2"></span><h3>Covariant differentiation<a class="headerlink" href="#covariant-differentiation" title="Permalink to this headline">¶</a></h3>
<p>The derivative of the basis vector <span class="math">\({\partial \vec
e_\alpha\over\partial x^\beta}\)</span> is a vector, thus it can be written as a linear
combination of the basis vectors:</p>
<div class="math">
\[{\partial \vec e_\alpha\over\partial x^\beta}=\Gamma^\mu_{\alpha\beta} \vec e_\mu\]</div>
<p>Differentiating a vector is then easy:</p>
<div class="math">
\[{\partial\vec V\over\partial x^\beta}\equiv\nabla_\beta \vec V ={\partial V^\alpha\over\partial x^\beta}\vec e_\alpha+   V^\alpha {\partial \vec e_\alpha\over\partial x^\beta} ={\partial V^\alpha\over\partial x^\beta}\vec e_\alpha+   V^\alpha \Gamma^\mu_{\alpha\beta} \vec e_\mu =\left({\partial V^\alpha\over\partial x^\beta}+   \Gamma^\alpha_{\mu\beta}V^\mu \right) \vec e_\alpha\]</div>
<p>So we define a covariant derivative:</p>
<div class="math">
\[\nabla_\beta V^\alpha = {\partial V^\alpha\over\partial x^\beta}+   \Gamma^\alpha_{\mu\beta}V^\mu\]</div>
<p>and write</p>
<div class="math">
\[{\partial\vec V\over\partial x^\beta}=\nabla_\beta \vec V =\left(\nabla_\beta \vec V\right)^\alpha\vec e_\alpha =\left(\nabla_\beta V^\alpha\right)\vec e_\alpha\]</div>
<p>I.e. we have:</p>
<div class="math">
\[\nabla_\beta \vec V = \nabla_\beta(V^\alpha\vec e_\alpha) = (\nabla_\beta V^\alpha)\vec e_\alpha\]</div>
<p>We also define:</p>
<div class="math">
\[\nabla_{\vec X} \vec V = \nabla_{X^\beta \vec e_\beta} \vec V \equiv X^\beta\nabla_\beta\vec V = X^\beta(\nabla_\beta V^\alpha)\vec e_\alpha\]</div>
<p>A scalar doesn&#8217;t depend on basis vectors, so its covariant derivative is just
its partial derivative</p>
<div class="math">
\[\nabla_\alpha \phi={\partial \phi\over\partial x^\alpha}\]</div>
<p>Differentiating a one form <span class="math">\(p_\alpha\)</span> is done using the fact, that
<span class="math">\(\phi=p_\alpha V^\alpha\)</span> is a scalar, thus</p>
<div class="math">
\[\nabla_\beta \phi={\partial p_\alpha V^\alpha\over\partial x^\beta} ={\partial p_\alpha \over\partial x^\beta}V^\alpha+ p_\alpha{\partial  V^\alpha\over\partial x^\beta} ={\partial p_\alpha \over\partial x^\beta}V^\alpha+ p_\alpha\left(\nabla_\beta V^\alpha-   \Gamma^\alpha_{\mu\beta}V^\mu\right)=\]</div>
<div class="math">
\[=V^\alpha\left({\partial p_\alpha \over\partial     x^\beta}-\Gamma^\mu_{\alpha\beta}p_\mu\right)+     p_\alpha\nabla_\beta V^\alpha =V^\alpha\nabla_\beta p_\alpha+     p_\alpha\nabla_\beta V^\alpha\]</div>
<p>where we have defined</p>
<div class="math">
\[\nabla_\beta p_\alpha = {\partial p_\alpha \over\partial     x^\beta}-\Gamma^\mu_{\alpha\beta}p_\mu\]</div>
<p>This is obviously a tensor, because the above equation has a tensor on the left
hand side (<span class="math">\(\nabla_\beta \phi\)</span>) and tensors on the right hand side
(<span class="math">\(p_\alpha\nabla_\beta V^\alpha\)</span> and <span class="math">\(V^\alpha\)</span>). Similarly for the derivative of
the tensor <span class="math">\(A^{\mu\nu}\)</span> we use the fact that <span class="math">\(V^\mu=A^{\mu\nu}p_\nu\)</span> is a
vector:</p>
<div class="math">
\[\nabla_\beta V^\mu=\nabla_\beta (A^{\mu\nu}p_\nu)=\partial_\beta (A^{\mu\nu}p_\nu)+\Gamma^\mu_{\alpha\beta}A^{\alpha\nu}p_\nu =p_\nu\partial_\beta A^{\mu\nu}+ A^{\mu\nu}\partial_\beta p_\nu+\Gamma^\mu_{\alpha\beta}A^{\alpha\nu}p_\nu=\]</div>
<div class="math">
\[=p_\nu\partial_\beta A^{\mu\nu}+     A^{\mu\nu}\left(\nabla_\beta p_\nu+\Gamma^\mu_{\nu\beta}p_\mu\right)     +\Gamma^\mu_{\alpha\beta}A^{\alpha\nu}p_\nu =p_\nu\nabla_\beta A^{\mu\nu}+ A^{\mu\nu}\nabla_\beta p_\nu\]</div>
<p>where we define</p>
<div class="math">
\[\nabla_\beta A^{\mu\nu}=\partial_\beta A^{\mu\nu} +\Gamma^\mu_{\alpha\beta}A^{\alpha\nu} +\Gamma^\nu_{\alpha\beta}A^{\mu\alpha}\]</div>
<p>and so on for other tensors, for example:</p>
<div class="math">
\[\nabla_\beta A^\mu{}_\nu=\partial_\beta A^\mu{}_\nu +\Gamma^\mu_{\alpha\beta}A^\alpha{}_\nu -\Gamma^\alpha_{\nu\beta}A^\mu{}_\alpha\]</div>
<div class="math">
\[\nabla_\beta A_{\mu\nu}=\partial_\beta A_{\mu\nu} -\Gamma^\alpha_{\mu\beta}A_{\alpha\nu} -\Gamma^\alpha_{\nu\beta}A_{\mu\alpha}\]</div>
<p>One can now easily proof some common relations simply by rewriting it to
components and back:</p>
<div class="math">
\[\nabla_{\vec X}(f\vec Y) = (\nabla_{\vec X}f)\vec Y + f\nabla_{\vec X}\vec Y\]</div>
<div class="math">
\[\nabla_{\vec X}(\vec Y+\vec Z) = \nabla_{\vec X}\vec Y     + \nabla_{\vec X}\vec Z\]</div>
<div class="math">
\[\nabla_{f\vec X}\vec Y = f\nabla_{\vec X}\vec Y\]</div>
<p>Change of variable:</p>
<div class="math">
\[\Gamma'^\alpha{}_{\beta\gamma}= {\partial x^\mu\over\partial x'^\beta} {\partial x^\nu\over\partial x'^\gamma} \Gamma^\sigma{}_{\mu\nu} {\partial x'^\alpha\over\partial x^\sigma} + {\partial x'^\alpha\over\partial x^\sigma} {\partial^2 x^\sigma\over\partial x'^\beta\partial x'^\gamma}\]</div>
</div>
<div class="section" id="parallel-transport">
<span id="index-3"></span><h3>Parallel transport<a class="headerlink" href="#parallel-transport" title="Permalink to this headline">¶</a></h3>
<p>If the vectors <span class="math">\(\vec V\)</span> at infinitesimally close points of the curve
<span class="math">\(x^\mu(\lambda)\)</span> are parallel and of equal length, then <span class="math">\(\vec V\)</span> is said to be
parallel transported along the curve, i.e.:</p>
<div class="math">
\[{\d \vec V\over\d\lambda} = 0\]</div>
<p>So</p>
<div class="math">
\[{\d \vec V\over\d\lambda} = {\d (V^\alpha\vec e_\alpha)\over\d\lambda} =  {\d x^\beta\over\d\lambda}\partial_\beta (V^\alpha\vec e_\alpha) =  {\d x^\beta\over\d\lambda}(\nabla_\beta V^\alpha) \vec e_\alpha = 0\]</div>
<p>In components (using the tangent vector <span class="math">\(U^\beta = {\d x^\beta\over\d\lambda}\)</span>):</p>
<div class="math">
\[{\d V^\alpha\over\d\lambda} = U^\beta\nabla_\beta V^\alpha = 0\]</div>
</div>
<div class="section" id="fermi-walker-transport">
<span id="index-4"></span><h3>Fermi-Walker transport<a class="headerlink" href="#fermi-walker-transport" title="Permalink to this headline">¶</a></h3>
<p>In local inertial frame:</p>
<div class="math">
\[U^\lambda_0 = (1, 0, 0, 0)\]</div>
<div class="math">
\[{\d S^i\over\d t} = 0\]</div>
<p>We require orthogonality <span class="math">\(S_\mu U^\mu = 0\)</span>,
in a general frame:</p>
<div class="math">
\[{\d S^\alpha\over\d \tau} = \lambda U^\alpha =  S_\mu {\d U^\mu\over\d \tau} U^\alpha\]</div>
<p>where <span class="math">\(\lambda\)</span> was calculated by differentiating the orthogonality condition.
This is called a Thomas precession.</p>
<p>For any vector, we define:
the vector <span class="math">\(X^\mu\)</span> is Fermi-Walker tranported along the curve if:</p>
<div class="math">
\[{\d X^\mu\over\d\lambda} = X_\alpha{\d U^\alpha\over\d\lambda}U^\mu -X_\alpha U^\alpha{\d U^\mu\over\d\lambda}\]</div>
<p>If <span class="math">\(X^\mu\)</span> is perpendicular to <span class="math">\(U^\mu\)</span>, the second term is zero and the result
is called a Fermi transport.</p>
<p>Why: the <span class="math">\(U^\mu\)</span> is transported by Fermi-Walker and also this is the equation
for gyroscopes, so the natural, nonrotating tetrade is the one with <span class="math">\(\vec e^\mu_0
\equiv U^\mu\)</span>, which is then correctly transported along any curve (not just
geodesics).</p>
</div>
<div class="section" id="geodesics">
<span id="index-5"></span><h3>Geodesics<a class="headerlink" href="#geodesics" title="Permalink to this headline">¶</a></h3>
<p>Geodesics is a curve <span class="math">\(x^\alpha(\lambda)\)</span> that locally looks like a line,
i.e. it parallel
transports its own tangent vector:</p>
<div class="math">
\[U^\beta\nabla_\beta U^\alpha = 0\]</div>
<p>so</p>
<div class="math">
\[U^\beta\partial_\beta U^\alpha + \Gamma^\alpha_{\beta\gamma}U^\beta U^\gamma  = 0\]</div>
<p>or equivalently (using the fact <span class="math">\(U^\beta\partial_\beta U^\alpha=
{\d x^\beta\over\d\lambda}{\partial\over\partial x^\beta}
{\d x^\alpha\over\d\lambda} = {\d^2 x^\alpha\over\d\lambda^2}\)</span>):</p>
<div class="math" id="equation-geodesic-equation">
<span class="eqno">(1)</span>\[{\d^2 x^\alpha\over\d\lambda^2} + \Gamma^\alpha_{\beta\gamma} {\d x^\beta\over\d\lambda}{\d x^\gamma\over\d\lambda} = 0\]</div>
<p>Let&#8217;s determine all possible reparametrizations that leave the geodesic
equation invariant:</p>
<div class="math">
\[\lambda' = f(\lambda)\]\[{\d x^\alpha\over\d\lambda} ={\d \lambda'\over\d\lambda}
    {\d x^\alpha\over\d\lambda'} = f'(\lambda){\d x^\alpha\over\d\lambda'}\]\[{\d^2 x^\alpha\over\d\lambda^2} ={\d \over\d\lambda}
    \left( f'(\lambda){\d x^\alpha\over\d\lambda'} \right)
    = f''(\lambda) {\d x^\alpha\over\d\lambda'} +
    f'(\lambda){\d \over\d\lambda}{\d x^\alpha\over\d\lambda'}
    =\]\[    = f''(\lambda) {\d x^\alpha\over\d\lambda'} +
    f'^2(\lambda){\d \over\d\lambda'}{\d x^\alpha\over\d\lambda'}
    =\]\[    = f''(\lambda) {\d x^\alpha\over\d\lambda'} +
    f'^2(\lambda){\d^2 x^\alpha\over\d\lambda'^2}\]</div>
<p>Substituting into the geodesic equation, we get:</p>
<div class="math">
\[f''(\lambda) {\d x^\alpha\over\d\lambda'} +
f'^2(\lambda)\left( {\d^2 x^\alpha\over\d\lambda'^2} +
    \Gamma^\alpha_{\beta\gamma} {\d x^\beta\over\d\lambda'}
    {\d x^\gamma\over\d\lambda'} \right) = 0\]</div>
<p>So we can see that the equation is invariant as long as <span class="math">\(f''(\lambda) = 0\)</span>,
which gives:</p>
<div class="math">
\[f(\lambda) = a \lambda + b\]</div>
<p>This is called an affine reparametrization.</p>
<p>Another way to derive the geodesic equation is by finding a curve that
extremizes the proper time:</p>
<div class="math">
\[\tau = \int \d \tau
    = \int \sqrt{-{1\over c^2} \d s^2}
    = \int \sqrt{-{1\over c^2} g_{\mu\nu} \d x^\mu \d x^\nu}
    = \int \sqrt{-{1\over c^2} g_{\mu\nu} {\d x^\mu\over\d \lambda}
        {\d x^\nu\over\d\lambda}} \d\lambda
    = \int K \d\lambda\]</div>
<p>Here <span class="math">\(\lambda\)</span> can be <em>any</em> parametrization. We have introduced <span class="math">\(K\)</span> to make the
formulas shorter:</p>
<div class="math">
\[K = \sqrt{-{1\over c^2} g_{\mu\nu} {\d x^\mu\over\d \lambda}
        {\d x^\nu\over\d\lambda}}\]</div>
<p>We vary this action with respect to <span class="math">\(x^\mu\)</span>:</p>
<div class="math">
\[\delta \tau = \delta \int K \d\lambda =\]\[    = \delta \int \sqrt{-{1\over c^2} g_{\mu\nu} {\d x^\mu\over\d \lambda}
        {\d x^\nu\over\d\lambda}} \d\lambda =\]\[    = \int {-{1\over c^2}\left(
 (\delta g_{\mu\nu}) {\d x^\mu\over\d \lambda}{\d x^\nu\over\d\lambda}
 +g_{\mu\nu} \left(\delta {\d x^\mu\over\d \lambda}\right)
    {\d x^\nu\over\d\lambda}
 +g_{\mu\nu} {\d x^\mu\over\d \lambda}\left(\delta {\d x^\nu\over\d\lambda}
    \right)
        \right) \over 2 K } \d\lambda =\]\[    = {1\over c^2}\int {\left(-\half
 (\delta g_{\mu\nu}) {\d x^\mu\over\d \lambda}{\d x^\nu\over\d\lambda}
 - g_{\mu\nu} \left(\delta {\d x^\mu\over\d \lambda}\right)
    {\d x^\nu\over\d\lambda}
        \right) \over K } \d\lambda =\]\[    = {1\over c^2}\int {\left(-\half
 (\delta x^\alpha) \partial_\alpha g_{\mu\nu}
    {\d x^\mu\over\d \lambda}{\d x^\nu\over\d\lambda}
 - g_{\alpha\nu} {\d (\delta x^\alpha)\over\d \lambda}
    {\d x^\nu\over\d\lambda}
        \right) \over K} \d\lambda =\]\[    = {1\over c^2}\int \left({-\half
 (\delta x^\alpha) \partial_\alpha g_{\mu\nu}
    {\d x^\mu\over\d \lambda}{\d x^\nu\over\d\lambda}
        \over
        K }
 + {\d\over\d\lambda}\left({g_{\alpha\nu}
    {\d x^\nu\over\d\lambda}
        \over K}\right)(\delta x^\alpha)\right) \d\lambda =\]\[    = {1\over c^2}\int {1\over K} \left(
    K{\d\over\d\lambda}\left({g_{\alpha\nu}
    {\d x^\nu\over\d\lambda}
        \over K}\right)
    -\half \partial_\alpha g_{\mu\nu}
    {\d x^\mu\over\d \lambda}{\d x^\nu\over\d\lambda}
        \right) (\delta x^\alpha) \d\lambda =\]\[    = {1\over c^2}\int {1\over K} \left(
    K{\d\over\d\lambda}\left(1\over K\right)+
    {\d g_{\alpha\nu} \over\d\lambda}
    {\d x^\nu\over\d\lambda}
    +
    g_{\alpha\nu}
    {\d^2 x^\nu\over\d\lambda^2}
    -\half \partial_\alpha g_{\mu\nu}
    {\d x^\mu\over\d \lambda}{\d x^\nu\over\d\lambda}
        \right) (\delta x^\alpha) \d\lambda =\]\[    = {1\over c^2}\int {1\over K} \left(
    K{\d\over\d\lambda}\left(1\over K\right)+
    g_{\alpha\nu}
    {\d^2 x^\nu\over\d\lambda^2}
    +\partial_\mu g_{\alpha\nu}
    {\d x^\mu\over\d\lambda}
    {\d x^\nu\over\d\lambda}
    -\half \partial_\alpha g_{\mu\nu}
    {\d x^\mu\over\d \lambda}{\d x^\nu\over\d\lambda}
        \right) (\delta x^\alpha) \d\lambda =\]\[    = {1\over c^2}\int {1\over K} \left(
    K{\d\over\d\lambda}\left(1\over K\right)+
    g_{\alpha\nu}
    {\d^2 x^\nu\over\d\lambda^2}
    +\half(\partial_\mu g_{\alpha\nu}+\partial_\nu g_{\alpha\mu}
    - \partial_\alpha g_{\mu\nu})
    {\d x^\mu\over\d \lambda}{\d x^\nu\over\d\lambda}
        \right) (\delta x^\alpha) \d\lambda =\]\[    = {1\over c^2}\int {1\over K} \left(
    K{\d\over\d\lambda}\left(1\over K\right)+
    g_{\alpha\nu}
        {\d^2 x^\nu\over\d\lambda^2}
    +\half(
   \partial_\mu g_{\alpha\nu}
 + \partial_\nu g_{\alpha\mu}
 - \partial_\alpha g_{\mu\nu}
   )
 {\d x^\mu\over\d \lambda} {\d x^\nu\over\d\lambda}
        \right)g^{\alpha\rho}(\delta x_\rho) \d\lambda =\]\[    = {1\over c^2}\int {1\over K} \left(
        K{\d\over\d\lambda}\left(1\over K\right)g^{\alpha\rho}+
        \delta_\nu{}^\rho
        {\d^2 x^\nu\over\d\lambda^2}
    +\half g^{\alpha\rho} (
   \partial_\mu g_{\alpha\nu}
 + \partial_\nu g_{\alpha\mu}
 - \partial_\alpha g_{\mu\nu}
   )
 {\d x^\mu\over\d \lambda} {\d x^\nu\over\d\lambda}
        \right)(\delta x_\rho) \d\lambda =\]\[    = {1\over c^2}\int {1\over K} \left(
    K{\d\over\d\lambda}\left(1\over K\right)g^{\alpha\rho}+
        {\d^2 x^\rho\over\d\lambda^2}
    +\Gamma^\rho_{\mu\nu}
 {\d x^\mu\over\d \lambda} {\d x^\nu\over\d\lambda}
        \right)(\delta x_\rho) \d\lambda\]</div>
<p>By setting the variation <span class="math">\(\delta\tau=0\)</span> we obtain the geodesic equation:</p>
<div class="math" id="equation-geodesic-equation2">
<span class="eqno">(2)</span>\[    K{\d\over\d\lambda}\left(1\over K\right)g^{\alpha\rho}+
        {\d^2 x^\rho\over\d\lambda^2}
    +\Gamma^\rho_{\mu\nu}
 {\d x^\mu\over\d \lambda} {\d x^\nu\over\d\lambda} = 0\]</div>
<p>We have a freedom of choosing <span class="math">\(\lambda\)</span>, so we choose
such parametrization so that <span class="math">\(\d\lambda = \d\tau\)</span>, which makes <span class="math">\(K=1\)</span> and
we recover <a href="#equation-geodesic-equation">(1)</a>:</p>
<div class="math">
\[       {\d^2 x^\rho\over\d\lambda^2}
   +\Gamma^\rho_{\mu\nu}
{\d x^\mu\over\d \lambda} {\d x^\nu\over\d\lambda} = 0\]</div>
<p>Note that the equation <a href="#equation-geodesic-equation2">(2)</a> is parametrization invariant,
but <a href="#equation-geodesic-equation">(1)</a> is not (only affine reparametrization leaves
<a href="#equation-geodesic-equation">(1)</a> invariant).</p>
</div>
<div class="section" id="riemann-curvature-tensor">
<span id="index-6"></span><h3>Riemann Curvature Tensor<a class="headerlink" href="#riemann-curvature-tensor" title="Permalink to this headline">¶</a></h3>
<p>Curvature means that we take a vector <span class="math">\(V^\mu\)</span>, parallel transport it around a
closed loop (which is just applying a commutator of the covariant derivatives
<span class="math">\([\nabla_\alpha, \nabla_\beta]V^\mu\)</span>) and see how it changes. We express the
result in terms of the vector <span class="math">\(V^\mu\)</span>:</p>
<div class="math">
\[[\nabla_\alpha, \nabla_\beta]V^\mu\equiv R^\mu{}_{\nu\alpha\beta}V^\nu\]</div>
<p>The coefficients <span class="math">\(R^\mu{}_{\nu\alpha\beta}\)</span> form a tensor called Riemann
curvature tensor.
Expanding the left hand side:</p>
<div class="math">
\[[\nabla_\alpha, \nabla_\beta]V^\mu
    =\nabla_\alpha \nabla_\beta V^\mu - \nabla_\alpha \nabla_\beta V^\mu =\]\[    =\nabla_\alpha \nabla_\beta V^\mu - (\alpha \leftrightarrow \beta) =\]\[    =\partial_\alpha \nabla_\beta V^\mu
        - \Gamma^\sigma_{\alpha \beta} \nabla_\sigma V^\mu
        + \Gamma^\mu_{\alpha \sigma} \nabla_\beta V^\sigma
        - (\alpha \leftrightarrow \beta) =\]\[    =\partial_\alpha
        \left(\partial_\beta V^\mu +\Gamma^\mu_{\beta\sigma} V^\sigma\right)
        - \Gamma^\sigma_{\alpha \beta}
        \left(\partial_\sigma V^\mu +\Gamma^\mu_{\sigma\nu} V^\nu\right)
        + \Gamma^\mu_{\alpha \sigma}
        \left(\partial_\beta V^\sigma +\Gamma^\sigma_{\beta\nu} V^\nu\right)
        - (\alpha \leftrightarrow \beta) =\]\[    =\partial_\alpha
        \left(\partial_\beta V^\mu +\Gamma^\mu_{\beta\sigma} V^\sigma\right)
        + \Gamma^\mu_{\alpha \sigma}
        \left(\partial_\beta V^\sigma +\Gamma^\sigma_{\beta\nu} V^\nu\right)
        - (\alpha \leftrightarrow \beta) =\]\[    = \partial_\alpha \partial_\beta V^\mu
            + \partial_\alpha\Gamma^\mu_{\beta\sigma} V^\sigma
            + \Gamma^\mu_{\beta\sigma} \partial_\alpha V^\sigma
        + \Gamma^\mu_{\alpha \sigma} \partial_\beta V^\sigma
            +\Gamma^\mu_{\alpha \sigma}\Gamma^\sigma_{\beta\nu} V^\nu
        - (\alpha \leftrightarrow \beta) =\]\[    = \partial_\alpha\Gamma^\mu_{\beta\sigma} V^\sigma
        +\Gamma^\mu_{\alpha \sigma}\Gamma^\sigma_{\beta\nu} V^\nu
        - (\alpha \leftrightarrow \beta) =\]\[    = \left(\partial_\alpha\Gamma^\mu_{\beta\nu}
        +\Gamma^\mu_{\alpha \sigma}\Gamma^\sigma_{\beta\nu}
        - (\alpha \leftrightarrow \beta) \right) V^\nu\]</div>
<p>Where we have used the fact that all terms symmetric in
<span class="math">\(\alpha\beta\)</span> (in particular <span class="math">\(\Gamma^\sigma_{\alpha\beta}\)</span> and
<span class="math">\(\partial_\alpha \partial_\beta V^\mu\)</span> and
<span class="math">\(\Gamma^\mu_{\beta\sigma} \partial_\alpha V^\sigma + \Gamma^\mu_{\alpha \sigma} \partial_\beta V^\sigma\)</span>) get canceled by the
same term in the <span class="math">\((\alpha \leftrightarrow \beta)\)</span>. We get</p>
<div class="math">
\[R^\mu{}_{\nu\alpha\beta}
    = \partial_\alpha\Gamma^\mu_{\beta \nu}
    + \Gamma^\mu_{\alpha\sigma}\Gamma^\sigma_{\beta \nu}
      - (\alpha \leftrightarrow \beta)
    = \partial_\alpha\Gamma^\mu_{\beta \nu}
    - \partial_\beta \Gamma^\mu_{\alpha\nu}
    + \Gamma^\mu_{\alpha\sigma}\Gamma^\sigma_{\beta \nu}
    - \Gamma^\mu_{\beta \sigma}\Gamma^\sigma_{\alpha\nu}\]</div>
<p>In order to see all the symmetries, that the Riemann tensor has, we lower the
first index</p>
<div class="math">
\[R_{\mu\nu\alpha\beta} = g_{\mu\lambda} R^\lambda{}_{\nu\alpha\beta}
    = g_{\mu\lambda} \left(
    \partial_\alpha\Gamma^\lambda_{\beta \nu}
    + \Gamma^\lambda_{\alpha\sigma}\Gamma^\sigma_{\beta \nu}
      - (\alpha \leftrightarrow \beta)
    \right)\]</div>
<p>and use local inertial frame coordinates, where all Christoffel
symbols vanish (not their derivatives though):</p>
<div class="math">
\[R_{\mu\nu\alpha\beta}
    = g_{\mu\lambda} \left(
    \partial_\alpha\Gamma^\lambda_{\beta \nu}
      - (\alpha \leftrightarrow \beta)
    \right)\]\[    = g_{\mu\lambda}\left(\partial_\alpha\left(
        \half g^{\lambda\sigma}(
             \partial_\beta g_{\sigma\nu}
            +\partial_\nu g_{\sigma\beta}
            -\partial_\sigma g_{\beta\nu}
            )\right)
      - (\alpha \leftrightarrow \beta)
            \right) =\]\[    = \half g_{\mu\lambda}g^{\lambda\sigma} \left(\partial_\alpha\left(
             \partial_\beta g_{\sigma\nu}
            +\partial_\nu g_{\sigma\beta}
            -\partial_\sigma g_{\beta\nu}
            \right)
      - (\alpha \leftrightarrow \beta)
            \right) =\]\[    = \half \delta_\mu{}^\sigma \left(\partial_\alpha\left(
             \partial_\beta g_{\sigma\nu}
            +\partial_\nu g_{\sigma\beta}
            -\partial_\sigma g_{\beta\nu}
            \right)
      - (\alpha \leftrightarrow \beta)
            \right) =\]\[    = \half \left(
             \partial_\alpha\partial_\beta g_{\mu\nu}
            +\partial_\alpha\partial_\nu g_{\mu\beta}
            -\partial_\alpha\partial_\mu g_{\beta\nu}
      - (\alpha \leftrightarrow \beta)
            \right) =\]\[    = \half \left(
            \partial_\alpha\partial_\nu g_{\mu\beta}
            -\partial_\alpha\partial_\mu g_{\beta\nu}
      - (\alpha \leftrightarrow \beta)
            \right) =\]\[    = \half \left(
            \partial_\alpha\partial_\nu g_{\mu\beta}
            -\partial_\alpha\partial_\mu g_{\beta\nu}
            -\partial_\beta\partial_\nu g_{\mu\alpha}
            +\partial_\beta\partial_\mu g_{\alpha\nu}
            \right)\]</div>
<p>We will also need:</p>
<div class="math">
\[\nabla_\lambda R_{\mu\nu\alpha\beta}
    = \half \partial_\lambda \left(
            \partial_\alpha\partial_\nu g_{\mu\beta}
            -\partial_\alpha\partial_\mu g_{\beta\nu}
      - (\alpha \leftrightarrow \beta)
            \right) =\]\[    = \half \left(
            \partial_\lambda\partial_\alpha\partial_\nu g_{\mu\beta}
            -\partial_\lambda\partial_\alpha\partial_\mu g_{\beta\nu}
            -\partial_\lambda\partial_\beta\partial_\nu g_{\mu\alpha}
            +\partial_\lambda\partial_\beta\partial_\mu g_{\alpha\nu}
            \right)\]</div>
<p>Using these expressions for the curvature tensor in a local inertial frame, we
derive the following 5 symmetries of the curvature tensor by simply
substituting for the left hand side and verify that it is equal to the right
hand side:</p>
<div class="math">
\[\begin{split}R_{\mu\nu\alpha\beta} &amp;= -R_{\mu\nu\beta\alpha} \\
R_{\mu\nu\alpha\beta} &amp;= -R_{\nu\mu\alpha\beta} \\
R_{\mu\nu\alpha\beta} &amp;= R_{\alpha\beta\mu\nu} \\
R_{\mu\nu\alpha\beta} + R_{\mu\alpha\beta\nu} + R_{\mu\beta\nu\alpha} &amp;= 0\\
\nabla_\lambda R_{\mu\nu\alpha\beta} +\nabla_\mu R_{\nu\lambda\alpha\beta} +\nabla_\nu R_{\lambda\mu\alpha\beta} &amp;= 0\end{split}\]</div>
<p>These are tensor expressions and so even though we derived them in a local
inertial frame, they hold in all coordinates. The last identity is called
a Bianchi identity.</p>
<p>The Ricci tensor is defined as:</p>
<div class="math">
\[R_{\mu\nu} = R^\lambda{}_{\mu\lambda\nu} = g^{\lambda\sigma}
    R_{\sigma\mu\lambda\nu}\]</div>
<p>From the last equality we can see that it is symmetric in <span class="math">\(\mu\nu\)</span>. A Ricci
scalar is defined as:</p>
<div class="math">
\[R = R^\mu{}_\mu = g^{\mu\nu} R_{\mu\nu}\]</div>
<p>The Einstein tensor is defined as:</p>
<div class="math">
\[G_{\mu\nu} = R_{\mu\nu} - \half R g_{\mu\nu}\]</div>
<p>It is symmetric in <span class="math">\(\mu\nu\)</span> due to the symmetry of the metric and Ricci
tensors. By contracting the Bianchi identity twice, we can show that Einstein
tensor has zero divergence:</p>
<div class="math">
\[g^{\lambda\alpha} g^{\nu\beta}\left(
\nabla_\lambda R_{\mu\nu\alpha\beta}
+\nabla_\mu R_{\nu\lambda\alpha\beta}
+\nabla_\nu R_{\lambda\mu\alpha\beta}\right) =\]\[= \nabla^\alpha g^{\nu\beta} R_{\mu\nu\alpha\beta}
+\nabla_\mu g^{\lambda\alpha} R^\beta{}_{\lambda\alpha\beta}
+\nabla^\beta g^{\lambda\alpha} R_{\lambda\mu\alpha\beta} =\]\[= \nabla^\alpha g^{\nu\beta} R_{\nu\mu\beta\alpha}
-\nabla_\mu g^{\lambda\alpha} R^\beta{}_{\lambda\beta\alpha}
+\nabla^\beta R^\alpha{}_{\mu\alpha\beta} =\]\[= \nabla^\alpha R^\beta{}_{\mu\beta\alpha}
-\nabla_\mu g^{\lambda\alpha} R_{\lambda\alpha}
+\nabla^\beta R_{\mu\beta} =\]\[= \nabla^\alpha R_{\mu\alpha}
-\nabla_\mu R^\alpha{}_\alpha
+\nabla^\beta R_{\mu\beta} =\]\[= 2\nabla^\alpha R_{\mu\alpha} -\nabla_\mu R =\]\[= 2\nabla^\alpha\left(R_{\mu\alpha} -\half g_{\mu\alpha} R \right) =\]\[= 2\nabla^\alpha G_{\mu\alpha} = 0\]</div>
</div>
<div class="section" id="lie-derivative">
<span id="index-7"></span><h3>Lie derivative<a class="headerlink" href="#lie-derivative" title="Permalink to this headline">¶</a></h3>
<p>Definition of the Lie derivative of any tensor <span class="math">\(T\)</span> is:</p>
<div class="math">
\[\L_{\vec U} T=\lim_{t\to0}{\phi_{t*}T(\phi_t(p))-T(p)\over t}\]</div>
<p>it can be shown directly from this definition, that the Lie derivative of a
vector is the same as a Lie
bracket:</p>
<div class="math">
\[\L_{\vec U}\vec V \equiv [\vec U, \vec V]\]</div>
<p>and in components</p>
<div class="math">
\[\L_{\vec U} V^\alpha =  [\vec U, \vec V]^\alpha\equiv U^\beta\nabla_\beta V^\alpha- V^\beta\nabla_\beta U^\alpha = U^\beta\partial_\beta V^\alpha- V^\beta\partial_\beta U^\alpha\]</div>
<p>Lie derivative of a scalar is</p>
<div class="math">
\[\L_{\vec V} f = V^\mu\partial_\mu f\]</div>
<p>and of a one form <span class="math">\(p_\mu\)</span> is derived using the observation that <span class="math">\(f=p_\mu V^\mu\)</span>
is a scalar:</p>
<div class="math">
\[\L_{\vec V} p_\mu = V^\nu\nabla_\nu p_\mu+p_\nu\nabla_\mu V^\nu = V^\nu\partial_\nu p_\mu+p_\nu\partial_\mu V^\nu\]</div>
<p>and so on for other tensors, for example:</p>
<div class="math">
\[\L_{\vec V} g_{\mu\nu} = V^\alpha\nabla_\alpha g_{\mu\nu} +g_{\alpha\nu}\nabla_\mu V^\alpha +g_{\mu\alpha}\nabla_\nu V^\alpha = V^\alpha\partial_\alpha g_{\mu\nu} +g_{\alpha\nu}\partial_\mu V^\alpha +g_{\mu\alpha}\partial_\nu V^\alpha\]</div>
</div>
<div class="section" id="metric">
<span id="index-8"></span><h3>Metric<a class="headerlink" href="#metric" title="Permalink to this headline">¶</a></h3>
<p>In general, the Christoffel symbols are not symmetric and there is no metric
that generates them. However, if the manifold is equipped with metrics, then
the fundamental theorem of Riemannian geometry states that there is a unique
Levi-Civita connection, for which the metric tensor is preserved by
parallel transport:</p>
<div class="math">
\[\nabla_\mu g_{\alpha\beta}=0\]</div>
<p>We define the commutation coefficients of the basis <span class="math">\(c^\alpha{}_{\mu\nu}\)</span> by</p>
<div class="math">
\[c^\alpha{}_{\mu\nu}\vec e_\alpha = \nabla_{\vec e_\mu}\vec e_\nu- \nabla_{\vec e_\nu}\vec e_\mu\]</div>
<p>In general these coefficients are not zero (as an example, take the units
vectors in spherical or cylindrical coordinates), but for coordinate bases
they are.
It can be proven, that</p>
<div class="math">
\[\Gamma^\mu_{\alpha\beta}=\half g^{\mu\sigma} \left(\partial_\beta g_{\sigma\alpha}+\partial_\alpha g_{\sigma\beta}- \partial_\sigma g_{\alpha\beta}+c_{\alpha\sigma\beta}+c_{\beta\sigma\alpha} -c_{\sigma\alpha\beta}\right)\]</div>
<p>and for coordinate bases <span class="math">\(c^\alpha{}_{\mu\nu}=0\)</span>, so</p>
<div class="math">
\[\Gamma^\mu_{\alpha\beta}=\Gamma^\mu_{\beta\alpha}\]\[\Gamma^\mu_{\alpha\beta}=\half g^{\mu\sigma} \left(\partial_\beta g_{\sigma\alpha}+\partial_\alpha g_{\sigma\beta}- \partial_\sigma g_{\alpha\beta}\right)\]</div>
<p>As a special case:</p>
<div class="math">
\[\Gamma^\mu_{\mu\beta}=\half g^{\mu\sigma} \left(\partial_\beta g_{\sigma\mu}+\partial_\mu g_{\sigma\beta}- \partial_\sigma g_{\mu\beta}\right)=\half g^{\mu\sigma}\partial_\beta g_{\sigma\mu}=\]\[ =\half \Tr g^{-1}\partial_\beta g =\half \Tr\partial_\beta\log g =\half \partial_\beta\Tr\log g =\half \partial_\beta\log|\det g| =\partial_\beta\log\sqrt{|\det g|} =\]\[={1\over2\det g}\partial_\beta\det g
={1\over\sqrt{|\det g|}}\partial_\beta\sqrt{|\det g|}\]</div>
<p>All last 3 expressions are used (but the last one is probably the most common).
<span class="math">\(g\)</span> is the matrix of coefficients <span class="math">\(g_{\mu\nu}\)</span>.  At the beginning we used the
usual trick that <span class="math">\(g^{\mu\sigma}\)</span> is symmetric but <span class="math">\(\partial_\mu
g_{\sigma\beta}- \partial_\sigma g_{\mu\beta}\)</span> is unsymmetric.  Later we used
the identity <span class="math">\(\Tr\log g = \log|\det g|\)</span>, which follows from the well-known
identity <span class="math">\(\det\exp A = \exp\Tr A\)</span> by substituting <span class="math">\(A=\log g\)</span> and taking the
logarithm of both sides.</p>
<div class="section" id="diagonal-metric">
<h4>Diagonal Metric<a class="headerlink" href="#diagonal-metric" title="Permalink to this headline">¶</a></h4>
<p>Many times the metric is diagonal, e.g. in 3D:</p>
<div class="math">
\[\begin{split}g_{ij} =
\mat{h_1^2 &amp; 0 &amp; 0\cr
0 &amp; h_2^2 &amp; 0\cr
0 &amp; 0 &amp; h_3^2\cr}\end{split}\]</div>
<p>(in general <span class="math">\(g_{ij} = \diag(h_1^2, h_2^2, \dots)\)</span>), then the Christoffel
symbols <span class="math">\(\Gamma^k_{ij}\)</span> can be calculated very easily (below we do not sum
over <span class="math">\(i\)</span>, <span class="math">\(j\)</span> and <span class="math">\(k\)</span>):</p>
<div class="math">
\[\Gamma^k_{ij}
    =\half g^{kl} \left(\partial_j g_{li}+\partial_i g_{lj}-
     \partial_l g_{ij}\right)
    =\half g^{kk} \left(\partial_j g_{ki}+\partial_i g_{kj}-
     \partial_k g_{ij}\right)\]</div>
<p>If <span class="math">\(k=i\)</span> or <span class="math">\(k=j\)</span> then</p>
<div class="math" id="equation-Chris1">
<span class="eqno">(3)</span>\[\Gamma^k_{ij} =
\Gamma^i_{ij} = \Gamma^i_{ji}
    =\half g^{ii} \left(\partial_j g_{ii}+\partial_i g_{ij}-
     \partial_i g_{ij}\right)
    =\half g^{ii} \partial_j g_{ii}
    =\half {1\over h_i^2} \partial_j h_i^2
    ={1\over h_i} \partial_j h_i\]</div>
<p>otherwise (i.e. <span class="math">\(k\neq i\)</span> and <span class="math">\(k\neq j\)</span>) then either <span class="math">\(i=j\)</span>:</p>
<div class="math" id="equation-Chris2">
<span class="eqno">(4)</span>\[\Gamma^k_{ij} =
\Gamma^k_{ii}
    =\half g^{kk} \left(\partial_i g_{ki}+\partial_i g_{ki}-
     \partial_k g_{ii}\right)
    =-\half g^{kk} \partial_k g_{ii}
    =-\half {1\over h_k^2} \partial_k h_i^2
    =-{h_i\over h_k^2} \partial_k h_i\]</div>
<p>or <span class="math">\(i\neq j\)</span> (i.e. <span class="math">\(i\neq j\neq k\)</span>):</p>
<div class="math">
\[\Gamma^k_{ij}
    =\half g^{kk} \left(\partial_j g_{ki}+\partial_i g_{kj}-
     \partial_k g_{ij}\right)
    =0\]</div>
<p>In other words, the symbols can only be nonzero if at least two of <span class="math">\(i\)</span>, <span class="math">\(j\)</span>
or <span class="math">\(k\)</span> are the same and one can use the two formulas <a href="#equation-Chris1">(3)</a> and
<a href="#equation-Chris2">(4)</a> to quickly evaluate them. A systematic way to do it is to write
<a href="#equation-Chris1">(3)</a> and <a href="#equation-Chris2">(4)</a> in the following form:</p>
<div class="math" id="equation-Chris3">
<span class="eqno">(5)</span>\[\Gamma^i_{ij} = \Gamma^i_{ji} ={1\over h_i} \partial_j h_i \quad\quad
    \mbox{$i$, $j$ arbitrary}\]\[\Gamma^j_{ii} =-{h_i\over h_j^2} \partial_j h_i \quad\quad
    \mbox{$i\neq j$}\]</div>
<p>Then find all <span class="math">\(i\)</span> and <span class="math">\(j\)</span> for which <span class="math">\(\partial_j h_i\)</span> is nonzero and then
immediately write all nonzero Christoffel symbols using the equations
<a href="#equation-Chris3">(5)</a>.</p>
<p>For example for cylindrical coordinates we have <span class="math">\(h_\rho=h_z =1\)</span> and <span class="math">\(h_\phi =
\rho\)</span>, so <span class="math">\(\partial_j h_i\)</span> is only nonzero for <span class="math">\(i=\phi\)</span> and <span class="math">\(j=\rho\)</span> and we
get:</p>
<div class="math">
\[\Gamma^\phi_{\phi\rho} = \Gamma^\phi_{\rho\phi} =
{1\over h_\phi} \partial_\rho h_\phi = {1\over\rho}\partial_\rho \rho
    = {1\over\rho}\]\[\Gamma^\rho_{\phi\phi} =
-{h_\phi\over h_\rho^2} \partial_\rho h_\phi =
    -{\rho\over 1^2}\partial_\rho \rho
    = -\rho\]</div>
<p>all other Christoffel symbols are zero. For spherical coordinates we have
<span class="math">\(h_\rho=1\)</span>, <span class="math">\(h_\theta=\rho\)</span> and <span class="math">\(h_\phi=\rho\sin\theta\)</span>, so <span class="math">\(\partial_j h_i\)</span> is
only nonzero for <span class="math">\(i=\theta\)</span>, <span class="math">\(j=\rho\)</span> or <span class="math">\(i=\phi\)</span>, <span class="math">\(j=\rho\)</span> or <span class="math">\(i=\phi\)</span>,
<span class="math">\(j=\theta\)</span> and we get:</p>
<div class="math">
\[\Gamma^\theta_{\theta\rho} =
\Gamma^\theta_{\rho\theta} =
    {1\over h_\theta}\partial_\rho h_\theta =
    {1\over \rho}\partial_\rho \rho = {1\over\rho}\]\[\Gamma^\rho_{\theta\theta} =
    -{h_\theta\over h_\rho^2}\partial_\rho h_\theta =
    -{\rho \over 1^2}\partial_\rho \rho = -\rho\]\[\Gamma^\phi_{\phi\rho} =
\Gamma^\phi_{\rho\phi} =
    {1\over h_\phi}\partial_\rho h_\phi =
    {1\over \rho\sin\theta}\partial_\rho (\rho\sin\theta) = {1\over\rho}\]\[\Gamma^\rho_{\phi\phi} =
    -{h_\phi\over h_\rho^2}\partial_\rho h_\phi =
    -{\rho\sin\theta \over 1^2}\partial_\rho (\rho\sin\theta) =
    -\rho\sin^2\theta\]\[\Gamma^\phi_{\phi\theta} =
\Gamma^\phi_{\theta\phi} =
    {1\over h_\phi}\partial_\theta h_\phi =
    {1\over \rho\sin\theta}\partial_\theta (\rho\sin\theta) =
    {\cos\theta\over\sin\theta}\]\[\Gamma^\theta_{\phi\phi} =
    -{h_\phi\over h_\theta^2}\partial_\theta h_\phi =
    -{\rho\sin\theta \over \rho^2}\partial_\theta (\rho\sin\theta) =
    -\sin\theta\cos\theta\]</div>
<p>All other symbols are zero.</p>
</div>
</div>
<div class="section" id="symmetries-killing-vectors">
<span id="index-9"></span><h3>Symmetries, Killing vectors<a class="headerlink" href="#symmetries-killing-vectors" title="Permalink to this headline">¶</a></h3>
<p>We say that a diffeomorphism <span class="math">\(\phi\)</span> is a symmetry of some tensor T if the
tensor is invariant after being pulled back under <span class="math">\(\phi\)</span>:</p>
<div class="math">
\[\phi_*T = T\]</div>
<p>Let the one-parameter family of symmetries <span class="math">\(\phi_t\)</span> be generated by a vector
field <span class="math">\(V^\mu(x)\)</span>, then the above equation is equivalent to:</p>
<div class="math">
\[\L_{\vec V} T = 0\]</div>
<p>If <span class="math">\(T\)</span> is the metric <span class="math">\(g_{\mu\nu}\)</span> then the symmetry is called isometry and
<span class="math">\(V^\mu\)</span> is called a Killing vector field and can be calculated from:</p>
<div class="math">
\[\L_{\vec V} g_{\mu\nu} = V^\alpha\nabla_\alpha g_{\mu\nu} +g_{\alpha\nu}\nabla_\mu V^\alpha +g_{\mu\alpha}\nabla_\nu V^\alpha = \nabla_\mu V_\nu +\nabla_\nu V_\mu = 0\]</div>
<p>The last equality is Killing&#8217;s equation. If <span class="math">\(x^\mu\)</span> is a geodesics with a
tangent vector <span class="math">\(U^\mu\)</span> and <span class="math">\(V^\mu\)</span> is a Killing vector, then the quantity
<span class="math">\(V_\mu U^\mu\)</span> is conserved along the geodesics, because:</p>
<div class="math">
\[{\d (V_\mu U^\mu)\over\d\lambda} =  U^\nu\nabla_\nu(V_\mu U^\mu)=U^\nu U^\mu\nabla_\nu V_\mu +V_\mu U^\nu\nabla_\nu U^\mu = 0\]</div>
<p>where the first term is both symmetric and antisymmetric in <span class="math">\((\mu, \nu)\)</span>, thus
zero, and the second term is the geodesics equation, thus also zero.</p>
</div>
<div class="section" id="symmetry-and-antisymmetry">
<h3>Symmetry and Antisymmetry<a class="headerlink" href="#symmetry-and-antisymmetry" title="Permalink to this headline">¶</a></h3>
<p>Every tensor can be decomposed into symmetric and antisymmetric parts:</p>
<div class="math">
\[T_{\alpha\beta} = \half(T_{\alpha\beta} + T_{\beta\alpha})
    + \half(T_{\alpha\beta} - T_{\beta\alpha})\]</div>
<p>In particular, for a symmetric tensor <span class="math">\(S_{\alpha\beta}=S_{\beta\alpha}\)</span> we get:</p>
<div class="math">
\[S_{\alpha\beta} = \half(S_{\alpha\beta} + S_{\beta\alpha})\]</div>
<p>and for antisymmetric tensor <span class="math">\(A_{\alpha\beta}=-A_{\beta\alpha}\)</span> we get:</p>
<div class="math">
\[A_{\alpha\beta} = \half(A_{\alpha\beta} - A_{\beta\alpha})\]</div>
<p>When contracting a symmetric tensor with an antisymmetric tensor we get zero:</p>
<div class="math">
\[S_{\alpha\beta} A^{\alpha\beta} =\]\[    = \half S_{\alpha\beta} (A^{\alpha\beta} - A^{\beta\alpha}) =\]\[    = \half (S_{\alpha\beta} A^{\alpha\beta} - S_{\alpha\beta}
        A^{\beta\alpha}) =\]\[    = \half (S_{\alpha\beta} A^{\alpha\beta} - S_{\beta\alpha}
        A^{\beta\alpha}) =\]\[    = \half (S_{\alpha\beta} A^{\alpha\beta} - S_{\alpha\beta}
        A^{\alpha\beta}) =\]\[    = 0\]</div>
<p>When contracting a general tensor <span class="math">\(T\)</span> with a symmetric tensor <span class="math">\(S\)</span>,
only the symmetric part of <span class="math">\(T\)</span> contributes:</p>
<div class="math">
\[T_{\alpha\beta} S^{\alpha\beta} =\]\[    = \half(T_{\alpha\beta} + T_{\beta\alpha})S^{\alpha\beta}
    + \half(T_{\alpha\beta} - T_{\beta\alpha})S^{\alpha\beta} =\]\[    = \half(T_{\alpha\beta} + T_{\beta\alpha})S^{\alpha\beta}\]</div>
<p>When contracting a general tensor <span class="math">\(T\)</span> with an antisymmetric tensor <span class="math">\(A\)</span>,
only the antisymmetric part of <span class="math">\(T\)</span> contributes:</p>
<div class="math">
\[T_{\alpha\beta} A^{\alpha\beta} =\]\[    = \half(T_{\alpha\beta} + T_{\beta\alpha})A^{\alpha\beta}
    + \half(T_{\alpha\beta} - T_{\beta\alpha})A^{\alpha\beta} =\]\[    = \half(T_{\alpha\beta} - T_{\beta\alpha})A^{\alpha\beta}\]</div>
<div class="section" id="example-i">
<h4>Example I<a class="headerlink" href="#example-i" title="Permalink to this headline">¶</a></h4>
<p>We want to rewrite:</p>
<div class="math">
\[2\partial_\nu g_{\mu\lambda} {\d x^\mu\over\d s} {\d x^\nu\over\d s}\]</div>
<p>So we write the left part as a sum of symmetric and antisymmetric parts:</p>
<div class="math">
\[(\partial_\nu g_{\mu\lambda} + \partial_\mu g_{\nu\lambda}
+\partial_\nu g_{\mu\lambda} - \partial_\mu g_{\nu\lambda})
{\d x^\mu\over\d s} {\d x^\nu\over\d s}\]</div>
<p>Here <span class="math">\(\partial_\nu g_{\mu\lambda} - \partial_\mu g_{\nu\lambda}\)</span> is
antisymmetric and <span class="math">\({\d x^\mu\over\d s} {\d x^\nu\over\d s}\)</span> is symmetric in
<span class="math">\(\mu,\nu\)</span>, so the contraction is zero. The final result is:</p>
<div class="math">
\[(\partial_\nu g_{\mu\lambda} + \partial_\mu g_{\nu\lambda})
{\d x^\mu\over\d s} {\d x^\nu\over\d s}\]</div>
</div>
<div class="section" id="example-ii">
<h4>Example II<a class="headerlink" href="#example-ii" title="Permalink to this headline">¶</a></h4>
<p>Let <span class="math">\(F_{\mu\nu} = \partial_\mu A_\nu - \partial_\nu A_\mu\)</span>. Then we
can simplify:</p>
<div class="math">
\[F^{\mu\nu} F_{\mu\nu} =
F^{\mu\nu} (\partial_\mu A_\nu - \partial_\nu A_\mu) =\]\[=2 F^{\mu\nu} \half (\partial_\mu A_\nu - \partial_\nu A_\mu)
=2 F^{\mu\nu} \partial_\mu A_\nu\]</div>
<p>Here <span class="math">\(\half (\partial_\mu A_\nu - \partial_\nu A_\mu)\)</span> is the antisymmetric
part (the only one that contributes, because <span class="math">\(F^{\mu\nu}\)</span> is antisymmetric) of
<span class="math">\(\partial_\mu A_\nu\)</span>.</p>
</div>
<div class="section" id="example-iii">
<h4>Example III<a class="headerlink" href="#example-iii" title="Permalink to this headline">¶</a></h4>
<p>Let <span class="math">\(F_{\mu\nu} = \partial_\mu A_\nu - \partial_\nu A_\mu\)</span>. Then we
get</p>
<div class="math">
\[F_{\mu\nu} v^\mu v^\nu = 0\,,\]</div>
<p>because <span class="math">\(F_{\mu\nu}\)</span> is an antisymmetric tensor, while <span class="math">\(v^\mu v^\nu\)</span> is a
symmetric tensor.</p>
</div>
</div>
<div class="section" id="divergence-operator">
<span id="index-10"></span><h3>Divergence Operator<a class="headerlink" href="#divergence-operator" title="Permalink to this headline">¶</a></h3>
<div class="math">
\[\nabla_\mu A^\mu
=\partial_\mu A^\mu+\Gamma^\mu_{\mu\sigma}A^\sigma
=\]\[=\partial_\mu A^\mu+{1\over\sqrt{|\det
g|}}\left(\partial_\sigma\sqrt{|\det g|}\right) A^\sigma
=\]\[={1\over\sqrt{|\det g|}}
\partial_\mu\left(\sqrt{|\det g|}\, A^\mu\right)\]</div>
<p>If the metric is diagonal (let&#8217;s show this in 3D):</p>
<div class="math">
\[\begin{split}g_{ij} =
\mat{h_1^2 &amp; 0 &amp; 0\cr
0 &amp; h_2^2 &amp; 0\cr
0 &amp; 0 &amp; h_3^2\cr}\end{split}\]</div>
<p>then</p>
<div class="math">
\[\sqrt{|\det g_{ij}|}=h_1 h_2 h_3\]\[\begin{split}g^{ij} =
\mat{{1\over h_1^2} &amp; 0 &amp; 0\cr
0 &amp; {1\over h_2^2} &amp; 0\cr
0 &amp; 0 &amp; {1\over h_3^2}\cr}\end{split}\]</div>
<p>and</p>
<div class="math">
\[\nabla\cdot{\bf A}=
\nabla_i A^i
={1\over h_1 h_2 h_3}\partial_i
\left(h_1 h_2 h_3 A^i \right)\]</div>
</div>
<div class="section" id="laplace-operator">
<span id="index-11"></span><h3>Laplace Operator<a class="headerlink" href="#laplace-operator" title="Permalink to this headline">¶</a></h3>
<div class="math">
\[\nabla^2\varphi
=\nabla_\mu\nabla^\mu\varphi
=\partial_\mu\nabla^\mu\varphi+\Gamma^\mu_{\mu\sigma}\nabla^\sigma\varphi
=\partial_\mu\partial^\mu\varphi+\Gamma^\mu_{\mu\sigma}\partial^\sigma\varphi
=\]\[=\partial_\mu\partial^\mu\varphi+{1\over\sqrt{|\det
g|}}\left(\partial_\sigma\sqrt{|\det g|}\right) \partial^\sigma\varphi
=\]\[={1\over\sqrt{|\det g|}}
\partial_\mu\left(\sqrt{|\det g|}\, \partial^\mu\varphi\right)
={1\over\sqrt{|\det g|}}
\partial_\mu\left(\sqrt{|\det g|}\, g^{\mu\sigma}\partial_\sigma\varphi\right)\]</div>
<p>If the metric is diagonal (let&#8217;s show this in 3D):</p>
<div class="math">
\[\begin{split}g_{ij} =
\mat{h_1^2 &amp; 0 &amp; 0\cr
0 &amp; h_2^2 &amp; 0\cr
0 &amp; 0 &amp; h_3^2\cr}\end{split}\]</div>
<p>then</p>
<div class="math">
\[\sqrt{|\det g_{ij}|}=h_1 h_2 h_3\]\[\begin{split}g^{ij} =
\mat{{1\over h_1^2} &amp; 0 &amp; 0\cr
0 &amp; {1\over h_2^2} &amp; 0\cr
0 &amp; 0 &amp; {1\over h_3^2}\cr}\end{split}\]</div>
<p>and</p>
<div class="math">
\[\nabla^2\varphi
=\sum_i{1\over h_1 h_2 h_3}\partial_i
\left({h_1 h_2 h_3\over h_i^2}\partial_i\varphi \right)\]</div>
</div>
<div class="section" id="covariant-integration">
<span id="index-12"></span><h3>Covariant integration<a class="headerlink" href="#covariant-integration" title="Permalink to this headline">¶</a></h3>
<p>If <span class="math">\(f(x)\)</span> is a scalar, then the integral <span class="math">\(\int f(x) \d^4 x\)</span> depends on
coordinates. The correct way to integrate <span class="math">\(f(x)\)</span> in any coordinates is:</p>
<div class="math">
\[\int f(x) \sqrt{|g|}\d^4 x\]</div>
<p>where <span class="math">\(g\equiv\det g_{\mu\nu}\)</span>. The Gauss theorem in curvilinear coordinates
is:</p>
<div class="math">
\[\int_\Omega \nabla_\mu u^\mu \sqrt{|g|}\d^4 x
=\int_\Omega {1\over\sqrt{|g|}}\partial_\mu\left(\sqrt{|g|} u^\mu\right) \sqrt{|g|}\d^4 x
=\int_\Omega \partial_\mu\left(\sqrt{|g|} u^\mu\right)\d^4 x
=\]\[=\int_{\partial\Omega} \sqrt{|g|} u^\mu n_\mu\d^3 x
=\int_{\partial\Omega} u^\mu n_\mu \sqrt{|g|}\d^3 x\]</div>
<p>where <span class="math">\(\partial\Omega\)</span> is the boundary (surface) of <span class="math">\(\Omega\)</span> and <span class="math">\(n_\nu\)</span> is the
normal vector to this surface.</p>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="weak-formulation-of-laplace-equation">
<h3>Weak Formulation of Laplace Equation<a class="headerlink" href="#weak-formulation-of-laplace-equation" title="Permalink to this headline">¶</a></h3>
<p>As an example, we write the weak formulation of the Laplace equation in
arbitrary coordintes:</p>
<div class="math">
\[\nabla^2\varphi - f = 0\]\[\int \left(\nabla^2\varphi v - f v\right)  \sqrt{|g|}d^3 x = 0\]\[\int \left(
{1\over\sqrt{|g|}}\partial_i\left(\sqrt{|g|}g^{ij}\partial_j\varphi\right)
v - f v\right)  \sqrt{|g|}d^3 x = 0\]\[\int \left(
\partial_i\left(\sqrt{|g|}g^{ij}\partial_j\varphi\right)
v - f v\sqrt{|g|}\right)  d^3 x = 0\]</div>
<p>Now we apply per-partes (assuming the boundary integral vanishes):</p>
<div class="math">
\[\int \left(
-\sqrt{|g|}g^{ij}\partial_j\varphi
\partial_i v - f v\sqrt{|g|}\right)  d^3 x = 0\]\[\int \left(
-g^{ij}\partial_j\varphi
\partial_i v - f v\right) \sqrt{|g|} d^3 x = 0\]</div>
<p>For diagonal metric this evaluates to:</p>
<div class="math">
\[\int \left(
-\sum_i {1\over h_i^2}\partial_i\varphi \partial_i v
- f v\right) h_1 h_2 h_3 d^3 x = 0\]</div>
</div>
<div class="section" id="cylindrical-coordinates">
<span id="index-13"></span><h3>Cylindrical Coordinates<a class="headerlink" href="#cylindrical-coordinates" title="Permalink to this headline">¶</a></h3>
<div class="math">
\[x = \rho\cos\phi\]</div>
<div class="math">
\[y = \rho\sin\phi\]</div>
<div class="math">
\[z = z\]</div>
<p>The transformation matrix is</p>
<div class="math">
\[\begin{split}{\partial (x, y, z)\over\partial(\rho, \phi, z)} =\mat{\cos\phi &amp; -\rho\sin\phi &amp; 0 \cr \sin\phi &amp; \rho\cos\phi &amp; 0 \cr 0 &amp; 0 &amp; 1 \cr}\end{split}\]</div>
<p>The metric tensor of the cartesian coordinate system <span class="math">\(\hat x^a=(x, y, z)\)</span> is
<span class="math">\(\hat g_{ab}={\rm diag}(1, 1, 1)\)</span>,
so by transformation we get the metric tensor <span class="math">\(g_{ij}\)</span> in the cylindrical
coordinates <span class="math">\(x^i=(\rho, \phi, z)\)</span>:</p>
<div class="math">
\[g_{ij} =  {\partial \hat x^a\over\partial x^i} {\partial \hat x^b\over\partial x^j} \hat g_{ab} = \left({\partial \hat x\over\partial x}\right)^T \hat g {\partial \hat x\over\partial x} =\]</div>
<div class="math">
\[\begin{split}= \left({\partial (x, y, z)\over\partial(\rho, \phi, z)}\right)^T \mat{1 &amp; 0 &amp; 0\cr 0 &amp; 1 &amp; 0\cr 0 &amp; 0 &amp; 1\cr} {\partial (x, y, z)\over\partial(\rho, \phi, z)}=\end{split}\]</div>
<div class="math">
\[\begin{split}= \mat{\cos\phi &amp;\sin\phi &amp; 0 \cr  -\rho\sin\phi &amp; \rho\cos\phi &amp; 0 \cr 0 &amp; 0 &amp; 1 \cr} \mat{1 &amp; 0 &amp; 0\cr 0 &amp; 1 &amp; 0\cr 0 &amp; 0 &amp; 1\cr} \mat{\cos\phi &amp; -\rho\sin\phi &amp; 0 \cr \sin\phi &amp; \rho\cos\phi &amp; 0 \cr 0 &amp; 0 &amp; 1 \cr}= \mat{1 &amp; 0 &amp; 0\cr 0 &amp; \rho^2 &amp; 0\cr 0 &amp; 0 &amp; 1\cr}\end{split}\]</div>
<div class="math">
\[\begin{split} g^{ij} = \mat{1 &amp; 0 &amp; 0\cr 0 &amp; 1\over\rho^2 &amp; 0\cr 0 &amp; 0 &amp; 1\cr}\end{split}\]\[\det g = \det g_{ij} = \rho^2\]\[h_\rho=h_z =1\]\[h_\phi = \rho\]\[\Gamma^\phi_{\phi\rho} = \Gamma^\phi_{\rho\phi} =
{1\over h_\phi} \partial_\rho h_\phi = {1\over\rho}\partial_\rho \rho
    = {1\over\rho}\]\[\Gamma^\rho_{\phi\phi} =
-{h_\phi\over h_\rho^2} \partial_\rho h_\phi =
    -{\rho\over 1^2}\partial_\rho \rho
    = -\rho\]\[\nabla\cdot{\bf A}=
\nabla_i A^i
={1\over h_1 h_2 h_3}\partial_i
\left(h_1 h_2 h_3 A^i \right)
={1\over \rho}\partial_i
\left(\rho A^i \right)
=\]\[={1\over\rho}\partial_\rho(\rho A^\rho) + \partial_\theta A^\theta
    + \partial_z A^z
=\partial_\rho A^\rho + {1\over\rho}A^\rho + \partial_\theta A^\theta
    + \partial_z A^z\]</div>
<div class="math">
\[\nabla^2 \varphi = \nabla^i\nabla_i\varphi
={1\over\sqrt{|\det g|}}
\partial_i\left(\sqrt{|\det g|}\, g^{ij}\partial_j\varphi\right)
=\]</div>
<div class="math">
\[={1\over\rho}\partial_i\left(\rho g^{ij}\partial_j\varphi\right)
={1\over\rho}\partial_\rho\left(\rho \partial_\rho\varphi\right)
+{1\over\rho}\partial_\phi\left(\rho {1\over\rho^2}\partial_\phi\varphi\right)
+{1\over\rho}\partial_z\left(\rho \partial_z\varphi\right)=\]\[={1\over\rho}\partial_\rho\left(\rho \partial_\rho\varphi\right)
+{1\over\rho^2}\partial_\phi\partial_\phi\varphi
+\partial_z\partial_z\varphi=\]</div>
<div class="math">
\[= \partial_\rho\partial_\rho\varphi
+{1\over\rho}\partial_\rho\varphi
+{1\over\rho^2}\partial_\phi\partial_\phi\varphi
+\partial_z\partial_z\varphi\]</div>
<p>As a particular example, let&#8217;s write the Laplace equation with nonconstant
conductivity for axially symmetric field. The Laplace equation is:</p>
<div class="math">
\[\nabla\cdot\sigma\nabla\varphi=0\]</div>
<p>so we use the formulas above to get:</p>
<div class="math">
\[0=\nabla\cdot\sigma\nabla\varphi=\nabla^i\sigma\nabla_i\varphi = {\partial\over\partial\rho}\sigma{\partial\varphi\over\partial\rho} + {1\over\rho^2} {\partial\over\partial\phi}\sigma{\partial\varphi\over\partial\phi} + {\partial\over\partial z}\sigma{\partial\varphi\over\partial z} + {\sigma\over\rho}{\partial\varphi\over\partial\rho}\]</div>
<p>but we know that <span class="math">\(\varphi=\varphi(\rho, z)\)</span>, so
<span class="math">\({\partial\varphi\over\partial\phi}=0\)</span>
and the final equation is:</p>
<div class="math">
\[{\partial\over\partial\rho}\sigma{\partial\varphi\over\partial\rho} + {\partial\over\partial z}\sigma{\partial\varphi\over\partial z} + {\sigma\over\rho}{\partial\varphi\over\partial\rho} =0\]</div>
<p>To write the weak formulation for it, we need to integrate covariantly (e.g.
<span class="math">\(\rho\,\d\rho\d\phi\d z\)</span> in our case) and
rewrite it using per partes. We did exactly this in the previous example in a
coordinate free maner, so we just use the final formula we got there for a
diagonal metric:</p>
<div class="math">
\[\int\left(
-\partial_\rho\varphi\partial_\rho v
-{1\over\rho^2}\partial_\phi\varphi\partial_\phi v
-\partial_z\varphi\partial_z v
\right)\sigma\rho\,\d\rho\d\phi\d z=0\]</div>
<p>and for <span class="math">\(\partial_\phi\varphi=0\)</span>, we get:</p>
<div class="math">
\[-2\pi\int\left(
\partial_\rho\varphi\partial_\rho v
+\partial_z\varphi\partial_z v
\right)\sigma\rho\,\d\rho\d z=0\]</div>
</div>
<div class="section" id="spherical-coordinates">
<span id="diff-geom-spherical-coordinates"></span><h3>Spherical Coordinates<a class="headerlink" href="#spherical-coordinates" title="Permalink to this headline">¶</a></h3>
<p>The relation between cartesian coordinates <span class="math">\(\hat x^a=(x, y, z)\)</span>
and spherical coordinates <span class="math">\(x^i=(\rho, \theta, \phi)\)</span> is:</p>
<div class="math" id="equation-spherical_coord">
<span class="eqno">(6)</span>\[\begin{split}x &amp;= \rho\sin\theta\cos\phi \\
y &amp;= \rho\sin\theta\sin\phi \\
z &amp;= \rho\cos\theta         \\\end{split}\]</div>
<p>The transformation matrix (Jacobian) is calculated by differentiating
<a href="#equation-spherical_coord">(6)</a>:</p>
<div class="math" id="equation-jacobian_spherical">
<span class="eqno">(7)</span>\[\begin{split}{\partial \hat x\over\partial x}
    = {\partial (x, y, z)\over\partial(\rho, \theta, \phi)}
    = \mat{
\sin\theta\cos\phi &amp; \rho\cos\theta\cos\phi &amp; -\rho\sin\theta\sin\phi \cr
\sin\theta\sin\phi &amp; \rho\cos\theta\sin\phi &amp;  \rho\sin\theta\cos\phi \cr
\cos\theta         &amp; -\rho\sin\theta        &amp;  0                      \cr}\end{split}\]</div>
<p>The inverse Jacobian is calculated by inverting the matrix
<a href="#equation-jacobian_spherical">(7)</a>:</p>
<div class="math">
\[\begin{split}{\partial x\over\partial \hat x}
    = {\partial(\rho, \theta, \phi)\over\partial(x, y, z)}
    = \mat{
\sin\theta\cos\phi             &amp; \sin\theta\sin\phi
        &amp; \cos\theta             \cr
{\cos\theta\cos\phi\over\rho}  &amp; {\cos\theta\sin\phi\over\rho}
        &amp; -{\sin\theta\over\rho} \cr
-{\sin\phi\over\rho\sin\theta} &amp; {\cos\phi\over\rho\sin\theta}
        &amp; 0                      \cr }\end{split}\]</div>
<p>We expressed the above Jacobians using <span class="math">\(\rho\)</span>, <span class="math">\(\theta\)</span>, <span class="math">\(\phi\)</span> and we can
use <a href="#equation-spherical_coord">(6)</a> to express them using <span class="math">\(x\)</span>, <span class="math">\(y\)</span>, <span class="math">\(z\)</span>. Code:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">zeros</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">latex</span>
<span class="n">var</span><span class="p">(</span><span class="s2">&quot;rho theta phi&quot;</span><span class="p">)</span>
<span class="n">x_hat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span>
    <span class="n">rho</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span>
    <span class="n">rho</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span>
    <span class="n">rho</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">rho</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">])</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_hat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;ADJ&quot;</span><span class="p">)</span>
<span class="n">one</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> \
        <span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">one_simple</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="n">N</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="c1"># one_simple is equal to 1, but simplify() can&#39;t do this automatically yet:</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">one_simple</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">&quot;J =&quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="k">print</span>
<span class="k">print</span> <span class="s2">&quot;J^{-1} =&quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="math">
\[\begin{split}J = \left[\begin{smallmatrix}\sin{\left (\theta \right )} \cos{\left (\phi \right )} &amp; \rho \cos{\left (\phi \right )} \cos{\left (\theta \right )} &amp; - \rho \sin{\left (\phi \right )} \sin{\left (\theta \right )}\\\sin{\left (\phi \right )} \sin{\left (\theta \right )} &amp; \rho \sin{\left (\phi \right )} \cos{\left (\theta \right )} &amp; \rho \sin{\left (\theta \right )} \cos{\left (\phi \right )}\\\cos{\left (\theta \right )} &amp; - \rho \sin{\left (\theta \right )} &amp; 0\end{smallmatrix}\right]\end{split}\]\[\begin{split}J^{-1} = \left[\begin{smallmatrix}\sin{\left (\theta \right )} \cos{\left (\phi \right )} &amp; \sin{\left (\phi \right )} \sin{\left (\theta \right )} &amp; \cos{\left (\theta \right )}\\\frac{\cos{\left (\phi \right )} \cos{\left (\theta \right )}}{\rho} &amp; \frac{\sin{\left (\phi \right )} \cos{\left (\theta \right )}}{\rho} &amp; - \frac{\sin{\left (\theta \right )}}{\rho}\\- \frac{\sin{\left (\phi \right )}}{\rho \sin{\left (\theta \right )}} &amp; \frac{\cos{\left (\phi \right )}}{\rho \sin{\left (\theta \right )}} &amp; 0\end{smallmatrix}\right]\end{split}\]</div>
<p>The transformation matrices (Jacobians) are then used to convert vectors</p>
<div class="math">
\[V_i =  {\partial \hat x^a\over\partial x^i} \hat V_a\]</div>
<p>and tensors</p>
<div class="math">
\[T_{ij} =  {\partial \hat x^a\over\partial x^i}
    {\partial \hat x^b\over\partial x^j} \hat T_{ab}\]</div>
<p>between spherical and cartesian coordinates. For example the partial
derivatives from cartesian to spherical coordinates transform as:</p>
<div class="math">
\[\partial_i =  {\partial \hat x^a\over\partial x^i} \hat \partial_a\]\[\begin{split}\mat{ \partial_\rho   &amp; \partial_\theta &amp; \partial_\phi   \cr }
=
\mat{ \partial_x &amp; \partial_y &amp; \partial_z \cr }
\mat{
\sin\theta\cos\phi &amp; \rho\cos\theta\cos\phi &amp; -\rho\sin\theta\sin\phi \cr
\sin\theta\sin\phi &amp; \rho\cos\theta\sin\phi &amp;  \rho\sin\theta\cos\phi \cr
\cos\theta         &amp; -\rho\sin\theta        &amp;  0                      \cr}\end{split}\]</div>
<p>and from spherical to cartesian as:</p>
<div class="math">
\[\hat \partial_a =  {\partial x^i\over\partial \hat x^a} \partial_i\]\[\begin{split}\mat{ \partial_x &amp; \partial_y &amp; \partial_z \cr }
=
\mat{ \partial_\rho   &amp; \partial_\theta &amp; \partial_\phi   \cr }
\mat{
\sin\theta\cos\phi             &amp; \sin\theta\sin\phi
        &amp; \cos\theta             \cr
{\cos\theta\cos\phi\over\rho}  &amp; {\cos\theta\sin\phi\over\rho}
        &amp; -{\sin\theta\over\rho} \cr
-{\sin\phi\over\rho\sin\theta} &amp; {\cos\phi\over\rho\sin\theta}
        &amp; 0                      \cr }\end{split}\]</div>
<p>Care must be taken when rewriting the index expression into matrices &#8211; the top
index of the Jacobian is the row index, the bottom index is the column index.</p>
<p>The metric tensor of the cartesian coordinate system <span class="math">\(\hat x^a\)</span> is
<span class="math">\(\hat g_{ab}={\rm diag}(1, 1, 1)\)</span>,
so by transformation we get the metric tensor <span class="math">\(g_{ij}\)</span> in the spherical
coordinates <span class="math">\(x^i\)</span>:</p>
<div class="math">
\[ g_{ij} =  {\partial \hat x^a\over\partial x^i} {\partial \hat x^b\over\partial x^j} \hat g_{ab} = \left({\partial \hat x\over\partial x}\right)^T \hat g {\partial \hat x\over\partial x} =\]\[\begin{split}
 = \left({\partial (x, y, z)\over\partial(\rho, \theta, \phi)}\right)^T \mat{1 &amp; 0 &amp; 0\cr 0 &amp; 1 &amp; 0\cr 0 &amp; 0 &amp; 1\cr} {\partial (x, y, z)\over\partial(\rho, \theta, \phi)}=\end{split}\]\[\begin{split}= \mat{ \sin\theta\cos\phi &amp; \sin\theta\sin\phi &amp; \cos\theta \cr \rho\cos\theta\cos\phi &amp; \rho\cos\theta\sin\phi &amp; -\rho\sin\theta \cr -\rho\sin\theta\sin\phi &amp; \rho\sin\theta\cos\phi &amp; 0 \cr } \mat{1 &amp; 0 &amp; 0\cr 0 &amp; 1 &amp; 0\cr 0 &amp; 0 &amp; 1\cr} \mat{\sin\theta\cos\phi &amp; \rho\cos\theta\cos\phi &amp; -\rho\sin\theta\sin\phi \cr \sin\theta\sin\phi &amp; \rho\cos\theta\sin\phi &amp; \rho\sin\theta\cos\phi \cr \cos\theta &amp; -\rho\sin\theta &amp; 0 \cr} =\end{split}\]\[\begin{split} = \mat{1 &amp; 0 &amp; 0\cr 0 &amp; \rho^2 &amp; 0\cr 0 &amp; 0 &amp; \rho^2\sin^2\theta\cr}\end{split}\]</div>
<p>Once we have the metric tensor expressed in spherical coordinates,
we don&#8217;t need the cartesian coordinates anymore. All formulas
only contain the spherical coordinates and the metric tensor.</p>
<div class="math">
\[\begin{split}g^{ij} = \mat{1 &amp; 0 &amp; 0\cr 0 &amp; 1\over\rho^2 &amp; 0\cr 0 &amp; 0 &amp; 1\over\rho^2\sin^2\theta\cr}\end{split}\]</div>
<div class="math">
\[\det g = \det g_{ij} = \rho^4\sin^2\theta\]</div>
<div class="math">
\[\nabla^i\nabla_i\varphi = \partial^i\partial_i\varphi+{1\over{2\det g}}\partial_j(\det g)\,\, g^{jk}\partial_k\varphi=\]</div>
<div class="math">
\[= g^{ij}\partial_i\partial_j\varphi+{1\over{2\rho^4\sin^2\theta }}\left( \partial_\rho(\rho^4\sin^2\theta)\,\,g^{\rho \rho}\partial_\rho\varphi + \partial_\theta(\rho^4\sin^2\theta)\,\,g^{\theta \theta}\partial_\theta\varphi \right)\]</div>
<div class="math">
\[= g^{ij}\partial_i\partial_j\varphi+{2\over\rho}\partial_\rho\varphi +{\cos\theta\over\rho^2\sin\theta}\partial_\theta\varphi =\]</div>
<div class="math">
\[= \partial_\rho\partial_\rho\varphi
+{1\over\rho^2}\partial_\theta\partial_\theta\varphi
+{1\over\rho^2\sin^2\theta}\partial_\phi\partial_\phi\varphi
+{2\over\rho}\partial_\rho\varphi +{\cos\theta\over\rho^2\sin\theta}\partial_\theta\varphi\]</div>
</div>
<div class="section" id="rotating-disk">
<span id="index-14"></span><h3>Rotating Disk<a class="headerlink" href="#rotating-disk" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s have a laboratory Euclidean system <span class="math">\(x^\mu = (t, x, y, z)\)</span> and
a rotating disk system <span class="math">\(x'^\mu = (t', x', y', z')\)</span>. The relation between the frames is</p>
<div class="math">
\[\begin{split}\mat{t'\cr x'\cr y'\cr z'\cr}= \mat{1 &amp; 0 &amp; 0 &amp; 0\cr 0 &amp; \cos\omega t &amp; \sin\omega t &amp; 0\cr 0 &amp; -\sin\omega t &amp; \cos\omega t &amp; 0\cr 0 &amp; 0 &amp; 0 &amp; 1\cr} \mat{t\cr x\cr y\cr z\cr} = \mat{t\cr x\cos\omega t+y\sin\omega t\cr -x\sin\omega t+y\cos\omega t\cr z\cr}\end{split}\]</div>
<p>The inverse transformation can be calculated by simply inverting the matrix:</p>
<div class="math">
\[\begin{split}\mat{t\cr x\cr y\cr z\cr}= \mat{1 &amp; 0 &amp; 0 &amp; 0\cr 0 &amp; \cos\omega t' &amp; -\sin\omega t' &amp; 0\cr 0 &amp; \sin\omega t' &amp; \cos\omega t' &amp; 0\cr 0 &amp; 0 &amp; 0 &amp; 1\cr} \mat{t'\cr x'\cr y'\cr z'\cr}\end{split}\]</div>
<p>so the transformation matrices are:</p>
<div class="math">
\[\begin{split}{\partial x'^\mu\over\partial x^\nu}= \mat{1 &amp; 0 &amp; 0 &amp; 0\cr -x\omega\sin\omega t + y\omega\cos\omega t &amp; \cos\omega t &amp; \sin\omega t &amp; 0\cr -x\omega\cos\omega t - y\omega\sin\omega t &amp; -\sin\omega t &amp; \cos\omega t &amp; 0\cr 0 &amp; 0 &amp; 0 &amp; 1\cr} ={\partial x'\over\partial x}\end{split}\]</div>
<div class="math">
\[\begin{split}{\partial x^\nu\over\partial x'^\mu}= \mat{1 &amp; 0 &amp; 0 &amp; 0\cr -x'\omega\sin\omega t' - y'\omega\cos\omega t' &amp; \cos\omega t' &amp; -\sin\omega t' &amp; 0\cr x'\omega\cos\omega t' - y'\omega\sin\omega t' &amp; \sin\omega t' &amp; \cos\omega t' &amp; 0\cr 0 &amp; 0 &amp; 0 &amp; 1\cr} ={\partial x\over\partial x'}\end{split}\]</div>
<p>The problem now is that Newtonian mechanics has a degenerated spacetime
metrics (see later). Let&#8217;s pretend we have the following metrics in the
<span class="math">\(x^\mu\)</span> system:</p>
<div class="math">
\[\begin{split}g_{\mu\nu} = \mat{1 &amp; 0 &amp; 0 &amp; 0\cr 0 &amp; 1 &amp; 0 &amp; 0\cr 0 &amp; 0 &amp; 1 &amp; 0\cr 0 &amp; 0 &amp; 0 &amp; 1\cr} =g\end{split}\]</div>
<p>and</p>
<div class="math">
\[\begin{split}g'_{\alpha\beta} = {\partial x^\mu\over\partial x'^\alpha} {\partial x^\nu\over\partial x'^\beta} g_{\mu\nu} = \left({\partial x\over\partial x'}\right)^T g \left({\partial x\over\partial x'}\right) = \mat{1 + \omega^2 (x'^2+y'^2) &amp; -\omega y' &amp; \omega x' &amp; 0\cr -\omega y' &amp; 1 &amp; 0 &amp; 0\cr \omega x' &amp; 0 &amp; 1 &amp; 0\cr 0 &amp; 0 &amp; 0 &amp; 1\cr} =g'\end{split}\]</div>
<p>However, if we calculate with the correct special relativity metrics:</p>
<div class="math">
\[\begin{split}g_{\mu\nu} = \mat{-c^2 &amp; 0 &amp; 0 &amp; 0\cr 0 &amp; 1 &amp; 0 &amp; 0\cr 0 &amp; 0 &amp; 1 &amp; 0\cr 0 &amp; 0 &amp; 0 &amp; 1\cr} =g\end{split}\]</div>
<p>and</p>
<div class="math">
\[\begin{split}g'_{\alpha\beta} = {\partial x^\mu\over\partial x'^\alpha} {\partial x^\nu\over\partial x'^\beta} g_{\mu\nu} = \left({\partial x\over\partial x'}\right)^T g \left({\partial x\over\partial x'}\right) = \mat{-c^2 + \omega^2 (x'^2+y'^2) &amp; -\omega y' &amp; \omega x' &amp; 0\cr -\omega y' &amp; 1 &amp; 0 &amp; 0\cr \omega x' &amp; 0 &amp; 1 &amp; 0\cr 0 &amp; 0 &amp; 0 &amp; 1\cr} =g'\end{split}\]</div>
<p>We get the same Christoffel symbols as with the <span class="math">\(\diag(1, 1, 1, 1)\)</span> metrics,
because only the derivatives of the metrics are important.
Then the only nonzero Christoffel symbols are</p>
<div class="math">
\[\Gamma^1_{00}=-x'\omega^2\]</div>
<div class="math">
\[\Gamma^1_{02}=\Gamma^1_{20}=-\omega\]</div>
<div class="math">
\[\Gamma^2_{00}=-y'\omega^2\]</div>
<div class="math">
\[\Gamma^2_{01}=\Gamma^2_{10}=\omega\]</div>
<p>If we want to avoid dealing with metrics, it is possible
to
start with the Christoffel symbols in the <span class="math">\(x^\mu\)</span> system:</p>
<div class="math">
\[\Gamma^\sigma_{\mu\nu}=0\]</div>
<p>and then transforming them to the <span class="math">\(x'^\mu\)</span> system using the change of variable
formula:</p>
<div class="math">
\[\Gamma'^\alpha{}_{\beta\gamma}= {\partial x^\mu\over\partial x'^\beta} {\partial x^\nu\over\partial x'^\gamma} \Gamma^\sigma{}_{\mu\nu} {\partial x'^\alpha\over\partial x^\sigma} + {\partial x'^\alpha\over\partial x^\sigma} {\partial^2 x^\sigma\over\partial x'^\beta\partial x'^\gamma} = {\partial x'^\alpha\over\partial x^\sigma} {\partial^2 x^\sigma\over\partial x'^\beta\partial x'^\gamma}\]</div>
<p>As an example, let&#8217;s calculate the coefficients above:</p>
<div class="math">
\[\Gamma'^2{}_{00}= {\partial x'^2\over\partial x^\sigma} {\partial^2 x^\sigma\over\partial x'^0\partial x'^0} = {\partial x'^2\over\partial x^\sigma} {\partial \over\partial x'^0} {\partial x^\sigma\over\partial x'^0} =\]</div>
<div class="math">
\[\begin{split}= \mat{-x\omega\cos\omega t - y\omega\sin\omega t &amp; -\sin\omega t &amp; \cos\omega t &amp; 0\cr} {\partial \over\partial t'} \mat{1\cr -x'\omega\sin\omega t'-y'\omega\cos\omega t'\cr x'\omega\cos\omega t'-y'\omega\sin\omega t'\cr 0\cr} =\end{split}\]</div>
<div class="math">
\[\begin{split}= \mat{-x\omega\cos\omega t - y\omega\sin\omega t &amp; -\sin\omega t &amp; \cos\omega t &amp; 0\cr} \mat{0\cr -x'\omega^2\cos\omega t'+y'\omega^2\sin\omega t'\cr -x'\omega^2\sin\omega t'-y'\omega^2\cos\omega t'\cr 0\cr} =-y'\omega^2\end{split}\]</div>
<div class="math">
\[\Gamma'^1{}_{00}=-x'\omega^2\]</div>
<div class="math">
\[\Gamma'^2{}_{01}=\Gamma'^2{}_{10}= {\partial x'^2\over\partial x^\sigma} {\partial^2 x^\sigma\over\partial x'^0\partial x'^1} = {\partial x'^2\over\partial x^\sigma} {\partial \over\partial x'^0} {\partial x^\sigma\over\partial x'^1} =\]</div>
<div class="math">
\[\begin{split}= \mat{-x\omega\cos\omega t - y\omega\sin\omega t &amp; -\sin\omega t &amp; \cos\omega t &amp; 0\cr} {\partial \over\partial t'} \mat{0\cr \cos\omega t'\cr \sin\omega t'\cr 0\cr} =\end{split}\]</div>
<div class="math">
\[\begin{split}= \mat{-x\omega\cos\omega t - y\omega\sin\omega t &amp; -\sin\omega t &amp; \cos\omega t &amp; 0\cr} \mat{0\cr -\omega\sin\omega t'\cr \omega\cos\omega t'\cr 0\cr} =\omega\end{split}\]</div>
<div class="math">
\[\Gamma'^1{}_{02}=\Gamma'^1{}_{20}=-\omega\]</div>
<p>So we got the same results.</p>
<p>Now let&#8217;s see what we have got.
Later we&#8217;ll show, that the <span class="math">\(\Gamma^i_{00}\)</span> coefficients are just
<span class="math">\(\partial_i\phi\)</span> in the Newtonian theory. E.g. in our case we have:</p>
<div class="math">
\[\Gamma'^1_{00} = -x'\omega^2 = \partial_x'\phi\]</div>
<div class="math">
\[\Gamma'^2_{00} = -y'\omega^2 = \partial_y'\phi\]</div>
<div class="math">
\[\Gamma'^3_{00} = 0 = \partial_z'\phi\]</div>
<p>from which:</p>
<div class="math">
\[\phi(t, x, y, z) = -\half(x'^2+y'^2)\omega^2 + C(t)\]</div>
<p>and the force acting on a test particle is then:</p>
<div class="math">
\[{\bf F} = -m\nabla\phi=m\,(x', y', 0)\,\omega^2=m{\bf r'}\omega^2\]</div>
<p>where we have defined <span class="math">\({\bf r'} = (x', y', 0)\)</span>. This is just the centrifugal
force. Also observe, that we could have read <span class="math">\(\phi\)</span> directly from the metrics
itself &#8212; just compare it to the Lorentzian metrics (with gravitation) in the
next chapter.</p>
<p>The other two terms (<span class="math">\(\Gamma'^1_{02}\)</span>, <span class="math">\(\Gamma'^2_{01}\)</span> and the symmetric ones) don&#8217;t behave as a gravitational force, but
rather only act when we are differentiating (e.g. only act on moving bodies).
Below we show this is just the <span class="math">\(-2\boldsymbol\omega\times{\d{\bf r}\over\d t}\)</span> term
(responsible for the Coriolis acceleration).</p>
<p>Let&#8217;s write the full equations of geodesics:</p>
<div class="math">
\[{\d^2 x^0\over\d\lambda^2}=0\]</div>
<div class="math">
\[{\d^2 x^1\over\d\lambda^2}+\Gamma^1_{00}\left({\d x^0\over\d\lambda}\right)^2 +2\Gamma^1_{20}{\d x^2\over\d\lambda}{\d x^0\over\d\lambda}=0\]</div>
<div class="math">
\[{\d^2 x^2\over\d\lambda^2}+\Gamma^2_{00}\left({\d x^0\over\d\lambda}\right)^2 +2\Gamma^2_{10}{\d x^1\over\d\lambda}{\d x^0\over\d\lambda}=0\]</div>
<div class="math">
\[{\d^2 x^3\over\d\lambda^2}=0\]</div>
<p>This becomes:</p>
<div class="math">
\[{\d^2 x\over\d t^2}=x\omega^2 +2\omega{\d y\over\d t}\]</div>
<div class="math">
\[{\d^2 y\over\d t^2}=y\omega^2 -2\omega{\d x\over\d t}\]</div>
<div class="math">
\[{\d^2 z\over\d t^2}=0\]</div>
<p>we can define <span class="math">\({\bf r} = (x, y, 0)\)</span> and <span class="math">\(\boldsymbol\omega=(0,0,\omega)\)</span>. Then the
above equations can be rewritten as:</p>
<div class="math">
\[{\d^2{\bf r}\over\d t^2}={\bf r}\omega^2-2\boldsymbol\omega\times{\d{\bf r}\over\d t}\]</div>
<p>So we get two fictituous forces, the centrifugal force and the Coriolis force.</p>
<p>Now imagine a static vector in the <span class="math">\(x^\mu\)</span> system along the <span class="math">\(x\)</span> axis, i.e.</p>
<div class="math">
\[V^\mu = \mat{1\cr 1\cr 0\cr 0\cr} = V\]</div>
<p>then</p>
<div class="math">
\[V'^\mu = {\partial x'^\mu\over\partial x^\alpha}V^\alpha= {\partial x'\over\partial x}V= \mat{1\cr -x\omega\sin\omega t + y\omega\cos\omega t + \cos\omega t \cr -x\omega\cos\omega t - y\omega\sin\omega t - \sin\omega t\cr 0\cr} = \mat{1\cr y'\omega + \cos\omega t' \cr -x'\omega - \sin\omega t'\cr 0\cr}=V'\]</div>
<p>In the last equality we transformed from <span class="math">\(x^\mu\)</span> to <span class="math">\(x'^\mu\)</span> using the
relation between frames.</p>
<p>Differentiating any vector in the <span class="math">\(x^\mu\)</span> coordinates
is easy &#8211; it&#8217;s just a partial derivative (due to the Euclidean metrics).
Let&#8217;s differentiate any vector in the <span class="math">\(x'^\mu\)</span>
coordinates with respect to time (since <span class="math">\(t=t'\)</span>, the time is the same in both
coordinate systems):</p>
<div class="math">
\[\nabla_0V'^{\mu}=\partial_0V'^{\mu}+\Gamma^\mu_{0\alpha}V'^{\alpha}\]</div>
<div class="math">
\[\nabla_0 \mat{V'^0\cr V'^1 \cr V'^2\cr V'^3\cr} = \mat{\partial_0V'^0\cr \partial_0V'^1 +\Gamma^1_{00}V'^0+\Gamma^1_{02}V'^2\cr \partial_0V'^2 +\Gamma^2_{00}V'^0+\Gamma^2_{01}V'^1\cr \partial_0V'^3\cr} = \mat{\partial_0V'^0\cr \partial_0V'^1 -x'\omega^2V'^0-\omega V'^2\cr \partial_0V'^2 -y'\omega^2V'^0+\omega V'^1\cr \partial_0V'^3\cr}=\]</div>
<div class="math" id="equation-vcovar">
<span class="eqno">(8)</span>\[\begin{split}=
\partial_0
\mat{V'^0\cr V'^1 \cr V'^2\cr V'^3\cr}
+
\mat{
0 &amp; 0 &amp; 0 &amp; 0\cr
-x'\omega^2 &amp; 0 &amp; -\omega &amp; 0\cr
-y'\omega^2 &amp; \omega &amp; 0 &amp; 0\cr
0 &amp; 0 &amp; 0 &amp; 0\cr
}
\mat{V'^0\cr V'^1 \cr V'^2\cr V'^3\cr}\end{split}\]</div>
<p>For our particular (static) vector this yields:</p>
<div class="math">
\[\nabla_0 \mat{1\cr y'\omega + \cos\omega t' \cr -x'\omega - \sin\omega t'\cr 0\cr} = \mat{0\cr 0\cr 0\cr 0\cr}\]</div>
<p>as expected, because it was at rest in the <span class="math">\(x^\mu\)</span> system.
Let&#8217;s imagine a static vector in the <span class="math">\(x'^\mu\)</span> system along the <span class="math">\(x'\)</span> axis, i.e.</p>
<div class="math">
\[W'^\mu = \mat{1\cr 1\cr 0\cr 0\cr}\]</div>
<div class="math">
\[W^\mu = {\partial x^\mu\over\partial x'^\alpha}W'^\alpha= \mat{1\cr -x'\omega\sin\omega t'-y'\omega\cos\omega t'+\cos\omega t'\cr x'\omega\cos\omega t'-y'\omega\sin\omega t'+\sin\omega t'\cr 0\cr} = \mat{1\cr -y\omega+\cos\omega t\cr x\omega+\sin\omega t\cr 0\cr}\]</div>
<p>then</p>
<div class="math">
\[\nabla_0W'^\mu= \nabla_0 \mat{1\cr 1\cr 0\cr 0\cr} = \mat{0\cr -x'\omega^2\cr -y'\omega^2+\omega\cr 0\cr}\]</div>
<div class="math">
\[\begin{split}\nabla_0W^\mu= \partial_0 \mat{1\cr -y\omega+\cos\omega t\cr x\omega+\sin\omega t\cr 0\cr} = \mat{0\cr -\omega\sin\omega t\cr \omega\cos\omega t\cr 0\cr} = \mat{ 0 &amp; 0 &amp; 0 &amp; 0\cr 0 &amp; 0 &amp; -\omega &amp; 0\cr 0 &amp; \omega &amp; 0 &amp; 0\cr 0 &amp; 0 &amp; 0 &amp; 0\cr } \mat{0\cr \cos\omega t\cr \sin\omega t\cr 0\cr} = \boldsymbol\omega\times{\bf W}\end{split}\]</div>
<p>Similarly</p>
<div class="math">
\[\nabla_0\nabla_0W'^\mu= = \mat{0\cr -y'\omega^3-\omega^2\cr -x'\omega^3\cr 0\cr}\]</div>
<div class="math">
\[\nabla_0\nabla_0W^\mu= = \mat{0\cr -\omega^2\cos\omega t\cr -\omega^2\sin\omega t\cr 0\cr}\]</div>
<p>How can one prove the relation:</p>
<div class="math" id="equation-vrot">
<span class="eqno">(9)</span>\[{\d{\bf A}\over\d t} = \boldsymbol\omega \times {\bf A} + {\d'{\bf A}\over\d t}\]</div>
<p>that is used for example to derive the Coriolis acceleration etc.?
We need to write it components to understand what it really means:</p>
<div class="math">
\[\begin{split}\nabla_0 \mat{A'^0\cr A'^1\cr A'^2\cr A'^3\cr} = \mat{ 0 &amp; 0 &amp; 0 &amp; 0\cr 0 &amp; 0 &amp; -\omega &amp; 0\cr 0 &amp; \omega &amp; 0 &amp; 0\cr 0 &amp; 0 &amp; 0 &amp; 0\cr } \mat{A'^0\cr A'^1\cr A'^2\cr A'^3\cr} + \partial_0 \mat{A'^0\cr A'^1\cr A'^2\cr A'^3\cr}\end{split}\]</div>
<p>Comparing to the covariant derivative above, it&#8217;s clear that they are equal
(provided that <span class="math">\(x'=0\)</span> and <span class="math">\(y'=0\)</span>, i.e. we are at the center of rotation).</p>
<p>Let&#8217;s show the derivation by Goldstein. The change in a time <span class="math">\(dt\)</span> of a
general vector <span class="math">\({\bf G}\)</span> as seen by an observer in the body system of axes will
differ from the corresponding change as seen by an observer in the space
system:</p>
<div class="math">
\[(d{\bf G})_{\rm space} = (d{\bf G})_{\rm body}+(d{\bf G})_{\rm rot}\]</div>
<p>Now consider a vector fixed in the rigid body. Then <span class="math">\((d{\bf G})_{\rm body}=0\)</span>
and</p>
<div class="math">
\[(d{\bf G})_{\rm rot} = (d{\bf G})_{\rm space} = d\boldsymbol\Omega \times {\bf G}\]</div>
<p>For an arbitrary vector, the change relative to the space axes is the sum of
the two effects:</p>
<div class="math">
\[(d{\bf G})_{\rm space} = (d{\bf G})_{\rm body}+d\boldsymbol\Omega \times {\bf G}\]</div>
<p>A more rigorous derivation of the last equation follows from:</p>
<div class="math">
\[G_i = a_{ji}G'_j\]</div>
<div class="math">
\[dG_i = a_{ji}dG'_j + da_{ji}G'_j\]</div>
<p>Let&#8217;s make the space and body instantaneously coincident at time t, then
<span class="math">\(a_{ji} = \delta_{ji}\)</span> and
<span class="math">\(da_{ji}=-\epsilon_{ijk}d\Omega_k=\epsilon_{ikj}d\Omega_k\)</span>, so
we get the same equation as earlier:</p>
<div class="math">
\[dG_i = dG'_i + \epsilon_{ikj}d\Omega_kG'_j\]</div>
<p>Anyhow, introducing <span class="math">\(\boldsymbol\omega\)</span> by:</p>
<div class="math">
\[\boldsymbol\omega = {d\boldsymbol\Omega\over dt}\]</div>
<p>we get</p>
<div class="math">
\[\left({d{\bf G}\over dt}\right)_{\rm space} = \left({d{\bf G}\over dt}\right)_{\rm body} + \boldsymbol\omega \times {\bf G}\]</div>
</div>
<div class="section" id="linear-elasticity-equations-in-cylindrical-coordinates">
<h3>Linear Elasticity Equations in Cylindrical Coordinates<a class="headerlink" href="#linear-elasticity-equations-in-cylindrical-coordinates" title="Permalink to this headline">¶</a></h3>
<p>Authors: Pavel Solin &amp; Lenka Dubcova</p>
<p>In this paper we derive the weak formulation of linear elasticity equations suitable
for the finite element discretization of axisymmetric 3D problems.</p>
<div class="section" id="original-equations-in-cartesian-coordinates">
<h4>Original equations in Cartesian coordinates<a class="headerlink" href="#original-equations-in-cartesian-coordinates" title="Permalink to this headline">¶</a></h4>
<p>Let&#8217;s start with some notations: By <span class="math">\(\bfu = (u_1, u_2, u_3)^T\)</span> we denote the displacement vector in
3D Cartesian coordinates, and by <span class="math">\(\epsilon\)</span> the tensor of small deformations,</p>
<div class="math">
\[\epsilon_{ij} = \frac{1}{2}\left(\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i}   \right),\ \ \ \ 1 \le i,j \le 3.\]</div>
<p>The stress tensor <span class="math">\(\sigma\)</span> has the form</p>
<div class="math" id="equation-0a">
<span class="eqno">(10)</span>\[   \sigma_{ij} = \lambda \delta_{ij}\mbox{div}\bfu + 2\mu \epsilon_{ij},\ \ \ \ 1 \le i,j \le 3,\]</div>
<p>where</p>
<div class="math">
\[\mbox{div}\bfu = \sum_{k=1}^3 \frac{\partial u_k}{\partial x_k} = \sum_{k=1}^3 \epsilon_{kk} = \mbox{Tr}(\epsilon).\]</div>
<p>The symbols <span class="math">\(\lambda\)</span> and <span class="math">\(\mu\)</span> are the Lam&#8217;e constants and <span class="math">\(\delta_{ij}\)</span> is the Kronecker
symbol (<span class="math">\(\delta_{ij} = 1\)</span> if <span class="math">\(i = j\)</span> and <span class="math">\(\delta_{ij} = 0\)</span> otherwise).
The equilibrium equations have the form</p>
<div class="math" id="equation-0b">
<span class="eqno">(11)</span>\[   \sum_{j=1}^3 \frac{\partial \sigma_{ij}}{\partial x_j} + f_i = 0,\ \ \ \ 1 \le i \le 3,\]</div>
<p>where <span class="math">\((f_1, f_2, f_3)^T\)</span> is the vector of internal forces (such as gravity).</p>
<p>The boundary conditions for linear elasticity are given by</p>
<div class="math">
\[\begin{eqnarray*}  u_i &=& \hat{u}_i \quad \mbox{on} \ \Gamma_1\\ \sum_{j=1}^3 \sigma_{ij} n_j &=& g_i \quad \mbox{on} \ \Gamma_2, \end{eqnarray*}\]</div><p>where <span class="math">\(g_i\)</span> are surface forces.</p>
</div>
<div class="section" id="weak-formulation">
<h4>Weak formulation<a class="headerlink" href="#weak-formulation" title="Permalink to this headline">¶</a></h4>
<p>Multiplying by test functions and integrating over the domain <span class="math">\(\Omega\)</span> we obtain</p>
<div class="math" id="equation-1a">
<span class="eqno">(12)</span>\[   - \int_{\Omega}\sum_{j=1}^3 \frac{\partial \sigma_{ij}}{\partial x_j}v_i = \int_{\Omega}f_i\ v_i,\ \ \ \ 1 \le i \le 3.\]</div>
<p>Using Green&#8217;s theorem and the boundary conditions</p>
<div class="math">
\[\int_{\Omega}\sum_{j=1}^3 \sigma_{ij} \frac{\partial v_i}{\partial x_j} - \int_{\partial \Omega} \sum_{j=1}^3 \sigma_{ij} n_j v_i = \int_{\Omega}f_i\ v_i,\ \ \ \ 1 \le i \le 3.\]</div>
<p>Thus</p>
<div class="math" id="equation-1b">
<span class="eqno">(13)</span>\[   \int_{\Omega}\sum_{j=1}^3 \sigma_{ij} \frac{\partial v_i}{\partial x_j} - \int_{\Gamma_2} g_i v_i = \int_{\Omega}f_i\ v_i,\ \ \ \ 1 \le i \le 3.\]</div>
<p>Let us write the equations <a href="#equation-1b">(13)</a> in detail using relation <a href="#equation-0a">(10)</a></p>
<div class="math" id="equation-weak">
\[\begin{eqnarray*}
\int_{\Omega} \left[\lambda \mbox{div}u + 2 \mu \frac{\partial u_1}{\partial x_1}\right] \frac{\partial v_1}{\partial x_1} + \mu \left(\frac{\partial u_1}{\partial x_2} + \frac{\partial u_2}{\partial x_1}\right)\frac{\partial v_1}{\partial x_2} + \mu \left(\frac{\partial u_1}{\partial x_3} + \frac{\partial u_3}{\partial x_1}\right)\frac{\partial v_1}{\partial x_3}
- \int_{\Gamma_2} g_1 v_1 &=& \int_{\Omega}f_1\ v_1,\nonumber\\
\int_{\Omega} \mu \left(\frac{\partial u_1}{\partial x_2} + \frac{\partial u_2}{\partial x_1}\right)\frac{\partial v_2}{\partial x_1} + \left[\lambda \mbox{div}u + 2 \mu \frac{\partial u_2}{\partial x_2}\right] \frac{\partial v_2}{\partial x_2} + \mu \left(\frac{\partial u_2}{\partial x_3} + \frac{\partial u_3}{\partial x_2}\right)\frac{\partial v_2}{\partial x_3}
- \int_{\Gamma_2} g_2 v_2 &=& \int_{\Omega}f_2\ v_2,\\
\int_{\Omega} \mu \left(\frac{\partial u_1}{\partial x_3} + \frac{\partial u_3}{\partial x_1}\right)\frac{\partial v_3}{\partial x_1} + \mu \left(\frac{\partial u_2}{\partial x_3} + \frac{\partial u_3}{\partial x_2}\right)\frac{\partial v_3}{\partial x_2}  + \left[\lambda \mbox{div}u + 2 \mu \frac{\partial u_3}{\partial x_3}\right] \frac{\partial v_3}{\partial x_3}
- \int_{\Gamma_2} g_3 v_3 &=& \int_{\Omega}f_3\ v_3.\nonumber
\end{eqnarray*}\]</div></div>
<div class="section" id="elementary-transformation-relations">
<h4>Elementary transformation relations<a class="headerlink" href="#elementary-transformation-relations" title="Permalink to this headline">¶</a></h4>
<p>First let us show how the partial derivatives of a scalar function <span class="math">\(g\)</span> are transformed
from Cartesian coordinates <span class="math">\(x_1, x_2, x_3\)</span> to cylindrical coordinates <span class="math">\(r, \phi, z\)</span>.
Note that</p>
<div class="math">
\[x_1(r, \phi) = r \cos \phi, \ \ \ x_2(r, \phi) = r \sin \phi, \ \ \ x_3(z) = z.\]</div>
<p>Since</p>
<div class="math">
\[g(x_1, x_2, x_3) = g(x_1(r, \phi), x_2(r, \phi), x_3(z)),\]</div>
<p>it is</p>
<div class="math">
\[\begin{eqnarray*}
\frac{\partial g}{\partial r} &=& \frac{\partial g}{\partial x_1}\cos\phi +  \frac{\partial g}{\partial x_2}\sin\phi,\nonumber \\
\frac{\partial g}{\partial \phi} &=& \frac{\partial g}{\partial x_1}(-r\sin\phi) +  \frac{\partial g}{\partial x_2}r\cos\phi,\nonumber\\
\frac{\partial g}{\partial z} &=&\frac{\partial g}{\partial x_3}.\nonumber
\end{eqnarray*}\]</div><p>From here we obtain</p>
<div class="math" id="equation-1">
\[\begin{eqnarray*}
\frac{\partial g}{\partial x_1} &=& \frac{\partial g}{\partial r}\cos\phi - \frac{1}{r}\frac{\partial g}{\partial \phi}\sin\phi,\nonumber \\
\frac{\partial g}{\partial x_2} &=& \frac{\partial g}{\partial r}\sin\phi + \frac{1}{r}\frac{\partial g}{\partial \phi}\cos\phi, \\
\frac{\partial g}{\partial x_3} &=& \frac{\partial g}{\partial z}. \nonumber
\end{eqnarray*}\]</div><p>The relations between displacement components in Cartesian and cylindrical
coordinates are</p>
<div class="math" id="equation-2">
\[\begin{eqnarray*}
u_1 &=& u_r \cos \phi, \nonumber \\
u_2 &=& u_r \sin \phi, \nonumber \\
u_3 &=& u_z. \nonumber
\end{eqnarray*}\]</div><p>The same relations hold for surface forces <span class="math">\(g_i\)</span> and volume forces <span class="math">\(f_i\)</span>.</p>
<p>Applying <a href="#equation-1">(15)</a> to <span class="math">\(u_1\)</span>, we obtain</p>
<div class="math">
\[\begin{eqnarray*}
\frac{\partial u_1}{\partial x_1} &=& \frac{\partial u_1}{\partial r}\cos\phi - \frac{1}{r}\frac{\partial u_1}{\partial \phi}\sin\phi,\nonumber \\
\frac{\partial u_1}{\partial x_2} &=& \frac{\partial u_1}{\partial r}\sin\phi + \frac{1}{r}\frac{\partial u_1}{\partial \phi}\cos\phi, \nonumber \\
\frac{\partial u_1}{\partial x_3} &=& \frac{\partial u_1}{\partial z}. \nonumber
\end{eqnarray*}\]</div><p>Using <a href="#equation-2">(16)</a> and the fact that <span class="math">\(u_r\)</span> does not depend on <span class="math">\(\phi\)</span>, this yields</p>
<div class="math">
\[\begin{eqnarray*}
\frac{\partial u_1}{\partial x_1} &=& \frac{\partial u_r}{\partial r}\cos^2\phi + \frac{1}{r} u_r\sin^2\phi,\nonumber \\
\frac{\partial u_1}{\partial x_2} &=& \frac{\partial u_r}{\partial r}\cos\phi\sin\phi - \frac{1}{r}u_r \cos\phi\sin\phi, \nonumber \\
\frac{\partial u_1}{\partial x_3} &=& \frac{\partial u_r}{\partial z}\cos\phi. \nonumber
\end{eqnarray*}\]</div><p>Analogously, for <span class="math">\(u_2\)</span> we calculate</p>
<div class="math">
\[\begin{eqnarray*}
\frac{\partial u_2}{\partial x_1} &=& \frac{\partial u_r}{\partial r}\cos\phi\sin\phi - \frac{1}{r}u_r \cos\phi\sin\phi, \nonumber \\
\frac{\partial u_2}{\partial x_2} &=& \frac{\partial u_r}{\partial r}\sin^2\phi + \frac{1}{r} u_r\cos^2\phi,\nonumber \\
\frac{\partial u_2}{\partial x_3} &=& \frac{\partial u_r}{\partial z}\sin\phi. \nonumber
\end{eqnarray*}\]</div><p>For <span class="math">\(u_3\)</span>, using that it does not depend on <span class="math">\(\phi\)</span>, we have</p>
<div class="math">
\[\begin{eqnarray*}
\frac{\partial u_3}{\partial x_1} &=& \frac{\partial u_z}{\partial r}\cos\phi, \nonumber \\
\frac{\partial u_3}{\partial x_2} &=& \frac{\partial u_z}{\partial r}\sin\phi,\nonumber \\
\frac{\partial u_3}{\partial x_3} &=& \frac{\partial u_z}{\partial z}. \nonumber
\end{eqnarray*}\]</div><p>For further reference, transform also <span class="math">\(\mbox{div}u\)</span> into cylindrical
coordinates</p>
<div class="math">
\[\begin{eqnarray*} \mbox{div}u &=& \frac{\partial u_1}{\partial x_1} + \frac{\partial u_2}{\partial x_2} + \frac{\partial u_3}{\partial x_3} = \\ &=& \frac{\partial u_r}{\partial r}\cos^2\phi + \frac{1}{r} u_r\sin^2\phi + \frac{\partial u_r}{\partial r}\sin^2\phi + \frac{1}{r} u_r\cos^2\phi + \frac{\partial u_z}{\partial z} = \\ &=& \frac{\partial u_r}{\partial r} + \frac{1}{r} u_r + \frac{\partial u_z}{\partial z}  \end{eqnarray*}\]</div></div>
<div class="section" id="axisymmetric-formulation">
<h4>Axisymmetric formulation<a class="headerlink" href="#axisymmetric-formulation" title="Permalink to this headline">¶</a></h4>
<p>Assuming that the domain <span class="math">\(\Omega\)</span> is axisymmetric,
we can begin to transform the integrals in <a href="#equation-weak">(14)</a> to cylindrical coordinates.
Recall that the Jacobian of the transformation is <span class="math">\(J(r, \phi, z) = r\)</span>. The first equation in <a href="#equation-weak">(14)</a> has the form:</p>
<div class="math">
\[\begin{eqnarray*} &&\int_{\Omega} r \left[\lambda (\frac{\partial u_r}{\partial r} + \frac{1}{r} u_r + \frac{\partial u_z}{\partial z}) + 2 \mu (\frac{\partial u_r}{\partial r}\cos^2\phi + \frac{1}{r} u_r\sin^2\phi)\right] (\frac{\partial v_r}{\partial r}\cos^2\phi + \frac{1}{r} v_r\sin^2\phi) + \\ &&r 2 \mu \left(\frac{\partial u_r}{\partial r}\cos\phi\sin\phi - \frac{1}{r}u_r \cos\phi\sin\phi\right)\left(\frac{\partial v_r}{\partial r}\cos\phi\sin\phi - \frac{1}{r}v_r \cos\phi\sin\phi\right) + \\ &&r \mu \left(\frac{\partial u_r}{\partial z}\cos\phi + \frac{\partial u_z}{\partial r}\cos\phi\right)\frac{\partial v_r}{\partial z}\cos\phi - \int_{\Gamma_2} r g_r v_r {\cos}^2 \phi = \int_{\Omega} r f_r\ v_r \cos^2 \phi, \end{eqnarray*}\]</div><p>The second equation in <a href="#equation-weak">(14)</a> has the form:</p>
<div class="math">
\[\begin{eqnarray*} &&\int_{\Omega} r 2\mu \left(\frac{\partial u_r}{\partial r}\cos\phi\sin\phi - \frac{1}{r}u_r \cos\phi\sin\phi\right)\left(\frac{\partial v_r}{\partial r}\cos\phi\sin\phi - \frac{1}{r}v_r \cos\phi\sin\phi\right) +\\ && r \left[\lambda (\frac{\partial u_r}{\partial r} + \frac{1}{r} u_r + \frac{\partial u_z}{\partial z}) + 2 \mu (\frac{\partial u_r}{\partial r}\sin^2\phi + \frac{1}{r} u_r\cos^2\phi)\right] (\frac{\partial v_r}{\partial r}\sin^2\phi + \frac{1}{r} v_r\cos^2\phi) + \\ && r \mu \left(\frac{\partial u_r}{\partial z}\sin\phi + \frac{\partial u_z}{\partial r}\sin\phi\right)(\frac{\partial v_r}{\partial z}\sin\phi)  - \int_{\Gamma_2}r g_r v_r \sin^2 \phi = \int_{\Omega}r f_r\ v_r \sin^2 \phi,\\ \end{eqnarray*}\]</div><p>Adding these two equations together we get</p>
<div class="math">
\[\begin{eqnarray*} &&\int_{\Omega} r \lambda (\frac{\partial u_r}{\partial r} + \frac{1}{r} u_r + \frac{\partial u_z}{\partial z}) (\frac{\partial v_r}{\partial r} + \frac{1}{r} v_r) + \\ &&\int_{\Omega} r \mu \left[ 2 \left(\frac{\partial u_r}{\partial r}\frac{\partial v_r}{\partial r}\cos^4\phi + \frac{1}{r} u_r \frac{\partial v_r}{\partial r}\sin^2 \phi \cos^2 \phi + \frac{1}{r}\frac{\partial u_r}{\partial r} v_r\sin^2 \phi \cos^2 \phi + \frac{1}{r^2} u_r v_r\sin^4\phi\right) +\right.\\ &&\qquad\ \left.2 \left(\frac{\partial u_r}{\partial r}\frac{\partial v_r}{\partial r}\sin^4\phi + \frac{1}{r} u_r \frac{\partial v_r}{\partial r}\sin^2 \phi \cos^2 \phi + \frac{1}{r}\frac{\partial u_r}{\partial r} v_r\sin^2 \phi \cos^2 \phi + \frac{1}{r^2} u_r v_r\cos^4\phi\right) + \right. \\ && \left. 4 \left( \frac{\partial u_r}{\partial r}\frac{\partial v_r}{\partial r}\cos^2\phi\sin^2\phi - \frac{1}{r}u_r\frac{\partial v_r}{\partial r} \cos^2\phi\sin^2\phi - \frac{1}{r} \frac{\partial u_r}{\partial r} v_r \cos^2\phi\sin^2\phi + \frac{1}{r^2}u_r v_r \cos^2\phi\sin^2\phi\right)\right. + \\ && \left. \left(\frac{\partial u_r}{\partial z}\frac{\partial v_r}{\partial z} + \frac{\partial u_z}{\partial r}\frac{\partial v_r}{\partial z}\right)\right]  - \int_{\Gamma_2} g_r v_r r= \int_{\Omega}f_r\ v_r r \end{eqnarray*}\]</div><p>This can be simplified to</p>
<div class="math">
\[\int_{\Omega} r \lambda (\frac{\partial u_r}{\partial r} + \frac{1}{r} u_r + \frac{\partial u_z}{\partial z}) (\frac{\partial v_r}{\partial r} + \frac{1}{r} v_r) + \int_{\Omega} r \mu \left[ 2 \left(\frac{\partial u_r}{\partial r}\frac{\partial v_r}{\partial r} + \frac{1}{r^2} u_r v_r\right) +  \left(\frac{\partial u_r}{\partial z}\frac{\partial v_r}{\partial z} + \frac{\partial u_z}{\partial r}\frac{\partial v_r}{\partial z}\right)\right]\]</div>
<div class="math">
\[- \int_{\Gamma_2} g_r v_r r = \int_{\Omega}f_r\ v_r r\]</div>
<p>Finally, the third equation in <a href="#equation-weak">(14)</a> has the form</p>
<div class="math">
\[\begin{eqnarray*} && \int_{\Omega} r \mu \left(\frac{\partial u_r}{\partial z}\cos\phi + \frac{\partial u_z}{\partial r}\cos\phi\right)\frac{\partial v_z}{\partial r}\cos\phi + r \mu \left(\frac{\partial u_r}{\partial z}\sin\phi + \frac{\partial u_z}{\partial r}\sin\phi\right)\frac{\partial v_z}{\partial r}\sin\phi  + \\ && r \left[\lambda (\frac{\partial u_r}{\partial r} + \frac{1}{r} u_r + \frac{\partial u_z}{\partial z} ) + 2 \mu \frac{\partial u_z}{\partial z}\right] \frac{\partial v_z}{\partial z} - \int_{\Gamma_2} g_z v_z  r = \int_{\Omega}f_z\ v_z r. \end{eqnarray*}\]</div><p>This gives us</p>
<div class="math">
\[\begin{eqnarray*} && \int_{\Omega} r \mu \left(\frac{\partial u_r}{\partial z}\frac{\partial v_z}{\partial r} + \frac{\partial u_z}{\partial r}\frac{\partial v_z}{\partial r} + 2 \frac{\partial u_z}{\partial z} \frac{\partial v_z}{\partial z}\right) +  r \lambda \left(\frac{\partial u_r}{\partial r} + \frac{1}{r} u_r + \frac{\partial u_z}{\partial z} \right)\frac{\partial v_z}{\partial z} - \int_{\Gamma_2} g_z v_z  r = \int_{\Omega}f_z\ v_z r. \end{eqnarray*}\]</div><p>Since the integrands do not depend on <span class="math">\(\phi\)</span>, we can simplify this to integral over <span class="math">\(\Omega_0\)</span>, where <span class="math">\(\Omega_0\)</span> is the intersection of the domain <span class="math">\(\Omega\)</span> with the <span class="math">\(x^+_1x_3\)</span> half-plane. Dividing both equations by <span class="math">\(2\pi\)</span> we get</p>
<div class="math">
\[\int_{\Omega_0} r \lambda (\frac{\partial u_r}{\partial r} + \frac{1}{r} u_r + \frac{\partial u_z}{\partial z}) (\frac{\partial v_r}{\partial r} + \frac{1}{r} v_r) + \int_{\Omega_0} r \mu \left[ 2 \left(\frac{\partial u_r}{\partial r}\frac{\partial v_r}{\partial r} + \frac{1}{r^2} u_r v_r\right) +  \left(\frac{\partial u_r}{\partial z}\frac{\partial v_r}{\partial z} + \frac{\partial u_z}{\partial r}\frac{\partial v_r}{\partial z}\right)\right]\]</div>
<div class="math">
\[- \int_{\Gamma_2} g_r v_r r = \int_{\Omega_0}f_r\ v_r r\]</div>
<div class="math">
\[\int_{\Omega_0} r \mu \left(\frac{\partial u_r}{\partial z}\frac{\partial v_z}{\partial r} + \frac{\partial u_z}{\partial r}\frac{\partial v_z}{\partial r} + 2 \frac{\partial u_z}{\partial z} \frac{\partial v_z}{\partial z}\right) +  r \lambda \left(\frac{\partial u_r}{\partial r} + \frac{1}{r} u_r + \frac{\partial u_z}{\partial z} \right)\frac{\partial v_z}{\partial z} - \int_{\Gamma_2} g_z v_z  r = \int_{\Omega_0}f_z\ v_z r.\]</div>
</div>
<div class="section" id="coordinate-independent-way">
<h4>Coordinate Independent Way<a class="headerlink" href="#coordinate-independent-way" title="Permalink to this headline">¶</a></h4>
<p>Let&#8217;s write the elasticity equations in the cartesian coordinates again:</p>
<div class="math">
\[\sigma_{ij} = \lambda \delta_{ij}\partial_k u^k + \mu
    (\partial_j u_i + \partial_i u_j)\]\[\partial_j \sigma^{ij} + f^i = 0\]</div>
<p>Those only work in the cartesian coordinates, so we first write them in a
coordinate independent way:</p>
<div class="math">
\[\sigma^{ij} = \lambda g^{ij}\nabla_k u^k + \mu
    (\nabla^j u^i + \nabla^i u^j)\]\[\nabla_j \sigma^{ij} + f^i = 0\]</div>
<p>so:</p>
<div class="math">
\[\nabla_j \left( \lambda g^{ij}\nabla_k u^k + \mu
    (\nabla^j u^i + \nabla^i u^j) \right) + f^i = 0\]</div>
<p>The weak formulation is then (do not sum over <span class="math">\(i\)</span>):</p>
<div class="math">
\[-\int \nabla_j \left( \lambda g^{ij}\nabla_k u^k + \mu
    (\nabla^j u^i + \nabla^i u^j) \right) v^i \sqrt{|g|}\d^3x
    = \int f^i v^i\sqrt{|g|}\d^3x\]</div>
<p>We apply the integration by parts:</p>
<div class="math">
\[\int \left( \lambda g^{ij}\nabla_k u^k + \mu
    (\nabla^j u^i + \nabla^i u^j) \right) \nabla_j v^i \sqrt{|g|}\d^3x
    = \int f^i v^i\sqrt{|g|}\d^3x\]</div>
<p>This is the weak formulation valid in any coordinates. Using the cylindrical
coordinates (see above) we get:</p>
<div class="math">
\[{\bf x} = (\rho, \phi, z)\]\[\d^3 x = \d\rho\, \d \phi\, \d z\]\[\begin{split}g^{ij} = \mat{1 &amp; 0 &amp; 0\cr 0 &amp; 1\over\rho^2 &amp; 0\cr 0 &amp; 0 &amp; 1\cr}\end{split}\]\[\sqrt{|g|} = \sqrt{|\det g_{ij}|} = \rho\]\[\nabla_k u^k = {1\over\sqrt{|g|}}\partial_k (\sqrt{|g|} u^k) =
    {1\over\rho}\partial_k (\rho u^k) =\]\[= {1\over\rho} u^\rho + \partial_\rho u^\rho + \partial_\phi u^\phi +
    \partial_z u^z\]\[(\nabla^j u^z + \nabla^z u^j) \nabla_j v^z =
    (g^{jk}\nabla_k u^z + g^{zk}\nabla_k u^j) \nabla_j v^z =
    (\partial_\rho u^z + \partial_z u^\rho) \partial_\rho v^z +
    (\partial_z u^z + \partial_z u^z) \partial_z v^z
    =\]\[= (\partial_\rho u^z + \partial_z u^\rho) \partial_\rho v^z +
    2\partial_z u^z \partial_z v^z\]\[g^{\rho j}\nabla_j v^\rho = g^{\rho\rho}\nabla_\rho v^\rho =
    \partial_\rho v^\rho + \Gamma^\rho_{k\rho} v^k =
    \partial_\rho v^\rho + {1\over\rho} v^\phi\]\[g^{\phi j}\nabla_j v^\phi = g^{\phi\phi}\nabla_\phi v^\phi =
    {1\over\rho^2}(\partial_\phi v^\phi + \Gamma^\phi_{k\phi} v^k )=
    {1\over\rho^2}(\partial_\phi v^\phi + {1\over\rho} v^\rho )=\]\[g^{zj}\nabla_j v^z = g^{zz}\nabla_z v^z =
    \partial_z v^z + \Gamma^z_{kz} v^k = \partial_z v^z\]\[\int \left( \lambda g^{ij}\left(
{1\over\rho} u^\rho + \partial_\rho u^\rho + \partial_\phi u^\phi +
    \partial_z u^z
\right) + \mu
    (\nabla^j u^i + \nabla^i u^j) \right) \nabla_j v^i
    \rho \,\d\rho\, \d \phi\, \d z
    = \int f^i v^i \rho \,\d\rho\, \d \phi\, \d z\]</div>
<p>for <span class="math">\(i=1, 2, 3\)</span> we get:</p>
<div class="math">
\[\int \lambda \left(
{1\over\rho} u^\rho + \partial_\rho u^\rho + \partial_\phi u^\phi +
    \partial_z u^z
\right)\left(\partial_\rho v^\rho + {1\over\rho} v^\phi\right)\rho + \mu
\left(2\partial_\rho u^\rho \partial_\rho v^\rho +
    (\partial_z u^\rho +\partial_\rho u^z)\partial_z v^\rho\right)
    \rho \,\d\rho\, \d \phi\, \d z
    = \int f^\rho v^\rho \rho \,\d\rho\, \d \phi\, \d z\]\[\int \lambda \left(
{1\over\rho} u^\rho + \partial_\rho u^\rho + \partial_\phi u^\phi +
    \partial_z u^z
\right){1\over\rho^2}\left(\partial_\phi v^\phi + {1\over\rho} v^\rho \right)\rho + \mu
\left(2\partial_\rho u^\rho \partial_\rho v^\rho +
    (\partial_z u^\rho +\partial_\rho u^z)\partial_z v^\rho\right)
    \rho \,\d\rho\, \d \phi\, \d z
    = \int f^\phi v^\phi \rho \,\d\rho\, \d \phi\, \d z\]\[\int \lambda \left(
{1\over\rho} u^\rho + \partial_\rho u^\rho + \partial_\phi u^\phi +
    \partial_z u^z
\right)\partial_z v^z\rho + \mu
\left((\partial_\rho u^z + \partial_z u^\rho) \partial_\rho v^z +
    2\partial_z u^z \partial_z v^z\right)
    \rho \,\d\rho\, \d \phi\, \d z
    = \int f^z v^z \rho \,\d\rho\, \d \phi\, \d z\]</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Differential Geometry</a><ul>
<li><a class="reference internal" href="#manifolds">Manifolds</a><ul>
<li><a class="reference internal" href="#scalars-vectors-tensors">Scalars, Vectors, Tensors</a></li>
<li><a class="reference internal" href="#covariant-differentiation">Covariant differentiation</a></li>
<li><a class="reference internal" href="#parallel-transport">Parallel transport</a></li>
<li><a class="reference internal" href="#fermi-walker-transport">Fermi-Walker transport</a></li>
<li><a class="reference internal" href="#geodesics">Geodesics</a></li>
<li><a class="reference internal" href="#riemann-curvature-tensor">Riemann Curvature Tensor</a></li>
<li><a class="reference internal" href="#lie-derivative">Lie derivative</a></li>
<li><a class="reference internal" href="#metric">Metric</a><ul>
<li><a class="reference internal" href="#diagonal-metric">Diagonal Metric</a></li>
</ul>
</li>
<li><a class="reference internal" href="#symmetries-killing-vectors">Symmetries, Killing vectors</a></li>
<li><a class="reference internal" href="#symmetry-and-antisymmetry">Symmetry and Antisymmetry</a><ul>
<li><a class="reference internal" href="#example-i">Example I</a></li>
<li><a class="reference internal" href="#example-ii">Example II</a></li>
<li><a class="reference internal" href="#example-iii">Example III</a></li>
</ul>
</li>
<li><a class="reference internal" href="#divergence-operator">Divergence Operator</a></li>
<li><a class="reference internal" href="#laplace-operator">Laplace Operator</a></li>
<li><a class="reference internal" href="#covariant-integration">Covariant integration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#weak-formulation-of-laplace-equation">Weak Formulation of Laplace Equation</a></li>
<li><a class="reference internal" href="#cylindrical-coordinates">Cylindrical Coordinates</a></li>
<li><a class="reference internal" href="#spherical-coordinates">Spherical Coordinates</a></li>
<li><a class="reference internal" href="#rotating-disk">Rotating Disk</a></li>
<li><a class="reference internal" href="#linear-elasticity-equations-in-cylindrical-coordinates">Linear Elasticity Equations in Cylindrical Coordinates</a><ul>
<li><a class="reference internal" href="#original-equations-in-cartesian-coordinates">Original equations in Cartesian coordinates</a></li>
<li><a class="reference internal" href="#weak-formulation">Weak formulation</a></li>
<li><a class="reference internal" href="#elementary-transformation-relations">Elementary transformation relations</a></li>
<li><a class="reference internal" href="#axisymmetric-formulation">Axisymmetric formulation</a></li>
<li><a class="reference internal" href="#coordinate-independent-way">Coordinate Independent Way</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="la.html"
                        title="previous chapter">Linear Algebra</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="operators.html"
                        title="next chapter">Operators</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/math/differential-geometry.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="operators.html" title="Operators"
             >next</a> |</li>
        <li class="right" >
          <a href="la.html" title="Linear Algebra"
             >previous</a> |</li>
        <li><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &raquo;</li>
          <li><a href="main.html" >Mathematics</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b3.
    </div>
  </body>
</html>