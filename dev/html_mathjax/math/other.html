
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>3.15. Delta Function &#8212; Theoretical Physics Reference 0.5 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.29. Legendre Polynomials" href="spherical-harmonics.html" />
    <link rel="prev" title="3.10. Periodic Functions" href="trig.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head><body>
    <div style="display:none">
    \(
        \newcommand{\d}{\mathrm{d}}
        \newcommand{\bomega}{\vec\omega}
        \newcommand{\half}{ {1\over 2} }
        \def\mathnot#1{\text{"$#1$"}}

        %operators
        \newcommand{\diag}{\mathrm{diag}}
        \newcommand{\sinc}{\mathrm{sinc}}
        \newcommand{\Sh}{ {\large\style{font-family:Times}{\text{Ш}}} }
        \newcommand{\res}{\mathrm{Res}}
    \)
    </div>
    

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="spherical-harmonics.html" title="3.29. Legendre Polynomials"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="trig.html" title="3.10. Periodic Functions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" accesskey="U">3. Mathematics</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="delta-function">
<h1>3.15. Delta Function<a class="headerlink" href="#delta-function" title="Permalink to this headline">¶</a></h1>
<p>Delta function <span class="math notranslate nohighlight">\(\delta(x)\)</span> is defined such that this relation holds:</p>
<div class="math notranslate nohighlight" id="equation-deltadef">
<span class="eqno">(3.15.1)<a class="headerlink" href="#equation-deltadef" title="Permalink to this equation">¶</a></span>\[   \int f(x)\delta(x-t)\d x=f(t)\]</div>
<p>No such function exists, but one can find many sequences “converging” to a delta function:</p>
<div class="math notranslate nohighlight" id="equation-deltalim">
<span class="eqno">(3.15.2)<a class="headerlink" href="#equation-deltalim" title="Permalink to this equation">¶</a></span>\[   \lim_{\alpha\to\infty}\delta_\alpha(x) = \delta(x)\]</div>
<p>more precisely:</p>
<div class="math notranslate nohighlight" id="equation-deltaprec">
<span class="eqno">(3.15.3)<a class="headerlink" href="#equation-deltaprec" title="Permalink to this equation">¶</a></span>\[   \lim_{\alpha\to\infty}\int f(x)\delta_\alpha(x)\d x = \int f(x)\lim_{\alpha\to\infty}\delta_\alpha(x)\d x = f(0)\]</div>
<p>one example of such a sequence is:</p>
<div class="math notranslate nohighlight">
\[\delta_\alpha(x) = {1\over\pi x}\sin(\alpha x)\]</div>
<p>It’s clear that <a class="reference internal" href="#equation-deltaprec">(3.15.3)</a> holds for any well behaved function <span class="math notranslate nohighlight">\(f(x)\)</span>.
Some mathematicians like to say that it’s incorrect to use such a notation when
in fact the integral <a class="reference internal" href="#equation-deltadef">(3.15.1)</a> doesn’t “exist”, but we will not follow
their approach, because it is not important if something “exists” or not,
but rather if it is clear what we mean by our notation: <a class="reference internal" href="#equation-deltadef">(3.15.1)</a> is a
shorthand for <a class="reference internal" href="#equation-deltaprec">(3.15.3)</a> and <a class="reference internal" href="#equation-deltalim">(3.15.2)</a> gets a mathematically rigorous
meaning when you integrate both sides and use <a class="reference internal" href="#equation-deltadef">(3.15.1)</a> to arrive at
<a class="reference internal" href="#equation-deltaprec">(3.15.3)</a>.  Thus one uses the relations <a class="reference internal" href="#equation-deltadef">(3.15.1)</a>, <a class="reference internal" href="#equation-deltalim">(3.15.2)</a>,
<a class="reference internal" href="#equation-deltaprec">(3.15.3)</a> to derive all properties of the delta function.</p>
<p>Let’s give an example. Let <span class="math notranslate nohighlight">\({\bf\hat r}\)</span> be the unit vector in 3D and we can
label it using spherical coordinates <span class="math notranslate nohighlight">\({\bf\hat r}={\bf\hat r}(\theta,\phi)\)</span>.
We can also express it in cartesian coordinates as <span class="math notranslate nohighlight">\({\bf\hat
r}(\theta,\phi)=(\cos\phi\sin\theta,\sin\phi\sin\theta,\cos\theta)\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-deltar">
<span class="eqno">(3.15.4)<a class="headerlink" href="#equation-deltar" title="Permalink to this equation">¶</a></span>\[   f({\bf\hat r'})=\int\delta({\bf\hat r}-{\bf\hat r'})f({\bf\hat r})\,\d {\bf\hat r}\]</div>
<p>Expressing <span class="math notranslate nohighlight">\(f({\bf\hat r})=f(\theta,\phi)\)</span> as a function of <span class="math notranslate nohighlight">\(\theta\)</span> and
<span class="math notranslate nohighlight">\(\phi\)</span> we have</p>
<div class="math notranslate nohighlight" id="equation-deltaangles">
<span class="eqno">(3.15.5)<a class="headerlink" href="#equation-deltaangles" title="Permalink to this equation">¶</a></span>\[   f(\theta',\phi')=\int\delta(\theta-\theta')\delta(\phi-\phi') f(\theta,\phi)\,\d\theta\d\phi\]</div>
<p>Expressing <a class="reference internal" href="#equation-deltar">(3.15.4)</a> in spherical coordinates we get</p>
<div class="math notranslate nohighlight">
\[f(\theta',\phi')=\int\delta({\bf\hat r}-{\bf\hat r'}) f(\theta,\phi)\sin\theta\,\d\theta\d\phi\]</div>
<p>and comparing to <a class="reference internal" href="#equation-deltaangles">(3.15.5)</a> we finally get</p>
<div class="math notranslate nohighlight">
\[\delta({\bf\hat r}-{\bf\hat r'})={1\over\sin\theta} \delta(\theta-\theta')\delta(\phi-\phi')\]</div>
<p>In exactly the same manner we get</p>
<div class="math notranslate nohighlight">
\[\delta({\bf r}-{\bf r'})=\delta({\bf\hat r}-{\bf\hat r'}) {\delta(\rho-\rho')\over\rho^2}\]</div>
<p>See also <a class="reference internal" href="#equation-functionalderdel">(3.17.4.1)</a> for an example of how to deal with more
complex expressions involving the delta function like <span class="math notranslate nohighlight">\(\delta^2(x)\)</span>.</p>
<p>When integrating over finite interval, this formula is very useful:</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x)\delta(x-t)\d x = f(t) \theta(b-t) \theta(t-a)\]</div>
<p>in other words, the integral vanishes unless <span class="math notranslate nohighlight">\(a &lt; t &lt; b\)</span>. In the limit <span class="math notranslate nohighlight">\(a\to
-\infty\)</span> and <span class="math notranslate nohighlight">\(b\to\infty\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\theta(b-t) \to \theta(\infty - t) = 1\\\theta(t-a) \to \theta(t - (-\infty)) = \theta(t+\infty) = 1\end{aligned}\end{align} \]</div>
<p>Another integral that converges to a delta function is:</p>
<div class="math notranslate nohighlight">
\[{1\over 2\pi} \int_{-\infty}^\infty e^{i\omega x} \d x
    = \lim_{L\to\infty} {1\over 2\pi} \int_{-L}^L e^{i\omega x} \d x
    = \lim_{L\to\infty} {\sin \omega L \over \pi \omega} = \delta(\omega)\]</div>
</div>
<div class="section" id="distributions">
<h1>3.16. Distributions<a class="headerlink" href="#distributions" title="Permalink to this headline">¶</a></h1>
<p>Some mathematicians like to use distributions and a mathematical notation for
that, which I think is making things less clear, but nevertheless it’s
important to understand it too, so the notation is explained in this section,
but I discourage to use it – I suggest to only use the physical notation as
explained below. The math notation below is put into quotation marks, so that
it’s not confused with the physical notation.</p>
<p>The distribution is a functional and each function <span class="math notranslate nohighlight">\(f(x)\)</span> can be identified
with a distribution <span class="math notranslate nohighlight">\(\mathnot{T_f}\)</span> that it generates using this definition
(<span class="math notranslate nohighlight">\(\varphi(x)\)</span>
is a test function):</p>
<div class="math notranslate nohighlight">
\[\mathnot{T_f(\phi(x))} \equiv \int f(x)\varphi(x) \d x \equiv
\mathnot{f(\varphi(x))} \equiv \mathnot{(f(x), \varphi(x))}\]</div>
<p>besides that, one can also define distributions that can’t be identified with
regular functions, one example is a delta distribution (Dirac delta function):</p>
<div class="math notranslate nohighlight">
\[\mathnot{\delta(\phi(x))} \equiv \phi(0) \equiv \int \delta(x) \phi(x) \d x\]</div>
<p>The last integral is not used in mathematics, in physics on the other hand, the
first expressions (<span class="math notranslate nohighlight">\(\mathnot{\delta(\phi(x))}\)</span>) is not used, so <span class="math notranslate nohighlight">\(\delta(x)\)</span> always means
that you have to integrate it, as explained in the previous section, so it
behaves like a regular function (except that such a function doesn’t exist and
the precise mathematical meaning is only after you integrate it, or through the
identification above with distributions).</p>
<p>One then defines common operations via acting on the generating function, then
observes the pattern and defines it for all distributions. For example
differentiation:</p>
<div class="math notranslate nohighlight">
\[\mathnot{{\d\over\d x}T_f(\varphi)} =
\mathnot{T_{f'}(\varphi)} =
\int f'\varphi \d x =
-\int f\varphi' \d x =
\mathnot{-T_f(\varphi')}\]</div>
<p>so:</p>
<div class="math notranslate nohighlight">
\[\mathnot{{\d\over\d x}T(\varphi)} =
\mathnot{-T(\varphi')}\]</div>
<p>Multiplication:</p>
<div class="math notranslate nohighlight">
\[\mathnot{gT_f(\varphi)} =
\mathnot{T_{gf}(\varphi)} =
\int gf\varphi \d x =
\mathnot{T_f(g\varphi)}\]</div>
<p>so:</p>
<div class="math notranslate nohighlight">
\[\mathnot{gT(\varphi)} =
\mathnot{T(g\varphi)}\]</div>
<p>Fourier transform:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathnot{FT_f(\varphi)} =
\mathnot{T_{Ff}(\varphi)} =
\int F(f)\varphi \d x =\\=\int\left[\int e^{-ikx} f(k) \d k\right] \varphi(x) \d x
=\int f(k)\left[\int e^{-ikx} \varphi(x) \d x\right] \d k
=\int f(x)\left[\int e^{-ikx} \varphi(k) \d k\right] \d x
=\\=
\int f F(\varphi) \d x =
\mathnot{T_f(F\varphi)}\end{aligned}\end{align} \]</div>
<p>so:</p>
<div class="math notranslate nohighlight">
\[\mathnot{FT(\varphi)} =
\mathnot{T(F\varphi)}\]</div>
<p>But as you can see, the notation is just making things more complex, since it’s
enough to just work with the integrals and forget about the rest. One can then
even omit the integrals, with the understanding that they are implicit.</p>
<p>Some more examples:</p>
<div class="math notranslate nohighlight">
\[\int \delta(x-x_0)\varphi(x) \d x = \int \delta(x)\varphi(x+x_0) \d x
= \varphi(x_0) \equiv \mathnot{\delta(\varphi(x+x_0))}\]</div>
<p>Proof of <span class="math notranslate nohighlight">\(\delta(-x) = \delta(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int_{-\infty}^\infty \delta(-x)\varphi(x)\d x =
-\int_{\infty}^{-\infty} \delta(y)\varphi(-y)\d y =
\int_{-\infty}^\infty \delta(x)\varphi(-x)\d x
\equiv \mathnot{\delta(\varphi(-x))} = \varphi(0)
=\mathnot{\delta(\phi(x))}
\equiv
\int_{-\infty}^\infty \delta(x)\varphi(x)\d x\]</div>
<p>Proof of <span class="math notranslate nohighlight">\(x\delta(x) = 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int x\delta(x)\varphi(x)\d x = \mathnot{\delta(x\varphi(x))}
= 0 \cdot \varphi(0) = 0\]</div>
<p>Proof of <span class="math notranslate nohighlight">\(\delta(cx) = {\delta(x)\over |c|}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int \delta(cx)\varphi(x)\d x = {1\over|c|}\int\delta(x)\varphi\left({x\over
c}\right)\d x
=\mathnot{\delta\left(\varphi\left({x\over c}\right)\over|c|\right)}
={\delta(0)\over|c|}
=\mathnot{{\delta(\varphi(x))\over|c|}}
=
\int {\delta(x)\over |c|}\varphi(x)\d x\]</div>
<p>To prove that <span class="math notranslate nohighlight">\(\lim_{L\to\infty} {1\over\pi x}\sin(L x)=\delta(x)\)</span> we do the
following calculation:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\left[\int_{-\infty}^\infty \lim_{L\to\infty} {1\over\pi x}\sin(L x)
    \varphi(x) \d x\right] - \varphi(0) =\\= \lim_{L\to\infty} \int_{-\infty}^\infty {1\over\pi x}\sin(L x)
    (\varphi(x)-\varphi(0)) \d x =\\= \lim_{L\to\infty} {1\over\pi} \int_{-\infty}^\infty
    {\varphi(x)-\varphi(0)\over x} \sin(L x) \d x =\\= \lim_{L\to\infty} {1\over\pi} \int_{-\infty}^\infty
    h(x) \sin(L x) \d x = 0\end{aligned}\end{align} \]</div>
<p>where the function <span class="math notranslate nohighlight">\(h(x) = {\varphi(x)-\varphi(0)\over x}\)</span> is bounded and <span class="math notranslate nohighlight">\(h(0)
=\lim_{x\to0}{\varphi(x)-\varphi(0)\over x}=\varphi'(0)\)</span> is finite since the
test function <span class="math notranslate nohighlight">\(\varphi(x)\)</span> is infinitely differentiable. From the
Riemann–Lebesgue lemma, the integral then converges towards zero as
<span class="math notranslate nohighlight">\(L\to\infty\)</span>.</p>
</div>
<div class="section" id="variations-and-functional-derivatives">
<span id="index-0"></span><h1>3.17. Variations and Functional Derivatives<a class="headerlink" href="#variations-and-functional-derivatives" title="Permalink to this headline">¶</a></h1>
<p>Variations and functional derivatives are generalization of differentials and
partial derivatives to functionals. It is important to master this subject just
like regular differentials/derivatives in calculus.</p>
<div class="section" id="functions-of-one-variable">
<h2>3.17.1. Functions of One Variable<a class="headerlink" href="#functions-of-one-variable" title="Permalink to this headline">¶</a></h2>
<p>Let’s first review differentials and derivatives of functions of one variable.
We will use an approach that directly generalizes to multivariable functions
and functionals.
The differential <span class="math notranslate nohighlight">\(\d f\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[\d f
    \equiv \lim_{\varepsilon\to0} {f(x+\varepsilon h)
        -f(x)\over\varepsilon}
    = a h\]</div>
<p>Last equality follows from the fact, that the limit is a linear function of
<span class="math notranslate nohighlight">\(h\)</span>:</p>
<div class="math notranslate nohighlight">
\[\lim_{\varepsilon\to0} {f(x+\varepsilon h) -f(x)\over\varepsilon}
    = \lim_{\eta\to0} {f(x+\eta) -f(x)\over\left(\eta\over h\right)}
    = \left(\lim_{\eta\to0} {f(x+\eta) -f(x)\over\eta}\right) h\]</div>
<p>Where we used the substitution <span class="math notranslate nohighlight">\(\eta = \varepsilon h\)</span>.
We define the derivative <span class="math notranslate nohighlight">\(\d f\over \d x\)</span> as:</p>
<div class="math notranslate nohighlight">
\[{\d f\over \d x} = a\]</div>
<p>To get a formula for <span class="math notranslate nohighlight">\({\d f\over \d x}\)</span>, we set <span class="math notranslate nohighlight">\(h=1\)</span> and get:</p>
<div class="math notranslate nohighlight">
\[{\d f\over \d x} = a = a \cdot 1
    = \lim_{\varepsilon\to0} {f(x+\varepsilon \cdot 1)-f(x)\over\varepsilon}
    = \lim_{\varepsilon\to0} {f(x+\varepsilon)-f(x)\over\varepsilon}\]</div>
<p>Using the formulas above we get an equivalent expression for the
differential:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\left.{\d\over\d\varepsilon}f(x+\varepsilon h) \right|_{\varepsilon=0}
    = \left.\lim_{\eta\to0} {f(x+(\varepsilon+\eta) h)
        -f(x+\varepsilon h)\over\eta}\right|_{\varepsilon=0} =\\    = \lim_{\eta\to0} {f(x+\eta h) -f(x)\over\eta} =\\    = \lim_{\varepsilon\to0} {f(x+\varepsilon h) -f(x)\over\varepsilon}\end{aligned}\end{align} \]</div>
<p>So we get a general formula (the analogy of which we will use later):</p>
<div class="math notranslate nohighlight">
\[\d f
    \equiv\left.{\d\over\d\varepsilon}f(x+\varepsilon h)
        \right|_{\varepsilon=0}
    = \lim_{\varepsilon\to0} {f(x+\varepsilon h)
        -f(x)\over\varepsilon}
    = a h\]</div>
<p>The variable <span class="math notranslate nohighlight">\(x\)</span> can be treated as a function (a very simple one):</p>
<div class="math notranslate nohighlight">
\[x = g(x)\]</div>
<p>So we define <span class="math notranslate nohighlight">\(\d x\)</span> as:</p>
<div class="math notranslate nohighlight">
\[\d x \equiv \d g = {\d g\over\d x} h = h\]</div>
<p>As such, <span class="math notranslate nohighlight">\(\d x\)</span> can have two meanings: either <span class="math notranslate nohighlight">\(\d x = h = x-x_0\)</span> (a finite
change in the variable <span class="math notranslate nohighlight">\(x\)</span>) or a differential (if <span class="math notranslate nohighlight">\(x\)</span> depends on another
variable, thanks to the chain rule everything will work).
With this understanding,
for all calculations, we only need the following two formulas —
the definition of the differential (using a limit):</p>
<div class="math notranslate nohighlight">
\[\d f = \lim_{\varepsilon\to0} {f(x+\varepsilon \d x) -f(x)\over\varepsilon}\]</div>
<p>and the definition of the derivative (using the differential):</p>
<div class="math notranslate nohighlight">
\[\d f = {\d f\over \d x} \d x\]</div>
<p>where <span class="math notranslate nohighlight">\(\d x\)</span> is either a differential or a finite change in the variable <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>If for example <span class="math notranslate nohighlight">\(x=p(y)\)</span> is a function of <span class="math notranslate nohighlight">\(y\)</span> then in the above <span class="math notranslate nohighlight">\(\d x\)</span> is a
differential and we get:</p>
<div class="math notranslate nohighlight">
\[\d f = {\d f\over \d x} \d x = {\d f\over \d x}{\d x\over \d y} \d y\]</div>
<p>Thanks to the chain rule, this can also be written as:</p>
<div class="math notranslate nohighlight">
\[\d f = {\d f\over \d y} \d y\]</div>
<p>and so the notation is consistent.</p>
</div>
<div class="section" id="functions-of-several-variables">
<h2>3.17.2. Functions of several variables<a class="headerlink" href="#functions-of-several-variables" title="Permalink to this headline">¶</a></h2>
<p>Let’s have <span class="math notranslate nohighlight">\(\x=(x_1,x_2,\dots,x_N)\)</span>. The function <span class="math notranslate nohighlight">\(f(\x)\)</span> assigns a number to
each <span class="math notranslate nohighlight">\(\x\)</span>. We define a differential of <span class="math notranslate nohighlight">\(f\)</span> in the direction of <span class="math notranslate nohighlight">\({\bf h}\)</span> as:</p>
<div class="math notranslate nohighlight">
\[\d f
    \equiv\left.{\d\over\d\varepsilon}f({\bf x}+\varepsilon{\bf h})
        \right|_{\varepsilon=0}
    = \lim_{\varepsilon\to0} {f({\bf x}+\varepsilon{\bf h})
        -f(\x)\over\varepsilon}
    = {\bf a} \cdot {\bf h}\]</div>
<p>The last equality follows from the fact, that
<span class="math notranslate nohighlight">\(\left.{\d\over\d\varepsilon}f({\bf x}+\varepsilon{\bf h}) \right|_{\varepsilon=0}\)</span> is a
linear function of <span class="math notranslate nohighlight">\({\bf h}\)</span>. We define the partial derivative <span class="math notranslate nohighlight">\({\partial
f\over\partial x_i}\)</span> of <span class="math notranslate nohighlight">\(f\)</span> with respect to <span class="math notranslate nohighlight">\(x_i\)</span> as the <span class="math notranslate nohighlight">\(i\)</span>-th component of
the vector <span class="math notranslate nohighlight">\({\bf a}\)</span>:</p>
<div class="math notranslate nohighlight">
\[{\bf a}
    \equiv \left({\partial f\over\partial x_1},
        {\partial f\over\partial x_2}, \dots,
        {\partial f\over\partial x_N}\right)
    \equiv \nabla f\]</div>
<p>This also gives a formula for computing <span class="math notranslate nohighlight">\({\partial f\over\partial x_i}\)</span>: we set <span class="math notranslate nohighlight">\(h_j=\delta_{ij}h_i\)</span> and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial f\over\partial x_i}
    = a_i
    = {\bf a}\cdot{\bf h}
    = \left.{\d\over\d\varepsilon} f(\x+\varepsilon(0,0,\dots,1,\dots,0))
        \right|_{\varepsilon=0} =\\    = \lim_{\varepsilon\to0} {f(x_1,x_2,\dots,x_i+\varepsilon,\dots,x_N)
        -f(x_1,x_2,\dots,x_i,\dots,x_N) \over\varepsilon}\end{aligned}\end{align} \]</div>
<p>The usual way to define partial derivatives is to use the last formula as the
definition, but here this formula is a consequence of our definition in terms
of the components of <span class="math notranslate nohighlight">\({\bf a}\)</span>.
Every variable can be treated as a function (very simple one):</p>
<div class="math notranslate nohighlight">
\[x_i=g(x_1,\dots,x_N)=\delta_{ij}x_j\]</div>
<p>and so we define</p>
<div class="math notranslate nohighlight">
\[\d x_i\equiv\d g=\d(\delta_{ij}x_j)=h_i\]</div>
<p>and thus we write <span class="math notranslate nohighlight">\(h_i=\d x_i\)</span> and <span class="math notranslate nohighlight">\({\bf h}=\d\x\)</span> and</p>
<div class="math notranslate nohighlight">
\[\d f={\d f\over\d x_i}\d x_i = (\nabla f) \cdot \d {\bf x}\]</div>
<p>So <span class="math notranslate nohighlight">\(\d{\bf x}\)</span> has two meanings — it’s either <span class="math notranslate nohighlight">\({\bf h}={\bf x}-{\bf x}_0\)</span> (a
finite change in the independent variable <span class="math notranslate nohighlight">\({\bf x}\)</span>) or a differential,
depending on the context. The above is a detailed explanation why things
are defined the way they are and what the exact meaning is. With this
understanding, the only things that are actually needed for any calculations
are the following – the definition of a differential:</p>
<div class="math notranslate nohighlight">
\[\d f = \left.{\d\over\d\varepsilon}f({\bf x}+\varepsilon\d {\bf x})
        \right|_{\varepsilon=0}\]</div>
<p>Only a regular derivative (defined in the previous section) is needed for this
definition. The definition of a partial derivative (and a gradient):</p>
<div class="math notranslate nohighlight">
\[\d f={\d f\over\d x_i}\d x_i = (\nabla f) \cdot \d {\bf x}\]</div>
<p>And finally the understanding that <span class="math notranslate nohighlight">\(\d{\bf x}\)</span> means
either <span class="math notranslate nohighlight">\({\bf h}={\bf x}-{\bf x}_0\)</span> or a differential depending on the context.
That’s all there is to it.</p>
</div>
<div class="section" id="functionals">
<h2>3.17.3. Functionals<a class="headerlink" href="#functionals" title="Permalink to this headline">¶</a></h2>
<p>Let’s now define functional derivatives and variations.
Functional <span class="math notranslate nohighlight">\(F[f]\)</span> assigns a number to each function <span class="math notranslate nohighlight">\(f(x)\)</span>. The variation is
defined as</p>
<div class="math notranslate nohighlight">
\[\delta F[f]\equiv\left.{\d\over\d\varepsilon}F[f+\varepsilon h] \right|_{\varepsilon=0}=\lim_{\epsilon\to0}{F[f+\epsilon h]-F[f]\over\epsilon}= \int a(x)h(x)\d x\]</div>
<p>We define <span class="math notranslate nohighlight">\({\delta F\over\delta f(x)}\)</span> as</p>
<div class="math notranslate nohighlight">
\[a(x)\equiv{\delta F\over\delta f(x)}\]</div>
<p>This also gives a formula for computing <span class="math notranslate nohighlight">\({\delta F\over\delta f(x)}\)</span>: we set
<span class="math notranslate nohighlight">\(h(y)=\delta(x-y)\)</span> and</p>
<div class="math notranslate nohighlight" id="equation-functional-derivative-def">
<span class="eqno">(3.17.3.1)<a class="headerlink" href="#equation-functional-derivative-def" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}   {\delta F\over\delta f(x)}=a(x)=\int a(y)\delta(x-y)\d y= \left.{\d\over\d\varepsilon}F[f(y)+\varepsilon\delta(x-y)] \right|_{\varepsilon=0}=\\   =\lim_{\varepsilon\to0} {F[f(y)+\varepsilon\delta(x-y)]-F[f(y)]\over\varepsilon}\end{aligned}\end{align} \]</div>
<p>Sometimes the functional derivative is defined using the last formula, here
this formula just follows from our definition.
Every function can be treated as a functional (although a very simple one):</p>
<div class="math notranslate nohighlight">
\[f(x)=G[f]=\int f(y)\delta(x-y)\d y\]</div>
<p>and so we define</p>
<div class="math notranslate nohighlight">
\[\delta f\equiv\delta G[f]= \left.{\d\over\d\varepsilon}G[f(x)+\varepsilon h(x)] \right|_{\varepsilon=0}= \left.{\d\over\d\varepsilon}(f(x)+\varepsilon h(x)) \right|_{\varepsilon=0}= h(x)\]</div>
<p>thus we write <span class="math notranslate nohighlight">\(h=\delta f\)</span> and</p>
<div class="math notranslate nohighlight">
\[\delta F[f]=\int {\delta F\over\delta f(x)}\delta f(x)\d x\]</div>
<p>so <span class="math notranslate nohighlight">\(\delta f\)</span> have two meanings — it’s either
<span class="math notranslate nohighlight">\(h(x)=f(x) - f_0(x)\)</span> (a finite change in the function <span class="math notranslate nohighlight">\(f\)</span>) or a variation
of a functional, depending on the context.
It is completely analogous to <span class="math notranslate nohighlight">\(\d\x\)</span>. Let’s summarize the only formulas needed
in actual calculations – the definition of a variation (using a regular
derivative):</p>
<div class="math notranslate nohighlight" id="equation-functional-deriv">
<span class="eqno">(3.17.3.2)<a class="headerlink" href="#equation-functional-deriv" title="Permalink to this equation">¶</a></span>\[\delta F[f] = \left.{\d\over\d\varepsilon}F[f+\varepsilon \delta f]
    \right|_{\varepsilon=0}\]</div>
<p>the definition of the functional derivative:</p>
<div class="math notranslate nohighlight">
\[\delta F[f]=\int {\delta F\over\delta f(x)} \delta f(x) \d x\]</div>
<p>and the understanding that <span class="math notranslate nohighlight">\(\delta f\)</span> means either
<span class="math notranslate nohighlight">\(h(x)=f(x) - f_0(x)\)</span> or a variation. The last equation is the best way to
calculate functional derivative — apply <span class="math notranslate nohighlight">\(\delta\)</span> variation, until you get the
integral into the form <span class="math notranslate nohighlight">\(\int \big(\ \ \big) \delta f(x) \d x\)</span> and then you read off
the functional derivative from the expression in the parentheses.</p>
<p>The correspondence between the finite and infinite dimensional case can be
summarized using a functional <span class="math notranslate nohighlight">\(F[n]\)</span>, function <span class="math notranslate nohighlight">\(n({\bf x})\)</span> of continuous
parameter <span class="math notranslate nohighlight">\({\bf x}\)</span> (which can be a scalar or a vector) and its discretized
version <span class="math notranslate nohighlight">\(n_i \equiv n({\bf x}_i)\)</span>, together with a function <span class="math notranslate nohighlight">\(F(n)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}i \quad &amp; \Longleftrightarrow \quad {\bf x} \\
n_i \quad &amp; \Longleftrightarrow \quad n({\bf x}) \\
F(n_i) \quad &amp; \Longleftrightarrow \quad F[n] \\
\d F = 0 \quad &amp; \Longleftrightarrow \quad \delta F = 0 \\
{\partial F\over\partial n_i} = 0 \quad &amp; \Longleftrightarrow \quad
    {\delta F \over \delta n({\bf x})} = 0 \\\end{split}\]</div>
<p>In other words, the basic difference is that the continuous parameter <span class="math notranslate nohighlight">\({\bf x}\)</span>
has been replaced with a discrete parameter <span class="math notranslate nohighlight">\(i\)</span>. Then the function <span class="math notranslate nohighlight">\(n({\bf x})\)</span>
becomes a vector of values <span class="math notranslate nohighlight">\(n_i\)</span>, variation becomes a differential and
functional derivative becomes a partial derivative. To minimize a functional,
one must search for zero functional derivative, while in the discrete case one
searches for zero partial derivatives (gradient).</p>
<p>We now extend the <span class="math notranslate nohighlight">\(\delta\)</span>-variation notation to any any function <span class="math notranslate nohighlight">\(g\)</span> which
contains the function <span class="math notranslate nohighlight">\(f(x)\)</span> being varied, you just need to replace <span class="math notranslate nohighlight">\(f\)</span> by
<span class="math notranslate nohighlight">\(f+\epsilon \delta f\)</span> and apply <span class="math notranslate nohighlight">\({\d\over\d\epsilon}\)</span> to the whole <span class="math notranslate nohighlight">\(g\)</span>, for
example (here <span class="math notranslate nohighlight">\(g=\partial_\mu\phi\)</span> and <span class="math notranslate nohighlight">\(f=\phi\)</span>):</p>
<div class="math notranslate nohighlight">
\[\delta\partial_\mu\phi
    = \left.{\d\over\d\varepsilon}\partial_\mu(\phi+\varepsilon \delta\phi) \right|_{\varepsilon=0}
    = \partial_\mu\left.{\d\over\d\varepsilon}(\phi+\varepsilon \delta\phi) \right|_{\varepsilon=0}
    =\partial_\mu \delta\phi\]</div>
<p>As such, the <span class="math notranslate nohighlight">\(F\)</span> in <a class="reference internal" href="#equation-functional-deriv">(3.17.3.2)</a> can be either a functional or any
expression that contains the function <span class="math notranslate nohighlight">\(f\)</span>.
This notation allows us a very convenient computation, as shown in the
following examples.</p>
<p>First, when computing a variation of some integral, we
can interchange <span class="math notranslate nohighlight">\(\delta\)</span> and <span class="math notranslate nohighlight">\(\int\)</span>:</p>
<div class="math notranslate nohighlight">
\[F[f]=\int K(x) f(x) \d x\]</div>
<div class="math notranslate nohighlight">
\[\delta F=\delta \int K(x) f(x) \d x = \left.{\d\over\d\varepsilon}\int K(x) (f+\varepsilon h)\d x\right|_{\varepsilon=0}= \left.\int{\d\over\d\varepsilon} (K(x) (f+\varepsilon h))\d x\right|_{\varepsilon=0}=\]</div>
<div class="math notranslate nohighlight">
\[=\int\delta(K(x) f(x))\d x\]</div>
<p>In the expression <span class="math notranslate nohighlight">\(\delta(K(x) f(x))\)</span> we must understand from the context if
we are treating it as a functional of <span class="math notranslate nohighlight">\(f\)</span> or <span class="math notranslate nohighlight">\(K\)</span>. In our case it’s a
functional of <span class="math notranslate nohighlight">\(f\)</span>, so we have <span class="math notranslate nohighlight">\(\delta(K f)=K\delta f\)</span>.</p>
<p>The second very important note is when taking variation of expression like:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\delta \int f(t_1)f(t_2) \d t_1 \d t_2 =\\= \int \delta (f(t_1)f(t_2)) \d t_1 \d t_2 =\\= \int \left.{\d\over\d\varepsilon}(f(t_1)+\varepsilon\delta f(t_1))
    (f(t_2)+\varepsilon\delta f(t_2)) \right|_{\varepsilon=0}
    \d t_1 \d t_2 =\\= \int (\delta f(t_1))f(t_2)+f(t_1)(\delta f(t_2)) \d t_1 \d t_2 =\\= \int (\delta f(t_1))f(t_2)+f(t_2)(\delta f(t_1)) \d t_1 \d t_2 =\\= 2 \int f(t_2) \delta f(t_1) \d t_1 \d t_2\end{aligned}\end{align} \]</div>
<p>then when <span class="math notranslate nohighlight">\(f\)</span> is replaced by <span class="math notranslate nohighlight">\(f+\epsilon \delta f\)</span>, one has to keep track of
the independent variable, so <span class="math notranslate nohighlight">\(f(t_1)\)</span> gets replaced by <span class="math notranslate nohighlight">\(f(t_1)+\epsilon \delta
f(t_1)\)</span> and <span class="math notranslate nohighlight">\(f(t_2)\)</span> gets replaced by <span class="math notranslate nohighlight">\(f(t_2)+\epsilon \delta f(t_2)\)</span>. Thus the
two variations <span class="math notranslate nohighlight">\(\delta f(t_1)\)</span> and <span class="math notranslate nohighlight">\(\delta f(t_2)\)</span> are different (independent).
If there is only one indepenent variable, one can simply write <span class="math notranslate nohighlight">\(\delta f\)</span> as it
is clear what the independent variable is. This is analogous to using
differentials, e.g. <span class="math notranslate nohighlight">\(\d (f(x) f(y)) = (\d f(x)) f(y) + f(x) \d f(y)
=f'(x) \d x f(y) + f(x) f'(y) \d y\)</span>, where one has to keep track of the
independent variable as well for each <span class="math notranslate nohighlight">\(\d f\)</span>.</p>
<p>Another useful formula is differentiation of a functional <span class="math notranslate nohighlight">\(F[\psi(\theta)]\)</span>
where the function <span class="math notranslate nohighlight">\(\psi(\theta)\)</span> depends on a parameter <span class="math notranslate nohighlight">\(\theta\)</span>:</p>
<div class="math notranslate nohighlight">
\[{\d F[\psi(\theta)] \over \d \theta}
=\left.{\d\over\d\epsilon} F[\psi(\theta+\epsilon)] \right|_{\epsilon=0}
=\left.{\d\over\d\epsilon} F\left[\psi(\theta)+\epsilon {d \psi(\theta)
    \over d \theta} + O(\epsilon^2)\right] \right|_{\epsilon=0}
=\left.{\d\over\d\epsilon} F\left[\psi(\theta)+\epsilon {d \psi(\theta)
    \over d \theta}\right] \right|_{\epsilon=0}
= \int {\delta F[\psi] \over \delta \psi} {\d\psi(\theta)\over\d\theta}\d x\]</div>
<p>where we used the definition of a variation and a functional derivative with
<span class="math notranslate nohighlight">\(\delta\psi={\d\psi(\theta) \over\d\theta}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\delta F = \left.{\d\over\d\epsilon}
    F[\psi+\epsilon\delta\psi]\right|_{\epsilon=0}
= \int{\delta F\over\delta\psi}\delta\psi\d x\]</div>
</div>
<div class="section" id="examples">
<h2>3.17.4. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Some of these examples show how to use the delta function definition of the
functional derivative in equation <a class="reference internal" href="#equation-functional-derivative-def">(3.17.3.1)</a>. However, the
simplest way is to calculate variation first and then read off the functional
derivative from the result, as explained above.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\delta\over\delta f(t)}\int\d t'f(t')g(t')= \left.{\d\over\d\varepsilon}\int\d t'(f(t')+\varepsilon\delta(t-t'))g(t') \right|_{\varepsilon=0}=g(t)\\\delta \int \d t f(t)g(t) = \left.{\d\over\d\varepsilon}\int\d
    t(f(t)+\varepsilon \delta f(t))g(t) \right|_{\varepsilon=0}
 = \int g(t) (\delta f(t)) \d t\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[{\delta f(t')\over\delta f(t)}= \left.{\d\over\d\varepsilon}(f(t')+\varepsilon\delta(t-t')) \right|_{\varepsilon=0}=\delta(t-t')\]</div>
<div class="math notranslate nohighlight">
\[{\delta f(t_1)f(t_2)\over\delta f(t)}= \left.{\d\over\d\varepsilon}(f(t_1)+\varepsilon\delta(t-t_1)) (f(t_2)+\varepsilon\delta(t-t_2)) \right|_{\varepsilon=0}=\delta(t-t_1)f(t_2)+f(t_1)\delta(t-t_2)\]</div>
<p>The next example shows that when taking variation of an expression containing
the function <span class="math notranslate nohighlight">\(f\)</span> of different independent variables, one has to keep track of
these variables in the variations:</p>
<div class="math notranslate nohighlight">
\[\delta (f(t_1)f(t_2))
    = \left.{\d\over\d\varepsilon}(f(t_1)+\varepsilon\delta f(t_1))
        (f(t_2)+\varepsilon\delta f(t_2)) \right|_{\varepsilon=0}
    =(\delta f(t_1))f(t_2)+f(t_1)(\delta f(t_2))\]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\delta\over\delta f(t)}\half\int\d t_1\d t_2K(t_1,t_2)f(t_1)f(t_2)= \half\int\d t_1\d t_2K(t_1,t_2){\delta f(t_1)f(t_2)\over\delta f(t)}=\\=\half\left(\int\d t_1 K(t_1,t)f(t_1)+\int\d t_2 K(t,t_2)f(t_2)\right) =\int\d t_2 K(t,t_2)f(t_2)\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\delta \half\int\d t_1\d t_2K(t_1,t_2)f(t_1)f(t_2)= \half\int\d t_1\d
t_2K(t_1,t_2)(\delta f(t_1)f(t_2))=\\= \half\int\d t_1\d t_2K(t_1,t_2) ((\delta f(t_1))f(t_2)
    +f(t_1)(\delta f(t_2))=\\= \int\d t_1\d t_2 K(t_1,t_2) f(t_2) (\delta f(t_1))\end{aligned}\end{align} \]</div>
<p>The last equality follows from <span class="math notranslate nohighlight">\(K(t_1,t_2)=K(t_2,t_1)\)</span> (any antisymmetrical
part of a <span class="math notranslate nohighlight">\(K\)</span> would not contribute to the symmetrical integration).</p>
<p>Another example is the derivation of Euler-Lagrange equations for the
Lagrangian density <span class="math notranslate nohighlight">\(\L=\L(\eta_\rho, \partial_\nu \eta_\rho, x^\nu)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}0 = \delta S = \delta \int \L \,\d^4x^\mu
= \int \delta \L \,\d^4x^\mu
= \int { \partial \L\over\partial \eta_\rho}\delta\eta_\rho
    +
    { \partial \L\over\partial (\partial_\nu \eta_\rho)}
    \delta(\partial_\nu\eta_\rho)
    \,\d^4x^\mu
=\\= \int { \partial \L\over\partial \eta_\rho}\delta\eta_\rho
    +
    { \partial \L\over\partial (\partial_\nu \eta_\rho)}
    \partial_\nu(\delta\eta_\rho)
    \,\d^4x^\mu
=\\= \int { \partial \L\over\partial \eta_\rho}\delta\eta_\rho
    -
    \partial_\nu\left(
    { \partial \L\over\partial (\partial_\nu \eta_\rho)}
    \right)
    \delta\eta_\rho
    \,\d^4x^\mu
    +\int \partial_\nu \left(
    { \partial \L\over\partial (\partial_\nu \eta_\rho)}
    \delta\eta_\rho
    \right)
    \,\d^4x^\mu
=\\= \int \left[{ \partial \L\over\partial \eta_\rho}
    -
    \partial_\nu\left(
    { \partial \L\over\partial (\partial_\nu \eta_\rho)}
    \right)
    \right]
    \delta\eta_\rho
    \,\d^4x^\mu\end{aligned}\end{align} \]</div>
<p>We can also write it using a functional derivative <span class="math notranslate nohighlight">\({\delta
S\over\delta\eta_\rho}\)</span> as:</p>
<div class="math notranslate nohighlight">
\[{\delta S\over\delta\eta_\rho}
    = { \partial \L\over\partial \eta_\rho}
    -
    \partial_\nu\left(
    { \partial \L\over\partial (\partial_\nu \eta_\rho)}
    \right)\]</div>
<p>Another example:</p>
<div class="math notranslate nohighlight">
\[{\delta\over\delta f(t)}\int f^3(x)\d x= \left.{\d\over\d\varepsilon}\int(f(x)+\varepsilon\delta(x-t))^3\d x \right|_{\varepsilon=0}=\]</div>
<div class="math notranslate nohighlight">
\[=\left.\int3(f(x)+\varepsilon\delta(x-t))^2\delta(x-t)\d x \right|_{\varepsilon=0}=\int3f^2(x)\delta(x-t)\d x=3f^2(t)\]</div>
<p>One might think that the above calculation is incorrect, because
<span class="math notranslate nohighlight">\(\delta^2(x-t)\)</span> is undefined. In case of
such problems the above notation automatically implies working with some
sequence <span class="math notranslate nohighlight">\(\delta_\alpha(x) \to \delta(x)\)</span> (for example <span class="math notranslate nohighlight">\(\delta_\alpha(x) =
{1\over\pi x}\sin(\alpha x)\)</span>) and taking the limit <span class="math notranslate nohighlight">\(\alpha\to\infty\)</span>:</p>
<div class="math notranslate nohighlight">
\[{\delta\over\delta f(t)}\int f^3(x)\d x= \left.\lim_{\alpha\to\infty}{\d\over\d\varepsilon}\int(f(x)+\varepsilon\delta_\alpha(x-t))^3\d x \right|_{\varepsilon=0}=\]</div>
<div class="math notranslate nohighlight">
\[=\left.\lim_{\alpha\to\infty}\int3(f(x)+\varepsilon\delta_\alpha(x-t))^2\delta_\alpha(x-t)\d x \right|_{\varepsilon=0}=\lim_{\alpha\to\infty}\int3f^2(x)\delta_\alpha(x-t)\d x=\]</div>
<div class="math notranslate nohighlight" id="equation-functionalderdel">
<span class="eqno">(3.17.4.1)<a class="headerlink" href="#equation-functionalderdel" title="Permalink to this equation">¶</a></span>\[   =\int3f^2(x)\lim_{\alpha\to\infty}\delta_\alpha(x-t)\d x= \int3f^2(x)\delta(x-t)\d x=3f^2(t)\]</div>
<p>As you can see, we got the same result, with the same rigor, but using an
obfuscating notation. That’s why such obvious manipulations with
<span class="math notranslate nohighlight">\(\delta_\alpha\)</span> are tacitly implied. However, the best method is to first
calculate the variation:</p>
<div class="math notranslate nohighlight">
\[\delta \int f^3(x) \d x = \int \delta f^3(x) \d x
=\int 3 f^2(x) \delta f(x) \d x\]</div>
<p>and immediately read off the functional derivative:</p>
<div class="math notranslate nohighlight">
\[{\delta\over\delta f(t)} \int f^3(x) \d x = 3 f^2(t)\]</div>
<p>Another example with a metric as a function of coordinates
<span class="math notranslate nohighlight">\(g_{\mu\nu} = g_{\mu\nu}(x^\mu)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\delta g_{\mu\nu}
    = \delta g_{\mu\nu}(x^\mu)
    = \left.{\d\over\d\varepsilon} g_{\mu\nu}(x^\mu+\varepsilon
            (\delta x^\mu)) \right|_{\varepsilon=0}
    = \left.{\d\over\d\varepsilon}
            (x^\sigma+\varepsilon(\delta x^\sigma)) \right|_{\varepsilon=0}
        \partial_\sigma g_{\mu\nu}
    = (\delta x^\sigma) \partial_\sigma g_{\mu\nu}\]</div>
<p>And an example of varying with respect to a metric:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\delta \sqrt{ |\det g_{\mu\nu}| }
    =\sqrt{ |\det g_{\mu\nu}| }\, \delta \log \sqrt{ |\det g_{\mu\nu}| }
    =\half \sqrt{ |\det g_{\mu\nu}| }\, \delta \log |\det g_{\mu\nu}| =\\    =\half \sqrt{ |\det g_{\mu\nu}| }\, \delta \Tr \log g_{\mu\nu}
    =\half \sqrt{ |\det g_{\mu\nu}| }\, \Tr \delta \log g_{\mu\nu} =\\    =\half \sqrt{ |\det g_{\mu\nu}| }\, \Tr g^{\mu\nu} \delta g_{\mu\nu}
    =\half \sqrt{ |\det g_{\mu\nu}| }\, g^{\mu\nu} \delta g_{\mu\nu} =\\    =-\half \sqrt{ |\det g_{\mu\nu}| }\, g_{\mu\nu} \delta g^{\mu\nu}\end{aligned}\end{align} \]</div>
<p>Another example (varying energy functional):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}E[\rho] = 4\pi\int {a \rho(r)\over b + r_s(r)} r^2 \d r\\r_s(r) = \left(3\over 4\pi (-\rho)\right)^{1\over 3}\\{\d r_s\over\d \rho} =
        {1\over 3}\left(3\over 4\pi (-\rho)\right)^{-{2\over 3}}
        {3\over 4\pi \rho^2}
    =
        -{1\over 3\rho}\left(3\over 4\pi (-\rho)\right)^{1\over 3}
    =
        -{r_s\over 3\rho}\\\delta E[\rho] = 4\pi \delta \int {a \rho\over b + r_s} r^2 \d r =\\    = 4\pi \int\left({a \delta \rho\over b + r_s}
        - {a \rho\over (b + r_s)^2 }\delta r_s\right) r^2 \d r =\\    = 4\pi \int\left({a \delta \rho\over b + r_s}
        - {a \rho\over (b + r_s)^2 }\left(-{r_s\over 3\rho}\right)
          \delta\rho\right)
          r^2 \d r =\\    = 4\pi \int\left({a \over b + r_s}
        +{1\over3} {a r_s\over (b + r_s)^2 }\right) (\delta\rho) r^2 \d r\\{\delta E[\rho]\over\delta\rho}
    = 4\pi r^2 \left({a \over b + r_s}
        +{1\over3} {a r_s\over (b + r_s)^2 }\right)\end{aligned}\end{align} \]</div>
<p>Another example (Hartree energy):</p>
<div class="math notranslate nohighlight">
\[E[n] = \half \int {n({\bf r}') n({\bf r}'')\over
    | {\bf r}' - {\bf r}''| } \d^3 r' \d^3 r''\]</div>
<p>we calculate the variation first:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\delta E[n] = \half \delta \int {n({\bf r}') n({\bf r}'')\over
    | {\bf r}' - {\bf r}''| } \d^3 r' \d^3 r'' =\\    = \half \int { (\delta n({\bf r}')) n({\bf r}'')
        + n({\bf r}') (\delta n({\bf r}''))\over
    | {\bf r}' - {\bf r}''| } \d^3 r' \d^3 r'' =\\    = \int { n({\bf r}') \over | {\bf r}' - {\bf r}''| }
        (\delta n({\bf r}'')) \d^3 r' \d^3 r'' =\\    = \int { n({\bf r}') \over | {\bf r} - {\bf r}'| }
        (\delta n({\bf r})) \d^3 r' \d^3 r\end{aligned}\end{align} \]</div>
<p>so the functional derivative is:</p>
<div class="math notranslate nohighlight">
\[{\delta E[n]\over \delta n({\bf r})}
    = \int { n({\bf r}') \over | {\bf r} - {\bf r}'| } \d^3 r'\]</div>
<p>Another example (functional with gradients):</p>
<div class="math notranslate nohighlight">
\[F[n] = \int h(n) {| \nabla n|^2 \over n} \d^3 r\]</div>
<p>the variation is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\delta F[n]
    = \int \delta \left( h(n) {| \nabla n|^2 \over n} \right) \d^3 r =\\    = \int {\d h \over \d n} {| \nabla n|^2 \over n} \delta n
        + h(n)\left(2n\nabla n \cdot \nabla \delta n - | \nabla n|^2
          \delta n
          \over n^2\right) \d^3 r =\\    = \int \left({\d h \over \d n} - {h(n)\over n}\right)
        {| \nabla n|^2 \over n}
        \delta n
        + 2 h(n){\nabla n \cdot \nabla \delta n \over n} \d^3 r =\\    = \int \left({\d h \over \d n} - {h(n)\over n} \right)
        {| \nabla n|^2 \over n}
        \delta n
        - 2 \nabla\cdot\left(h(n){\nabla n \over n}\right)\delta n\ \d^3 r =\\    = \int \left({\d h \over \d n} - {h(n)\over n} \right)
        {| \nabla n|^2 \over n}
        \delta n
        - 2 \left({\d h \over \d n}{| \nabla n|^2 \over n}
          +h(n){\nabla^2 n \over n}
          -h(n){| \nabla n|^2 \over n^2}
          \right)\delta n\ \d^3 r =\\    = \int \left[ \left({h(n)\over n} - {\d h \over \d n}\right)
        {| \nabla n|^2 \over n}
        - 2 h(n){\nabla^2 n \over n}\right]
          \delta n\ \d^3 r\end{aligned}\end{align} \]</div>
<p>from which we read off the functional derivative:</p>
<div class="math notranslate nohighlight">
\[{\delta F[n] \over \delta n({\bf r})}
    = \left({h(n)\over n} - {\d h \over \d n}\right)
        {| \nabla n|^2 \over n}
        - 2 h(n){\nabla^2 n \over n}\]</div>
</div>
</div>
<div class="section" id="dirac-notation">
<span id="index-1"></span><h1>3.18. Dirac Notation<a class="headerlink" href="#dirac-notation" title="Permalink to this headline">¶</a></h1>
<p>The Dirac notation allows a very compact and powerful way of writing
equations that describe a function expansion into a basis, both discrete
(e.g. a Fourier series expansion) and continuous (e.g. a Fourier transform)
and related things. The notation is designed so that it is very easy to
remember and it just guides you to write the correct equation.</p>
<p>Let’s have a function <span class="math notranslate nohighlight">\(f(x)\)</span>. We define</p>
<div class="math notranslate nohighlight">
\begin{eqnarray*} \braket{x|f}&amp;\equiv&amp; f(x) \\ \braket{x'|f}&amp;\equiv&amp; f(x') \\ \braket{x'|x}&amp;\equiv&amp;\delta(x'-x) \\ \int\ket{x}\bra{x}\d x&amp;\equiv&amp;\one \\ \end{eqnarray*}</div><p>The following equation</p>
<div class="math notranslate nohighlight">
\[f(x')=\int\delta(x'-x)f(x)\d x\]</div>
<p>then becomes</p>
<div class="math notranslate nohighlight">
\[\braket{x'|f}=\int\braket{x'|x}\braket{x|f}\d x\]</div>
<p>and thus we can interpret <span class="math notranslate nohighlight">\(\ket{f}\)</span> as a vector, <span class="math notranslate nohighlight">\(\ket{x}\)</span> as a basis and <span class="math notranslate nohighlight">\(\braket{x|f}\)</span> as the coefficients in the basis expansion:</p>
<div class="math notranslate nohighlight">
\[\ket{f}=\one\ket{f}=\int\ket{x}\bra{x}\d x\ket{f}= \int\ket{x}\braket{x|f}\d x\]</div>
<p>That’s all there is to it. Take the above rules as the operational definition
of the Dirac notation. It’s like with the delta function - written alone it
doesn’t have any meaning, but there are clear and non-ambiguous rules to
convert any expression with <span class="math notranslate nohighlight">\(\delta\)</span> to an expression which even mathematicians
understand (i.e. integrating, applying test functions and using other relations
to get rid of all <span class="math notranslate nohighlight">\(\delta\)</span> symbols in the expression – but the result is
usually much more complicated than the original formula). It’s the same with
the ket <span class="math notranslate nohighlight">\(\ket{f}\)</span>: written alone it doesn’t have any meaning, but you can
always use the above rules to get an expression that make sense to everyone
(i.e. attaching any bra to the left and rewriting all brackets <span class="math notranslate nohighlight">\(\braket{a|b}\)</span>
with their equivalent expressions) – but it will be more complex and harder to
remember and – that is important – less general.</p>
<p>Now, let’s look at the spherical harmonics:</p>
<div class="math notranslate nohighlight">
\[Y_{lm}({\bf\hat r})\equiv\braket{{\bf\hat r}|lm}\]</div>
<p>on the unit sphere, we have</p>
<div class="math notranslate nohighlight">
\[\int\ket{\bf\hat r}\bra{\bf\hat r}\d{\bf\hat r}= \int\ket{\bf\hat r}\bra{\bf\hat r}\d\Omega=\one\]</div>
<div class="math notranslate nohighlight">
\[\delta({\bf\hat r}-{\bf\hat r'})=\braket{{\bf\hat r}|{\bf\hat r'}}\]</div>
<p>thus</p>
<div class="math notranslate nohighlight">
\[\int_0^{2\pi}\int_0^{\pi} Y_{lm}(\theta,\phi)\,Y^*_{l'm'}(\theta,\phi)\sin\theta\,\d\theta\,\d\phi = \int\braket{l'm'|{\bf\hat r}}\braket{{\bf\hat r}|lm}\d\Omega= \braket{l'm'|lm}\]</div>
<p>and from <a class="reference internal" href="spherical-harmonics.html#equation-yorto">(3.30.1)</a> we get</p>
<div class="math notranslate nohighlight">
\[\braket{l'm'|lm}=\delta_{mm'}\delta_{ll'}\]</div>
<p>now</p>
<div class="math notranslate nohighlight">
\[\sum_{lm}Y_{lm}(\theta,\phi)Y_{lm}^*(\theta',\phi')= \sum_{lm}\braket{{\bf\hat r}|lm}\braket{lm|{\bf\hat r'}}\]</div>
<p>from <a class="reference internal" href="spherical-harmonics.html#equation-ycomplete">(3.30.3)</a> we get</p>
<div class="math notranslate nohighlight">
\[\sum_{lm}\braket{{\bf\hat r}|lm}\braket{lm|{\bf\hat r'}}= \braket{{\bf\hat r}|{\bf\hat r'}}\]</div>
<p>so we have</p>
<div class="math notranslate nohighlight">
\[\sum_{lm}\ket{lm}\bra{lm}=\one\]</div>
<p>so <span class="math notranslate nohighlight">\(\ket{lm}\)</span> forms an orthonormal basis. Any function defined on the sphere <span class="math notranslate nohighlight">\(f({\bf\hat r})\)</span> can be written using this basis:</p>
<div class="math notranslate nohighlight">
\[f({\bf\hat r}) =\braket{{\bf\hat r}|f} =\sum_{lm}\braket{{\bf\hat r}|lm}\braket{lm|f} =\sum_{lm}Y_{lm}({\bf\hat r})f_{lm}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[f_{lm}=\braket{lm|f}=\int\braket{lm|{\bf\hat r}}\braket{{\bf\hat r}|f}\d\Omega =\int Y_{lm}^*({\bf\hat r}) f({\bf\hat r})\d\Omega\]</div>
<p>If we have a function <span class="math notranslate nohighlight">\(f({\bf r})\)</span> in 3D, we can write it as a function of <span class="math notranslate nohighlight">\(\rho\)</span> and <span class="math notranslate nohighlight">\({\bf\hat r}\)</span> and expand only with respect to the variable <span class="math notranslate nohighlight">\({\bf\hat r}\)</span>:</p>
<div class="math notranslate nohighlight">
\[f({\bf r})=f(\rho{\bf\hat r})\equiv g(\rho,{\bf\hat r})= \sum_{lm}Y_{lm}({\bf\hat r})g_{lm}(\rho)\]</div>
<p>In Dirac notation we are doing the following: we decompose the space into the angular and radial part</p>
<div class="math notranslate nohighlight">
\[\ket{{\bf r}}=\ket{{\bf\hat r}}\otimes\ket{\rho} \equiv\ket{{\bf\hat r}}\ket{\rho}\]</div>
<p>and write</p>
<div class="math notranslate nohighlight">
\[f({\bf r})=\braket{{\bf r}|f}=\bra{{\bf\hat r}}\braket{\rho|f}= \sum_{lm}Y_{lm}({\bf\hat r})\bra{lm}\braket{\rho|f}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\bra{lm}\braket{\rho|f}= \int\braket{lm|{\bf\hat r}}\bra{{\bf\hat r}}\braket{\rho|f}\d\Omega =\int Y_{lm}^*({\bf\hat r}) f({\bf r})\d\Omega\]</div>
<p>Let’s calculate <span class="math notranslate nohighlight">\(\braket{\rho|\rho'}\)</span></p>
<div class="math notranslate nohighlight">
\[\braket{{\bf r}|{\bf r'}}=\bra{\bf\hat r}\braket{\rho|\rho'}\ket{{\bf\hat r'}} =\braket{{\bf\hat r}|{\bf\hat r'}}\braket{\rho|\rho'}\]</div>
<p>so</p>
<div class="math notranslate nohighlight">
\[\braket{\rho|\rho'} ={\braket{{\bf r}|{\bf r'}}\over\braket{{\bf\hat r}|{\bf\hat r'}}} ={\delta(\rho-\rho')\over\rho^2}\]</div>
<p>We must stress that <span class="math notranslate nohighlight">\(\ket{lm}\)</span> only acts in the <span class="math notranslate nohighlight">\(\ket{{\bf\hat r}}\)</span> space
(not the <span class="math notranslate nohighlight">\(\ket\rho\)</span> space) which means that</p>
<div class="math notranslate nohighlight">
\[\braket{{\bf r}|lm} =\bra{\bf\hat r}\braket{\rho|lm} =\braket{{\bf\hat r}|lm}\bra{\rho} =Y_{lm}({\bf\hat r})\bra{\rho}\]</div>
<p>and <span class="math notranslate nohighlight">\(V\ket{lm}\)</span> leaves <span class="math notranslate nohighlight">\(V\ket\rho\)</span> intact. Similarly,</p>
<div class="math notranslate nohighlight">
\[\sum_{lm} \ket{lm}\bra{lm}=\one\]</div>
<p>is a unity in the <span class="math notranslate nohighlight">\(\ket{\bf\hat r}\)</span> space only (i.e. on the unit sphere).</p>
<p>Let’s rewrite the equation <a class="reference internal" href="spherical-harmonics.html#equation-lsum">(3.30.4)</a>:</p>
<div class="math notranslate nohighlight">
\[\sum_m\braket{{\bf\hat r}|lm}\braket{lm|{\bf\hat r'}}= {4\pi\over 2l+1} \braket{{\bf\hat r}\cdot{\bf\hat r'}|P_l}\]</div>
<p>Using the completeness relation <a class="reference internal" href="spherical-harmonics.html#equation-lorto">(3.29.1)</a>:</p>
<div class="math notranslate nohighlight">
\[\sum_l {2l+1\over2}\braket{x'|P_l}\braket{P_l|x}=\braket{x'|x}\]</div>
<div class="math notranslate nohighlight">
\[\sum_l \ket{P_l}{2l+1\over2}\bra{P_l}=\one\]</div>
<p>we can now derive a very important formula true for every function <span class="math notranslate nohighlight">\(f({\bf\hat r}\cdot{\bf\hat r'})\)</span>:</p>
<div class="math notranslate nohighlight">
\[f({\bf\hat r}\cdot{\bf\hat r'})=\braket{{\bf\hat r}\cdot{\bf\hat r'}|f}= \sum_l \braket{{\bf\hat r}\cdot{\bf\hat r'}|P_l}{2l+1\over2}\braket{P_l|f}= \sum_{lm}\braket{{\bf\hat r}|lm}\braket{lm|{\bf\hat r'}}{(2l+1)^2\over8\pi} \braket{P_l|f}=\]</div>
<div class="math notranslate nohighlight">
\[=\sum_{lm}\braket{{\bf\hat r}|lm}f_l \braket{lm|{\bf\hat r'}}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[f_l={(2l+1)^2\over8\pi}\braket{P_l|f} ={(2l+1)^2\over8\pi}\int_{-1}^1 \braket{P_l|x}\braket{x|f}\d x ={(2l+1)^2\over8\pi}\int_{-1}^1 P_l(x)f(x)\d x\]</div>
<p>or written explicitly</p>
<div class="math notranslate nohighlight" id="equation-fylm">
<span class="eqno">(3.18.1)<a class="headerlink" href="#equation-fylm" title="Permalink to this equation">¶</a></span>\[   f({\bf\hat r}\cdot{\bf\hat r'})= \sum_{l=0}^\infty\sum_{m=-l}^l Y_{lm}({\bf\hat r}) f_l Y_{lm}^*({\bf\hat r'})\]</div>
</div>
<div class="section" id="homogeneous-functions-euler-s-theorem">
<span id="homogeneous-functions"></span><span id="index-2"></span><h1>3.19. Homogeneous Functions (Euler’s Theorem)<a class="headerlink" href="#homogeneous-functions-euler-s-theorem" title="Permalink to this headline">¶</a></h1>
<p>A function of several variables <span class="math notranslate nohighlight">\(f(x_1, x_2, \dots) \equiv f(x_i)\)</span> is
homogeneous of degree <span class="math notranslate nohighlight">\(k\)</span> if</p>
<div class="math notranslate nohighlight">
\[f(\lambda x_i) = \lambda^k f(x_i)\]</div>
<p>By differentiating with respect to <span class="math notranslate nohighlight">\(\lambda\)</span>:</p>
<div class="math notranslate nohighlight">
\[x_i {\partial f(\lambda x_i)\over\partial x_i} = k\lambda^{k-1} f(x_i)\]</div>
<p>and setting <span class="math notranslate nohighlight">\(\lambda=1\)</span> we get the so called Euler equation:</p>
<div class="math notranslate nohighlight">
\[x_i {\partial f(x_i)\over\partial x_i} = k f(x_i)\]</div>
<p>in 3D this can also be written as:</p>
<div class="math notranslate nohighlight">
\[{\bf x} \cdot \nabla f({\bf x}) = k f({\bf x})\]</div>
<div class="section" id="example-1">
<h2>3.19.1. Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h2>
<p>The function <span class="math notranslate nohighlight">\(f(x, y, z) = {xy\over z}\)</span> is homogeneous of degree 1, because:</p>
<div class="math notranslate nohighlight">
\[f(\lambda x, \lambda y, \lambda z) = {\lambda x\lambda y\over \lambda z}
= \lambda {xy\over z}
= \lambda f(x, y, z)\]</div>
<p>and the Euler equation is:</p>
<div class="math notranslate nohighlight">
\[x{\partial f\over\partial x} +
y{\partial f\over\partial y} +
z{\partial f\over\partial z}
=
f\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[x{y\over z} +
y{x\over z} +
z\left(-{xy\over z^2}\right)
={xy\over z}\]</div>
<p>Which is true.</p>
</div>
<div class="section" id="example-2">
<h2>3.19.2. Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h2>
<p>The function <span class="math notranslate nohighlight">\(V(r) = -{Z \over r}\)</span> is homogeneous of degree -1, because:</p>
<div class="math notranslate nohighlight">
\[V(\lambda r) = -{Z\over \lambda r} = \lambda^{-1} V(r)\]</div>
<p>and the Euler equation is:</p>
<div class="math notranslate nohighlight">
\[r{\d V\over\d r} = -V\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[r{Z\over r^2} = -\left(-{Z\over r}\right)\]</div>
<p>Which is true.</p>
</div>
</div>
<div class="section" id="green-functions">
<h1>3.20. Green Functions<a class="headerlink" href="#green-functions" title="Permalink to this headline">¶</a></h1>
<p>Green functions are an excellent tool for working with a solution to any ODE or
PDE. In this text we explain how it works and then show how one can calculate
them using FEM.</p>
<div class="section" id="introduction">
<h2>3.20.1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Let’s put any ODE or PDE in the form:</p>
<div class="math notranslate nohighlight" id="equation-pde">
<span class="eqno">(3.20.1.1)<a class="headerlink" href="#equation-pde" title="Permalink to this equation">¶</a></span>\[Lu(x)=f(x)\]</div>
<p>Here <span class="math notranslate nohighlight">\(L\)</span> is a differential operator and <span class="math notranslate nohighlight">\(x\)</span> can have any dimension, e.g. 1D
(ODE), 2D, 3D or more (PDE). Then we can express the solution as</p>
<div class="math notranslate nohighlight" id="equation-solution">
<span class="eqno">(3.20.1.2)<a class="headerlink" href="#equation-solution" title="Permalink to this equation">¶</a></span>\[u(x) = L^{-1}f(x) = \int G(x, x')f(x')\d x'\]</div>
<p>where <span class="math notranslate nohighlight">\(G(x, x')\)</span> is a Green function, that needs to satisfy the equation:</p>
<div class="math notranslate nohighlight" id="equation-green">
<span class="eqno">(3.20.1.3)<a class="headerlink" href="#equation-green" title="Permalink to this equation">¶</a></span>\[LG(x, x')=\delta(x-x')\]</div>
<p>Remember, that <span class="math notranslate nohighlight">\(L\)</span> acts on <span class="math notranslate nohighlight">\(x\)</span> only, so we can check, that <a class="reference internal" href="#equation-solution">(3.20.1.2)</a>
indeed solves the PDE <a class="reference internal" href="#equation-pde">(3.20.1.1)</a>:</p>
<div class="math notranslate nohighlight">
\[Lu(x)
= L\int G(x, x')f(x')\d x'
= \int LG(x, x')f(x')\d x'
= \int \delta(x-x')f(x')\d x'
= f(x)\]</div>
</div>
<div class="section" id="boundary-conditions">
<h2>3.20.2. Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p>The equation <a class="reference internal" href="#equation-green">(3.20.1.3)</a> doesn’t determine the Green function uniquely,
because one can add to it any solution of the homogeneous equation <span class="math notranslate nohighlight">\(Lu(x)=0\)</span>.
We can use this freedom to solve <a class="reference internal" href="#equation-green">(3.20.1.3)</a> for any boundary condition.
So we prescribe a boundary condition
and find the Green function (by solving <a class="reference internal" href="#equation-green">(3.20.1.3)</a>) that satisfies the
boundary condition. It can be shown, that <span class="math notranslate nohighlight">\(u(x)\)</span> determined from
<a class="reference internal" href="#equation-solution">(3.20.1.2)</a> then also needs to satisfy the same boundary condition.</p>
</div>
<div class="section" id="symmetry">
<h2>3.20.3. Symmetry<a class="headerlink" href="#symmetry" title="Permalink to this headline">¶</a></h2>
<p>We write the equation for Green functions at two different points <span class="math notranslate nohighlight">\(x_1\)</span>
and <span class="math notranslate nohighlight">\(x_2\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}L G(x, x_1) = \delta(x-x_1)\\L G(x, x_2) = \delta(x-x_2)\end{aligned}\end{align} \]</div>
<p>and multiply the first equation by <span class="math notranslate nohighlight">\(G(x, x_2)\)</span>, second by <span class="math notranslate nohighlight">\(G(x, x_1)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}G(x, x_2) L G(x, x_1) = \delta(x-x_1) G(x, x_2)\\G(x, x_1) L G(x, x_2) = \delta(x-x_2) G(x, x_1)\end{aligned}\end{align} \]</div>
<p>substract them and integrate over <span class="math notranslate nohighlight">\(x\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}G(x, x_2) L G(x, x_1) - G(x, x_1) L G(x, x_2)
    = \delta(x-x_1) G(x, x_2) - \delta(x-x_2) G(x, x_1)\\\int \left(G(x, x_2) L G(x, x_1) - G(x, x_1) L G(x, x_2) \right) \d x
    = \int \left(\delta(x-x_1) G(x, x_2) - \delta(x-x_2) G(x, x_1)
        \right)\d x\\\int \left(G(x, x_2) L G(x, x_1) - G(x, x_1) L G(x, x_2) \right) \d x
    = G(x_1, x_2) - G(x_2, x_1)\end{aligned}\end{align} \]</div>
<p>Assuming that the operator <span class="math notranslate nohighlight">\(L\)</span> is Hermitean, we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\int \left((L G(x, x_2)) G(x, x_1) - G(x, x_1) L G(x, x_2) \right) \d x
    = G(x_1, x_2) - G(x_2, x_1)\\0 = G(x_1, x_2) - G(x_2, x_1)\end{aligned}\end{align} \]</div>
<p>So the Green function is symmetric for Hermitean operators <span class="math notranslate nohighlight">\(L\)</span>.</p>
</div>
<div class="section" id="id1">
<h2>3.20.4. Examples<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="poisson-equation-in-1d">
<h3>Poisson Equation in 1D<a class="headerlink" href="#poisson-equation-in-1d" title="Permalink to this headline">¶</a></h3>
<p>Poisson equation:</p>
<div class="math notranslate nohighlight">
\[-{\d^2\over\d x^2} u(x) = f(x)\]</div>
<p>We calculate the Green function using the Fourier transform:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}-{\partial^2\over\partial x^2} G(x, x') = \delta(x-x')\\-(ik)^2 \tilde G(k, x') = {e^{ikx'}\over\sqrt{2\pi}}\\\tilde G(k, x') = {e^{ikx'}\over\sqrt{2\pi}\,k^2}\\G(x, x') = -\half (x-x') \sign(x-x')
    = -\half (x-x') (2H(x-x')-1)
    = H(x-x') (x'-x) +\half(x-x')\end{aligned}\end{align} \]</div>
<p>Check:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial\over\partial x} G(x, x')
    = \delta(x-x') (x'-x) + H(x-x') (-1) + \half
    = - H(x-x') + \half\\{\partial^2\over\partial x^2} G(x, x')
    = - \delta(x-x')\end{aligned}\end{align} \]</div>
<p>Then:</p>
<div class="math notranslate nohighlight">
\[u(x) = \int G(x, x') f(x') \d x'
    = \int \left(H(x-x') (x'-x) +\half(x-x')\right) f(x') \d x'\]</div>
<p>The green function can also be written using <span class="math notranslate nohighlight">\(x_&lt;=\min(x, x')\)</span> and
<span class="math notranslate nohighlight">\(x_&gt; = \max(x, x')\)</span>:</p>
<div class="math notranslate nohighlight">
\[G(x, x') = H(x-x') (x'-x) +\half(x-x')
    = \half(x_&lt; - x_&gt;)\]</div>
</div>
<div class="section" id="radial-poisson-equation">
<h3>Radial Poisson Equation<a class="headerlink" href="#radial-poisson-equation" title="Permalink to this headline">¶</a></h3>
<p>Let’s write <span class="math notranslate nohighlight">\(r_&gt;\)</span> and <span class="math notranslate nohighlight">\(r_&lt;\)</span> using the Heaviside step function:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}r_&gt; = \max(r, r')
    =
\begin{cases}
r&amp;\quad\mbox{for $r&gt;r'$}\cr
r'&amp;\quad\mbox{for $r&lt;r'$}\cr
\end{cases}
= H(r-r') r + H(r'-r)r' =\\= H(r-r') r + (1-H(r-r'))r'
= H(r-r') (r-r') + r'\end{aligned}\end{align} \]</div>
<p>and:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}r_&lt; = \min(r, r')
    =
\begin{cases}
r'&amp;\quad\mbox{for $r&gt;r'$}\cr
r&amp;\quad\mbox{for $r&lt;r'$}\cr
\end{cases}
= H(r-r') r' + H(r'-r)r =\\= H(r-r') r' + (1-H(r-r'))r
= H(r-r') (r'-r) + r\end{aligned}\end{align} \]</div>
<p>Then we can differentiate:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial\over\partial r} r_&gt;
    = \delta(r-r')(r-r') + H(r-r')
    = H(r-r')\\{\partial^2\over\partial r^2} r_&gt;
    = \delta(r-r')\\{\partial\over\partial r} r_&lt;
    = \delta(r-r')(r'-r) - H(r-r') + 1
    = 1-H(r-r') = H(r'-r)\\{\partial^2\over\partial r^2} r_&lt;
    = -\delta(r-r')\end{aligned}\end{align} \]</div>
<p>Given:</p>
<div class="math notranslate nohighlight" id="equation-rad-integral-u">
<span class="eqno">(3.20.4.1)<a class="headerlink" href="#equation-rad-integral-u" title="Permalink to this equation">¶</a></span>\[u(r) = \int_0^\infty {f(r') r'^2 \over r_&gt;} \d r'\]</div>
<p>The Green function is</p>
<div class="math notranslate nohighlight">
\[G(r, r') = {r'^2\over r_&gt;}\]</div>
<p>Let’s differentiate:</p>
<div class="math notranslate nohighlight">
\[{\partial\over\partial r} G(r, r') = -{r'^2\over r_&gt;^2}
        {\partial\over\partial r} r_&gt;
= -{r'^2\over r_&gt;^2} H(r-r')
= -{r'^2\over r^2} H(r-r')\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[{\partial^2\over\partial r^2} G(r, r') = +{2\over r}{r'^2\over r^2}
    H(r-r') -{r'^2\over r^2} \delta(r-r')\]</div>
<p>So we get:</p>
<div class="math notranslate nohighlight">
\[-{\partial^2\over\partial r^2} G(r, r')
    -{2\over r}{\partial\over\partial r} G(r, r')
    =-{2\over r}{r'^2\over r^2} H(r-r') +{r'^2\over r^2} \delta(r-r')
        +{2\over r}{r'^2\over r^2} H(r-r')
    ={r'^2\over r^2} \delta(r-r') = \delta(r-r')\]</div>
<p>So <span class="math notranslate nohighlight">\(u(r)\)</span> from <a class="reference internal" href="#equation-rad-integral-u">(3.20.4.1)</a> is a solution to the radial Poisson
equation:</p>
<div class="math notranslate nohighlight">
\[-{\d^2\over\d r^2} u(r) - {2\over r}{\d\over\d r}u(r) = f(r)\]</div>
</div>
<div class="section" id="helmholtz-equation-in-1d">
<h3>Helmholtz Equation in 1D<a class="headerlink" href="#helmholtz-equation-in-1d" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\left({\d^2\over\d x^2}+1\right)u(x)=f(x)\\\left({\d^2\over\d x^2}+1\right)G(x, x')=\delta(x-x')\end{aligned}\end{align} \]</div>
<p>with boundary conditions <span class="math notranslate nohighlight">\(u(0)=u({\pi\over2})=0\)</span>.
We use the Fourier transform:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\left((ik)^2+1\right)\tilde G(k, x')={e^{ikx'}\over\sqrt{2\pi}}\\\tilde G(k, x')={e^{ikx'}\over \sqrt{2\pi} (1-k^2)}\\G(x, x') = \half\sign(x-x')\sin(x-x')\end{aligned}\end{align} \]</div>
<p>Check:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial\over\partial x} G(x, x') = \delta(x-x')\sin(x-x')
    +\half\sign(x-x')\cos(x-x') =\\    = \half\sign(x-x')\cos(x-x')\\{\partial^2\over\partial x^2} G(x, x') = \delta(x-x')\cos(x-x')
    -\half\sign(x-x')\sin(x-x') =\\    = -\half\sign(x-x')\sin(x-x') + \delta(x-x')\\{\partial^2\over\partial x^2} G(x, x')
+{\partial\over\partial x} G(x, x') = \delta(x-x')\end{aligned}\end{align} \]</div>
<p>The general solution of the homogeneous equation is:</p>
<div class="math notranslate nohighlight">
\[u(x) = C_1 \sin x + C_2 \cos x\]</div>
<p>so the general Green function is:</p>
<div class="math notranslate nohighlight">
\[G(x, x') = \half\sign(x-x')\sin(x-x') + C_1 \sin (x+x')
    + C_2 \cos (x+x')\]</div>
<p>Satisfying the boundary conditions (for all <span class="math notranslate nohighlight">\(x' \ne 0\)</span>):</p>
<div class="math notranslate nohighlight">
\[G(0, x') = G({\pi\over 2}, x') = 0\]</div>
<p>we get:</p>
<div class="math notranslate nohighlight">
\[\begin{split}C_1 &amp; = -\half \\
C_2 &amp; = 0\end{split}\]</div>
<p>and:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}G(x, x') = \half\sign(x-x')\sin(x-x') -\half \sin (x+x') =\\=-H(x'-x)\sin x\cos x' - H(x - x') \cos x \sin x' =\\=
\begin{cases}
-\sin x\cos x'&amp;\quad x&lt;x'\cr
-\cos x\sin x'&amp;\quad x&gt;x'\cr
\end{cases}
=-\sin x_&lt; \cos x_&gt;\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ u(x) = \int G(x, x')f(x')\d x'
=-\cos x\int_0^xf(x')\sin x'\d x'
-\sin x\int_x^{\pi\over2}f(x')\cos x'\d x'\]</div>
<p>To show that this really works, let’s take for example <span class="math notranslate nohighlight">\(f(x)=3\sin2x\)</span>. Then</p>
<div class="math notranslate nohighlight">
\[u(x)
=-\cos x\int_0^x3\sin 2x'\sin x'\d x'
-\sin x\int_x^{\pi\over2}3\sin 2x'\cos x'\d x'\]</div>
<p>We can use SymPy to evaluate the integrals:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">u</span> <span class="o">=</span> <span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">integrate</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span> <span class="o">-</span> \
    <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">integrate</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">u</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="o">-</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">simplify</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
     <span class="mi">2</span>                  <span class="mi">2</span>
<span class="o">-</span> <span class="n">cos</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">sin</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">trigsimp</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>And we get</p>
<div class="math notranslate nohighlight">
\[u(x)=-\sin 2x\]</div>
<p>We can easily check, that <span class="math notranslate nohighlight">\(u''+u=3\sin2x\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span>
<span class="go">3*sin(2*x)</span>
</pre></div>
</div>
<p>and since <span class="math notranslate nohighlight">\(f(x) = 3\sin2x\)</span>, we have verified, that <span class="math notranslate nohighlight">\(u(x)=-\sin 2x\)</span> is the correct
solution.</p>
</div>
<div class="section" id="poisson-equation-in-2d">
<h3>Poisson Equation in 2D<a class="headerlink" href="#poisson-equation-in-2d" title="Permalink to this headline">¶</a></h3>
<p>Let <span class="math notranslate nohighlight">\({\bf x}=(x, y)\)</span> and we want to solve:</p>
<div class="math notranslate nohighlight">
\[\nabla^2u({\bf x})=f({\bf x})\]</div>
<p>So we have:</p>
<div class="math notranslate nohighlight">
\[\nabla^2G({\bf x}, {\bf x'})=\delta({\bf x}-{\bf x'})\]</div>
<p>The solution is:</p>
<div class="math notranslate nohighlight">
\[G({\bf x}, {\bf x'})
={1\over2\pi}\log|{\bf x}-{\bf x'}|
={1\over4\pi}\log|{\bf x}-{\bf x'}|^2
={1\over4\pi}\log((x-x')^2+(y-y')^2)\]</div>
</div>
<div class="section" id="poisson-equation-in-3d">
<h3>Poisson Equation in 3D<a class="headerlink" href="#poisson-equation-in-3d" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\nabla^2u(x)=f(x)\\\nabla^2G(x, x')=\delta(x-x')\end{aligned}\end{align} \]</div>
<p>with boundary condition <span class="math notranslate nohighlight">\(G(x) = 0\)</span> at infinity. Then:</p>
<div class="math notranslate nohighlight">
\[G(x, x')=-{1\over4\pi}{1\over|x-x'| }\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[u(x) = -{1\over4\pi}\int {f(x')\over|x-x'| }\d x'\]</div>
</div>
<div class="section" id="helmholtz-equation-in-3d">
<h3>Helmholtz Equation in 3D<a class="headerlink" href="#helmholtz-equation-in-3d" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(\nabla^2+k^2)u(x)=f(x)\\(\nabla^2+k^2)G(x, x')=\delta(x-x')\end{aligned}\end{align} \]</div>
<p>with boundary condition <span class="math notranslate nohighlight">\(G(x) = 0\)</span> at infinity. Then:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}G(x, x')=-{1\over4\pi}{e^{ik|x-x'| }\over|x-x'| }\\u(x) = -{1\over4\pi}\int {f(x')e^{ik|x-x'| }\over|x-x'| }\d x'\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="finite-element-method">
<h3>Finite Element Method<a class="headerlink" href="#finite-element-method" title="Permalink to this headline">¶</a></h3>
<p>Let’s show it on the Laplace equation. We want to solve:</p>
<div class="math notranslate nohighlight">
\[\nabla^2G(x, x')=\delta(x-x')\]</div>
<p>We will treat <span class="math notranslate nohighlight">\(x'\)</span> as a parameter, so we define <span class="math notranslate nohighlight">\(g_{x'}(x)\equiv G(x, x')\)</span>:</p>
<div class="math notranslate nohighlight">
\[\nabla^2g_{x'}(x)=\delta(x-x')\]</div>
<p>We set <span class="math notranslate nohighlight">\(g_{x'}(x)=0\)</span> on the boundary and we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}-\int\nabla g_{x'}(x) \cdot \nabla v(x) \d x = \int v(x)\delta(x-x')\d x\\-\int\nabla g_{x'}(x) \cdot \nabla v(x) \d x = v(x')\end{aligned}\end{align} \]</div>
<p>So we choose <span class="math notranslate nohighlight">\(x'\)</span> and then solve for <span class="math notranslate nohighlight">\(g_{x'}(x)\)</span> using FEM and we get the
Green function <span class="math notranslate nohighlight">\(G(x, x')\)</span> for all <span class="math notranslate nohighlight">\(x\)</span> and one particular <span class="math notranslate nohighlight">\(x'\)</span>. We can then
evaluate the integral <a class="reference internal" href="#equation-solution">(3.20.1.2)</a> numerically – one would have to use FEM
for all <span class="math notranslate nohighlight">\(x'\)</span> that are needed in the integral, so that is not efficient, but it
should work. One will then be able to play with Green functions and be able to
calculate them numerically for any boundary condition (which is not possible
analytically).</p>
</div>
</div>
</div>
<div class="section" id="binomial-coefficients">
<h1>3.21. Binomial Coefficients<a class="headerlink" href="#binomial-coefficients" title="Permalink to this headline">¶</a></h1>
<p>For <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(k\)</span> integers, the binomial coefficients are defined by:</p>
<div class="math notranslate nohighlight">
\[\binom{n}{k} = {n!\over k! (n-k)!} =
    {n (n-1) \cdots (n-k+1)\over k!}\]</div>
<p>For <span class="math notranslate nohighlight">\(r\)</span> real, one just uses the second formula as a definition:</p>
<div class="math notranslate nohighlight">
\[\binom{r}{k} = {r (r-1) \cdots (r-k+1)\over k!}\]</div>
<p>Example I:</p>
<div class="math notranslate nohighlight">
\[\binom{-n}{k}
    = {(-n) (-n-1) \cdots (-n-k+1)\over k!}
    = (-1)^{k} {n (n+1) \cdots (n+k-1)\over k!}
    = (-1)^{k}\binom{n+k-1}{k}\]</div>
<p>Example II:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\binom{k-\half}{k}
    = {(k-\half) (k-\half-1) \cdots (k-\half-k+1)\over k!}
    = {(k-\half) (k-\half-1) \cdots \half\over k!} =\\    = {(2k-1) (2k-3) \cdots 1\over 2^k k!}
    = {(2k-1)!!\over 2^k k!}
    = {(2k)!\over (2^k k!)^2}
    = {1\over 4^k}\binom{2k}{k}\end{aligned}\end{align} \]</div>
<p>The binomial formula is for <span class="math notranslate nohighlight">\(n\)</span> integer:</p>
<div class="math notranslate nohighlight">
\[(x+y)^n = \sum_{k=0}^n \binom{n}{k} x^k y^{n-k}\]</div>
<p>and for <span class="math notranslate nohighlight">\(r\)</span> real and <span class="math notranslate nohighlight">\(|x| &lt; |y|\)</span> this can be generalized to:</p>
<div class="math notranslate nohighlight">
\[(x+y)^r = \sum_{k=0}^\infty \binom{r}{k} x^k y^{r-k}\]</div>
<p>Example: (for <span class="math notranslate nohighlight">\(|x| &lt; 1\)</span>)</p>
<div class="math notranslate nohighlight">
\[(1 + x)^{-n} = \sum_{k=0}^\infty \binom{-n}{k} x^k
    = \sum_{k=0}^\infty (-1)^k\binom{n+k-1}{k} x^k
    = \sum_{k=0}^\infty \binom{n+k-1}{k} (-x)^k\]</div>
<p>so:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(1 - x)^{-n} = \sum_{k=0}^\infty \binom{n+k-1}{k} x^k\\(1 - x)^{-1} = \sum_{k=0}^\infty \binom{1+k-1}{k} x^k
    = \sum_{k=0}^\infty \binom{k}{k} x^k
    = \sum_{k=0}^\infty x^k\\(1 - x)^{-\half} = \sum_{k=0}^\infty \binom{\half+k-1}{k} x^k
= \sum_{k=0}^\infty \binom{k-\half}{k} x^k
= \sum_{k=0}^\infty {1\over 4^k}\binom{2k}{k} x^k\end{aligned}\end{align} \]</div>
<p>Another example:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{1\over\sqrt{1-2xt+t^2}} = \left(1-(2xt-t^2)\right)^{-\half}
    = \sum_{n=0}^\infty {1\over 4^n}\binom{2n}{n} (2xt-t^2)^n =\\    = \sum_{n=0}^\infty {1\over 4^n}\binom{2n}{n} \sum_{k=0}^n
        \binom{n}{k} (-t^2)^k (2xt)^{n-k} =\\    = \sum_{n=0}^\infty {1\over 4^n}\binom{2n}{n} \sum_{k=0}^n
        \binom{n}{k} (-1)^k t^{2k} (2x)^{n-k} t^{n-k} =\\    = \sum_{n=0}^\infty {1\over 4^n}\binom{2n}{n} \sum_{k=0}^n
        \binom{n}{k} (-1)^k t^{n+k} (2x)^{n-k} =\\    = \sum_{n=0}^\infty \sum_{k=0}^{\left\lfloor n\over 2 \right\rfloor}
        {1\over 4^{n-k}}\binom{2n-2k}{n-k}
        \binom{n-k}{k} (-1)^k t^{n} (2x)^{n-2k} =\\    = \sum_{n=0}^\infty \left(
        {1\over 2^n}
        \sum_{k=0}^{\left\lfloor n\over 2 \right\rfloor}
        (-1)^k
        \binom{n}{k}
        \binom{2n-2k}{n}
        x^{n-2k} \right) t^{n} =\\    = \sum_{n=0}^\infty \left(
        {1\over 2^n}
        \sum_{k=0}^{\left\lfloor n\over 2 \right\rfloor}
        (-1)^k
        \binom{n}{k}
        {1\over n!}{\d^n \over \d x^n} x^{2n-2k}
        \right) t^{n} =\\    = \sum_{n=0}^\infty \left(
        {1\over 2^n}
        \sum_{k=0}^n
        (-1)^k
        \binom{n}{k}
        {1\over n!}{\d^n \over \d x^n} x^{2n-2k}
        \right) t^{n} =\\    = \sum_{n=0}^\infty \left(
        {1\over 2^n n!}
        {\d^n \over \d x^n} (x^2 - 1)^n
        \right) t^{n} =\\    = \sum_{n=0}^\infty P_n(x) t^{n}\end{aligned}\end{align} \]</div>
<p>where we used <a class="reference internal" href="#equation-double-sum-2">(3.22.2)</a> and</p>
<div class="math notranslate nohighlight">
\[\binom{2n-2k}{n-k} \binom{n-k}{k} = \binom{2n-2k}{n} \binom{n}{k}\]</div>
<p>The <span class="math notranslate nohighlight">\(P_n(x)\)</span> are <a class="reference internal" href="spherical-harmonics.html#legendre-polynomials"><span class="std std-ref">Legendre Polynomials</span></a>.</p>
</div>
<div class="section" id="double-sums">
<h1>3.22. Double Sums<a class="headerlink" href="#double-sums" title="Permalink to this headline">¶</a></h1>
<p>When evaluating double sums, one can use triangular summation to reorder them:</p>
<div class="math notranslate nohighlight" id="equation-double-sum-1">
<span class="eqno">(3.22.1)<a class="headerlink" href="#equation-double-sum-1" title="Permalink to this equation">¶</a></span>\[\sum_{n=0}^\infty \sum_{k=0}^\infty a_{n k} =
\sum_{n=0}^\infty \sum_{k=0}^n a_{n-k, k}\]</div>
<p>Also it holds</p>
<div class="math notranslate nohighlight" id="equation-double-sum-2">
<span class="eqno">(3.22.2)<a class="headerlink" href="#equation-double-sum-2" title="Permalink to this equation">¶</a></span>\[\sum_{n=0}^\infty \sum_{k=0}^n a_{n k} =
    \sum_{n=0}^\infty \sum_{k=0}^{\left\lfloor n\over 2 \right\rfloor}
        a_{n-k, k}\]</div>
</div>
<div class="section" id="triangle-inequality">
<h1>3.23. Triangle Inequality<a class="headerlink" href="#triangle-inequality" title="Permalink to this headline">¶</a></h1>
<p>Triangle inequality (condition) means that none of the three
quantities <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span> is greater than the sum of the other two:</p>
<div class="math notranslate nohighlight" id="equation-trig-three">
<span class="eqno">(3.23.1)<a class="headerlink" href="#equation-trig-three" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}a + b \ge c\\b + c \ge a\\c + a \ge b\end{aligned}\end{align} \]</div>
<p>This is equivalent to just one equation:</p>
<div class="math notranslate nohighlight" id="equation-trig-one">
<span class="eqno">(3.23.2)<a class="headerlink" href="#equation-trig-one" title="Permalink to this equation">¶</a></span>\[|a-b| \le c \le a+b\]</div>
<p>we can do any permutation of the symbols, i.e. the above equation is equivalent
to any of these:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}|b-c| \le a \le b+c\\|c-a| \le b \le c+a\end{aligned}\end{align} \]</div>
<p>So instead of stating the three inequalities <a class="reference internal" href="#equation-trig-three">(3.23.1)</a> it is more
convenient to just write <a class="reference internal" href="#equation-trig-one">(3.23.2)</a>, using any permutation that we like.</p>
<p>To show, that <a class="reference internal" href="#equation-trig-three">(3.23.1)</a> implies <a class="reference internal" href="#equation-trig-one">(3.23.2)</a> we rewrite
<a class="reference internal" href="#equation-trig-three">(3.23.1)</a>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}a + b \ge c\\c \ge a-b\\c \ge b-a\end{aligned}\end{align} \]</div>
<p>so</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}a + b \ge c\\c \ge |a-b|\end{aligned}\end{align} \]</div>
<p>and we get <a class="reference internal" href="#equation-trig-one">(3.23.2)</a>.
To show, that <a class="reference internal" href="#equation-trig-one">(3.23.2)</a> implies <a class="reference internal" href="#equation-trig-three">(3.23.1)</a> we rewrite
<a class="reference internal" href="#equation-trig-one">(3.23.2)</a> for <span class="math notranslate nohighlight">\(a\ge b\)</span> first:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}a \ge b\\|a-b| \le c \le a+b\end{aligned}\end{align} \]</div>
<p>so:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}a \ge b\\a-b \le c \le a+b\end{aligned}\end{align} \]</div>
<p>rearranging:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}a + b \ge c\\b + c \ge a\\a \ge b\end{aligned}\end{align} \]</div>
<p>since <span class="math notranslate nohighlight">\(c\)</span> is positive, if <span class="math notranslate nohighlight">\(a\ge b\)</span> then also <span class="math notranslate nohighlight">\(c+a\ge b\)</span> and we get
<a class="reference internal" href="#equation-trig-three">(3.23.1)</a>. Finally, for <span class="math notranslate nohighlight">\(a &lt; b\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}a &lt; b\\|a-b| \le c \le a+b\end{aligned}\end{align} \]</div>
<p>so:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}a &lt; b\\-(a-b) \le c \le a+b\end{aligned}\end{align} \]</div>
<p>rearranging:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}a + b \ge c\\b &gt; a\\c + a \ge b\end{aligned}\end{align} \]</div>
<p>since <span class="math notranslate nohighlight">\(c\)</span> is positive, if <span class="math notranslate nohighlight">\(b &gt; a\)</span> then also <span class="math notranslate nohighlight">\(b+c\ge a\)</span> and we get
<a class="reference internal" href="#equation-trig-three">(3.23.1)</a>.</p>
</div>
<div class="section" id="gamma-function">
<h1>3.24. Gamma Function<a class="headerlink" href="#gamma-function" title="Permalink to this headline">¶</a></h1>
<p>The Gamma function <span class="math notranslate nohighlight">\(\Gamma(x)\)</span> is defined by the following properties
for <span class="math notranslate nohighlight">\(x &gt; 0\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-gamma1">
<span class="eqno">(3.24.1)<a class="headerlink" href="#equation-gamma1" title="Permalink to this equation">¶</a></span>\[\Gamma(1) = 1\]</div>
<div class="math notranslate nohighlight" id="equation-gamma2">
<span class="eqno">(3.24.2)<a class="headerlink" href="#equation-gamma2" title="Permalink to this equation">¶</a></span>\[\Gamma(x+1) = x \Gamma(x)\]</div>
<div class="math notranslate nohighlight" id="equation-gamma3">
<span class="eqno">(3.24.3)<a class="headerlink" href="#equation-gamma3" title="Permalink to this equation">¶</a></span>\[\log\Gamma(x) \quad\mbox{is convex}\]</div>
<p>It can be shown that this determines the function uniquely for <span class="math notranslate nohighlight">\(x &gt; 0\)</span> (this is
called the Bohr-Mollerup theorem) and then it can be extended analytically to
the whole complex plane.</p>
<p>The most common formula for <span class="math notranslate nohighlight">\(\Gamma(z)\)</span> that satisfies <a class="reference internal" href="#equation-gamma1">(3.24.1)</a>,
<a class="reference internal" href="#equation-gamma2">(3.24.2)</a> and <a class="reference internal" href="#equation-gamma3">(3.24.3)</a>
is:</p>
<div class="math notranslate nohighlight" id="equation-gamma-int">
<span class="eqno">(3.24.4)<a class="headerlink" href="#equation-gamma-int" title="Permalink to this equation">¶</a></span>\[\Gamma(z) = \int_0^\infty t^{z-1} e^{-t} \d t\]</div>
<p>It satisfies <a class="reference internal" href="#equation-gamma1">(3.24.1)</a> because:</p>
<div class="math notranslate nohighlight">
\[\Gamma(1)
    = \int_0^\infty t^{1-1} e^{-t} \d t
    = \int_0^\infty e^{-t} \d t
    = [-e^{-t}]_0^\infty
    = 1\]</div>
<p>It satisfies <a class="reference internal" href="#equation-gamma2">(3.24.2)</a> by integrating by parts:</p>
<div class="math notranslate nohighlight">
\[\Gamma(z)
    = \int_0^\infty t^{z-1} e^{-t} \d t
    = (z-1)\int_0^\infty t^{z-2} e^{-t} \d t-[t^{z-1}e^{-t}]_0^\infty
    = (z-1)\Gamma(z-1)\]</div>
<p>Finally it satisfies <a class="reference internal" href="#equation-gamma3">(3.24.3)</a> by verifying the convex condition
directly (<span class="math notranslate nohighlight">\(x, y &gt; 0\)</span> and <span class="math notranslate nohighlight">\(0\le \lambda \le 1\)</span>):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\log\Gamma(\lambda x + (1-\lambda) y)
    = \log\int_0^\infty t^{\lambda x + (1-\lambda) y - 1} e^{-t} \d t =\\    = \log \int_0^\infty (t^{x-1} e^{-t})^\lambda
        (t^{y-1} e^{-t})^{1-\lambda} \d t \le\\    \le \log \left(
        \left(\int_0^\infty t^{x-1} e^{-t} \d t\right)^\lambda
        \left(\int_0^\infty t^{y-1} e^{-t} \d t\right)^{1-\lambda}\right) =\\    = \lambda \log\Gamma(x) + (1-\lambda) \log \Gamma(y)\end{aligned}\end{align} \]</div>
<p>And thus <a class="reference internal" href="#equation-gamma-int">(3.24.4)</a> uniquely determines the Gamma function.
We can use <a class="reference internal" href="#equation-gamma-int">(3.24.4)</a> to calculate <span class="math notranslate nohighlight">\(\Gamma(\half)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\Gamma(\half)
    = \int_0^\infty t^{{1\over2}-1} e^{-t} \d t
    = \int_0^\infty {e^{-t}\over\sqrt t} \d t
    = \int_0^\infty {e^{-x^2}\over x} 2x\, \d x
    = 2\int_0^\infty e^{-x^2} \d x =\\    = \int_{-\infty}^\infty e^{-x^2} \d x
    = \sqrt{
        \int_{-\infty}^\infty e^{-x^2} \d x
        \int_{-\infty}^\infty e^{-y^2} \d y
        }
    = \sqrt{2\pi \int_0^\infty e^{-r^2} r\d r} =\\    = \sqrt{2\pi \int_0^\infty e^{-u} \half\d u}
    = \sqrt\pi\end{aligned}\end{align} \]</div>
<p>From this and the definition of the Gamma function we get
for integer <span class="math notranslate nohighlight">\(n\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-gamma-fact">
<span class="eqno">(3.24.5)<a class="headerlink" href="#equation-gamma-fact" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}\Gamma(n+1) = n\Gamma(n) = n(n-1)\Gamma(n-1)
    = n(n-1)(n-2)\cdots 2\cdot1\cdot\Gamma(1) =\\    = n(n-1)(n-2)\cdots 1
    = n!\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-gamma-double-fact">
<span class="eqno">(3.24.6)<a class="headerlink" href="#equation-gamma-double-fact" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}\Gamma(n+\half) = (n-\half)\Gamma(n-\half)
    = (n-\half)(n-1-\half)\Gamma(n-1-\half)
    = (n-\half)(n-1-\half)\cdots\half\Gamma(\half) =\\    = {2n-1\over2}{2n-3\over2}{2n-5\over2}\cdots{1\over2}\Gamma(\half)
    = {(2n-1)!!\over 2^n}\Gamma(\half)
    = {(2n-1)!!\over 2^n}\sqrt\pi\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="incomplete-gamma-function">
<h1>3.25. Incomplete Gamma Function<a class="headerlink" href="#incomplete-gamma-function" title="Permalink to this headline">¶</a></h1>
<p>The upper incomplete gamma function is defined by:</p>
<div class="math notranslate nohighlight">
\[\Gamma(z, x) = \int_x^\infty t^{z-1} e^{-t} \d t\]</div>
<p>Integrating by parts we get:</p>
<div class="math notranslate nohighlight">
\[\Gamma(z+1, x)
    = \int_x^\infty t^z e^{-t} \d t
    = z\int_x^\infty t^{z-1} e^{-t} \d t-[t^ze^{-t}]_x^\infty
    = z\Gamma(z, x) + x^z e^{-x}\]</div>
<p>Some special values are:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\Gamma(z, 0) = \int_0^\infty t^{z-1} e^{-t} \d t = \Gamma(z)\\\Gamma(1, x) = \int_x^\infty e^{-t} \d t = -[e^{-t}]_x^\infty = e^{-x}\\\Gamma(\half, x)
    = \int_x^\infty t^{-\half} e^{-t} \d t
    = 2\int_{\sqrt{x}}^\infty e^{-s^2} \d s
    = \sqrt{\pi} \mbox{erfc}(\sqrt{x})\end{aligned}\end{align} \]</div>
<p>For integer <span class="math notranslate nohighlight">\(n\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\Gamma(n+1, x)
    = n\Gamma(n, x) + x^n e^{-x}
    = n(n-1)\Gamma(n-1, x) + (n x^{n-1} + x^n) e^{-x} =\\    = n(n-1)(n-2)\Gamma(n-2, x) + (n (n-1) x^{n-2}
        + n x^{n-1} + x^n) e^{-x} =\\    = n(n-1)(n-2)\cdots 2\cdot 1\cdot \Gamma(1, x)
        + (n(n-1)\cdots 2 x^1 + \cdots
          + n (n-1) x^{n-2} + n x^{n-1} + x^n) e^{-x} =\\    = n! e^{-x} + (n(n-1)\cdots 2 x^1 + \cdots
          + n (n-1) x^{n-2} + n x^{n-1} + x^n) e^{-x} =\\    = n! e^{-x}\sum_{\nu=0}^n {x^\nu\over\nu!}\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\Gamma(n+\half, x)
    = (n-\half)\Gamma(n-\half, x) + x^{n-\half} e^{-x}
    = (n-\half)(n-1-\half)\Gamma(n-1-\half, x)
        + ((n-\half) x^{n-1-\half} + x^{n-\half})) e^{-x} =\\    = (n-\half)(n-1-\half)\cdots\half\Gamma(\half, x)
        + ((n-\half)(n-1-\half)\cdots(1+\half) x^\half + \cdots +
            (n-\half) x^{n-1-\half} + x^{n-\half})) e^{-x} =\\    = {(2n-1)!!\over 2^n}\Gamma(\half, x)
        +
        {(2n-1)!!\over 2^n} e^{-x}\sum_{\nu=1}^n
            {2^\nu x^{\nu-\half}\over(2\nu-1)!!} =\\    = {(2n-1)!!\over 2^n}\left(\sqrt\pi \mbox{erfc}(\sqrt x)
        +
        e^{-x}\sum_{\nu=1}^n
            {2^\nu x^{\nu-\half}\over(2\nu-1)!!} \right)\end{aligned}\end{align} \]</div>
<p>The lower incomplete gamma function is defined by:</p>
<div class="math notranslate nohighlight">
\[\gamma(z, x) = \int_0^x t^{z-1} e^{-t} \d t = \Gamma(z) - \Gamma(z, x)\]</div>
<p>and as such all expressions can be easily derived using the gamma and upper
incomplete gamma functions.
The recursion relation is then:</p>
<div class="math notranslate nohighlight">
\[\gamma(z+1, x) = \Gamma(z+1) - \Gamma(z+1, x)
    = z \Gamma(z) - (z\Gamma(z, x) + x^z e^{-x})
    = z \gamma(z, x) - x^z e^{-x}\]</div>
<p>Some special values are:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\gamma(z, 0) = \Gamma(z) - \Gamma(z, 0) = \Gamma(z) - \Gamma(z) = 0\\\gamma(1, x) = \Gamma(1) - \Gamma(1, x) = 1 - e^{-x}\\\gamma(\half, x) = \Gamma(\half) - \Gamma(\half, x)
    = \sqrt\pi - \sqrt\pi \mbox{erfc}(\sqrt x)
    = \sqrt\pi \mbox{erf}(\sqrt x)\end{aligned}\end{align} \]</div>
<p>By repeated application of the recursion formula we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\gamma(z, x)
    = {1\over z}\gamma(z+1, x) + e^{-x} {x^z\over z}
    = {1\over z(z+1)}\gamma(z+2, x) + e^{-x} \left({x^z\over z}
        + {x^{z+1}\over z(z+1)}\right) =\\    = {1\over z(z+1)\cdots(z+n)}\gamma(z+n+1, x) + e^{-x}
        \sum_{k=0}^n {x^{z+k}\over z(z+1)\cdots(z+k)} =\\    = {\Gamma(z)\over \Gamma(z+n+1)}\gamma(z+n+1, x) + x^z
        \Gamma(z) e^{-x} \sum_{k=0}^n {x^k\over \Gamma(z+k+1)} =\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight" id="equation-gamma-series">
<span class="eqno">(3.25.1)<a class="headerlink" href="#equation-gamma-series" title="Permalink to this equation">¶</a></span>\[    = x^z \Gamma(z) e^{-x} \sum_{k=0}^\infty {x^k\over \Gamma(z+k+1)}\]</div>
<p>where we used:</p>
<div class="math notranslate nohighlight">
\[\lim_{z\to\infty} {\gamma(z, x)\over\Gamma(z)} = 0\]</div>
<p>which can be proven by the following inequality which uses the fact that the
function <span class="math notranslate nohighlight">\(f(t) = t^{z-1} e^{-t}\)</span> is an increasing function for <span class="math notranslate nohighlight">\(t &lt; z-1\)</span>, so as
long as <span class="math notranslate nohighlight">\(x &lt; z-1\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\gamma(z, x)
    = \int_0^x t^{z-1} e^{-t} \d t
    = \int_0^x f(t) \d t &lt;\\    &lt; \int_0^x f(x) \d t = x f(x) =\\    = {x \over z - 1 - x} \int_x^{z-1} f(x) \d t &lt;\\    &lt; {x \over z - 1 - x} \int_x^{z-1} f(t) \d t &lt;\\    &lt; {x \over z - 1 - x} \int_0^\infty f(t) \d t =\\    = {x \over z - 1 - x} \Gamma(z)\end{aligned}\end{align} \]</div>
<p>Using <a class="reference internal" href="#equation-gamma-series">(3.25.1)</a> we can now write <span class="math notranslate nohighlight">\(\gamma(z, x)\)</span> using the Kummer
confluent hypergeometric function <span class="math notranslate nohighlight">\({}_1F_1(a, b, z)\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[\gamma(z, x)
    = x^z \Gamma(z) e^{-x} \sum_{k=0}^\infty {x^k\over \Gamma(z+k+1)}
    = x^z z^{-1} e^{-x}\, {}_1F_1(1, z+1, x)
    = x^z z^{-1}\, {}_1F_1(z, z+1, -x)\]</div>
<div class="section" id="example">
<h2>3.25.1. Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Consider the class of integrals:</p>
<div class="math notranslate nohighlight">
\[F_m(t) = \int_0^1 u^{2m} e^{-tu^2} \d u, \quad\quad
    \mbox{($t&gt;0$; $m=0,1,2,\dots$)}\]</div>
<p>We write them using the lower incomplete gamma function as:</p>
<div class="math notranslate nohighlight">
\[F_m(t) = \int_0^t \left(v\over t\right)^m e^{-v}
        \left(v\over t\right)^{-\half}{\d v\over 2 t}
    = {1\over 2 t^{m+\half}}\int_0^t v^{m-\half} e^{-v} \d v
    = {\gamma(m+\half, t)\over 2 t^{m+\half}}\]</div>
<p>We can also write it using the confluent hypergeometric function as follows:</p>
<div class="math notranslate nohighlight">
\[F_m(t) = {\gamma(m+\half, t)\over 2 t^{m+\half}}
    = {t^{m+\half}(m+\half)^{-1} \over 2 t^{m+\half}}
        \,{}_1F_1(m+\half, m+{\textstyle{3\over2}}, -t)
    = {{}_1F_1(m+\half, m+{\textstyle{3\over2}}, -t)\over 2m+1}\]</div>
<p>For <span class="math notranslate nohighlight">\(m=0\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[F_0(t) = {\gamma(\half, t)\over 2 t^{\half}}
    = \half \sqrt{\pi\over t} \mbox{erf}(\sqrt t)\]</div>
<p>Using the recursion relation we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}F_{m+1}(t)
    = {\gamma(m+\half+1, t)\over 2 t^{m+\half+1}}
    = {(m+\half)\gamma(m+\half, t)-t^{m+\half}e^{-t}\over 2 t^{m+\half} t}
    = {(m+\half)\over t}F_m(t)-{e^{-t}\over 2 t} =\\    = {(2m+1) F_m(t)-e^{-t}\over 2 t}\end{aligned}\end{align} \]</div>
<p>By expressing <span class="math notranslate nohighlight">\(F_m(t)\)</span> from the equation we obtain the inverse relation:</p>
<div class="math notranslate nohighlight">
\[F_m(t) = {2t F_{m+1}(t) + e^{-t}\over 2m+1}\]</div>
<p>From <a class="reference internal" href="#equation-gamma-series">(3.25.1)</a> we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}F_m(t)
    = {\gamma(m+\half, t)\over 2 t^{m+\half}}
    = {1\over 2 t^{m+\half}}
    t^{m+\half} \Gamma(m+\half) e^{-t} \sum_{k=0}^\infty {t^k\over
        \Gamma(m+\half+k+1)} =\\    = \half \Gamma(m+\half) e^{-t} \sum_{k=0}^\infty {t^k\over
        \Gamma(m+k+{3\over2})} =\\    = \half {(2m-1)!! \sqrt\pi\over 2^m} e^{-t} \sum_{k=0}^\infty {t^k\over
        {(2m+2k+1)!!\sqrt\pi\over 2^{m+k+1}}} =\\    = e^{-t} \sum_{k=0}^\infty {(2m-1)!! (2t)^k\over (2m+2k+1)!!} =\\    = e^{-t} \sum_{k=0}^\infty {(2t)^k\over (2m+1)(2m+3)\cdots(2m+2k+1)}\end{aligned}\end{align} \]</div>
</div>
</div>
<div class="section" id="factorial">
<h1>3.26. Factorial<a class="headerlink" href="#factorial" title="Permalink to this headline">¶</a></h1>
<p>The factorial <span class="math notranslate nohighlight">\(n!\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[n! = n(n-1)(n-2)\cdots 3\cdot2\cdot 1\]</div>
<p>By <a class="reference internal" href="#equation-gamma-fact">(3.24.5)</a> it can be written using the Gamma function as:</p>
<div class="math notranslate nohighlight">
\[n! = \Gamma(n+1)\]</div>
</div>
<div class="section" id="double-factorial">
<h1>3.27. Double Factorial<a class="headerlink" href="#double-factorial" title="Permalink to this headline">¶</a></h1>
<p>The double factorial <span class="math notranslate nohighlight">\(n!!\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}n!! = \begin{cases}
    n(n-2)(n-4)(n-6)\cdots 5\cdot3\cdot1\quad\quad\mbox{for odd $n=2k+1$} \\
    n(n-2)(n-4)(n-6)\cdots 6\cdot4\cdot2\quad\quad\mbox{for even $n=2k$}
\end{cases}\end{split}\]</div>
<p>One can rewrite double factorial using a factorial as:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(2k)!! = 2\cdot4\cdot6\cdots (2k)
    = 2^k (1\cdot2\cdot3\cdots k)
    = 2^k k!\\(2k-1)!!
    = 1\cdot3\cdot5\cdots(2k-1)
    = {1\cdot2\cdot3\cdot4\cdot5\cdots(2k) \over 2\cdot4\cdot6\cdots (2k)}
    = {(2k)!\over (2k)!!} = {(2k)!\over 2^k k!}\end{aligned}\end{align} \]</div>
<p>For odd <span class="math notranslate nohighlight">\(n\)</span> it can be written using the Gamma function, see <a class="reference internal" href="#equation-gamma-double-fact">(3.24.6)</a>:</p>
<div class="math notranslate nohighlight">
\[(2k-1)!! = {1\over\sqrt\pi} 2^k \Gamma\left(k+\half\right)\]</div>
<div class="section" id="id2">
<h2>3.27.1. Example<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}A(n) = {1\cdot3\cdot5 \cdot \dots \cdot (2n-1) \over
    1\cdot 2\cdot 3\cdot \dots \cdot n}
    = {(2n-1)!!\over n!}
    = {(2n)!\over 2^n (n!)^2}
    = {1\over 2^n}\binom{2n}{n}\\B(n) = {1\cdot3\cdot5 \cdot \dots \cdot (2n-1) \over
    2\cdot 4\cdot\cdot6 \dots \cdot 2n}
    = {(2n-1)!!\over (2n)!!}
    = {(2n)!\over (2^n n!)^2}
    = {1\over 4^n}\binom{2n}{n}\end{aligned}\end{align} \]</div>
</div>
</div>
<div class="section" id="fermi-dirac-integral">
<span id="fermi-integral"></span><h1>3.28. Fermi-Dirac Integral<a class="headerlink" href="#fermi-dirac-integral" title="Permalink to this headline">¶</a></h1>
<p>The Fermi-Dirac integral (sometimes just called a Fermi integral) is defined
as:</p>
<div class="math notranslate nohighlight">
\[I_\alpha(\mu) = \int_0^\infty {\epsilon^\alpha \d\epsilon \over
    e^{\epsilon-\mu} + 1}\]</div>
<p>Examples:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}I_{1\over 2}(\mu) = \int_0^\infty {\sqrt \epsilon \d\epsilon \over
    e^{\epsilon-\mu} + 1}\\I_{3\over 2}(\mu) = \int_0^\infty {\epsilon^{3\over2} \d\epsilon \over
    e^{\epsilon-\mu} + 1}\end{aligned}\end{align} \]</div>
<p>The Fermi-Dirac integral can also be written using the polylogarithm, see
<a class="reference internal" href="hyper.html#fermi-dirac-poly"><span class="std std-ref">The Series pFq</span></a> for details.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3.15. Delta Function</a></li>
<li><a class="reference internal" href="#distributions">3.16. Distributions</a></li>
<li><a class="reference internal" href="#variations-and-functional-derivatives">3.17. Variations and Functional Derivatives</a><ul>
<li><a class="reference internal" href="#functions-of-one-variable">3.17.1. Functions of One Variable</a></li>
<li><a class="reference internal" href="#functions-of-several-variables">3.17.2. Functions of several variables</a></li>
<li><a class="reference internal" href="#functionals">3.17.3. Functionals</a></li>
<li><a class="reference internal" href="#examples">3.17.4. Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dirac-notation">3.18. Dirac Notation</a></li>
<li><a class="reference internal" href="#homogeneous-functions-euler-s-theorem">3.19. Homogeneous Functions (Euler’s Theorem)</a><ul>
<li><a class="reference internal" href="#example-1">3.19.1. Example 1</a></li>
<li><a class="reference internal" href="#example-2">3.19.2. Example 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#green-functions">3.20. Green Functions</a><ul>
<li><a class="reference internal" href="#introduction">3.20.1. Introduction</a></li>
<li><a class="reference internal" href="#boundary-conditions">3.20.2. Boundary Conditions</a></li>
<li><a class="reference internal" href="#symmetry">3.20.3. Symmetry</a></li>
<li><a class="reference internal" href="#id1">3.20.4. Examples</a><ul>
<li><a class="reference internal" href="#poisson-equation-in-1d">Poisson Equation in 1D</a></li>
<li><a class="reference internal" href="#radial-poisson-equation">Radial Poisson Equation</a></li>
<li><a class="reference internal" href="#helmholtz-equation-in-1d">Helmholtz Equation in 1D</a></li>
<li><a class="reference internal" href="#poisson-equation-in-2d">Poisson Equation in 2D</a></li>
<li><a class="reference internal" href="#poisson-equation-in-3d">Poisson Equation in 3D</a></li>
<li><a class="reference internal" href="#helmholtz-equation-in-3d">Helmholtz Equation in 3D</a></li>
<li><a class="reference internal" href="#finite-element-method">Finite Element Method</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#binomial-coefficients">3.21. Binomial Coefficients</a></li>
<li><a class="reference internal" href="#double-sums">3.22. Double Sums</a></li>
<li><a class="reference internal" href="#triangle-inequality">3.23. Triangle Inequality</a></li>
<li><a class="reference internal" href="#gamma-function">3.24. Gamma Function</a></li>
<li><a class="reference internal" href="#incomplete-gamma-function">3.25. Incomplete Gamma Function</a><ul>
<li><a class="reference internal" href="#example">3.25.1. Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#factorial">3.26. Factorial</a></li>
<li><a class="reference internal" href="#double-factorial">3.27. Double Factorial</a><ul>
<li><a class="reference internal" href="#id2">3.27.1. Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fermi-dirac-integral">3.28. Fermi-Dirac Integral</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="trig.html"
                        title="previous chapter">3.10. Periodic Functions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="spherical-harmonics.html"
                        title="next chapter">3.29. Legendre Polynomials</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/math/other.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="spherical-harmonics.html" title="3.29. Legendre Polynomials"
             >next</a> |</li>
        <li class="right" >
          <a href="trig.html" title="3.10. Periodic Functions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" >3. Mathematics</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>