
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>8.7. Examples &#8212; Theoretical Physics Reference 0.5 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8.8. Radial Schrödinger and Dirac Equations" href="radial.html" />
    <link rel="prev" title="8.4. Quantum Mechanics" href="qm.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head><body>
    <div style="display:none">
    \(
        \newcommand{\d}{\mathrm{d}}
        \newcommand{\bomega}{\vec\omega}
        \newcommand{\half}{ {1\over 2} }
        \def\mathnot#1{\text{"$#1$"}}

        %operators
        \newcommand{\diag}{\mathrm{diag}}
        \newcommand{\sinc}{\mathrm{sinc}}
        \newcommand{\Sh}{ {\large\style{font-family:Times}{\text{Ш}}} }
        \newcommand{\res}{\mathrm{Res}}
    \)
    </div>
    

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="radial.html" title="8.8. Radial Schrödinger and Dirac Equations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="qm.html" title="8.4. Quantum Mechanics"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" accesskey="U">8. Quantum Field Theory and Quantum Mechanics</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="examples">
<h1>8.7. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="two-particles-in-harmonic-potential">
<h2>8.7.1. Two Particles in Harmonic Potential<a class="headerlink" href="#two-particles-in-harmonic-potential" title="Permalink to this headline">¶</a></h2>
<p>It is a 1D, two-body problem with an interacting Hamiltonian</p>
<div class="math notranslate nohighlight">
\[H(x_1, x_2) = -\half{\partial^2\over\partial x_1^2}
-\half{\partial^2\over\partial x_2^2}
    +{1\over|x_1 - x_2|} + \half\omega^2 x_1^2 + \half\omega^2 x_2^2\]</div>
<p>and it can be solved analytically. The Schrödinger equation is</p>
<div class="math notranslate nohighlight">
\[\left(-\half{\partial^2\over\partial x_1^2} -\half{\partial^2\over\partial x_2^2}
    +{1\over|x_1 - x_2|} + \half\omega^2 x_1^2 + \half\omega^2 x_2^2
\right)\Psi(x_1, x_2) = E \Psi(x_1, x_2)\]</div>
<p>we use the substitution:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}u = {1\over\sqrt2}(x_1 - x_2)\\v = {1\over\sqrt2}(x_1 + x_2)\end{aligned}\end{align} \]</div>
<p>then</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial^2\over\partial x_1^2} + {\partial^2\over\partial x_2^2}=
{\partial^2\over\partial u^2} + {\partial^2\over\partial v^2}\\|x_1 - x_2| = \sqrt2|u|\\x_1^2 + x_2^2 = u^2 + v^2\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\left(-\half{\partial^2\over\partial u^2} -\half{\partial^2\over\partial v^2}
    +{1\over\sqrt2 |u|} + \half\omega^2 u^2 + \half\omega^2 v^2
\right)\Psi(u, v) = E \Psi(u, v)\]</div>
<p>Note also the symmetry of the Hamiltonian <span class="math notranslate nohighlight">\(H(x_1, x_2) = H(x_2, x_1)\)</span> which
after substitution is equivalent to <span class="math notranslate nohighlight">\(H(u, v) = H(-u, v)\)</span>.
Now we can separate the equation:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\Psi(u, v) = f(u)g(v)\\\left(-\half{\d^2\over\d u^2} +{1\over\sqrt2 |u|} + \half\omega^2 u^2
\right)f_k(u) = \epsilon_k f_k(u)\\\left(-\half{\d^2\over\d v^2} + \half\omega^2 v^2
\right)g_l(v) = \epsilon_l g_l(v)\\E_{kl} = \epsilon_k + \epsilon_l\end{aligned}\end{align} \]</div>
<p>the solution of the second equation is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}g_l(v) = {1\over\sqrt{2^l l!}} \left(\omega\over\pi\right)^{1\over4}
    e^{-{\omega v^2\over2}} H_l(\sqrt\omega v)\\\epsilon_l = \omega(l+\half)\quad\mbox{for $l=0, 1, 2, \dots$}\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(H_n(x)\)</span> are the Hermite polynomials:</p>
<div class="math notranslate nohighlight">
\[H_n(x) = (-1)^n e^{x^2} {\d^n\over\d x^n} e^{-x^2}\]</div>
<p>The solution to the first equation can be approximated around the minimum of
the potential, which occurs at point <span class="math notranslate nohighlight">\(u=u_0\)</span> (since the potential is symmetric
with respect to <span class="math notranslate nohighlight">\(u\)</span>, we only treat the branch <span class="math notranslate nohighlight">\(u&gt;0\)</span>):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}V(u) = {1\over\sqrt2 |u|} + \half\omega^2 u^2 =
    \left(2^{-{1\over 3}} + 2^{-{4\over3}}\right) \omega^{2\over3}
    +{3\over 2}\omega^2(u-u_0)^2
    +O\left((u-u_0)^3\right)\\u_0 = 2^{-{1\over6}}\omega^{-{2\over3}}\end{aligned}\end{align} \]</div>
<p>So the first few states can be approximated by the harmonic oscillator
solution with frequency <span class="math notranslate nohighlight">\(\sqrt3\omega\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}f_k(u) = {1\over\sqrt{2^k k!}} \left(\sqrt3\omega\over\pi\right)^{1\over4}
    e^{-{\sqrt3\omega (u-u_0)^2\over2}} H_k(3^{1\over4}\sqrt\omega (u-u_0))\\\epsilon_k =
    \left(2^{-{1\over 3}} + 2^{-{4\over3}}\right) \omega^{2\over3}
    +
    \sqrt3\omega(k+\half)\quad\mbox{for $k=0, 1, 2, \dots$}\end{aligned}\end{align} \]</div>
<p>The final solution is then:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\Psi_{kl}(u, v) = f_k(u) g_l(v) =\\    =
    {1\over\sqrt{2^k k!}} \left(\sqrt3\omega\over\pi\right)^{1\over4}
    e^{-{\sqrt3\omega (u-u_0)^2\over2}} H_k(3^{1\over4}\sqrt\omega (u-u_0))
    {1\over\sqrt{2^l l!}} \left(\omega\over\pi\right)^{1\over4}
    e^{-{\omega v^2\over2}} H_l(\sqrt\omega v)\\E_{kl} = \epsilon_k + \epsilon_l =
    \left(2^{-{1\over 3}} + 2^{-{4\over3}}\right) \omega^{2\over3}
    +
    \sqrt3\omega(k+\half)
    +
    \omega(l+\half)\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="quantum-harmonic-oscillator">
<h2>8.7.2. Quantum Harmonic Oscillator<a class="headerlink" href="#quantum-harmonic-oscillator" title="Permalink to this headline">¶</a></h2>
<p>The quantum
harmonic oscillator for one particle in 1D is:</p>
<div class="math notranslate nohighlight">
\[i\hbar{\partial\over\partial t}\psi(x, t)= -{\hbar^2\over2m}{\partial^2\over\partial x^2}\psi(x,t)+V(x)\psi(x,t)\]</div>
<div class="math notranslate nohighlight">
\[V(x)={1\over2}m\omega^2x^2\]</div>
<p>This is a partial differential equation for the time evolution of the wave
function <span class="math notranslate nohighlight">\(\psi(x, t)\)</span>, but one method to solve it is the
eigenvalues expansion:</p>
<div class="math notranslate nohighlight">
\[\psi(x,t) = \sum_E c_E\psi_E(x)e^{-{i\over\hbar}Et}\]</div>
<p>where the sum goes over the whole spectrum (for continuous spectrum the sum
turns into an integral), the <span class="math notranslate nohighlight">\(c_E\)</span> coefficients are determined from the initial condition
and <span class="math notranslate nohighlight">\(\psi_E(x)\)</span> satisfies the one dimensional one particle time independent
Schrödinger equation:</p>
<div class="math notranslate nohighlight">
\[-{\hbar^2\over2m}{\d^2\over\d x^2}\psi_E(x)+V(x)\psi_E(x)=E\psi_E(x)\]</div>
<p>and this is just an ODE and thus can be solved with Hermes1D. There can be many
types of boundary conditions for this equation, depending on the physical
problem, but in our case we simply have <span class="math notranslate nohighlight">\(\lim_{x\to\pm\infty}\psi_E(x)=0\)</span> and
the normalization condition <span class="math notranslate nohighlight">\(\int_{-\infty}^\infty|\psi_E(x)|^2\d x=1\)</span>.</p>
<p>We can set <span class="math notranslate nohighlight">\(m=\hbar=1\)</span> and from now on we’ll just write <span class="math notranslate nohighlight">\(\psi(x)\)</span> instead of
<span class="math notranslate nohighlight">\(\psi_E(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[-{1\over2}{\d^2\over\d x^2}\psi(x)+V(x)\psi(x)=E\psi(x)\]</div>
<p>and we will solve it on the interval <span class="math notranslate nohighlight">\((a, b)\)</span> with the boundary condition
<span class="math notranslate nohighlight">\(\psi(a)=\psi(b)=0\)</span>. The weak formulation is</p>
<div class="math notranslate nohighlight">
\[\int_a^b{1\over2}{\d\psi(x)\over\d x}{\d v(x)\over\d x}+V(x)\psi(x)v(x)\,\d x -\left[{\d\psi(x)\over\d x}v(x)\right]^a_b =E\int_a^b\psi(x)v(x)\,\d x\]</div>
<p>but due to the boundary condition <span class="math notranslate nohighlight">\(v(a)=v(b)=0\)</span> so
<span class="math notranslate nohighlight">\(\left[\psi'(x)v(x)\right]^a_b=0\)</span> and we get</p>
<div class="math notranslate nohighlight">
\[\int_a^b{1\over2}{\d\psi(x)\over\d x}{\d v(x)\over\d x}+V(x)\psi(x)v(x)\,\d x =E\int_a^b\psi(x)v(x)\,\d x\]</div>
<p>And the finite element formulation is then <span class="math notranslate nohighlight">\(\psi(x)=\sum_j y_j\phi_j(x)\)</span> and
<span class="math notranslate nohighlight">\(v=\phi_i(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\left(\int_a^b{1\over2}\phi_i'(x)\phi_j'(x)+V(x)\phi_i(x)\phi_j(x)\,\d x\right) y_j =E\int_a^b\phi_i(x)\phi_j(x)\,\d x\ y_j\]</div>
<p>which is a generalized eigenvalue problem:</p>
<div class="math notranslate nohighlight">
\[A_{ij}y_j=EB_{ij}y_j\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[A_{ij}=\int_a^b{1\over2}\phi_i'(x)\phi_j'(x)+V(x)\phi_i(x)\phi_j(x)\,\d x\]</div>
<div class="math notranslate nohighlight">
\[B_{ij}=\int_a^b\phi_i(x)\phi_j(x)\,\d x\]</div>
</div>
<div class="section" id="radial-schrodinger-equation">
<h2>8.7.3. Radial Schrödinger Equation<a class="headerlink" href="#radial-schrodinger-equation" title="Permalink to this headline">¶</a></h2>
<p>Another important example is the three dimensional one particle time
independent Schrödinger equation for a spherically symmetric potential:</p>
<div class="math notranslate nohighlight">
\[-{1\over2}\nabla^2\psi({\bf x})+V(r)\psi({\bf x})=E\psi({\bf x})\]</div>
<p>The way to solve it is to separate the equation into radial and angular parts
by writing the Laplace operator in spherical coordinates as:</p>
<div class="math notranslate nohighlight">
\[\nabla^2f =  {\partial^2 f\over\partial\rho^2} +{2\over \rho}{\partial^2 f\over\partial\rho^2} -{L^2\over \rho^2}\]</div>
<div class="math notranslate nohighlight">
\[L^2= -{\partial^2 f\over\partial\theta^2} -{1\over\sin^2\theta}{\partial^2 f\over\partial\phi^2} -{1\over\tan\theta}{\partial f\over\partial\theta}\]</div>
<p>Substituting <span class="math notranslate nohighlight">\(\psi({\bf x})=R(\rho)Y(\theta,\phi)\)</span> into the Schrödinger equation
yields:</p>
<div class="math notranslate nohighlight">
\[-{1\over2}\nabla^2(RY)+VRY=ERY\]</div>
<div class="math notranslate nohighlight">
\[-{1\over2}R''Y-{1\over\rho}R'Y+{L^2RY\over2\rho^2}+VRY=ERY\]</div>
<p>Using the fact that <span class="math notranslate nohighlight">\(L^2Y=l(l+1)Y\)</span> we can cancel <span class="math notranslate nohighlight">\(Y\)</span> and we get the radial
Schrödinger equation:</p>
<div class="math notranslate nohighlight">
\[-{1\over2}R''-{1\over\rho}R'+{l(l+1)R\over2\rho^2}+VR=ER\]</div>
<p>The solution is then:</p>
<div class="math notranslate nohighlight">
\[\psi({\bf x})=\sum_{nlm}c_{nlm}R_{nl}(r)Y_{lm}\left({\bf x}\over r\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(R_{nl}(r)\)</span> satisfies the radial Schrödinger equation (from now on we
just write <span class="math notranslate nohighlight">\(R(r)\)</span>):</p>
<div class="math notranslate nohighlight">
\[-{1\over2}R''(r)-{1\over r}R'(r)+\left(V+{l(l+1)\over2r^2}\right)R(r)=ER(r)\]</div>
<p>Again there are many types of boundary conditions, but the most common case is
<span class="math notranslate nohighlight">\(\lim_{r\to\infty}R(r)=0\)</span> and <span class="math notranslate nohighlight">\(R(0)=1\)</span> or <span class="math notranslate nohighlight">\(R(0)=0\)</span>. One solves this equation on
the interval <span class="math notranslate nohighlight">\((0, a)\)</span> for large enough <span class="math notranslate nohighlight">\(a\)</span>.</p>
<p>The procedure is similar to the previous example, only we need to remember that
we always have to use covariant integration (in the previous example the
covariant integration was the same as the coordinate integration),
in this case <span class="math notranslate nohighlight">\(r^2\sin\theta \d
r\d\theta\d\phi\)</span>, so the weak formulation is:</p>
<div class="math notranslate nohighlight">
\[\int \left(-{1\over2}R''(r)-{1\over r}R'(r)+\left(V+{l(l+1)\over2r^2}\right)R(r)\right)v(r)r^2\sin\theta \d r\d\theta\d\phi=\]</div>
<div class="math notranslate nohighlight">
\[=\int ER(r) v(r)r^2\sin\theta \d r\d\theta\d\phi\]</div>
<p>Integrating over the angles gives <span class="math notranslate nohighlight">\(4\pi\)</span> which we cancel out at both sides and
we get:</p>
<div class="math notranslate nohighlight">
\[\int_0^a \left(-{1\over2}R''(r)-{1\over r}R'(r)+\left(V+{l(l+1)\over2r^2}\right)R(r)\right)v(r)r^2 \d r=\]</div>
<div class="math notranslate nohighlight">
\[=E\int_0^a R(r) v(r)r^2 \d r\]</div>
<p>We apply per partes to the first two terms on the left hand side:</p>
<div class="math notranslate nohighlight">
\[\int_0^a \left(-{1\over2}R''(r)-{1\over r}R'(r)\right)v(r)r^2 \d r =\int_0^a -{1\over2r^2}\left(r^2 R'(r)\right)'v(r)r^2 \d r=\]</div>
<div class="math notranslate nohighlight">
\[=\int_0^a -{1\over2}\left(r^2 R'(r)\right)'v(r) \d r =\int_0^a {1\over2}r^2 R'(r)v'(r) \d r-{1\over2} [r^2R'(r)v(r)]_0^a=\]</div>
<div class="math notranslate nohighlight">
\[=\int_0^a {1\over2} R'(r)v'(r) r^2\d r -{1\over2} a^2R'(a)v(a)\]</div>
<p>We used the fact that <span class="math notranslate nohighlight">\(\lim_{r\to0} r^2 R'(r) = 0\)</span>. If we also prescribe the
boundary condition <span class="math notranslate nohighlight">\(R'(a)=0\)</span>, then the boundary term vanishes completely. The
weak formulation is then:</p>
<div class="math notranslate nohighlight">
\[\int_0^a {1\over2}R'(r)v'(r)r^2+ \left(V+{l(l+1)\over2r^2}\right)R(r)v(r)r^2\,\d r = E\int_0^aR(r)v(r)r^2\,\d r\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\int_0^a {1\over2}R'(r)v'(r)r^2+ V(r)R(r)v(r)r^2+{l(l+1)\over2} R(r)v(r)\,\d r = E\int_0^aR(r)v(r)r^2\,\d r\]</div>
<div class="section" id="another-approach">
<h3>Another approach<a class="headerlink" href="#another-approach" title="Permalink to this headline">¶</a></h3>
<p>Another (equivalent) approach is to write a weak formulation for
the 3D problem in cartesian coordinates:</p>
<div class="math notranslate nohighlight">
\[\int_\Omega{1\over2}\nabla\psi({\bf x})\nabla v({\bf x})+V(r)\psi({\bf x})v({\bf x})\,\d^3 x =E\int_\Omega\psi({\bf x})v({\bf x})\,\d^3 x\]</div>
<p>and only then transform to spherical coordinates:</p>
<div class="math notranslate nohighlight">
\[\int_0^{2\pi}\d\varphi\int_0^\pi\d\theta\int_0^a\d r \left({1\over2}\nabla\psi({\bf x})\nabla v({\bf x})+V(r)\psi({\bf x})v({\bf x})\right)r^2\sin\theta=\]</div>
<div class="math notranslate nohighlight">
\[= E\int_0^{2\pi}\d\varphi\int_0^\pi\d\theta\int_0^a\d r\, \psi({\bf x})v({\bf x})r^2\sin\theta\]</div>
<p>The 3d eigenvectors <span class="math notranslate nohighlight">\(\psi({\bf x})\)</span> however are not spherically symmetric.
Nevertheless we can still proceed by choosing our basis as</p>
<div class="math notranslate nohighlight">
\[v_{ilm}({\bf x})=\phi_{il}(r)Y_{lm}(\theta, \varphi)\]</div>
<p>and seek our solution as</p>
<div class="math notranslate nohighlight">
\[\psi({\bf x})=\sum_{jlm}y_{jlm}\phi_{jl}(r)Y_{lm}(\theta, \varphi)\]</div>
<p>Using the properties of spherical harmonics and the gradient:</p>
<div class="math notranslate nohighlight">
\[\int Y_{lm} Y_{l'm'} \sin\theta\,\d\theta\,\d\varphi= \delta_{ll'}\delta_{mm'}\]</div>
<div class="math notranslate nohighlight">
\[\int r^2\nabla Y_{lm} \nabla Y_{l'm'} \sin\theta\,\d\theta\,\d\varphi= l(l+1)\delta_{ll'}\delta_{mm'}\]</div>
<div class="math notranslate nohighlight">
\[\nabla f = {\partial f\over \partial r}\boldsymbol{\hat r} + {1\over r} {\partial f\over\partial\theta}\boldsymbol{\hat\theta}+{1\over r\sin\theta} {\partial f\over\partial\phi}\boldsymbol{\hat\phi}\]</div>
<p>the weak formulation becomes:</p>
<div class="math notranslate nohighlight">
\[\left(\int_0^a {1\over2}r^2\phi_{il}'(r)\phi_{jl}'(r)+ {1\over2}X+ {l(l+1)\over2}\phi_{il}(r)\phi_{jl}(r)+ r^2V(r)\phi_{il}(r)\phi_{jl}(r)\,\d r\right)y_{jlm}=\]</div>
<div class="math notranslate nohighlight">
\[= E\int_0^ar^2 \phi_{il}(r)\phi_{jl}(r)\,\d r\ y_{jlm}\]</div>
<p>where both <span class="math notranslate nohighlight">\(l\)</span> and <span class="math notranslate nohighlight">\(m\)</span> indices are given by the indices of the particular base
function <span class="math notranslate nohighlight">\(v_{ilm}\)</span>. The <span class="math notranslate nohighlight">\(X\)</span> term is (schematically):</p>
<div class="math notranslate nohighlight">
\[X=\int r^2\sin\theta(r)Y_{lm}(\theta,\varphi) (\phi_{il}\nabla\phi_{jl}+\nabla\phi_{il}\phi_{jl}) \nabla Y_{lm}\]</div>
<p>There is an interesting identity:</p>
<div class="math notranslate nohighlight">
\[\int r{\bf \hat r} Y_{lm} \nabla Y_{l'm'} \sin\theta\,\d\theta\,\d\varphi= 0\]</div>
<p>But it cannot be applied, because we have one more <span class="math notranslate nohighlight">\(r\)</span> in the expression.
Nevertheless the term is probably zero, as can be seen when we compare the weak
formulation to the one we got directly from the radial equation.</p>
</div>
<div class="section" id="how-not-to-derive-the-weak-formulation">
<h3>How Not To Derive The Weak Formulation<a class="headerlink" href="#how-not-to-derive-the-weak-formulation" title="Permalink to this headline">¶</a></h3>
<p>If we forgot that we have to integrate covariantly, this section is devoted
to what happens if we integrate using the coordinate integration. We would get:</p>
<div class="math notranslate nohighlight">
\[\int_0^a {1\over2}R'(x)v'(x)-{1\over r}R'(x)v(x)+ \left(V+{l(l+1)\over2r^2}\right)R(x)v(x)\,\d x = E\int_0^aR(x)v(x)\,\d x\]</div>
<p>Notice the matrix on the left hand side is not symmetric. There is another way
of writing the weak formulation by applying per-partes to the <span class="math notranslate nohighlight">\(R'(r)v(r)\)</span> term:</p>
<div class="math notranslate nohighlight">
\[-\int_0^a{1\over r}R'(x)v(x)\d x=\]</div>
<div class="math notranslate nohighlight">
\[=\int_0^a{1\over r}R(x)v'(x)\d x -\int_0^a{1\over r^2}R(x)v(x)\d x -\left[{1\over r}R'(x)v'(x)\right]_0^a +\left[{1\over r^2}R'(x)v(x)\right]_0^a\]</div>
<p>We can use <span class="math notranslate nohighlight">\(v(a)=0\)</span> and <span class="math notranslate nohighlight">\(R'(a)=0\)</span> to simplify a bit:</p>
<div class="math notranslate nohighlight">
\[-\int_0^a{1\over r}R'(x)v(x)\d x=\]</div>
<div class="math notranslate nohighlight">
\[=\int_0^a{1\over r}R(x)v'(x)\d x -\int_0^a{1\over r^2}R(x)v(x)\d x +\lim_{r\to0}\left({R'(x)v'(x)\over r}-{R'(x)v(x)\over r^2}\right)\]</div>
<p>Since <span class="math notranslate nohighlight">\(R(x)\sim r^l\)</span> near <span class="math notranslate nohighlight">\(r=0\)</span>, we can see that for <span class="math notranslate nohighlight">\(l\ge3\)</span> the limits
on the right hand side are zero, but for <span class="math notranslate nohighlight">\(l=0, 1, 2\)</span> they are not zero and need
to be taken into account. Let’s assume <span class="math notranslate nohighlight">\(l\ge3\)</span> for now, then our weak formulation looks like:</p>
<div class="math notranslate nohighlight">
\[\int_0^a {1\over2}R'(x)v'(x)+{1\over r}R(x)v'(x)+ \left(V+{l(l+1)\over2r^2}-{1\over r^2}\right)R(x)v(x)\,\d x = E\int_0^aR(x)v(x)\,\d x\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\int_0^a {1\over2}R'(x)v'(x)+{1\over r}R(x)v'(x)+ \left(V+{(l-2)(l+1)\over2r^2}\right)R(x)v(x)\,\d x = E\int_0^aR(x)v(x)\,\d x\]</div>
<p>The left hand side is also not symmetric, however we can now take an average of
our both weak formulations to get a symmetric weak formulation:</p>
<div class="math notranslate nohighlight">
\[\int_0^a {1\over2}R'(x)v'(x)+{R(x)v'(x)-R'(x)v(x)\over 2r}+ \left(V+{l(l+1)-1\over2r^2}\right)R(x)v(x)\,\d x =\]</div>
<div class="math notranslate nohighlight">
\[= E\int_0^aR(x)v(x)\,\d x\]</div>
<p>Keep in mind, that this symmetric version is only correct for <span class="math notranslate nohighlight">\(l\ge3\)</span>. For
<span class="math notranslate nohighlight">\(l&lt;3\)</span> we need to use our first nonsymmetric version.</p>
<p>As you can see, this is something very different to what we got in the previous
section. First there were lots of technical difficulties and second the final
result is wrong, since it doesn’t correspond to the 3D Schrödinger equation.</p>
</div>
<div class="section" id="scattering-in-radial-potential">
<h3>Scattering in radial potential<a class="headerlink" href="#scattering-in-radial-potential" title="Permalink to this headline">¶</a></h3>
<p>If <span class="math notranslate nohighlight">\(V=0\)</span>, the radial equation is:</p>
<div class="math notranslate nohighlight">
\[-{1\over2}R_{El}''(r)-{1\over r}R_{El}'(r)+{l(l+1)\over2r^2} R_{El}(r)
    = E R_{El}(r)\]</div>
<p>The general solution is a linear combination of the spherical Bessel functions
<span class="math notranslate nohighlight">\(j_l(kr)\)</span> and <span class="math notranslate nohighlight">\(n_l(kr)\)</span>:</p>
<div class="math notranslate nohighlight">
\[R_{El}(r) = A_l j_l(kr) + B_l n_l(kr)\]</div>
<p>where <span class="math notranslate nohighlight">\(k=\sqrt{2E}\)</span> and <span class="math notranslate nohighlight">\(E &gt; 0\)</span> is a continuous spectrum. The asymptotic expansion for <span class="math notranslate nohighlight">\(r\to\infty\)</span> is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}j_l(kr)\to{1\over kr}\sin\left(kr-{l\pi\over 2}\right)\\n_l(kr)\to{1\over kr}\cos\left(kr-{l\pi\over 2}\right)\end{aligned}\end{align} \]</div>
<p>so we get for large <span class="math notranslate nohighlight">\(r\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}R_{El}(r) = A_l j_l(kr) + B_l n_l(kr) \to\\\to A_l {1\over kr}\sin\left(kr-{l\pi\over 2}\right)
    + B_l{1\over kr}\cos\left(kr-{l\pi\over 2}\right) =\\= \sqrt{A_l^2 + B_l^2} {1\over kr}\sin\left(kr-{l\pi\over 2}
    +\atan2(B_l, A_l)\right)
= C_l {1\over kr}\sin\left(kr-{l\pi\over 2}+\delta_l\right)\end{aligned}\end{align} \]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-deltaceq">
<span class="eqno">(8.7.3.1)<a class="headerlink" href="#equation-deltaceq" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}\delta_l = \atan2(B_l, A_l)\\C_l = \sqrt{A_l^2 + B_l^2}\end{aligned}\end{align} \]</div>
<p>The <span class="math notranslate nohighlight">\(C_l\)</span> and <span class="math notranslate nohighlight">\(\delta_l\)</span> are physical variables, so we express <span class="math notranslate nohighlight">\(A_l\)</span> and <span class="math notranslate nohighlight">\(B_l\)</span>
using them:</p>
<div class="math notranslate nohighlight" id="equation-abeq">
<span class="eqno">(8.7.3.2)<a class="headerlink" href="#equation-abeq" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}A_l = C_l \cos\delta_l\\B_l = C_l \sin\delta_l\end{aligned}\end{align} \]</div>
<p>and write the exact solution <span class="math notranslate nohighlight">\(R_{El}\)</span> as:</p>
<div class="math notranslate nohighlight" id="equation-rnlas">
<span class="eqno">(8.7.3.3)<a class="headerlink" href="#equation-rnlas" title="Permalink to this equation">¶</a></span>\[R_{El}(r) = C_l (\cos\delta_l\, j_l(kr) + \sin\delta_l\, n_l(kr))\]</div>
<p>We can then compare this to <span class="math notranslate nohighlight">\(\phi \approx e^{ikz} + f(\theta, \phi)
{e^{ikr}\over r}\)</span>, by expanding <span class="math notranslate nohighlight">\(e^{ikz} = e^{ikr\cos\theta}=
\sum (2l+1) i^l j_l(kr)P_l(\cos\theta)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}C_l = {e^{i\delta_l}\over k}\\f(\theta, \phi) = {1\over 2ik} \sum (2l+1)(e^{2i\delta_l}-1)P_l(\cos\theta)\end{aligned}\end{align} \]</div>
<p>Since <span class="math notranslate nohighlight">\(\sigma(\theta) = |f(\theta)|^2\)</span> and integrating over <span class="math notranslate nohighlight">\(\omega\)</span> we get the
total cross section:</p>
<div class="math notranslate nohighlight">
\[\sigma = {4\pi\over k}\sum (2l+1)\sin^2\delta_l\]</div>
<p>In order to find the phase shifts <span class="math notranslate nohighlight">\(\delta_l\)</span>, we solve the radial equation for
the full potential</p>
<div class="math notranslate nohighlight">
\[-{1\over2}R_{nl}''(r)-{1\over r}R_{nl}'(r)+\left(V+{l(l+1)\over2r^2}\right)
    R_{nl}(r)=ER_{nl}(r)\]</div>
<p>and then fit it to the above asymptotic solution for V=0. We require that the
value and the slope must be continuous, so we use <a class="reference internal" href="#equation-rnlas">(8.7.3.3)</a> and <span class="math notranslate nohighlight">\(R_{nl}\)</span> must
satisfy the following two equations (for the value and the derivative)
at the point <span class="math notranslate nohighlight">\(r=a\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-r-conditions">
<span class="eqno">(8.7.3.4)<a class="headerlink" href="#equation-r-conditions" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}R_{El}(a)
    = A j_l(ka) + B n_l(ka))
    = C_l (\cos\delta_l\, j_l(ka) + \sin\delta_l\, n_l(ka))\\R_{El}'(a)
    = k A j_l'(ka) + k B n_l'(ka))
    = C_l k (\cos\delta_l\, j_l'(ka) + \sin\delta_l\, n_l'(ka))\end{aligned}\end{align} \]</div>
<p>This is a set of two equations for two unknowns <span class="math notranslate nohighlight">\(C_l\)</span> and <span class="math notranslate nohighlight">\(\delta_l\)</span>.
The solution is:</p>
<div class="math notranslate nohighlight" id="equation-absol">
<span class="eqno">(8.7.3.5)<a class="headerlink" href="#equation-absol" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}D = k(j_l(ka) n_l'(ka) - j_l'(ka) n_l(ka))\\A = {R_{El}(a) k n_l'(ka) - R_{El}'(a) n_l(ka) \over D}\\B = -{R_{El}(a) k j_l'(ka) - R_{El}'(a) j_l(ka) \over D}\end{aligned}\end{align} \]</div>
<p>And one can calculate <span class="math notranslate nohighlight">\(C_l\)</span> and <span class="math notranslate nohighlight">\(\delta_l\)</span> from <a class="reference internal" href="#equation-deltaceq">(8.7.3.1)</a>.
Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">solve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;R Rp j jp n np A B k&quot;</span><span class="p">)</span>
<span class="go">(R, Rp, j, jp, n, np, A, B, k)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq1</span> <span class="o">=</span> <span class="n">R</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">j</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">n</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq2</span> <span class="o">=</span> <span class="n">Rp</span> <span class="o">-</span> <span class="n">k</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">jp</span> <span class="o">-</span> <span class="n">k</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">([</span><span class="n">eq1</span><span class="p">,</span> <span class="n">eq2</span><span class="p">],</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">])</span>
<span class="go">{A: (R*k*np - Rp*n)/(k*(j*np - jp*n)), B: (-R*jp*k + Rp*j)/(k*(j*np - jp*n))}</span>
</pre></div>
</div>
<p>Another approach to calculate <span class="math notranslate nohighlight">\(\delta_l\)</span> is to
take the logarithmic
derivative (<span class="math notranslate nohighlight">\((\log |u|)'={u'\over u}\)</span>) at the point <span class="math notranslate nohighlight">\(r=a\)</span>:</p>
<div class="math notranslate nohighlight">
\[\gamma_l \equiv \left.{\d\over\d r} \log |R_l(r)|\right|_{r=a}
= {R_{El}'(a)\over R_{El}(a)}
    = {C_l k (\cos\delta_l\, j_l'(ka) + \sin\delta_l\, n_l'(ka)) \over
            C_l (\cos\delta_l\, j_l(ka) + \sin\delta_l\, n_l(ka)) }
    =\]</div>
<div class="math notranslate nohighlight" id="equation-gamma-xx">
<span class="eqno">(8.7.3.6)<a class="headerlink" href="#equation-gamma-xx" title="Permalink to this equation">¶</a></span>\[= k {j_l'(ka) + \tan\delta_l\, n_l'(ka) \over
        j_l(ka) + \tan\delta_l\, n_l(ka) }\]</div>
<p>and solving for <span class="math notranslate nohighlight">\(\delta_l\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[\tan\delta_l
    = -{k j_l'(ka) - \gamma_l j_l(ka)\over k n_l'(ka)-\gamma_l n_l(ka)}
    = -{-k j_{l+1}(ka) +kl{j_l(ka)\over ka} - \gamma_l j_l(ka)
        \over -k n_{l+1}(ka)+kl{n_l(ka)\over ka} - \gamma_l n_l(ka)}
    =\]</div>
<div class="math notranslate nohighlight" id="equation-delta-l">
<span class="eqno">(8.7.3.7)<a class="headerlink" href="#equation-delta-l" title="Permalink to this equation">¶</a></span>\[= -{ka j_{l+1}(ka) -l j_l(ka) + a j_l(ka) \gamma_l
    \over ka n_{l+1}(ka) -l n_l(ka) + a n_l(ka) \gamma_l}\]</div>
<p>where we used the following relations:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}j_l'(z) = -j_{l+1}(z) + l{j_l(z)\over z}\\n_l'(z) = -n_{l+1}(z) + l{n_l(z)\over z}\end{aligned}\end{align} \]</div>
<p>The disadvantage of <a class="reference internal" href="#equation-delta-l">(8.7.3.7)</a> is that we only know <span class="math notranslate nohighlight">\(\tan\delta_l\)</span>, while in
<a class="reference internal" href="#equation-absol">(8.7.3.5)</a> we know <span class="math notranslate nohighlight">\(\delta_l\)</span> directly using the <span class="math notranslate nohighlight">\(\atan2\)</span> function.</p>
<p>Now we can use these <span class="math notranslate nohighlight">\(\delta_l\)</span> in the formula for the total cross section. We
can define a reduced phase-shift <span class="math notranslate nohighlight">\(\eta_l\)</span> by</p>
<div class="math notranslate nohighlight">
\[\delta_l = (n-l-1) \pi + \eta_l\]</div>
<p>where <span class="math notranslate nohighlight">\(n-l-1\)</span> is the number of radial nodes and <span class="math notranslate nohighlight">\(0 \le \eta_l \le \pi\)</span>.</p>
<p>The problem can now be formulated in two ways. Either to solve the radial
equation for a potential with finite reach and then “measure” those phase
shifts in the solution. Or by prescribing those phase shifts and we now need to
calculate the solutions (e.g. the energies) from the radial equation.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">8.7. Examples</a><ul>
<li><a class="reference internal" href="#two-particles-in-harmonic-potential">8.7.1. Two Particles in Harmonic Potential</a></li>
<li><a class="reference internal" href="#quantum-harmonic-oscillator">8.7.2. Quantum Harmonic Oscillator</a></li>
<li><a class="reference internal" href="#radial-schrodinger-equation">8.7.3. Radial Schrödinger Equation</a><ul>
<li><a class="reference internal" href="#another-approach">Another approach</a></li>
<li><a class="reference internal" href="#how-not-to-derive-the-weak-formulation">How Not To Derive The Weak Formulation</a></li>
<li><a class="reference internal" href="#scattering-in-radial-potential">Scattering in radial potential</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="qm.html"
                        title="previous chapter">8.4. Quantum Mechanics</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="radial.html"
                        title="next chapter">8.8. Radial Schrödinger and Dirac Equations</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/quantum/examples.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="radial.html" title="8.8. Radial Schrödinger and Dirac Equations"
             >next</a> |</li>
        <li class="right" >
          <a href="qm.html" title="8.4. Quantum Mechanics"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" >8. Quantum Field Theory and Quantum Mechanics</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>