
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Radial Schrödinger and Dirac Equations &#8212; Theoretical Physics Reference 0.5 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Density Functional Theory (DFT)" href="dft.html" />
    <link rel="prev" title="Examples" href="examples.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head><body>
    <div style="display:none">
    \(
        \newcommand{\d}{\mathrm{d}}
        \newcommand{\bomega}{\vec\omega}
        \newcommand{\half}{ {1\over 2} }
        \def\mathnot#1{\text{"$#1$"}}

        %operators
        \newcommand{\diag}{\mathrm{diag}}
        \newcommand{\sinc}{\mathrm{sinc}}
        \newcommand{\Sh}{ {\large\style{font-family:Times}{\text{Ш}}} }
        \newcommand{\res}{\mathrm{Res}}
    \)
    </div>
    

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="dft.html" title="Density Functional Theory (DFT)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" accesskey="U">Quantum Field Theory and Quantum Mechanics</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="radial-schrodinger-and-dirac-equations">
<h1>Radial Schrödinger and Dirac Equations<a class="headerlink" href="#radial-schrodinger-and-dirac-equations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="variational-formulation-of-the-schrodinger-equation">
<h2>Variational Formulation of the Schrödinger equation<a class="headerlink" href="#variational-formulation-of-the-schrodinger-equation" title="Permalink to this headline">¶</a></h2>
<p>Lagrangian is:</p>
<div class="math notranslate nohighlight">
\[\L(\psi) = \half (\nabla \psi)^2 + V(x) \psi^2(x)\]</div>
<p>Subject to the normalization constrain:</p>
<div class="math notranslate nohighlight">
\[N[\psi] = \int|\psi(x)|^2 \d^3 x - 1 = 0\]</div>
<p>The action is:</p>
<div class="math notranslate nohighlight">
\[S[\psi] = \int \L \d^3 x\]</div>
<p>Variating it (subject to the normalization condition) we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}0 = \delta (S - \epsilon N) =
\delta\int\half (\nabla \psi)^2 + V(x) \psi^2(x) \d^3x
 - \epsilon \left(\int|\psi(x)|^2 \d^3 x - 1\right)
=\\= \int (\nabla \psi)\cdot(\nabla\delta\psi) + 2 V \psi \delta \psi
        -2\epsilon\psi\delta\psi\d^3 x\\= 2\int \left(-\half\nabla^2 \psi + V \psi - \epsilon\psi\right) \delta \psi
        \d^3 x + \int ({\bf n}\cdot\nabla\psi) \delta \psi\, \d^2 x\end{aligned}\end{align} \]</div>
<p>Which gives the Schrödinger equation assuming the surface integral vanishes.</p>
<p>Note: to apply the variation <span class="math notranslate nohighlight">\(\delta\)</span> correctly, one uses the definition:</p>
<div class="math notranslate nohighlight">
\[\delta F[\psi] \equiv \left.{\d\over\d\epsilon}F[\psi + \epsilon \delta\psi]
    \right|_{\epsilon=0}\]</div>
<div class="section" id="weak-formulation">
<h3>Weak Formulation<a class="headerlink" href="#weak-formulation" title="Permalink to this headline">¶</a></h3>
<p>The weak formulation is obtained from the above by substituting <span class="math notranslate nohighlight">\(\delta\psi
\to v\)</span> (the test function) so we get:</p>
<div class="math notranslate nohighlight">
\[\int \half(\nabla \psi)\cdot(\nabla v) + V \psi v - \epsilon\psi v\,\d^3 x\]</div>
</div>
</div>
<div class="section" id="radial-schrodinger-equation">
<h2>Radial Schrödinger equation<a class="headerlink" href="#radial-schrodinger-equation" title="Permalink to this headline">¶</a></h2>
<p>There are two ways to obtain the radial Schrödinger equation. Either from the
Lagrangian, or from the equation itself.</p>
<div class="section" id="from-the-equation">
<h3>From the Equation<a class="headerlink" href="#from-the-equation" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[-{1\over2}\nabla^2\psi({\bf x})+V(r)\psi({\bf x})=E\psi({\bf x})\]</div>
<p>The way to solve it is to separate the equation into radial and angular parts
by writing the Laplace operator in spherical coordinates as:</p>
<div class="math notranslate nohighlight">
\[\nabla^2f =  {\partial^2 f\over\partial\rho^2} +{2\over \rho}{\partial f\over\partial\rho} -{L^2 f\over \rho^2}\]</div>
<div class="math notranslate nohighlight">
\[L^2= -{\partial^2\over\partial\theta^2} -{1\over\sin^2\theta}{\partial^2\over\partial\phi^2} -{1\over\tan\theta}{\partial\over\partial\theta}\]</div>
<p>Substituting <span class="math notranslate nohighlight">\(\psi({\bf x})=R(\rho)Y(\theta,\phi)\)</span> into the Schrödinger equation
yields:</p>
<div class="math notranslate nohighlight">
\[-{1\over2}\nabla^2(RY)+VRY=ERY\]</div>
<div class="math notranslate nohighlight">
\[-{1\over2}R''Y-{1\over\rho}R'Y+{L^2RY\over2\rho^2}+VRY=ERY\]</div>
<p>Using the fact that <span class="math notranslate nohighlight">\(L^2Y=l(l+1)Y\)</span> we can cancel <span class="math notranslate nohighlight">\(Y\)</span> and we get the radial
Schrödinger equation:</p>
<div class="math notranslate nohighlight">
\[-{1\over2}R''-{1\over\rho}R'+{l(l+1)R\over2\rho^2}+VR=ER\]</div>
<p>Normalization:</p>
<div class="math notranslate nohighlight">
\[1 = \int |\psi|^2 \d^3 x
  = \int R^2 |Y|^2 \d^3 x
  = \int R^2 |Y|^2 \rho^2\d\Omega\d \rho
  = \int R^2 \rho^2 \d\rho \int |Y|^2 \d\Omega
  = \int R^2 \rho^2 \d \rho\]</div>
</div>
<div class="section" id="from-the-lagrangian">
<h3>From the Lagrangian<a class="headerlink" href="#from-the-lagrangian" title="Permalink to this headline">¶</a></h3>
<p>We need to convert the Lagrangian to spherical coordinates. In order to easily
make sure we do things covariantly, we start from the action (which is a
scalar):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}S[\psi] = \int \half (\nabla \psi)^2 + V(x) \psi^2(x) \, \d^3 x =\\= \int (\half (\nabla (RY))^2 + V (RY)^2  )\rho^2\d \rho \d\Omega =\\= \int (\half (R'^2Y^2 + R^2(\nabla Y)^2 + 2RR'({\bf\hat\rho}Y)\cdot\nabla Y) + V (RY)^2  )\rho^2\d \rho \d\Omega =\\= \int \left(\half \left(R'^2 + R^2{l(l+1)\over\rho^2}\right) + V R^2\right)\rho^2\d \rho =\\= \int \half \rho^2 R'^2 + (\rho^2 V + \half l(l+1)) R^2\,\d \rho =\end{aligned}\end{align} \]</div>
<p>where we used the following properties of spherical harmonics:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\int Y^2\d\Omega = 1\\\int \rho^2 (\nabla Y)^2\d\Omega = l(l+1)\\(Y{\bf \hat \rho})\cdot(\rho \nabla Y) = 0\end{aligned}\end{align} \]</div>
<p>We now minimize the action (subject to the normalization <span class="math notranslate nohighlight">\(\int \rho^2 R^2\d\rho
= 1\)</span>) to obtain the radial equation:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}0 = \delta (S - \epsilon N) = \delta
\int \half \rho^2 R'^2 + (\rho^2 V + \half l(l+1)) R^2 - \epsilon \rho^2R^2
    \,\d \rho =\\= 2\int \half \rho^2 R'(\delta R)' + (\rho^2 V + \half l(l+1)) R\delta R -
\epsilon \rho^2 R\delta R \,\d \rho =\\= 2\int \left( (-\half \rho^2 R')' + (\rho^2 V + \half l(l+1)) R - \epsilon \rho^2
R\right)\delta R \,\d \rho + [\rho^2 R' \delta R]^a_b\end{aligned}\end{align} \]</div>
<p>So the radial equation is:</p>
<div class="math notranslate nohighlight" id="equation-radial2">
<span class="eqno">(1)<a class="headerlink" href="#equation-radial2" title="Permalink to this equation">¶</a></span>\[(-\half \rho^2 R')' + (\rho^2 V + \half l(l+1)) R = \epsilon \rho^2 R\]</div>
<p>In agreement with the previous result.</p>
</div>
<div class="section" id="solving-for-u-rr">
<h3>Solving for u=rR<a class="headerlink" href="#solving-for-u-rr" title="Permalink to this headline">¶</a></h3>
<p>We can also make the substitution <span class="math notranslate nohighlight">\(u = rR\)</span> and solve for <span class="math notranslate nohighlight">\(u\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}R = {u\over r}\\R' = {u'\over r} - {u\over r^2}\end{aligned}\end{align} \]</div>
<p>and we substitute this to <a class="reference internal" href="#equation-radial2">(1)</a>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}-\half \left(r^2\left({u'\over r} - {u\over r^2}\right)\right)'+
    \left(V + {l(l+1)\over 2 r^2}\right) r u = \epsilon r u\\-\half ru''+ \left(V + {l(l+1)\over 2 r^2}\right) r u = \epsilon r u\\-\half u''+ \left(V + {l(l+1)\over 2 r^2}\right) u = \epsilon u\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="perturbative-correction-to-energy">
<h3>Perturbative Correction to Energy<a class="headerlink" href="#perturbative-correction-to-energy" title="Permalink to this headline">¶</a></h3>
<p>We introduce <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> by <span class="math notranslate nohighlight">\(P(r) = u(r)\)</span> and <span class="math notranslate nohighlight">\(Q(r) = P'(r) = u'(r)\)</span>. The
radial Schrödinger equation is then:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P'(r) = Q(r)\\Q'(r) = -2\left(E - V(r) - {l(l+1)\over 2 r^2}\right)P(r)\end{aligned}\end{align} \]</div>
<p>Let <span class="math notranslate nohighlight">\(P_1\)</span> and <span class="math notranslate nohighlight">\(Q_1\)</span> represent the radial wave function and its derivative at
<span class="math notranslate nohighlight">\(E_1\)</span> and <span class="math notranslate nohighlight">\(P_2\)</span>, <span class="math notranslate nohighlight">\(Q_2\)</span> at <span class="math notranslate nohighlight">\(E_2\)</span>, so the following holds:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}Q_1'(r) = -2\left(E_1 - V(r) - {l(l+1)\over 2 r^2}\right)P_1(r)\\Q_2'(r) = -2\left(E_2 - V(r) - {l(l+1)\over 2 r^2}\right)P_2(r)\end{aligned}\end{align} \]</div>
<p>Now we evaluate <span class="math notranslate nohighlight">\((Q_2 P_1 - P_2 Q_1)'\)</span> using the relations above:</p>
<div class="math notranslate nohighlight">
\[(Q_2 P_1 - P_2 Q_1)' = Q_2' P_1 + Q_2 P_1' - P_2'Q_1 - P_2 Q_1'
= Q_2' P_1 + Q_2 Q_1' - Q_2'Q_1 - P_2 Q_1'
= Q_2' P_1 - P_2 Q_1'
= 2 (E_1 - E_2) P_1 P_2\]</div>
<p>We integrate the last formula on the intervals <span class="math notranslate nohighlight">\((0, a_c)\)</span> and <span class="math notranslate nohighlight">\((a_c, \infty)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}[Q_2 P_1 - P_2 Q_1]^{a_c}_0
    = 2 (E_1 - E_2) \int^{a_c}_0 P_1(r) P_2(r) \,\d r\\[Q_2 P_1 - P_2 Q_1]^\infty_{a_c}
    = 2 (E_1 - E_2) \int^\infty_{a_c} P_1(r) P_2(r) \,\d r\end{aligned}\end{align} \]</div>
<p>On the interval <span class="math notranslate nohighlight">\((0, a_c)\)</span> we know the exact solution corresponding to the
energies <span class="math notranslate nohighlight">\(E_1\)</span> and <span class="math notranslate nohighlight">\(E_2\)</span> by integrating outwards (the solution will eventually
diverge for large <span class="math notranslate nohighlight">\(r\)</span> except for the eigenvalues, but we only need it up to
<span class="math notranslate nohighlight">\(a_c\)</span>) and we know that <span class="math notranslate nohighlight">\(P_1(0) = P_2(0) = 0\)</span>, so we get:</p>
<div class="math notranslate nohighlight">
\[Q_2(a_c^-) P_1(a_c^-) - P_2(a_c^-) Q_1(a_c^-)
    = 2 (E_1 - E_2) \int^{a_c}_0 P_1(r) P_2(r) \,\d r\]</div>
<p>where <span class="math notranslate nohighlight">\(a_c^-\)</span> means that we need the values at <span class="math notranslate nohighlight">\(a_c\)</span> when integrating the
equation from the left (the value will generally be different when integrating
the equation from the right, unless the energy is an eigenvalue).
Similarly on the other interval where <span class="math notranslate nohighlight">\(P_1(\infty) = P_2(\infty)=0\)</span>:</p>
<div class="math notranslate nohighlight">
\[-(Q_2(a_c^+) P_1(a_c^+) - P_2(a_c^+) Q_1(a_c^+))
    = 2 (E_1 - E_2) \int^\infty_{a_c} P_1(r) P_2(r) \,\d r\]</div>
<p>Taking the sum of the last two expressions:</p>
<div class="math notranslate nohighlight">
\[2 (E_1 - E_2) \int^\infty_0 P_1(r) P_2(r) \,\d r
    = Q_2(a_c^-) P_1(a_c^-) - P_2(a_c^-) Q_1(a_c^-)
        -(Q_2(a_c^+) P_1(a_c^+) - P_2(a_c^+) Q_1(a_c^+))\]</div>
<p>Now we use the fact that <span class="math notranslate nohighlight">\(P_1(a_c^-) = P_1(a_c^+)\)</span> and
<span class="math notranslate nohighlight">\(P_2(a_c^-) = P_2(a_c^+)\)</span>, because we match the two solutions from the left and
right, so that the function is continuous (it’s derivative will have a jump
though):</p>
<div class="math notranslate nohighlight">
\[2 (E_1 - E_2) \int^\infty_0 P_1(r) P_2(r) \,\d r
    = P_1(a_c) (Q_2(a_c^-)-Q_2(a_c^+)) - P_2(a_c)(Q_1(a_c^-)-Q_1(a_c^+))\]</div>
<p>By requiring, that the energy <span class="math notranslate nohighlight">\(E_2\)</span> is an eigenvalue, it follows that there is
no jump in the derivative, so we set <span class="math notranslate nohighlight">\(Q_2(a_c^-)=Q_2(a_c^+)\)</span> and we get:</p>
<div class="math notranslate nohighlight">
\[2 (E_1 - E_2) \int^\infty_0 P_1(r) P_2(r) \,\d r
    = -P_2(a_c)(Q_1(a_c^-)-Q_1(a_c^+))\]</div>
<p>that gives us an exact formula for the eigenvalue <span class="math notranslate nohighlight">\(E_2\)</span>:</p>
<div class="math notranslate nohighlight">
\[E_2 = E_1 +
{P_2(a_c)(Q_1(a_c^-)-Q_1(a_c^+))\over 2\int^\infty_0 P_1(r) P_2(r) \,\d r}\]</div>
<p>We approximate the value of <span class="math notranslate nohighlight">\(P_2(a_c)\)</span> by <span class="math notranslate nohighlight">\(P_1(a_c)\)</span> as well as the integral
<span class="math notranslate nohighlight">\(\int^\infty_0 P_1(r) P_2(r) \,\d r\)</span> by <span class="math notranslate nohighlight">\(\int^\infty_0 P_1^2(r) \,\d r\)</span> and we
get an approximation for the eigenenergy:</p>
<div class="math notranslate nohighlight">
\[E_2 \approx E_1 +
    {P_1(a_c)(Q_1(a_c^-)-Q_1(a_c^+))\over 2\int^\infty_0 P_1^2(r) \,\d r}\]</div>
<p>We use this approximation iteratively until the convergence is achieved (the
discontinuity in <span class="math notranslate nohighlight">\(Q(r)\)</span> at <span class="math notranslate nohighlight">\(r=a_c\)</span> is small enough, or equivalently, the
correction to the energy is small enough).</p>
<p>For Dirac equation, one obtains a similar formula:</p>
<div class="math notranslate nohighlight">
\[E_2 \approx E_1 +
    c {P_1(a_c)(Q_1(a_c^-)-Q_1(a_c^+))\over \int^\infty_0 P_1^2(r)
        +Q_1^2(r) \,\d r}\]</div>
<p>So it is just the previous formula multiplied by <span class="math notranslate nohighlight">\(2c\)</span> and the normalization is
calculated using both <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> (as usual for the Dirac equation).</p>
</div>
<div class="section" id="id1">
<h3>Weak Formulation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The weak formulation is obtained from the action above by substituting <span class="math notranslate nohighlight">\(\delta R
\to v\)</span> (the test function) so we get:</p>
<div class="math notranslate nohighlight">
\[\int \half \rho^2 R'v' + (\rho^2 V + \half l(l+1)) Rv\,\d\rho =
\epsilon \int \rho^2 Rv \,\d \rho\]</div>
<p>We can also start from the equation itself, multiply by a test function <span class="math notranslate nohighlight">\(v\)</span>:</p>
<div class="math notranslate nohighlight">
\[(-\half \rho^2 R')'v + (\rho^2 V + \half l(l+1)) Rv = \epsilon \rho^2 Rv\]</div>
<p>We integrate it. Normally we need to be using <span class="math notranslate nohighlight">\(\rho^2\d\rho\)</span> in order to
integrate covariantly, but the above equation was already multiplied by
<span class="math notranslate nohighlight">\(\rho^2\)</span> (i.e. strictly speaking, it is not coordinate independent anymore), so
we only integrate by <span class="math notranslate nohighlight">\(\d\rho\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int (-\half \rho^2 R')'v + (\rho^2 V + \half l(l+1)) Rv \d\rho =
    \epsilon \int \rho^2 Rv \d\rho\]</div>
<p>After integration by parts:</p>
<div class="math notranslate nohighlight">
\[\int \half \rho^2 R'v' + (\rho^2 V + \half l(l+1)) Rv \d\rho
    -\half[\rho^2R'v]_0^a
=
    \epsilon \int \rho^2 Rv \d\rho\]</div>
<p>Where <span class="math notranslate nohighlight">\(a\)</span> is the end of the domain (the origin is at <span class="math notranslate nohighlight">\(0\)</span>).
The boundary term is zero at the origin, so we get:</p>
<div class="math notranslate nohighlight">
\[\int \half \rho^2 R'v' + (\rho^2 V + \half l(l+1)) Rv \d\rho
    +\half\rho^2R'(a)v(a)
=
    \epsilon \int \rho^2 Rv \d\rho\]</div>
<p>We usually want to have the boundary term <span class="math notranslate nohighlight">\(\half\rho^2R'(a)v(a)\)</span> equal to zero.
This is equivalent to either letting <span class="math notranslate nohighlight">\(R'(a) = 0\)</span> (we prescribe the zero
derivative of the radial wave function at <span class="math notranslate nohighlight">\(a\)</span>) or we set <span class="math notranslate nohighlight">\(v(a)=0\)</span> (which
corresponds to zero Dirichlet condition for <span class="math notranslate nohighlight">\(R\)</span>, i.e. setting <span class="math notranslate nohighlight">\(R(a)=0\)</span>).</p>
<div class="section" id="weak-formulation-for-u">
<h4>Weak Formulation for u<a class="headerlink" href="#weak-formulation-for-u" title="Permalink to this headline">¶</a></h4>
<div class="math notranslate nohighlight">
\[\int \half u'v' + \left(V + {l(l+1)\over 2\rho^2}\right) uv \,\d\rho
    -\half\left[u'v\right]_0^R
=
    \epsilon \int uv \,\d\rho\]</div>
<p>We prescribe <span class="math notranslate nohighlight">\(u(0) = u(R) = 0\)</span>, so we get:</p>
<div class="math notranslate nohighlight">
\[\int \half u'v' + \left(V + {l(l+1)\over 2\rho^2}\right) uv \,\d\rho
=
    \epsilon \int uv \,\d\rho\]</div>
</div>
<div class="section" id="dirac-notation">
<h4>Dirac Notation<a class="headerlink" href="#dirac-notation" title="Permalink to this headline">¶</a></h4>
<p>We can also write all the formulas using the Dirac notation:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\one = \int \d\rho \rho^2 \ket{\rho}\bra{\rho}\\\braket{\rho|\rho'} = {\delta(\rho-\rho')\over \rho^2}\\\braket{\rho|R} = R(\rho)\\\braket{\rho|\hat H|R} =
    {1\over\rho^2}(-\half \rho^2 R')' + (V + \half {l(l+1)\over\rho^2}) R\\\hat H \ket{R} = E\ket{R}\end{aligned}\end{align} \]</div>
<p>Then normalization is:</p>
<div class="math notranslate nohighlight">
\[\braket{R|R} = \int \d\rho \rho^2 \braket{R|\rho}\braket{\rho|R} =
    \int \d\rho \rho^2 R^2(\rho)\]</div>
<p>The operator <span class="math notranslate nohighlight">\(\hat H\)</span> can be written as:</p>
<div class="math notranslate nohighlight">
\[\braket{\rho|\hat H|\rho'} = \braket{\rho|\rho'}\left(
    -\half{1\over\rho^2}{\d\over\d\rho}\left(\rho^2{\d\over\d\rho}\right)
    + (V + \half {l(l+1)\over\rho^2})
    \right)\]</div>
<p>so to recover the above formula, we do:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\braket{\rho|\hat H| R} = \int\d\rho'\rho'^2\braket{\rho|\hat H|\rho'}
    \braket{\rho'|R}=\\=\int\d\rho'\rho'^2
{\delta(\rho-\rho')\over \rho^2}
\left(
    -\half{1\over\rho^2}{\d\over\d\rho}\left(\rho^2{\d\over\d\rho}\right)
    + (V + \half {l(l+1)\over\rho^2})
    \right)
R(\rho')
=
    {1\over\rho^2}(-\half \rho^2 R')' + (V + \half {l(l+1)\over\rho^2}) R\end{aligned}\end{align} \]</div>
<p>Operator <span class="math notranslate nohighlight">\(\hat H\)</span> is symmetric, because:</p>
<div class="math notranslate nohighlight">
\[\int f{1\over\rho^2}(\rho^2 g')' \rho^2\d\rho =
\int {1\over\rho^2}(\rho^2 f')'g \rho^2\d\rho\]</div>
<p>The weak formulation is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\braket{v|H|R} = E\braket{v|R}\\\int\d\rho\rho^2 \braket{v|\rho}\braket{\rho|H|R} = E
    \int\d\rho\rho^2\braket{v|\rho}\braket{\rho|R}\\\int\d\rho\rho^2 v(\rho)\left(
    {1\over\rho^2}(-\half \rho^2 R')' + (V + \half {l(l+1)\over\rho^2}) R
\right) = E
    \int\d\rho\rho^2v(\rho)R(\rho)\end{aligned}\end{align} \]</div>
<p>and we obtain the FE formulation by expanding <span class="math notranslate nohighlight">\(\ket{R} =\sum_j R_j \ket{j}\)</span>
(note that the basis <span class="math notranslate nohighlight">\(\ket{j}\)</span> is not orthogonal, so in particular <span class="math notranslate nohighlight">\(\sum_j
\ket{j}\bra{j} \neq 1\)</span>):</p>
<div class="math notranslate nohighlight">
\[\sum_j\braket{i|H|j}R_j = E\sum_j\braket{i|j}R_j\]</div>
<p>This is a generalized eigenvalue problem.
In the special case of an orthonormal basis, <span class="math notranslate nohighlight">\(\braket{i|j} = \delta_{ij}\)</span>
(which FE is not), we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\sum_j\braket{i|H|j}R_j = R_i\\R_i = \braket{i|R}\end{aligned}\end{align} \]</div>
<p>Which is an eigenvalue problem.</p>
</div>
</div>
</div>
<div class="section" id="variational-formulation-of-the-dirac-equation">
<h2>Variational Formulation of the Dirac equation<a class="headerlink" href="#variational-formulation-of-the-dirac-equation" title="Permalink to this headline">¶</a></h2>
<p>The QED Lagrangian density is</p>
<div class="math notranslate nohighlight">
\[\L=\bar\psi(i\hbar c\gamma^\mu D_\mu-mc^2)\psi-{1\over4}F_{\mu\nu}F^{\mu\nu}\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}D_\mu=\partial_\mu+{i\over \hbar}eA_\mu\\F_{\mu\nu}=\partial_\mu A_\nu-\partial_\nu A_\mu\end{aligned}\end{align} \]</div>
<p>We will treat the fields as classical fields, so we get the classical wave
Dirac equation, after plugging this Lagrangian into the Euler-Lagrange equation
of motion:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(i\hbar c\gamma^\mu D_\mu-mc^2)\psi=0\\\partial_\nu F^{\nu\mu}=-ec\bar\psi\gamma^\mu\psi\end{aligned}\end{align} \]</div>
<p>Notice that the Lagrangian happens to be zero for the solution of Dirac
equation (e.g. the extremum of the action). This has nothing to do with the
variational principle itself, it’s just a coincindence.</p>
<p>In this section we are only interested in the Dirac equation, so we write the
Lagrangian as:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\L=\bar\psi(i\hbar c\gamma^\mu D_\mu-mc^2)\psi =\\=\psi^\dag\gamma^0(i\hbar c\gamma^\mu D_\mu-mc^2)\psi=\\=\psi^\dag\gamma^0(i\hbar c\gamma^0(\partial_0+{i\over\hbar}eA_0)+ic\gamma^i (\partial_i+{i\over\hbar}eA_i)-mc^2)\psi=\\=\psi^\dag(i\hbar c\partial_0+i\hbar c\gamma^0\gamma^i\partial_i-\gamma^0mc^2-ceA_0 -ce\gamma^0\gamma^iA_i)\psi=\\=\psi^\dag(i\hbar{\partial\over\partial t}+c\alpha^i p_i-\beta mc^2-ceA_0-ce\alpha^iA_i)\psi=\\=-\psi^\dag(-i\hbar{\partial\over\partial t}+c\alpha^i (-p_i+eA_i)+\beta mc^2+ceA_0)\psi=\\=-\psi^\dag(-i\hbar{\partial\over\partial t}+c{\boldsymbol\alpha}\cdot({\bf p}-e{\bf A})+\beta mc^2+V)\psi\end{aligned}\end{align} \]</div>
<p>where we introduced the potential by <span class="math notranslate nohighlight">\(V = c e A_0\)</span>. We also could have done the
same manipulation to the dirac equation itself and we would get the same
expression:</p>
<div class="math notranslate nohighlight">
\[(-i\hbar{\partial\over\partial t}+c{\boldsymbol\alpha}\cdot({\bf p}-e{\bf A})+\beta mc^2+V)\psi = 0\]</div>
<p>The corresponding eigenvalue problem is:</p>
<div class="math notranslate nohighlight">
\[(c{\boldsymbol\alpha}\cdot({\bf p}-e{\bf A})+\beta mc^2+V)\psi = W\psi\]</div>
</div>
<div class="section" id="radial-dirac-equation">
<h2>Radial Dirac equation<a class="headerlink" href="#radial-dirac-equation" title="Permalink to this headline">¶</a></h2>
<p>As for the Schrödinger equation, there are two ways to obtain the radial Dirac
equation. Either from the Lagrangian, or from the equation itself.</p>
<div class="section" id="id2">
<h3>From the Equation<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>The manipulations are well known, one starts by writing the Dirac spinors using
the spin angular functions and radial components <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}\psi = \left(\begin{array}{c}{P\over\rho}\chi^{j_3}_\kappa\\
    i{Q\over\rho}\chi^{j_3}_{-\kappa}\end{array}\right)\end{split}\\\psi^\dag = \left(\begin{array}{cc}{P\over\rho}\chi^{j_3}_\kappa &amp;
    -i{Q\over\rho}\chi^{j_3}_{-\kappa}\end{array}\right)\end{aligned}\end{align} \]</div>
<p>and putting this into the Dirac equation one obtains:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left(\begin{array}{cc}
    \left(-\hbar c \left({\d\over\d\rho} - {\kappa\over\rho}\right)Q + (V+mc^2-W)P\right)  &amp; 0\\
    0 &amp; \left(\hbar c \left({\d\over\d\rho} + {\kappa\over\rho}\right)P + (V-mc^2-W)Q\right)
    \end{array}\right)
    \left(
    \begin{array}{c}
    {1\over \rho}\chi^{j_3}_\kappa \\
    i{1\over\rho}\chi^{j_3}_{-\kappa}
    \end{array}
    \right)
    =0\end{split}\]</div>
<p>So one obtains the following radial equations:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}-\hbar c \left({\d\over\d\rho} - {\kappa\over\rho}\right)Q + (V+mc^2-W)P=0\\\hbar c \left({\d\over\d\rho} + {\kappa\over\rho}\right)P + (V-mc^2-W)Q=0\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="id3">
<h3>From the Lagrangian<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>We can reuse the calculations from the previous sections, because the Lagrangian
happens to be zero for the solution of the Dirac equation:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\L=\bar\psi(i\hbar c\gamma^\mu D_\mu-mc^2)\psi =\\=-\psi^\dag(-i\hbar{\partial\over\partial t}+c{\boldsymbol\alpha}\cdot({\bf
    p}-e{\bf A})+\beta mc^2+V)\psi=\\\begin{split}=
\left(\begin{array}{cc}{P\over\rho}\chi^{j_3}_\kappa &amp;
    -i{Q\over\rho}\chi^{j_3}_{-\kappa}\end{array}\right)
\left(\begin{array}{cc}
    \left(-\hbar c \left({\d\over\d\rho} - {\kappa\over\rho}\right)Q + (V+mc^2)P\right)  &amp; 0\\
    0 &amp; \left(\hbar c \left({\d\over\d\rho} + {\kappa\over\rho}\right)P + (V-mc^2)Q\right)
    \end{array}\right)
    \left(
    \begin{array}{c}
    {1\over \rho}\chi^{j_3}_\kappa \\
    i{1\over\rho}\chi^{j_3}_{-\kappa}
    \end{array}
    \right)
=\end{split}\\=
{1\over\rho^2}
P
\left(-\hbar c \left({\d\over\d\rho} - {\kappa\over\rho}\right)Q + (V+mc^2)P\right)
\chi^{j_3}_\kappa\chi^{j_3}_\kappa
+
{1\over\rho^2}
Q
\left(\hbar c \left({\d\over\d\rho} + {\kappa\over\rho}\right)P + (V-mc^2)Q\right)
\chi^{j_3}_{-\kappa}\chi^{j_3}_{-\kappa}\end{aligned}\end{align} \]</div>
<p>We can now write the action:</p>
<div class="math notranslate nohighlight">
\[S = \int \L \,\rho^2 \,\d\rho\d\Omega\]</div>
<p>the spin angular functions integrate to <span class="math notranslate nohighlight">\(1\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\int \chi^{j_3}_\kappa\chi^{j_3}_\kappa \d\Omega = 1\\\int \chi^{j_3}_{-\kappa}\chi^{j_3}_{-\kappa} \d\Omega = 1\end{aligned}\end{align} \]</div>
<p>the <span class="math notranslate nohighlight">\(\rho^2\)</span> cancels out and we
get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}S[P, Q] = \int
P
\left(-\hbar c \left({\d\over\d\rho} - {\kappa\over\rho}\right)Q + (V+mc^2)P\right)
+
Q
\left(\hbar c \left({\d\over\d\rho} + {\kappa\over\rho}\right)P + (V-mc^2)Q\right)
\,\d\rho=\\=\int -\hbar c(PQ' - QP') + \hbar c {2\kappa\over\rho} PQ +
    V(P^2+Q^2) + m c^2 (P^2 - Q^2) \d\rho\end{aligned}\end{align} \]</div>
<p>the normalization condition is:</p>
<div class="math notranslate nohighlight">
\[N = \int P^2 + Q^2 \d\rho - 1 = 0\]</div>
<p>and we can variate the action, we also shift the energy <span class="math notranslate nohighlight">\(W=\epsilon + mc^2\)</span>:</p>
<div class="math notranslate nohighlight">
\[0 = \delta (S - W N) = \delta (S - \epsilon N - mc^2N)\]</div>
<p>which effectively adds <span class="math notranslate nohighlight">\(-mc^2(P^2+Q^2)\)</span> into the Lagrangian, which changes the
term <span class="math notranslate nohighlight">\(mc^2(P^2 - Q^2)\)</span> into <span class="math notranslate nohighlight">\(-2mc^2 Q^2\)</span>.
We can now variate the (constrained) action:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}0=\delta\int -\hbar c(PQ' - QP') + \hbar c {2\kappa\over\rho} PQ +
    V(P^2+Q^2) - 2m c^2 Q^2 \d\rho=\\= 2\int \left(-\hbar c((\delta P)Q' - P'\delta Q) + \hbar c{\kappa\over\rho}
    ((\delta P)Q + P\delta Q)) + (P\delta P + Q\delta Q)V
    -2mc^2Q\delta Q - \epsilon(P\delta P + Q\delta Q)\right)\d\rho\\    +[P\delta Q - Q\delta P]^R_0 =\\= 2\int
\delta P \left(-\hbar c Q' + \hbar c{\kappa\over\rho}Q + PV -          \epsilon P
\right)+
\delta Q \left(\hbar c P' + \hbar c{\kappa\over\rho}P + QV - 2mc^2Q - \epsilon Q
\right)\d\rho
    +[P\delta Q - Q\delta P]^R_0 =\end{aligned}\end{align} \]</div>
<p>which gives the two radial equations:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}-\hbar c Q' + \hbar c{\kappa\over\rho}Q + PV          = \epsilon P\\ \hbar c P' + \hbar c{\kappa\over\rho}P + QV - 2mc^2Q = \epsilon Q\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="id4">
<h3>Weak Formulation<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>The weak formulation can be obtained by substituting <span class="math notranslate nohighlight">\(\delta P \to v_1\)</span> and
<span class="math notranslate nohighlight">\(\delta Q\to v_2\)</span> into the action above (and separating the integrals) and
omitting the the boundary term:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\int -\hbar c Q'v_1 + \hbar c{\kappa\over\rho}Qv_1 + PVv_1\d\rho =
\epsilon \int Pv_1 \d\rho\\\int \hbar c P'v_2 + \hbar c{\kappa\over\rho}Pv_2 + QVv_2 -2mc^2Qv_2\d\rho =
    \epsilon \int Q v_2 \d\rho\end{aligned}\end{align} \]</div>
<p>We can also start from the radial equations themselves to get the same result.
If we start from the equations themselves (which is the most elementary
approach), there are no boundary terms (because we didn’t integrate by parts).
We can separate the integrals according to the matrix elements that they
contribute to:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\int PVv_1 \d\rho + \int -\hbar c Q'v_1 +
    \hbar c{\kappa\over\rho}Qv_1 \d\rho =
\epsilon \int Pv_1 \d\rho\\\int \hbar c P'v_2 + \hbar c{\kappa\over\rho}Pv_2 +
    \int (V -2mc^2)Qv_2 \d\rho =
    \epsilon \int Q v_2 \d\rho\end{aligned}\end{align} \]</div>
<p>To show that this problem generates a symmetric matrix, it is helpful to write
the radial equations in the following form:</p>
<div class="math notranslate nohighlight">
\[\hat H \ket{P, Q} = \epsilon \ket{P, Q}\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}\ket{P, Q} = \left(\begin{array}{c} P(\rho) \\ Q(\rho)\end{array}\right)\end{split}\\\begin{split}\hat H = \left(\begin{array}{cc}
    V(\rho) &amp; \hbar c \left(-{\d\over\d\rho}+{\kappa\over\rho}\right) \\
    \hbar c \left({\d\over\d\rho}+{\kappa\over\rho}\right) &amp; V(\rho) - 2mc^2 \\
    \end{array}\right)\end{split}\end{aligned}\end{align} \]</div>
<p>the operator <span class="math notranslate nohighlight">\(\hat H\)</span> is Hermitean (<span class="math notranslate nohighlight">\(\hat H^\dag = \hat H\)</span>), because
<span class="math notranslate nohighlight">\(\left(-{\d\over\d\rho}\right)^\dag = {\d\over\d\rho}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int f{\d\over\d\rho}g \d\rho =
\int \left(-{\d\over\d\rho}\right)f g \d\rho\]</div>
<p>and all the other
quantities are just scalars.</p>
<p>Stricly speaking, the exact Dirac notation (that is coordinate/representation
independent) would be the following (notice the missing <span class="math notranslate nohighlight">\(\rho^2\)</span> in the
completeness relation, which is different to the radial Schrödinger equation):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\hat H \ket{P, Q} = \epsilon \ket{P, Q}\\\one = \int \d\rho \ket{\rho}\bra{\rho}\\\braket{\rho|\rho'} = \delta(\rho-\rho')\\\int
\braket{\rho|\hat H|\rho'}\braket{\rho'|P, Q}\d\rho'
    = \epsilon \braket{\rho|P, Q}\\\begin{split}\braket{\rho|P, Q} =
    \left(\begin{array}{c} P(\rho) \\ Q(\rho)\end{array}\right)\end{split}\\\begin{split}\braket{\rho|\hat H|\rho'} = \delta(\rho-\rho')
    \left(\begin{array}{cc}
    V(\rho) &amp; \hbar c \left(-{\d\over\d\rho}+{\kappa\over\rho}\right) \\
    \hbar c \left({\d\over\d\rho}+{\kappa\over\rho}\right) &amp; V(\rho) - 2mc^2 \\
    \end{array}\right)\end{split}\end{aligned}\end{align} \]</div>
<p>The normalization is:</p>
<div class="math notranslate nohighlight">
\[\braket{P, Q| P, Q} = \int \d\rho \braket{P, Q|\rho}\braket{\rho|P, Q} =
    \int \d\rho (P^2+Q^2) = 1\]</div>
<p>The weak formulation is:</p>
<div class="math notranslate nohighlight">
\[\braket{v|\hat H|P, Q} =
    \epsilon \braket{v|P, Q}\]</div>
<p>where the test function <span class="math notranslate nohighlight">\(\ket{v}\)</span> is one of:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\ket{v} = \begin{cases}
    \ket{v_1}\left(\begin{array}{c}1\\0\\\end{array}\right) \cr
    \ket{v_2}\left(\begin{array}{c}0\\1\\\end{array}\right) \cr
    \end{cases}\end{split}\]</div>
<p>The FE formulation is then obtained by expanding <span class="math notranslate nohighlight">\(\ket{P, Q} = \sum_k q_k \ket{k}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\sum_l \braket{k|\hat H|l}q_l =
    \epsilon \sum_l\braket{k|l}q_l\]</div>
<p>The basis <span class="math notranslate nohighlight">\(\ket{k}\)</span> can be for example the FE basis, some spline basis set, or
gaussians. The basis has actually <span class="math notranslate nohighlight">\(2n\)</span> base functions and it enumerates each
equation like this:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\ket{k} = \begin{cases}
    \ket{i}\left(\begin{array}{c}1\\0\\\end{array}\right) &amp;
        \mbox{for } i=k &lt; n\cr
    \ket{i}\left(\begin{array}{c}0\\1\\\end{array}\right) &amp;
        \mbox{for } i=k &gt;= n\cr
    \end{cases}\end{split}\]</div>
<p>So at the end of the day, the <span class="math notranslate nohighlight">\(\braket{k|\hat H|l}\)</span> matrix looks like this:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\braket{k|\hat H|l} = \left(\begin{array}{cc}
    \braket{i|V(r)|j} &amp; \hbar c \braket{i|-{\d\over\d\rho}+{\kappa\over\rho}|j} \\
    \hbar c \braket{i|{\d\over\d\rho}+{\kappa\over\rho}|j} &amp; \braket{i|V(r) - 2mc^2|j} \\
    \end{array}\right)\end{split}\]</div>
<p>The matrix is <span class="math notranslate nohighlight">\(2n \times 2n\)</span>, composed of those 4 matrices <span class="math notranslate nohighlight">\(n \times n\)</span>. The
<span class="math notranslate nohighlight">\(\braket{k|l}\)</span> matrix looks like this:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\braket{k|l} = \left(\begin{array}{cc}
    \braket{i|j} &amp; 0 \\
    0            &amp; \braket{i|j} \\
    \end{array}\right)\end{split}\]</div>
<p>We can also write the matrix elements explicitly. Let <span class="math notranslate nohighlight">\(\ket{i} = B_i(\rho)\)</span>,
then:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\braket{i|j} = \int B_i B_j \,\d\rho\\\braket{i|V|j} = \int B_i V B_j \,\d\rho\\\braket{i|V-2mc^2|j} = \int B_i (V-2mc^2) B_j \,\d\rho\\\hbar c \braket{i|{\d\over\d\rho}+{\kappa\over\rho}|j} =
    \hbar c\int B_i B_j' + B_i {\kappa\over\rho} B_j \,\d\rho\\\hbar c \braket{i|-{\d\over\d\rho}+{\kappa\over\rho}|j} =
    \hbar c\int -B_i B_j' + B_i {\kappa\over\rho} B_j \,\d\rho\end{aligned}\end{align} \]</div>
</div>
</div>
<div class="section" id="other-forms-of-dirac-equations">
<h2>Other Forms of Dirac Equations<a class="headerlink" href="#other-forms-of-dirac-equations" title="Permalink to this headline">¶</a></h2>
<p>The radial Dirac equations are:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\hat H \ket{P, Q} = \epsilon \ket{P, Q}\\\begin{split}\ket{P, Q} = \left(\begin{array}{c} P(\rho) \\ Q(\rho)\end{array}\right)\end{split}\\\begin{split}\hat H = \left(\begin{array}{cc}
    V(\rho) &amp; \hbar c \left(-{\d\over\d\rho}+{\kappa\over\rho}\right) \\
    \hbar c \left({\d\over\d\rho}+{\kappa\over\rho}\right) &amp; V(\rho) - 2mc^2 \\
    \end{array}\right)\end{split}\end{aligned}\end{align} \]</div>
<p>After substitution <span class="math notranslate nohighlight">\(S = f(r)P\)</span> and <span class="math notranslate nohighlight">\(T = f(r)Q\)</span>, we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\hat H \ket{P, Q} = \epsilon \ket{P, Q}\\\hat H {1\over f} \ket{S, T} = \epsilon {1\over f}\ket{S, T}\\f\hat H {1\over f} \ket{S, T} = \epsilon \ket{S, T}\end{aligned}\end{align} \]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}f\hat H {1\over f}= f\left(\begin{array}{cc}
    V(\rho) &amp; \hbar c \left(-{\d\over\d\rho}+{\kappa\over\rho}\right) \\
    \hbar c \left({\d\over\d\rho}+{\kappa\over\rho}\right) &amp; V(\rho) - 2mc^2 \\
    \end{array}\right){1\over f}
    =\end{split}\\\begin{split}= \left(\begin{array}{cc}
    V(\rho) &amp; \hbar c \left(-f{\d\over\d\rho}{1\over f}+{\kappa\over\rho}\right) \\
    \hbar c \left(f{\d\over\d\rho}{1\over f}+{\kappa\over\rho}\right) &amp; V(\rho) - 2mc^2 \\
    \end{array}\right)\end{split}\end{aligned}\end{align} \]</div>
<p>and after using:</p>
<div class="math notranslate nohighlight">
\[f{\d\over\d\rho}{1\over f} = {\d\over\d\rho} - {f'\over f}\]</div>
<p>we get:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f\hat H {1\over f}
= \left(\begin{array}{cc}
    V(\rho) &amp; \hbar c \left(-{\d\over\d\rho}+{\kappa\over\rho}+{f'\over f}\right) \\
    \hbar c \left({\d\over\d\rho}+{\kappa\over\rho}-{f'\over f}\right) &amp; V(\rho) - 2mc^2 \\
    \end{array}\right)\end{split}\]</div>
<div class="section" id="example-i">
<h3>Example I<a class="headerlink" href="#example-i" title="Permalink to this headline">¶</a></h3>
<p>In order to obtain equations for <span class="math notranslate nohighlight">\(g\)</span> and <span class="math notranslate nohighlight">\(f\)</span>, related to <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> by:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P = \rho g\\Q = \rho f\end{aligned}\end{align} \]</div>
<p>so <span class="math notranslate nohighlight">\(f(r) = {1\over \rho}\)</span> and</p>
<div class="math notranslate nohighlight">
\[{f'\over f} = -{1\over \rho}\]</div>
<p>and we get the radial Dirac equation for <span class="math notranslate nohighlight">\(g\)</span> and <span class="math notranslate nohighlight">\(f\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f\hat H {1\over f}
= \left(\begin{array}{cc}
    V(\rho) &amp; \hbar c \left(-{\d\over\d\rho}+{\kappa-1\over\rho}\right) \\
    \hbar c \left({\d\over\d\rho}+{\kappa+1\over\rho}\right) &amp; V(\rho) - 2mc^2 \\
    \end{array}\right)\end{split}\]</div>
</div>
<div class="section" id="example-ii">
<h3>Example II<a class="headerlink" href="#example-ii" title="Permalink to this headline">¶</a></h3>
<p>For <span class="math notranslate nohighlight">\(f(r) = \rho\)</span> we get</p>
<div class="math notranslate nohighlight">
\[{f'\over f} = {1\over \rho}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}f\hat H {1\over f}
= \left(\begin{array}{cc}
    V(\rho) &amp; \hbar c \left(-{\d\over\d\rho}+{\kappa+1\over\rho}\right) \\
    \hbar c \left({\d\over\d\rho}+{\kappa-1\over\rho}\right) &amp; V(\rho) - 2mc^2 \\
    \end{array}\right)\end{split}\]</div>
</div>
<div class="section" id="example-iii">
<h3>Example III<a class="headerlink" href="#example-iii" title="Permalink to this headline">¶</a></h3>
<p>For <span class="math notranslate nohighlight">\(f(r) = \rho^n\)</span> we get</p>
<div class="math notranslate nohighlight">
\[{f'\over f} = {n\over \rho}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}f\hat H {1\over f}
= \left(\begin{array}{cc}
    V(\rho) &amp; \hbar c \left(-{\d\over\d\rho}+{\kappa+n\over\rho}\right) \\
    \hbar c \left({\d\over\d\rho}+{\kappa-n\over\rho}\right) &amp; V(\rho) - 2mc^2 \\
    \end{array}\right)\end{split}\]</div>
<p>Example I is just a special case for <span class="math notranslate nohighlight">\(n=-1\)</span>, Example II for <span class="math notranslate nohighlight">\(n=1\)</span>.</p>
</div>
<div class="section" id="example-iv">
<h3>Example IV<a class="headerlink" href="#example-iv" title="Permalink to this headline">¶</a></h3>
<p>For <span class="math notranslate nohighlight">\(f(r) = \tanh \rho\)</span> we get</p>
<div class="math notranslate nohighlight">
\[{f'\over f} = {1\over \sinh\rho\cosh\rho}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}f\hat H {1\over f}
= \left(\begin{array}{cc}
    V(\rho) &amp; \hbar c \left(-{\d\over\d\rho}+{\kappa\over\rho}+{1\over \sinh\rho\cosh\rho}\right) \\
    \hbar c \left({\d\over\d\rho}+{\kappa\over\rho}-{1\over \sinh\rho\cosh\rho}\right) &amp; V(\rho) - 2mc^2 \\
    \end{array}\right)\end{split}\]</div>
</div>
<div class="section" id="example-v">
<h3>Example V<a class="headerlink" href="#example-v" title="Permalink to this headline">¶</a></h3>
<p>For <span class="math notranslate nohighlight">\(f(r) = \tanh^n k\rho\)</span> we get</p>
<div class="math notranslate nohighlight">
\[{f'\over f} = {nk\over \sinh k\rho\cosh k\rho}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}f\hat H {1\over f}
= \left(\begin{array}{cc}
    V(\rho) &amp; \hbar c \left(-{\d\over\d\rho}+{\kappa\over\rho}+{nk\over
    \sinh k\rho\cosh k\rho}\right) \\
    \hbar c \left({\d\over\d\rho}+{\kappa\over\rho}-{nk\over \sinh
    k\rho\cosh k\rho}\right) &amp; V(\rho) - 2mc^2 \\
    \end{array}\right)\end{split}\]</div>
<p>Example IV is just a special case for <span class="math notranslate nohighlight">\(n=1\)</span>, <span class="math notranslate nohighlight">\(k=1\)</span>.</p>
</div>
</div>
<div class="section" id="asymptotic">
<h2>Asymptotic<a class="headerlink" href="#asymptotic" title="Permalink to this headline">¶</a></h2>
<div class="section" id="schrodinger">
<h3>Schrödinger<a class="headerlink" href="#schrodinger" title="Permalink to this headline">¶</a></h3>
<p>The radial Schrödinger equation is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P''(r) + 2\left(E-V(r)-{l(l+1)\over 2r^2}\right) P(r) = 0\\Q(r) = P'(r)\end{aligned}\end{align} \]</div>
<p>For <span class="math notranslate nohighlight">\(r\to\infty\)</span>, assuming <span class="math notranslate nohighlight">\(V(r)\to0\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[P''(r) + 2E P(r) = 0\]</div>
<p>And the asymptotic is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P(r) = e^{-\sqrt{-2E} r}\\Q(r) = P'(r) = -\sqrt{-2E} e^{-\sqrt{-2E} r}\end{aligned}\end{align} \]</div>
<p>For <span class="math notranslate nohighlight">\(r\to0\)</span> and assuming that <span class="math notranslate nohighlight">\(V(r)\)</span> can be neglected compared to the
<span class="math notranslate nohighlight">\({l(l+1)\over 2r^2}\)</span> term (for example <span class="math notranslate nohighlight">\(V(r) = -Z/r + O(1)\)</span> is ok) we get:</p>
<div class="math notranslate nohighlight">
\[P''(r) -{l(l+1)\over r^2} P(r) = 0\]</div>
<p>And the asymptotic is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P(r) = r^{l+1}\\Q(r) = (l+1) r^l\end{aligned}\end{align} \]</div>
<p>From the derivation this is valid for <span class="math notranslate nohighlight">\(l&gt;0\)</span>, but it turns out to be valid also
for <span class="math notranslate nohighlight">\(l=0\)</span>, because for <span class="math notranslate nohighlight">\(V(r) = -Z/r + O(1)\)</span> the equations become:</p>
<div class="math notranslate nohighlight">
\[P''(r) +{2Z\over r} P(r) = 0\]</div>
<p>the asymptotic of which is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P(r) = r(1-Zr)\\P'(r) = 1-2Zr\\P''(r) = -2Z\end{aligned}\end{align} \]</div>
<p>Which in the first order is just the above asymptotic for <span class="math notranslate nohighlight">\(l=0\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P(r) = r\\Q(r) = 1\end{aligned}\end{align} \]</div>
<p>Note that <span class="math notranslate nohighlight">\(Z\)</span> can be both positive and negative.</p>
</div>
<div class="section" id="dirac">
<h3>Dirac<a class="headerlink" href="#dirac" title="Permalink to this headline">¶</a></h3>
<p>The Dirac equation is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}H = \left(\begin{array}{cc}
    V(r) + c^2 &amp; c\left(-{\d\over\d r}+{\kappa\over r}\right) \\
    c \left({\d\over\d r}+{\kappa\over r}\right) &amp; V(r) - c^2 \\
    \end{array}\right)\end{split}\\\begin{split}H\left(\begin{array}{c}
    P(r) \\
    Q(r) \\
    \end{array}\right) =
W\left(\begin{array}{c}
    P(r) \\
    Q(r) \\
    \end{array}\right)\end{split}\end{aligned}\end{align} \]</div>
<p>Where the relativistic energy <span class="math notranslate nohighlight">\(W = E + c^2\)</span>. In terms of the nonrelativistic
energy it becomes:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}H_{nonrel} = \left(\begin{array}{cc}
    V(r) &amp; c\left(-{\d\over\d r}+{\kappa\over r}\right) \\
    c \left({\d\over\d r}+{\kappa\over r}\right) &amp; V(r) - 2c^2 \\
    \end{array}\right)\end{split}\\\begin{split}H_{nonrel}\left(\begin{array}{c}
    P(r) \\
    Q(r) \\
    \end{array}\right) =
E\left(\begin{array}{c}
    P(r) \\
    Q(r) \\
    \end{array}\right)\end{split}\end{aligned}\end{align} \]</div>
<p>For <span class="math notranslate nohighlight">\(r\to\infty\)</span>, assuming <span class="math notranslate nohighlight">\(V(r)\to 0\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[\begin{split}H = \left(\begin{array}{cc}
    c^2 &amp; -c{\d\over\d r} \\
    c {\d\over\d r} &amp; - c^2 \\
    \end{array}\right)\end{split}\]</div>
<p>and in terms of <span class="math notranslate nohighlight">\(P(r)\)</span> and <span class="math notranslate nohighlight">\(Q(r)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}c^2 P - c Q' = W P\\c P' - c^2 Q = W Q\end{aligned}\end{align} \]</div>
<p>let’s put the derivatives on the left hand side:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}c P' =  (W + c^2) Q\\c Q' = -(W - c^2) P\end{aligned}\end{align} \]</div>
<p>write a second order equation:</p>
<div class="math notranslate nohighlight">
\[c^2 P'' =  (W + c^2) c Q' = - (W + c^2)(W - c^2) P
    = - (W^2 - c^4) P\]</div>
<p>and finally we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P'' + {W^2 - c^4 \over c^2} P = 0\\Q = {c\over W + c^2} P'\end{aligned}\end{align} \]</div>
<p>The asymptotic is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P(r) = e^{-\sqrt{c^4-W^2\over c^2} r}\\Q(r) = {c\over W + c^2} \left(-\sqrt{c^4-W^2\over c^2}\right)
    e^{-\sqrt{c^4-W^2\over c^2} r}
  = -\sqrt{c^2-W\over c^2+W} e^{-\sqrt{c^4-W^2\over c^2} r}\end{aligned}\end{align} \]</div>
<p>We can also write it in terms of <span class="math notranslate nohighlight">\(E\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P(r) = e^{-\sqrt{-2E-\left(E\over c\right)^2} r}\\Q(r) = -\sqrt{-{E\over E + 2c^2}} P(r)\end{aligned}\end{align} \]</div>
<p>For <span class="math notranslate nohighlight">\(r\to 0\)</span> we write the full equations:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(V+c^2) P - c Q' + c{\kappa\over r} Q = W P\\c P' + c{\kappa\over r} P + (V-c^2) Q = W Q\end{aligned}\end{align} \]</div>
<p>Then we assume <span class="math notranslate nohighlight">\(P(r) = r^\beta\)</span> and use the second equation to express <span class="math notranslate nohighlight">\(Q(r)\)</span>:</p>
<div class="math notranslate nohighlight">
\[Q(r) = {c P' + c{\kappa\over r} P \over W - V + c^2}
    ={c \beta r^{\beta-1} + c{\kappa\over r} r^\beta \over W - V + c^2}
    =r^{\beta-1} {c(\beta + \kappa)\over W - V + c^2}\]</div>
<p>We can always write any potential as <span class="math notranslate nohighlight">\(V(r) = -{Z(r)\over r}\)</span> and we get:</p>
<div class="math notranslate nohighlight">
\[Q(r)
    =r^{\beta-1} {c(\beta + \kappa)\over W + {Z(r)\over r} + c^2}
    =r^\beta {c(\beta + \kappa)\over Z(r) + (W + c^2)r}\]</div>
<p>If <span class="math notranslate nohighlight">\(Z(r)\to Z\)</span> as <span class="math notranslate nohighlight">\(r\to 0\)</span> then the term <span class="math notranslate nohighlight">\((W + c^2)r\)</span> goes to zero and we get:</p>
<div class="math notranslate nohighlight">
\[Q(r) =r^\beta {c(\beta + \kappa)\over Z}\]</div>
<p>If <span class="math notranslate nohighlight">\(Z(r) \to Z_1 r\)</span>, then we get:</p>
<div class="math notranslate nohighlight">
\[Q(r)
    =r^\beta {c(\beta + \kappa)\over Z_1 r + (W + c^2)r}
    =r^{\beta-1} {c(\beta + \kappa)\over Z_1 + W + c^2}\]</div>
<p>If <span class="math notranslate nohighlight">\(Z(r) \sim r^3\)</span> (harmonic oscillator) or <span class="math notranslate nohighlight">\(Z(r) \sim r^2\)</span>, then the <span class="math notranslate nohighlight">\(Z(r)\)</span>
term goes to zero and we get:</p>
<div class="math notranslate nohighlight">
\[Q(r) =r^{\beta-1} {c(\beta + \kappa)\over W + c^2}\]</div>
<p>In order to determine the constant <span class="math notranslate nohighlight">\(\beta\)</span> for <span class="math notranslate nohighlight">\(Z\ne0\)</span>, we write the fraction
<span class="math notranslate nohighlight">\(Q(r)\over P(r)\)</span> in two ways:</p>
<div class="math notranslate nohighlight">
\[{Q(r)\over P(r)} = {c(\beta+\kappa) \over Z} = {Z\over c(\kappa-\beta)}\]</div>
<p>The second equation follows from first assuming <span class="math notranslate nohighlight">\(Q(r)=r^\beta\)</span> and using the
first Dirac equation to express <span class="math notranslate nohighlight">\(P(r)=r^\beta {c(\kappa-\beta) \over Z}\)</span>.  Now
we can express <span class="math notranslate nohighlight">\(\beta\)</span> (we can assume <span class="math notranslate nohighlight">\(\beta &gt; 0\)</span>):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{Z^2\over c^2} = \kappa^2 - \beta^2\\\beta = \sqrt{\kappa^2 - \left(Z\over c\right)^2}\end{aligned}\end{align} \]</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Radial Schrödinger and Dirac Equations</a><ul>
<li><a class="reference internal" href="#variational-formulation-of-the-schrodinger-equation">Variational Formulation of the Schrödinger equation</a><ul>
<li><a class="reference internal" href="#weak-formulation">Weak Formulation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#radial-schrodinger-equation">Radial Schrödinger equation</a><ul>
<li><a class="reference internal" href="#from-the-equation">From the Equation</a></li>
<li><a class="reference internal" href="#from-the-lagrangian">From the Lagrangian</a></li>
<li><a class="reference internal" href="#solving-for-u-rr">Solving for u=rR</a></li>
<li><a class="reference internal" href="#perturbative-correction-to-energy">Perturbative Correction to Energy</a></li>
<li><a class="reference internal" href="#id1">Weak Formulation</a><ul>
<li><a class="reference internal" href="#weak-formulation-for-u">Weak Formulation for u</a></li>
<li><a class="reference internal" href="#dirac-notation">Dirac Notation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#variational-formulation-of-the-dirac-equation">Variational Formulation of the Dirac equation</a></li>
<li><a class="reference internal" href="#radial-dirac-equation">Radial Dirac equation</a><ul>
<li><a class="reference internal" href="#id2">From the Equation</a></li>
<li><a class="reference internal" href="#id3">From the Lagrangian</a></li>
<li><a class="reference internal" href="#id4">Weak Formulation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-forms-of-dirac-equations">Other Forms of Dirac Equations</a><ul>
<li><a class="reference internal" href="#example-i">Example I</a></li>
<li><a class="reference internal" href="#example-ii">Example II</a></li>
<li><a class="reference internal" href="#example-iii">Example III</a></li>
<li><a class="reference internal" href="#example-iv">Example IV</a></li>
<li><a class="reference internal" href="#example-v">Example V</a></li>
</ul>
</li>
<li><a class="reference internal" href="#asymptotic">Asymptotic</a><ul>
<li><a class="reference internal" href="#schrodinger">Schrödinger</a></li>
<li><a class="reference internal" href="#dirac">Dirac</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="examples.html"
                        title="previous chapter">Examples</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dft.html"
                        title="next chapter">Density Functional Theory (DFT)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/quantum/radial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="dft.html" title="Density Functional Theory (DFT)"
             >next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" >Quantum Field Theory and Quantum Mechanics</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>