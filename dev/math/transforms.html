<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Fourier Transform &mdash; Theoretical Physics Reference 0.5 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Theoretical Physics Reference 0.5 documentation" href="../index.html" />
    <link rel="up" title="Mathematics" href="main.html" />
    <link rel="next" title="Periodic Functions" href="trig.html" />
    <link rel="prev" title="Residue Theorem" href="residue.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="trig.html" title="Periodic Functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="residue.html" title="Residue Theorem"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &raquo;</li>
          <li><a href="main.html" accesskey="U">Mathematics</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="fourier-transform">
<h1>Fourier Transform<a class="headerlink" href="#fourier-transform" title="Permalink to this headline">¶</a></h1>
<p>The 1D Fourier transform is:</p>
<div class="math">
<p><img src="../_images/math/9fb62c3445027a0cb4e744bb622c727f548308f3.png" alt="F[f(x)] \equiv \tilde f(\omega)
    = \int_{-\infty}^{\infty} f(x) e^{-i\omega x}\,\d x

F^{-1}[\tilde f(\omega)] = f(x)
    = {1\over2\pi}\int_{-\infty}^{\infty}
    \tilde f(\omega) e^{+i\omega x}\,\d \omega"/></p>
</div><p>To show that it works:</p>
<div class="math">
<p><img src="../_images/math/a0f1e4fbee5dd57836921191bbe74736bff28d4a.png" alt="F^{-1} F [f(x)]
=
{1\over2\pi}\int_{-\infty}^{\infty} \left[\int_{-\infty}^{\infty}
    f(x) e^{-i\omega x}\,\d x\right] e^{+i\omega x}\,\d \omega
=
{1\over2\pi}\int_{-\infty}^{\infty} \left[\int_{-\infty}^{\infty}
    f(x') e^{-i\omega x'}\,\d x'\right] e^{+i\omega x}\,\d \omega
=

=
\int_{-\infty}^{\infty} f(x') \left[{1\over2\pi}\int_{-\infty}^{\infty}
    e^{i\omega (x- x')}\,\d \omega \right] \,\d x'
=
\int_{-\infty}^{\infty} f(x') \delta(x-x') \,\d x'
=f(x)"/></p>
</div><p>If <img class="math" src="../_images/math/26eeb5258ca5099acf8fe96b2a1049c48c89a5e6.png" alt="x"/> is time (unit <img class="math" src="../_images/math/47ae4bc88fe242250b2dd44b2004b6c86237ab88.png" alt="[\mathrm{s}]"/>), then <img class="math" src="../_images/math/54d7d48553f4d9e7ab418118607ea324cbfddfda.png" alt="\omega"/> is angular frequency (unit
<img class="math" src="../_images/math/1dd82d57f37a410f4763b953f8ec055a815decc0.png" alt="[\mathrm{rad}/\mathrm{s}]"/>). One can express the Fourier transform in terms of
ordinary frequency <img class="math" src="../_images/math/d6a7ccf879c4a4fe694033606332cb83806db296.png" alt="\nu"/> (unit <img class="math" src="../_images/math/f449771115817b9606dfe5405d2aa2411c62eddd.png" alt="[1/\mathrm{s}] = [\mathrm{Hz}]"/>) by
substituting <img class="math" src="../_images/math/c917a2d660e3cec03a921006df1a979440ed355a.png" alt="\omega = 2\pi \nu"/>:</p>
<div class="math">
<p><img src="../_images/math/ceb54bda54060ee8434819513e546e5c95220172.png" alt="\tilde f(\omega) = \tilde f(2\pi \nu) \equiv \tilde f'(\nu)
    = \int_{-\infty}^{\infty} f(x) e^{-2\pi i\nu x}\,\d x

f(x) = \int_{-\infty}^{\infty} \tilde f'(\nu) e^{+2\pi i\nu x}\,\d \nu"/></p>
</div><p>Both transformations are equivalent and only differ in whether we
express the transform in terms of <img class="math" src="../_images/math/54d7d48553f4d9e7ab418118607ea324cbfddfda.png" alt="\omega"/> or <img class="math" src="../_images/math/d6a7ccf879c4a4fe694033606332cb83806db296.png" alt="\nu"/>,
the conversion
being given by <img class="math" src="../_images/math/dfe7c6cc11ba9f9805c49b775d45763bc319a24f.png" alt="\tilde f(\omega) = \tilde f(2\pi \nu) \equiv \tilde f'(\nu)"/>.
Third frequently used convention that is however not equivalent to the above is:</p>
<div class="math">
<p><img src="../_images/math/dc6b0c5cdd355c2e4f8d4cc2e714758a7beb0248.png" alt="\tilde f(k)
    = {1\over\sqrt{2\pi}}
      \int_{-\infty}^{\infty} f(x) e^{-ik x}\,\d x

f(x)
    = {1\over\sqrt{2\pi}}
      \int_{-\infty}^{\infty} \tilde f(k) e^{+ik x}\,\d k"/></p>
</div><p>The 3D Fourier transform is:</p>
<div class="math" id="equation-fourier1">
<p><span class="eqno">(1)</span><img src="../_images/math/363a5fbf231c33e18af3afc0440f7a970caac6d8.png" alt="F[f(\mathbf{x})] \equiv \tilde f(\bomega)
    = \int_{-\infty}^{\infty} f(\mathbf{x}) e^{-i\bomega \cdot
        \mathbf{x}}\,\d^3 x

F^{-1}[\tilde f(\bomega)] = f(\mathbf{x})
    = {1\over(2\pi)^3}\int_{-\infty}^{\infty}
    \tilde f(\bomega) e^{+i\bomega \cdot \mathbf{x}}\,\d^3 \omega"/></p>
</div><p>With obvious analogs for other conventions and dimensions.</p>
<p>The sign convention in the exponentials <img class="math" src="../_images/math/cf3de7bb79e0d73a627ec989754395db803998c5.png" alt="e^{\pm i\omega x}"/> is arbitrary, one
can as well flip the sign of the direct and inverse transforms. In particular,
one often uses both sign conventions in the same equation. Consider a spacetime
plane-wave <img class="math" src="../_images/math/ca818affa24d5a57639c001d7185cca577050a11.png" alt="e^{i k\cdot x} = e^{i(\omega t - \mathbf{k}\cdot\mathbf{x})}"/>. Then
we obtain (using plus sign convention in the <img class="math" src="../_images/math/255a308ec183ddd1675089271e850db35865c3df.png" alt="e^{ik \cdot x}"/> exponential for
the direct transformation):</p>
<div class="math">
<p><img src="../_images/math/32ffba18dd123b1df27ef951911ede8752bbc3ac.png" alt="F[f(x)] \equiv \tilde f(k)
    = \int_{-\infty}^{\infty} f(x) e^{ik \cdot x}\,\d^4 x
    = \int_{-\infty}^{\infty} f(x)
        e^{i(\omega t - \mathbf{k}\cdot\mathbf{x})}\,\d^4 x

F^{-1}[f(k)] \equiv f(x)
    = {1\over(2\pi)^4} \int_{-\infty}^{\infty} \tilde f(k)
        e^{-ik \cdot x}\,\d^4 k
    = {1\over(2\pi)^4} \int_{-\infty}^{\infty} \tilde f(k)
        e^{-i(\omega t - \mathbf{k}\cdot\mathbf{x})}\,\d^4 k"/></p>
</div><p>Finally, the equation <img class="math" src="../_images/math/54bc44077b02e209baee3a7358ccd893ef61ddeb.png" alt="k\cdot x = \omega t - \mathbf{k}\cdot\mathbf{x}"/> depends
on the metric signature, in this case <img class="math" src="../_images/math/88cb959c49e0a7eff0d6d7fc998d408d419943a9.png" alt="\diag({1, -1, -1, -1})"/>.
For a signature <img class="math" src="../_images/math/742b7002ebd418b263a8088eecb18e2fe7e3c596.png" alt="\diag({-1, 1, 1, 1})"/> we would get
<img class="math" src="../_images/math/641d9909e596deece0cd516a9f8c30f97a7c5978.png" alt="k\cdot x = -\omega t + \mathbf{k}\cdot\mathbf{x}"/>.</p>
<p>Unlike the normalization convention, where one has to be very careful, the sign
convention in Fourier transform is not a problem, one just has to remember to
flip the sign for the inverse transform.</p>
<div class="section" id="shift-theorem">
<h2>Shift Theorem<a class="headerlink" href="#shift-theorem" title="Permalink to this headline">¶</a></h2>
<p>The Fourier transform of a shifted function, in 3D:</p>
<div class="math">
<p><img src="../_images/math/f2b6218f6df8a6d59138fd351a390d2985a17416.png" alt="F[f(\mathbf{x}+\mathbf{b})]
    = \int_{-\infty}^{\infty} f(\mathbf{x}+\mathbf{b}) e^{-i\bomega \cdot
        \mathbf{x}}\,\d^3 x =

    = \int_{-\infty}^{\infty} f(\mathbf{x}) e^{-i\bomega \cdot
        (\mathbf{x}-\mathbf{b})}\,\d^3 x =

    = e^{i\bomega\cdot \mathbf{b}} \int_{-\infty}^{\infty} f(\mathbf{x}) e^{-i\bomega \cdot
        \mathbf{x}}\,\d^3 x =

    = e^{i\bomega\cdot \mathbf{b}} F[f(\mathbf{x})]"/></p>
</div></div>
<div class="section" id="derivative">
<h2>Derivative<a class="headerlink" href="#derivative" title="Permalink to this headline">¶</a></h2>
<p>The Fourier transform of a derivative, in 3D:</p>
<div class="math">
<p><img src="../_images/math/0cb5e9c85a58490fba5c2e903e14677a5598b8dc.png" alt="F[\partial_i f(\mathbf{x})]
    = \int_{-\infty}^{\infty} (\partial_i f(\mathbf{x})) e^{-i\bomega \cdot
        \mathbf{x}}\,\d^3 x =

    = \left[f(\mathbf{x}) e^{-i\bomega \cdot
            \mathbf{x}}\right]_{-\infty}^{\infty}
      -\int_{-\infty}^{\infty} f(\mathbf{x}) \partial_i e^{-i\bomega \cdot
        \mathbf{x}}\,\d^3 x =

    = -\int_{-\infty}^{\infty} f(\mathbf{x}) \partial_i e^{-i\omega_j
        x^j}\,\d^3 x =

    = -(-i\omega_i)\int_{-\infty}^{\infty} f(\mathbf{x})
        e^{-i\bomega \cdot \mathbf{x}}\,\d^3 x =

    = i\omega_i F[f(\mathbf{x})]\,."/></p>
</div><p>An alternative derivation is to start from:</p>
<div class="math">
<p><img src="../_images/math/8da845b564e841c586b345cff39c1f7dbb9917f9.png" alt="f(\mathbf{x}) = F^{-1}[\tilde f(\bomega)]
    = {1\over(2\pi)^3}\int_{-\infty}^{\infty}
    \tilde f(\bomega) e^{+i\bomega \cdot \mathbf{x}}\,\d^3 \omega"/></p>
</div><p>and differentiate both sides:</p>
<div class="math">
<p><img src="../_images/math/5bb3944ec8cfbde2761e1dbb8d51fbb1db2694d7.png" alt="\partial_i f(\mathbf{x})
    = {1\over(2\pi)^3}\int_{-\infty}^{\infty}
    \tilde f(\bomega) \partial_i e^{+i\bomega \cdot \mathbf{x}}\,\d^3 \omega

\partial_i f(\mathbf{x})
    = {1\over(2\pi)^3}\int_{-\infty}^{\infty}
    i\omega_i \tilde f(\bomega) e^{+i\bomega \cdot \mathbf{x}}\,\d^3 \omega
    \,,"/></p>
</div><p>from which:</p>
<div class="math">
<p><img src="../_images/math/43f7c7c8db8ec06838b8802c42b0b28d221efb98.png" alt="F[\partial_i f(\mathbf{x})]
    = i\omega_i \tilde f(\bomega)
    = i\omega_i F[f(\mathbf{x})]\,."/></p>
</div></div>
<div class="section" id="radial-fourier-transform">
<h2>Radial Fourier Transform<a class="headerlink" href="#radial-fourier-transform" title="Permalink to this headline">¶</a></h2>
<p>As a special case when the function <img class="math" src="../_images/math/c9392fa3753b06b346e51952e909adf296a14453.png" alt="f(\mathbf{x})=f(r)"/> is spherically symmetric,
we introduce spherical coordinates such that the <img class="math" src="../_images/math/b13f21416d84e13708696f34dea81026cda583c9.png" alt="z"/>-axis is along the
<img class="math" src="../_images/math/3d60306d6601bee96e70de9d22d49cc5d09e76e0.png" alt="\bomega"/> vector and calculate (we use <img class="math" src="../_images/math/66230c4dd11be2e3bb614402f3d6426a53fed467.png" alt="r=|\mathbf{x}|"/> and <img class="math" src="../_images/math/9dea4929d6effd73252a857f75396a3d6e236abe.png" alt="\omega=|\bomega|"/>):</p>
<div class="math">
<p><img src="../_images/math/5d50740835b11f1df1ce6e1aa48ee46dde030cb5.png" alt="F[f(\mathbf{x})] \equiv \tilde f(\bomega)
    = \int_{-\infty}^{\infty} f(\mathbf{x}) e^{-i\bomega \cdot
        \mathbf{x}}\,\d^3 x
    = \int_{-\infty}^{\infty} f(r) e^{-i\bomega \cdot
        \mathbf{x}}\,\d^3 x =

    = \int_0^\infty\d r \int_0^\pi\d\theta \int_0^{2\pi}\d\phi f(r)
        e^{-i \omega r \cos\theta}\,r^2\sin\theta =

    = 2\pi \int_0^\infty\d r \int_0^\pi\d\theta f(r)
        e^{-i \omega r \cos\theta}\,r^2\sin\theta =

    = 4\pi \int_0^\infty f(r) j_0(\omega r) \,r^2 \d r =

    = 4\pi \int_0^\infty f(r) {\sin\omega r \over \omega r}\,r^2 \d r =

    = {4\pi\over\omega} \int_0^\infty r\sin(\omega r) f(r) \,\d r\,,"/></p>
</div><p>where we used:</p>
<div class="math">
<p><img src="../_images/math/30217556dc4e8dbedc0a422fca42e4fb2106f3fb.png" alt="\int_0^\pi e^{-i \omega r \cos\theta}\,\sin\theta \d\theta
    = \int_{-1}^1 e^{i\omega r u} \d u
    = \left[e^{i\omega r u} \over i\omega r\right]_{-1}^1
    = {e^{i\omega r} - e^{-i\omega r} \over i \omega r}
    = 2 {\sin \omega r \over \omega r} = 2 j_0(\omega r)\,."/></p>
</div><p>So the transform is real and spherically symmetric, since the result only
depends on <img class="math" src="../_images/math/54d7d48553f4d9e7ab418118607ea324cbfddfda.png" alt="\omega"/>.</p>
<p>Similarly, for the inverse transform:</p>
<div class="math">
<p><img src="../_images/math/6407d4b6b9aa557ab5b1273f065d511154d31261.png" alt="F^{-1}[\tilde f(\bomega)] = f(\mathbf{x})
    = {1\over(2\pi)^3}\int_{-\infty}^{\infty}
    \tilde f(\bomega) e^{+i\bomega \cdot \mathbf{x}}\,\d^3 \omega =

    = {1\over(2\pi)^3}\int_{-\infty}^{\infty}
    \tilde f(\omega) e^{+i\bomega \cdot \mathbf{x}}\,\d^3 \omega =

    = {1\over(2\pi)^3}
    {4\pi\over r} \int_0^\infty \omega\sin(\omega r) f(\omega) \,\d \omega
    =

    = {1\over 2\pi^2 r}
    \int_0^\infty \omega\sin(\omega r) f(\omega) \,\d \omega"/></p>
</div></div>
</div>
<div class="section" id="fourier-transform-of-a-periodic-function-e-g-in-a-crystal">
<h1>Fourier Transform of a Periodic Function (e.g. in a Crystal)<a class="headerlink" href="#fourier-transform-of-a-periodic-function-e-g-in-a-crystal" title="Permalink to this headline">¶</a></h1>
<p>The Fourier transform in <a href="#equation-fourier1">(1)</a> requires the function <img class="math" src="../_images/math/873966ab6208920d791267d0a516a2641e7b3d87.png" alt="f(\mathbf{x})"/>
to be decaying fast enough in order to converge. In an infinite crystal, on the
other hand, the function <img class="math" src="../_images/math/873966ab6208920d791267d0a516a2641e7b3d87.png" alt="f(\mathbf{x})"/> is typically periodic (and thus not
decaying):</p>
<div class="math">
<p><img src="../_images/math/226ed6d0a016bdb7afb3ddef82ff1aaf0ff4c8c4.png" alt="f(\mathbf{x}+\mathbf{T}(n_1, n_2, n_3)) = f(\mathbf{x})"/></p>
</div><p>where <img class="math" src="../_images/math/4ce00b945d4b00a31f227f8193e7dc2d71cca5be.png" alt="\mathbf{T}(\mathbf{n})=\mathbf{T}(n_1, n_2,
n_3)=n_1\mathbf{a}_1+n_2\mathbf{a}_2+n_3\mathbf{a}_3"/> are the crystal
translation vectors. As such, the Fourier transform in <a href="#equation-fourier1">(1)</a> is
infinite, but it can be made finite by the following definition:</p>
<div class="math" id="equation-fourier2">
<p><span class="eqno">(2)</span><img src="../_images/math/32bd4ecf75020161f9e3e1727ef1326c814164a2.png" alt="F[f(\mathbf{x})] \equiv \tilde f(\bomega)
    = {1\over\Omega_\mathrm{crystal}}\int_{\Omega_\mathrm{crystal}} f(\mathbf{x}) e^{-i\bomega \cdot
        \mathbf{x}}\,\d^3 x =

    = {1\over\Omega_\mathrm{crystal}} \sum_\mathbf{n} \int_{\Omega_\mathrm{cell}}
    f(\mathbf{x}+\mathbf{T}(\mathbf{n}))
    e^{-i\bomega \cdot (\mathbf{x}+\mathbf{T}(\mathbf{n}))}\,\d^3 x =

    = {1\over\Omega_\mathrm{crystal}} \sum_\mathbf{n} \int_{\Omega_\mathrm{cell}} f(\mathbf{x})
    e^{-i\bomega \cdot (\mathbf{x}+\mathbf{T}(\mathbf{n}))}\,\d^3 x =

    = {1\over\Omega_\mathrm{crystal}} \sum_\mathbf{n} e^{-i\bomega \cdot \mathbf{T}(\mathbf{n})} \int_{\Omega_\mathrm{cell}} f(\mathbf{x})
    e^{-i\bomega \cdot \mathbf{x}}\,\d^3 x =

    = {1\over\Omega_\mathrm{crystal}} N_\mathrm{cell} \int_{\Omega_\mathrm{cell}} f(\mathbf{x})
    e^{-i\bomega \cdot \mathbf{x}}\,\d^3 x =

    = {1\over\Omega_\mathrm{cell}} \int_{\Omega_\mathrm{cell}} f(\mathbf{x})
    e^{-i\bomega \cdot \mathbf{x}}\,\d^3 x"/></p>
</div><p>This assumes that the wave vector <img class="math" src="../_images/math/4c4f42d087c7349c44f73af6a2af9458633332f8.png" alt="\bomega=\mathbf{G}"/> is equal to the
reciprocal space vectors <img class="math" src="../_images/math/597c852cd8d4be79f01a80b6317d2096dd10c544.png" alt="\mathbf{G}"/>, defined by</p>
<div class="math" id="equation-G">
<p><span class="eqno">(3)</span><img src="../_images/math/3c13d5c59aafdeec5682eed26a72ab37187bd70c.png" alt="e^{i\mathbf{G} \cdot \mathbf{T}(\mathbf{n})} = 1\,,"/></p>
</div><p>because then <img class="math" src="../_images/math/70b793518ba7d407408ba9bb3c4504bc3aaa6847.png" alt="\sum_\mathbf{n} e^{-i\bomega \cdot \mathbf{T}(\mathbf{n})} =
\sum_\mathbf{n} 1 = N_\mathrm{cell}"/>.</p>
<p>For <img class="math" src="../_images/math/9538fa0648d848bccec22a5a3e49d7d5233362aa.png" alt="\bomega\neq\mathbf{G}"/>, the expression <img class="math" src="../_images/math/0cdd003ae40e0bcabf8783d55978587e15cff6ea.png" alt="{1\over\Omega_\mathrm{crystal}}
\sum_\mathbf{n} e^{-i\bomega \cdot \mathbf{T}(\mathbf{n})} = 0"/> vanishes,
because the sum is bounded, and so dividing by the (infinite) crystal volume
makes the expression vanish, and so <img class="math" src="../_images/math/e0650e61f6518c3c160fa5bd9b6ef706775c3a7a.png" alt="\tilde f(\bomega)=0"/>.  In other words, the
only non-zero Fourier components <img class="math" src="../_images/math/122d4fd94b8be8cf55fa1f562bbe242a356a1611.png" alt="\tilde f(\bomega)"/> of any periodic function
<img class="math" src="../_images/math/873966ab6208920d791267d0a516a2641e7b3d87.png" alt="f(\mathbf{x})"/> are those with <img class="math" src="../_images/math/4c4f42d087c7349c44f73af6a2af9458633332f8.png" alt="\bomega=\mathbf{G}"/>. Equivalently said, if the
Fourier components of a given function are non-zero for some
<img class="math" src="../_images/math/9538fa0648d848bccec22a5a3e49d7d5233362aa.png" alt="\bomega\neq\mathbf{G}"/>, then the function is not periodic.</p>
<p>Summary: the only difference between the crystal Fourier transform
<a href="#equation-fourier2">(2)</a> and the usual Fourier transform <a href="#equation-fourier1">(1)</a> is the
<img class="math" src="../_images/math/567f4bec3bb3c201050a68653a0daaecc25ea049.png" alt="\Omega_\mathrm{crystal}"/> factor. The Fourier transform <a href="#equation-fourier2">(2)</a> of a
periodic function is nonzero only for <img class="math" src="../_images/math/400fcf5ba719b5d0f22ef845317f14bb5d75762a.png" alt="\omega=\mathbf{G}"/> and is equal to:</p>
<div class="math" id="equation-fourier2b">
<p><span class="eqno">(4)</span><img src="../_images/math/1a3afbe2f0e43382ad62b5ed586698bc1615b1ce.png" alt="F[f(\mathbf{x})] \equiv \tilde f(\mathbf{G})
    = {1\over\Omega_\mathrm{cell}} \int_{\Omega_\mathrm{cell}} f(\mathbf{x})
    e^{-i\mathbf{G} \cdot \mathbf{x}}\,\d^3 x"/></p>
</div><p>Note: the fact that the sum is bounded follows from:</p>
<div class="math">
<p><img src="../_images/math/325083ba307e01c292894884e9577d133068189d.png" alt="\left| \sum_{n=-\infty}^\infty e^{ikn} \right|
    = \left| \lim_{N\to\infty} \sum_{n=-N}^N e^{ikn} \right|
    = \left| \lim_{N\to\infty} \left(1+2\sum_{n=1}^N \cos kn\right) \right|=

    = \left| \lim_{N\to\infty} {\cos kN - \cos k(N+1) \over 1-\cos k}
        \right|
    &lt; {2 \over | 1-\cos k | }"/></p>
</div><p>Because <img class="math" src="../_images/math/b185df0b706669c03c1b3476eae4df9057f233e5.png" alt="| \cos kN - \cos k(N+1) | &lt; 2"/>.  So for <img class="math" src="../_images/math/1a6ea20d1ea2b4e7ea0a909b2c0ba18831d729e2.png" alt="k\neq 2\pi"/> (i.e. the
denominator is non-zero), the sum is bounded (to be precise, the infinite sum
does not converge, because it oscillates, but the point is that the partial sum
is always bounded). For <img class="math" src="../_images/math/119e65d218eae53f30bc36405bb491214aa2ce16.png" alt="k=2\pi"/>, the sum is infinite, because <img class="math" src="../_images/math/53ba5cb41fcf1e1b153125a504aab4fd130fd33d.png" alt="e^{i2\pi n} =
1"/>.</p>
<p>Since we divided the direct Fourier transform in <a href="#equation-fourier1">(1)</a> by
<img class="math" src="../_images/math/567f4bec3bb3c201050a68653a0daaecc25ea049.png" alt="\Omega_\mathrm{crystal}"/> to obtain <a href="#equation-fourier2">(2)</a>, we need to multiply the
inverse transform in <a href="#equation-fourier1">(1)</a> by <img class="math" src="../_images/math/567f4bec3bb3c201050a68653a0daaecc25ea049.png" alt="\Omega_\mathrm{crystal}"/>:</p>
<div class="math" id="equation-fourier2b_inv">
<p><span class="eqno">(5)</span><img src="../_images/math/a08ab937558651e45b27e1b9b4034d46568bce14.png" alt="F^{-1}[\tilde f(\bomega)] = f(\mathbf{x})
    = {\Omega_\mathrm{crystal}\over(2\pi)^3}\int_{-\infty}^{\infty}
    \tilde f(\bomega) e^{+i\bomega \cdot \mathbf{x}}\,\d^3 \omega
    =

    = {\Omega_\mathrm{cell}N_\mathrm{cell}\over(2\pi)^3}\int_{-\infty}^{\infty}
    \tilde f(\bomega) e^{+i\bomega \cdot \mathbf{x}}\,\d^3 \omega
    =

    = {N_\mathrm{cell}\over\Omega_\mathrm{BZ}}
    \sum_{\mathbf{G}}
    \int_{\Omega_\mathrm{BZ}}
    \tilde f(\mathbf{G}+\bomega)
        e^{+i(\mathbf{G}+\bomega) \cdot \mathbf{x}}\,\d^3 \omega
    =

    = {N_\mathrm{cell}\over\Omega_\mathrm{BZ}}
    \sum_{\mathbf{G}} e^{+i\mathbf{G} \cdot \mathbf{x}}
    \int_{\Omega_\mathrm{BZ}}
    \tilde f(\mathbf{G}+\bomega)
        e^{+i\bomega \cdot \mathbf{x}}\,\d^3 \omega
    =

    =
    \sum_{\mathbf{G}} \tilde f(\mathbf{G}) e^{+i\mathbf{G} \cdot \mathbf{x}}
    \int_{\Omega_\mathrm{BZ}}
    \delta(\boldsymbol\omega)
        e^{+i\boldsymbol\omega \cdot \mathbf{x}}\,d^3 \omega
    =

    =
    \sum_{\mathbf{G}} \tilde f(\mathbf{G}) e^{+i\mathbf{G} \cdot \mathbf{x}}"/></p>
</div><p>where we used the fact that:</p>
<div class="math">
<p><img src="../_images/math/feae350934a368e0752681a16d02333996adf3bf.png" alt="{N_\mathrm{cell}\over\Omega_\mathrm{BZ}}\tilde f(\mathbf{G}+\boldsymbol\omega)
=\tilde f(\mathbf{G})\delta(\boldsymbol\omega) \,."/></p>
</div><p>Alternatively, if one is only interested to show that the inverse
transformation works, one can directly substitute the direct formula
<a href="#equation-fourier2b">(4)</a> into <a href="#equation-fourier2b_inv">(5)</a> as follows:</p>
<div class="math">
<p><img src="../_images/math/680a061bf5dadb822706f4f22f931e3a3925e337.png" alt="F^{-1}[\tilde f(\mathbf{G})] = \sum_{\mathbf{G}}
    \tilde f(\mathbf{G}) e^{+i\mathbf{G} \cdot \mathbf{x}} =

= \sum_{\mathbf{G}}
    \left({1\over\Omega_\mathrm{cell}} \int_{\Omega_\mathrm{cell}}
    f(\mathbf{x'})
    e^{-i\mathbf{G} \cdot \mathbf{x'}}\,d^3 x'\right)
    e^{+i\mathbf{G} \cdot \mathbf{x}} =

= {1\over\Omega_\mathrm{cell}} \int_{\Omega_\mathrm{cell}} f(\mathbf{x'})
    \sum_{\mathbf{G}} e^{i\mathbf{G}
     \cdot (\mathbf{x}-\mathbf{x'})}\,d^3 x' =

= {1\over\Omega_\mathrm{cell}} \int_{\Omega_\mathrm{cell}} f(\mathbf{x'})
    (2\pi)^3
    \delta\left({(2\pi)^3\over\Omega_\mathrm{cell}}
        (\mathbf{x}-\mathbf{x'})\right) \,d^3 x' =

= {1\over\Omega_\mathrm{cell}} \int_{\Omega_\mathrm{cell}} f(\mathbf{x'})
    (2\pi)^3 {\Omega_\mathrm{cell}\over (2\pi)^3}
    \delta(\mathbf{x}-\mathbf{x'}) \,d^3 x' =

=f(\mathbf{x})\,,"/></p>
</div><p>where we used the fact that:</p>
<div class="math">
<p><img src="../_images/math/f95e140c68ba3b5a9cd37416661c0965e5de67bb.png" alt="\sum_{n=-\infty}^\infty e^{inx} = 2\pi\delta(x)\,."/></p>
</div><p>Thus we have shown that <img class="math" src="../_images/math/096ef7faa82ab2fce9f269e4e625fd7f8dced3ce.png" alt="F^{-1}[\tilde f(\mathbf{G})] = f(\mathbf{x})"/>.</p>
<div class="section" id="one-dimension-fourier-series">
<h2>One Dimension (Fourier Series)<a class="headerlink" href="#one-dimension-fourier-series" title="Permalink to this headline">¶</a></h2>
<p>In one dimension with a periodic function <img class="math" src="../_images/math/c07f2792470f5cc757767d0ef7585533665f3276.png" alt="f(x+L)=f(x)"/>,
the volume of a unit cell is <img class="math" src="../_images/math/5883634311503d62c53079edc560e3ef81a14910.png" alt="\Omega_\mathrm{cell}=L"/>
and the reciprocal space vectors <img class="math" src="../_images/math/6e28ce12d49d39f160d5a0ef54077fc98e4b9d2b.png" alt="G"/> are defined using
<img class="math" src="../_images/math/a5296d39bc0b0abfa0a875f4b2a865ddf9ce7a4b.png" alt="e^{iGL}=1"/> from which <img class="math" src="../_images/math/91caf48ac43dfb3a5e11db79a931705309181128.png" alt="G_k = {2\pi\over L} k"/>.
The equation <a href="#equation-fourier2b">(4)</a> then becomes:</p>
<div class="math" id="equation-fourier2b_1d">
<p><span class="eqno">(6)</span><img src="../_images/math/e82fdf5867cecce4b739b2ec87d630cdddccf742.png" alt="F[f(x)] \equiv \tilde f(G_k) \equiv c_k
    = {1\over L} \int_{-{L\over2}}^{L\over2} f(x)
    e^{-i G_k x}\,\d x
    = {1\over L} \int_{-{L\over2}}^{L\over2} f(x)
    e^{-i(2\pi k x/L)}\,\d x"/></p>
</div><p>This is exactly the definition of a Fourier series (<img class="math" src="../_images/math/3bd87559f4e4c9af40246a0fdbafe6feab507414.png" alt="c_k"/> are the Fourier
coefficients). The inverse transform follows from <a href="#equation-fourier2b_inv">(5)</a>:</p>
<div class="math" id="equation-fourier2b_1d_inv">
<p><span class="eqno">(7)</span><img src="../_images/math/00466c51c884eff8e20249205ec08488313281f1.png" alt="f(x) = \sum_{k=-\infty}^\infty \tilde f(G_k) e^{i G_k x}
    = \sum_{k=-\infty}^\infty c_k e^{i(2\pi kx/L)}"/></p>
</div></div>
</div>
<div class="section" id="discrete-fourier-transform">
<h1>Discrete Fourier Transform<a class="headerlink" href="#discrete-fourier-transform" title="Permalink to this headline">¶</a></h1>
<p>In the discrete case, we only have a finite
number <img class="math" src="../_images/math/fc97ef67268cd4e91bacdf12b8901d7036c9a056.png" alt="N"/> of reciprocal points:</p>
<div class="math">
<p><img src="../_images/math/848d9d361c09bff72a0eabc9442ca6e29f55fb6b.png" alt="k=0, 1, \dots, N/2-1, -N/2, -N/2+1, \dots, -1 \quad\mbox{if $N$ is even}

k=0, 1, \dots, (N-1)/2, -(N-1)/2, -(N-1)/2+1, \dots, -1 \quad\mbox{if $N$ is odd}"/></p>
</div><p>E.g. for:</p>
<div class="math">
<p><img src="../_images/math/629ad56cea884d661b312137bf0ce7dc0c63fbbe.png" alt="N=8 \quad \mbox{we get} \quad k=0, 1, 2, 3, -4, -3, -2, -1

N=9 \quad \mbox{we get} \quad k=0, 1, 2, 3, 4, -4, -3, -2, -1"/></p>
</div><p>The real space function <img class="math" src="../_images/math/c96dd6ec1dc4ad7520fbdc78fcdbec9edd068d0c.png" alt="f(x)"/> is sampled at points <img class="math" src="../_images/math/173a8b9a8b7af48f153fa5eef0aa0534d51a1b2a.png" alt="x_n={L\over N}n"/> for
<img class="math" src="../_images/math/6b5569bde634dd283ce1bd02f8cea61a6df55da1.png" alt="n=-N/2,\dots,N/2-1"/> and the equation <a href="#equation-fourier2b_1d">(6)</a> becomes:</p>
<div class="math">
<p><img src="../_images/math/df90794583716e6e7642056738d13ba1dd64f77d.png" alt="c_k
    = {1\over L} \int_{-{L\over2}}^{L\over2} f(x)
    e^{-i(2\pi k x/L)}\,\d x =

    = \lim_{N\to\infty}
    {1\over L}\sum_{n=-N/2}^{N/2-1}
    f(x_n)
    e^{-i(2\pi k x_n/L)}\,{L\over N} =

    = \lim_{N\to\infty}
    {1\over N}\sum_{n=-N/2}^{N/2-1}
    f(x_n)
    e^{-2\pi i {k\over N} n}"/></p>
</div><p>The equation <a href="#equation-fourier2b_1d_inv">(7)</a> becomes:</p>
<div class="math">
<p><img src="../_images/math/f4a50e44d8358b38a1c994c1ea2d7c0ca97d2457.png" alt="f(x_n) = \sum_{k=-\infty}^\infty c_k e^{i(2\pi kx_n/L)} =

    = \lim_{N\to\infty}
    \sum_{k=-N/2}^{N/2-1} c_k e^{i(2\pi kx_n/L)} =

    = \lim_{N\to\infty}
    \sum_{k=-N/2}^{N/2-1} c_k e^{2\pi i {k\over N} n}"/></p>
</div><p>Using the fact</p>
<div class="math">
<p><img src="../_images/math/33c6c1e2f49f8a7200ea72503e42a360ae3a3027.png" alt="x_n + L = {L\over N}n + L = {L\over N}(n + N) = x_{n+N}\,,"/></p>
</div><p>we can express the periodicity <img class="math" src="../_images/math/a0638517509cde5b988047fab5624c6e1e0cd1e4.png" alt="f(x_n+L)=f(x_n)"/> as <img class="math" src="../_images/math/fc2a2f467e26c4d293145abf40e2cfe9ef5364c7.png" alt="f(x_{n+N})=f(x_n)"/>. The
sums can then be rearranged:</p>
<div class="math">
<p><img src="../_images/math/b6b6b5e71a95a0031d2beb5845408c3d1c75af80.png" alt="c_k
    = \lim_{N\to\infty}
    {1\over N}\sum_{n=-N/2}^{N/2-1}
    f(x_n)
    e^{-2\pi i {k\over N} n} =

    = \lim_{N\to\infty} {1\over N} \left(
    \sum_{n=-N/2}^{-1}
    f(x_n)
    e^{-2\pi i {k\over N} n}
        +
    \sum_{n=0}^{N/2-1}
    f(x_n)
    e^{-2\pi i {k\over N} n} \right) =

    = \lim_{N\to\infty} {1\over N} \left(
    \sum_{n=N/2}^{N-1}
    f(x_{n-N})
    e^{-2\pi i {k\over N} (n-N)}
        +
    \sum_{n=0}^{N/2-1}
    f(x_n)
    e^{-2\pi i {k\over N} n} \right) =

    = \lim_{N\to\infty} {1\over N}
    \sum_{n=0}^{N-1} f(x_n) e^{-2\pi i {k\over N} n}"/></p>
</div><p>and if we drop the limit and consider a finite <img class="math" src="../_images/math/fc97ef67268cd4e91bacdf12b8901d7036c9a056.png" alt="N"/> only:</p>
<div class="math">
<p><img src="../_images/math/eccc97bac175c48a835fa8a4db27ce92596f0bcd.png" alt="f(x_n)
    = \sum_{k=-N/2}^{N/2-1} c_k e^{2\pi i {k\over N} n} =

    = \left(
    \sum_{k=-N/2}^{-1} c_k e^{2\pi i {k\over N} n}
    +
    \sum_{k=0}^{N/2-1} c_k e^{2\pi i {k\over N} n}
    \right) =

    = \left(
    \sum_{k=N/2}^{N-1} c_{k-N} e^{2\pi i {(k-N)\over N} n}
    +
    \sum_{k=0}^{N/2-1} c_k e^{2\pi i {k\over N} n}
    \right) =

    = \sum_{k=0}^{N-1} c_k e^{2\pi i {k\over N} n}"/></p>
</div><p>Summary, the direct transform:</p>
<div class="math" id="equation-dft">
<p><span class="eqno">(8)</span><img src="../_images/math/f7b1656063139d37df79227d807e2a9f355c941d.png" alt="c_k
    = {1\over N} \sum_{n=0}^{N-1} f(x_n) e^{-2\pi i {k\over N} n}"/></p>
</div><p>and inverse transform:</p>
<div class="math" id="equation-idft">
<p><span class="eqno">(9)</span><img src="../_images/math/835b270923781b5ac60d13aab058abfb1429a283.png" alt="f(x_n)
    = \sum_{k=0}^{N-1} c_k e^{2\pi i {k\over N} n}\,,"/></p>
</div><p>with <img class="math" src="../_images/math/173a8b9a8b7af48f153fa5eef0aa0534d51a1b2a.png" alt="x_n={L\over N}n"/>. In the limit <img class="math" src="../_images/math/f296b863454e7f6b2fd20ff63cab1fff689db3d1.png" alt="N\to\infty"/>, the equation <a href="#equation-dft">(8)</a>
becomes <a href="#equation-fourier2b_1d">(6)</a> and equation <a href="#equation-idft">(9)</a> becomes
<a href="#equation-fourier2b_1d_inv">(7)</a> and as we increase <img class="math" src="../_images/math/fc97ef67268cd4e91bacdf12b8901d7036c9a056.png" alt="N"/>, the discrete Fourier
transform numerically converges towards the Fourier series results.</p>
<p>The <img class="math" src="../_images/math/788e13fd256ea8c4554d7b13d017b2b514638fdc.png" alt="{1\over N}"/> factor is sometimes moved from the direct to the inverse
transform, but then the correspondence with Fourier series is broken (one has
to divide and multiply by <img class="math" src="../_images/math/fc97ef67268cd4e91bacdf12b8901d7036c9a056.png" alt="N"/> appropriately to recover it).</p>
</div>
<div class="section" id="fast-fourier-transform-fft">
<h1>Fast Fourier Transform (FFT)<a class="headerlink" href="#fast-fourier-transform-fft" title="Permalink to this headline">¶</a></h1>
<p>We write the discrete Fourier transform <a href="#equation-dft">(8)</a> using a notation more commonly
used for FFTs:</p>
<div class="math">
<p><img src="../_images/math/4f6233b578704b6685d646e5664167fed8539951.png" alt="X(k) = \sum_{n=0}^{N-1} x(n) W_N^{kn}"/></p>
</div><p>where:</p>
<div class="math">
<p><img src="../_images/math/59e19e3e5b04cc3683febe481557c473338d4f82.png" alt="W_N = e^{-2\pi i / N}"/></p>
</div><p>Similarly, the inverse discrete Fourier transform <a href="#equation-idft">(9)</a> becomes:</p>
<div class="math">
<p><img src="../_images/math/c6720f4aa318c671a63540fc298eb9e268000680.png" alt="x(n) = {1\over N} \sum_{k=0}^{N-1} X(k) W_N^{-kn}"/></p>
</div><div class="section" id="decimation-in-frequency-dif">
<h2>Decimation In Frequency (DIF)<a class="headerlink" href="#decimation-in-frequency-dif" title="Permalink to this headline">¶</a></h2>
<p>We start with radix-4:</p>
<div class="math">
<p><img src="../_images/math/4201b48211ac7a663e39b2d85feeaf1bb8b9f07f.png" alt="X(k) = \sum_{n=0}^{N-1} x(n) W_N^{kn} =

=\sum_{n=0}^{{N\over4}-1} x(n) W_N^{kn}
+\sum_{n={N\over4}}^{{2N\over4}-1} x(n) W_N^{kn}
+\sum_{n={2N\over4}}^{{3N\over4}-1} x(n) W_N^{kn}
+\sum_{n={3N\over4}}^{{4N\over4}-1} x(n) W_N^{kn} =

=\sum_{n=0}^{{N\over4}-1} \left[ x(n) W_N^{kn}
+x\left(n+{N\over4}\right) W_N^{k\left(n+{N\over4}\right)}
+x\left(n+{2N\over4}\right) W_N^{k\left(n+{2N\over4}\right)}
+x\left(n+{3N\over4}\right) W_N^{k\left(n+{3N\over4}\right)}
\right] =

=\sum_{n=0}^{{N\over4}-1} \left[ x(n)
+x\left(n+{N\over4}\right) W_N^{kN\over4}
+x\left(n+{2N\over4}\right) W_N^{2kN\over4}
+x\left(n+{3N\over4}\right) W_N^{3kN\over4}
\right] W_N^{kn} =

=\sum_{n=0}^{{N\over4}-1} \left[ x(n)
+x\left(n+{N\over4}\right) (-i)^k
+x\left(n+{2N\over4}\right) (-1)^k
+x\left(n+{3N\over4}\right) i^k
\right] W_N^{kn}"/></p>
</div><p>Now we subdivide the <img class="math" src="../_images/math/872459c9d9d954338e76df9ad1e93e015ca1b025.png" alt="X(k)"/> sequence into 4 subsequences:</p>
<div class="math">
<p><img src="../_images/math/3f0dada4b9028a13d0fabe370502b97be95bc444.png" alt="X(4k) = \sum_{n=0}^{{N\over4}-1} \left[ x(n)
+x\left(n+{N\over4}\right) (-i)^{4k}
+x\left(n+{2N\over4}\right) (-1)^{4k}
+x\left(n+{3N\over4}\right) i^{4k}
\right] W_N^{4kn} =

= \sum_{n=0}^{{N\over4}-1} \left[ x(n)
+x\left(n+{N\over4}\right)
+x\left(n+{2N\over4}\right)
+x\left(n+{3N\over4}\right)
\right] W_{N\over4}^{kn}"/></p>
</div><p>Similarly:</p>
<div class="math">
<p><img src="../_images/math/c9bb67e5428d7e0abb7aac370ffc096e204c346f.png" alt="X(4k+1) = \sum_{n=0}^{{N\over4}-1} \left[ x(n)
-i x\left(n+{N\over4}\right)
-x\left(n+{2N\over4}\right)
+i x\left(n+{3N\over4}\right)
\right] W_N^{n} W_{N\over4}^{kn}

X(4k+2) = \sum_{n=0}^{{N\over4}-1} \left[ x(n)
-x\left(n+{N\over4}\right)
+x\left(n+{2N\over4}\right)
-x\left(n+{3N\over4}\right)
\right] W_N^{2n} W_{N\over4}^{kn}

X(4k+3) = \sum_{n=0}^{{N\over4}-1} \left[ x(n)
+i x\left(n+{N\over4}\right)
-x\left(n+{2N\over4}\right)
-i x\left(n+{3N\over4}\right)
\right] W_N^{3n} W_{N\over4}^{kn}"/></p>
</div><p>This has a form of a DFT of length <img class="math" src="../_images/math/316166a234f53d567aedc134b91517dd75c64477.png" alt="{N\over4}"/>:</p>
<div class="math">
<p><img src="../_images/math/6428133c879d35b9d227b8b4fa8f7887726339f7.png" alt="X(4k) = \sum_{n=0}^{{N\over4}-1} F_0(n) W_{N\over4}^{kn}

X(4k+1) = \sum_{n=0}^{{N\over4}-1} F_1(n) W_{N\over4}^{kn}

X(4k+2) = \sum_{n=0}^{{N\over4}-1} F_2(n) W_{N\over4}^{kn}

X(4k+3) = \sum_{n=0}^{{N\over4}-1} F_3(n) W_{N\over4}^{kn}"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/5c94eb734e55b799bdc77e9bf9fb22ef1809d7a1.png" alt="\begin{pmatrix}
F_0(n) \\
F_1(n) \\
F_2(n) \\
F_3(n) \\
\end{pmatrix} =
\begin{pmatrix}
x(n)
+x\left(n+{N\over4}\right)
+x\left(n+{2N\over4}\right)
+x\left(n+{3N\over4}\right) \\
x(n)
-i x\left(n+{N\over4}\right)
-x\left(n+{2N\over4}\right)
+i x\left(n+{3N\over4}\right) \\
x(n)
-x\left(n+{N\over4}\right)
+x\left(n+{2N\over4}\right)
-x\left(n+{3N\over4}\right) \\
x(n)
+i x\left(n+{N\over4}\right)
-x\left(n+{2N\over4}\right)
-i x\left(n+{3N\over4}\right)
\end{pmatrix} =

=\begin{pmatrix}
1 &amp;  1 &amp;  1 &amp;  1 \\
1 &amp; -i &amp; -1 &amp;  i \\
1 &amp; -1 &amp;  1 &amp; -1 \\
1 &amp;  i &amp; -1 &amp; -i
\end{pmatrix}
\begin{pmatrix}
x(n) \\
x\left(n+{N\over4}\right) \\
x\left(n+{2N\over4}\right) \\
x\left(n+{3N\over4}\right)
\end{pmatrix}"/></p>
</div><p>This coefficient matrix for various radix-n schemes can be generated by:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">pprint</span><span class="p">,</span> <span class="n">Matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="o">/</span><span class="n">n</span><span class="p">))</span>
<span class="go">[1  1]</span>
<span class="go">[1 -1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">j</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="p">))</span>
<span class="go">[1,              1,              1]</span>
<span class="go">[1, exp(-2*I*pi/3), exp(-4*I*pi/3)]</span>
<span class="go">[1, exp(-4*I*pi/3), exp(-2*I*pi/3)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="o">/</span><span class="n">n</span><span class="p">))</span>
<span class="go">[1  1  1  1]</span>
<span class="go">[1 -I -1  I]</span>
<span class="go">[1 -1  1 -1]</span>
<span class="go">[1  I -1 -I]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">j</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="p">))</span>
<span class="go">[1,              1,              1,              1,              1]</span>
<span class="go">[1, exp(-2*I*pi/5), exp(-4*I*pi/5), exp(-6*I*pi/5), exp(-8*I*pi/5)]</span>
<span class="go">[1, exp(-4*I*pi/5), exp(-8*I*pi/5), exp(-2*I*pi/5), exp(-6*I*pi/5)]</span>
<span class="go">[1, exp(-6*I*pi/5), exp(-2*I*pi/5), exp(-8*I*pi/5), exp(-4*I*pi/5)]</span>
<span class="go">[1, exp(-8*I*pi/5), exp(-6*I*pi/5), exp(-4*I*pi/5), exp(-2*I*pi/5)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">j</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="p">))</span>
<span class="go">[1,              1,  1,              1,  1,              1,  1,              1]</span>
<span class="go">[1,   exp(-I*pi/4), -I, exp(-3*I*pi/4), -1, exp(-5*I*pi/4),  I, exp(-7*I*pi/4)]</span>
<span class="go">[1,             -I, -1,              I,  1,             -I, -1,              I]</span>
<span class="go">[1, exp(-3*I*pi/4),  I,   exp(-I*pi/4), -1, exp(-7*I*pi/4), -I, exp(-5*I*pi/4)]</span>
<span class="go">[1,             -1,  1,             -1,  1,             -1,  1,             -1]</span>
<span class="go">[1, exp(-5*I*pi/4), -I, exp(-7*I*pi/4), -1,   exp(-I*pi/4),  I, exp(-3*I*pi/4)]</span>
<span class="go">[1,              I, -1,             -I,  1,              I, -1,             -I]</span>
<span class="go">[1, exp(-7*I*pi/4),  I, exp(-5*I*pi/4), -1, exp(-3*I*pi/4), -I,   exp(-I*pi/4)]</span>
</pre></div>
</div>
<p>One then recursively solves the smaller problems. This approach is used for
example in FFTPACK. There are also other approaches how to decompose the DFT,
used in various other libraries.</p>
</div>
</div>
<div class="section" id="laplace-transform">
<h1>Laplace Transform<a class="headerlink" href="#laplace-transform" title="Permalink to this headline">¶</a></h1>
<p>Laplace transform of <img class="math" src="../_images/math/c96dd6ec1dc4ad7520fbdc78fcdbec9edd068d0c.png" alt="f(x)"/> is:</p>
<div class="math">
<p><img src="../_images/math/8939823ab6133af32f1845a2d1adef453446dcd2.png" alt="L[f(x)] = \int_0^{\infty} f(x) e^{-s x}\,\d x

L^{-1}[\bar f(s)]
= {1\over2\pi i}\int_{\sigma-i\infty}^{\sigma+i\infty}
    \bar f(s) e^{s x}\,\d s
= \sum_{s_0} \res_{s=s_0} (\bar f(s) e^{s x})"/></p>
</div><p>The contour integration is over the vertical line <img class="math" src="../_images/math/267f5facc7e76cd98b5358ab98ee1f92466c67cf.png" alt="\sigma+i\omega"/> and <img class="math" src="../_images/math/fa35d9fc104207e09a712110ac81612c5b279a6c.png" alt="\sigma"/>
is chosen large enough so that all residues are to the left of the line (that&#8217;s
because the Laplace transform <img class="math" src="../_images/math/2cce8230f9ec14f8577ec5112a360c68d550969d.png" alt="\bar f(s)"/> is only defined for <img class="math" src="../_images/math/f37bba504894945c07a32f5496d74299a37aa51c.png" alt="s"/> larger than
the residues, so we have to integrate in this range as well).  It can be shown
that the integral over the left semicircle goes to zero:</p>
<div class="math">
<p><img src="../_images/math/4a8097935cc530eeef3a35998c76507853f9e7c9.png" alt="\left|\int_\Omega e^{sx}g(s) \d s \right|
=\left|\int_{\pi\over2}^{3\pi\over2} e^{(\sigma + Re^{i\varphi})x}
g(\sigma+Re^{i\varphi})iRe^{i\varphi}\d\varphi\right|
\le

\le R \max_\Omega |g(z)| e^{\sigma x}
    \int_{\pi\over2}^{3\pi\over2}\left| e^{xRe^{i\varphi}}
    \right|\d\varphi
=

= R \max_\Omega |g(z)| e^{\sigma x}
    \int_{\pi\over2}^{3\pi\over2}e^{xR \cos \varphi} \d\varphi
=

= R \max_\Omega |g(z)| e^{\sigma x}
    \int_0^{\pi}e^{-xR \sin \varphi} \d\varphi
=

&lt; {\pi e^{\sigma x}\over x} \max_\Omega |g(z)|"/></p>
</div><p>so the complex integral is equal to the sum of all residues of <img class="math" src="../_images/math/f86714ee986f85607ef56c935a30f8290860a757.png" alt="\bar
f(s)e^{sx}"/> in the complex plane.</p>
<p>To show that it works:</p>
<div class="math">
<p><img src="../_images/math/e35a8957cafe2ab1c2039d94f29c8fd06596c54f.png" alt="L^{-1} L [f(x)]
=
{1\over2\pi i}\int_{\sigma-i\infty}^{\sigma+i\infty}
    \left[\int_0^{\infty}
    f(x) e^{-s x}\,\d x\right] e^{s x}\,\d s
=
{1\over2\pi i}\int_{\sigma-i\infty}^{\sigma+i\infty}
    \left[\int_0^{\infty}
    f(x') e^{-s x'}\,\d x'\right] e^{s x}\,\d s
=

=
\int_0^{\infty} f(x') \left[{1\over2\pi i}
    \int_{\sigma-i\infty}^{\sigma+i\infty}
    e^{s (x- x')}\,\d s \right] \,\d x'
=
\int_0^{\infty} f(x') \delta(x-x') \,\d x'
=f(x)"/></p>
</div><p>where we used:</p>
<div class="math">
<p><img src="../_images/math/f002cb90e9caa541a6d4b9ace65944eb782e77a8.png" alt="{1\over2\pi i}
\int_{\sigma-i\infty}^{\sigma+i\infty} e^{s (x- x')}\,\d s
=
{1\over2\pi i}
    \int_{\sigma-i\infty}^{\sigma+i\infty} e^{s (x- x')}\,\d s
=
{1\over2\pi i}
    \int_{-\infty}^{\infty} e^{(\sigma+i\omega) (x- x')}\,i\d \omega
=

=
{e^{\sigma (x- x')}\over2\pi}
    \int_{-\infty}^{\infty} e^{i\omega (x- x')}\,\d \omega
= e^{\sigma (x- x')}\delta(x - x')
=\delta(x - x')"/></p>
</div><p>and it can be derived from the Fourier transform by
transforming a function <img class="math" src="../_images/math/073f69367cee601cff7c1b8684c1453c6dd75e27.png" alt="U(x)"/>:</p>
<div class="math">
<p><img src="../_images/math/5f197daf6c9926eae698592b2172aa92b08eadf5.png" alt="U(x) = \begin{cases}
    f(x)e^{-\sigma x} &amp;\text{for $x\ge0$}\cr
    0 &amp;\text{for $x&lt;0$}\cr
    \end{cases}"/></p>
</div><p>and making a substitution <img class="math" src="../_images/math/ac15f719720433a411b0e6bfd7208e95958f2a6e.png" alt="s = \sigma + i\omega"/>:</p>
<div class="math">
<p><img src="../_images/math/2be27d3ddb29bec572de95bb7e366faad0dc3748.png" alt="L[f(x)] \equiv \bar f(s) = F[U(x)] \equiv \tilde U(\omega)
= \int_{-\infty}^{\infty} U(x) e^{-i\omega x}\,\d x
= \int_0^{\infty} f(x) e^{-\sigma x} e^{-i\omega x}\,\d x
= \int_0^{\infty} f(x) e^{-s x}\,\d x

L^{-1}[\bar f(s)] \equiv f(x) = U(x) e^{\sigma x}
= F^{-1}[\tilde U(\omega)]e^{\sigma x}
= F^{-1}[\bar f(s)]e^{\sigma x}
= F^{-1}[\bar f(\sigma+i\omega)e^{\sigma x}]

= {1\over2\pi}\int_{-\infty}^{\infty} \bar f(\sigma + i\omega)e^{\sigma x}
    e^{i\omega x}\,\d \omega
= {1\over2\pi i}\int_{\sigma-i\infty}^{\sigma+i\infty}
    \bar f(s) e^{s x}\,\d s
= \sum_{s_0} \res_{s=s_0} (\bar f(s) e^{s x})"/></p>
</div><p>Where the bar (<img class="math" src="../_images/math/d30f27428b5089654561a4103e3ebfccf9e39895.png" alt="\bar f"/>) means the Laplace transform and tilde (<img class="math" src="../_images/math/9fad7e35d3630d54c16f6dc9ce146031cad37dfd.png" alt="\tilde U"/>)
means the Fourier transform.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Fourier Transform</a><ul>
<li><a class="reference internal" href="#shift-theorem">Shift Theorem</a></li>
<li><a class="reference internal" href="#derivative">Derivative</a></li>
<li><a class="reference internal" href="#radial-fourier-transform">Radial Fourier Transform</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fourier-transform-of-a-periodic-function-e-g-in-a-crystal">Fourier Transform of a Periodic Function (e.g. in a Crystal)</a><ul>
<li><a class="reference internal" href="#one-dimension-fourier-series">One Dimension (Fourier Series)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#discrete-fourier-transform">Discrete Fourier Transform</a></li>
<li><a class="reference internal" href="#fast-fourier-transform-fft">Fast Fourier Transform (FFT)</a><ul>
<li><a class="reference internal" href="#decimation-in-frequency-dif">Decimation In Frequency (DIF)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#laplace-transform">Laplace Transform</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="residue.html"
                        title="previous chapter">Residue Theorem</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="trig.html"
                        title="next chapter">Periodic Functions</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/math/transforms.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="trig.html" title="Periodic Functions"
             >next</a> |</li>
        <li class="right" >
          <a href="residue.html" title="Residue Theorem"
             >previous</a> |</li>
        <li><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &raquo;</li>
          <li><a href="main.html" >Mathematics</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b3.
    </div>
  </body>
</html>