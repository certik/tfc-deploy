
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>3.2. Complex Numbers &#8212; Theoretical Physics Reference 0.5 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.3. Residue Theorem" href="residue.html" />
    <link rel="prev" title="3.1. Integration" href="integration.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head><body>
    <div style="display:none">
    \(
        \newcommand{\d}{\mathrm{d}}
        \newcommand{\bomega}{\vec\omega}
        \newcommand{\half}{ {1\over 2} }
        \def\mathnot#1{\text{"$#1$"}}

        %operators
        \newcommand{\diag}{\mathrm{diag}}
        \newcommand{\sinc}{\mathrm{sinc}}
        \newcommand{\Sh}{ {\large\style{font-family:Times}{\text{Ш}}} }
        \newcommand{\res}{\mathrm{Res}}
    \)
    </div>
    

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="residue.html" title="3.3. Residue Theorem"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="integration.html" title="3.1. Integration"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" accesskey="U">3. Mathematics</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="complex-numbers">
<span id="index-0"></span><h1>3.2. Complex Numbers<a class="headerlink" href="#complex-numbers" title="Permalink to this headline">¶</a></h1>
<p>We start by defining <span class="math notranslate nohighlight">\(\arg(z)\)</span> by its principal value, then everything else
follows from this definition.  We could have also used any other branch, but
then most results in this chapter would need to be updated with the new
convention.</p>
<p>Then we define exponential, logarithm, power and so on using simple natural
formulas. From these definitions, everything else follows using a very simple
algebra manipulation, all the “messy” features are hidden in the definition and
properties of the real <span class="math notranslate nohighlight">\(\atan2\)</span> function. In the derivation of each formula,
only formulas introduced before (above) are used.</p>
<p>Every formula in this chapter holds for all complex numbers, unless explicitly
specified otherwise.</p>
<div class="section" id="real-and-imaginary-part">
<h2>3.2.1. Real and Imaginary Part<a class="headerlink" href="#real-and-imaginary-part" title="Permalink to this headline">¶</a></h2>
<p>A complex number <span class="math notranslate nohighlight">\(z\)</span> can be written using its real and imaginary parts:</p>
<div class="math notranslate nohighlight">
\[z = \Re z + i \Im z\]</div>
<p>The absolute value <span class="math notranslate nohighlight">\(|z|\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[|z| = \sqrt{\Re^2 z + \Im^2 z}\]</div>
</div>
<div class="section" id="argument-function">
<h2>3.2.2. Argument Function<a class="headerlink" href="#argument-function" title="Permalink to this headline">¶</a></h2>
<p>Principal value of <span class="math notranslate nohighlight">\(\arg(z)\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\arg z = \atan2(\Im z, \Re z)\]</div>
<p>Thus we have <span class="math notranslate nohighlight">\(-\pi &lt; \arg z \le \pi\)</span>. All operations with <span class="math notranslate nohighlight">\(\arg z\)</span> are then
derived using the properties of the real <span class="math notranslate nohighlight">\(\atan2\)</span> function.</p>
</div>
<div class="section" id="exponential">
<h2>3.2.3. Exponential<a class="headerlink" href="#exponential" title="Permalink to this headline">¶</a></h2>
<p>Exponential is defined using:</p>
<div class="math notranslate nohighlight">
\[e^z = e^{\Re z + i\Im z} = e^{\Re z} (\cos\Im z + i \sin \Im z)\]</div>
<p>It follows:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}e^{a+b}
    = e^{\Re(a+b)} (\cos\Im(a+b) + i \sin \Im(a+b)) =\\    = e^{\Re a}e^{\Re b} \left(
        \cos(\Im a)\cos(\Im b) - \sin(\Im a)\sin(\Im b)
        + i \sin(\Im a)\cos(\Im b) + i\cos(\Im a) \sin(\Im b)\right) =\\    = e^{\Re a} (\cos\Im a + i \sin \Im a)
      e^{\Re b} (\cos\Im b + i \sin \Im b) =\\    = e^a e^b\end{aligned}\end{align} \]</div>
<p>Any complex number can be written in a polar form as follows:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}z = \Re z + i \Im z = |z| \left( {\Re z \over |z|} + i {\Im z\over
    |z|}\right) =\\= |z| \left( {\Re z \over\sqrt{\Re^2 z + \Im^2 z}}
    + i {\Im z\over\sqrt{\Re^2 z + \Im^2 z}}\right) =\\= |z| \left(\cos\atan2(\Im z, \Re z) + i \sin\atan2(\Im z, \Re z)\right) =\\= |z| \left(\cos\arg z + i \sin\arg z\right) =\\= |z| e^{i\arg z}\end{aligned}\end{align} \]</div>
<p>The following formula holds:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\arg e^z = \arg e^{\Re z} e^{i\Im z} = \arg e^{i\Im z} =\\    = \arg(\cos\Im z + i\sin\Im z) =\\    = \atan2(\sin\Im z, \cos\Im z) =\\    = \Im z + 2\pi \left\lfloor \pi-\Im z \over 2\pi \right\rfloor\end{aligned}\end{align} \]</div>
<p>and also:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\arg ab
    = \arg(|a| e^{i\arg a} |b| e^{i\arg b}) =\\    = \arg(|a| |b| e^{i(\arg a+\arg b)}) =\\    = \arg(e^{i(\arg a+\arg b)}) =\\    = \arg(\cos(\arg a+\arg b) + i\sin(\arg a + \arg b)) =\\    = \atan2(\sin(\arg a+\arg b), \cos(\arg a + \arg b)) =\\    = \arg a + \arg b + 2\pi
        \left\lfloor \pi-\arg a-\arg b\over 2\pi \right\rfloor\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\arg {1\over z} = -\arg z + 2\pi
        \left\lfloor \pi+\arg z\over 2\pi \right\rfloor\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\arg {a\over b}
    = \arg\left(|a| e^{i\arg a} \left|{1\over b}\right| e^{i\arg {1\over
        b}}\right) =\\    = \arg\left(|a| \left|{1\over b}\right| e^{i(\arg a-\arg b)
        +2\pi i \left\lfloor \pi+\arg b\over 2\pi \right\rfloor }\right) =\\    = \arg(e^{i(\arg a-\arg b)}) =\\    = \arg(\cos(\arg a-\arg b) + i\sin(\arg a - \arg b)) =\\    = \atan2(\sin(\arg a-\arg b), \cos(\arg a - \arg b)) =\\    = \arg a - \arg b + 2\pi
        \left\lfloor \pi-\arg a+\arg b\over 2\pi \right\rfloor\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="logarithm">
<h2>3.2.4. Logarithm<a class="headerlink" href="#logarithm" title="Permalink to this headline">¶</a></h2>
<p>The logarithm is defined as:</p>
<div class="math notranslate nohighlight" id="equation-def-log">
<span class="eqno">(3.2.4.1)<a class="headerlink" href="#equation-def-log" title="Permalink to this equation">¶</a></span>\[\log z = \log|z| + i \arg z\]</div>
<p>The motivation is from the following formula:</p>
<div class="math notranslate nohighlight">
\[z = |z| e^{i\arg z} = e^{\log |z|} e^{i\arg z} = e^{\log|z| + i \arg z}\]</div>
<p>which using our definition becomes:</p>
<div class="math notranslate nohighlight" id="equation-elog">
<span class="eqno">(3.2.4.2)<a class="headerlink" href="#equation-elog" title="Permalink to this equation">¶</a></span>\[z = e^{\log|z| + i \arg z} = e^{\log z}\]</div>
<p>so a logarithm is an inverse function to an exponential. The formula <a class="reference internal" href="#equation-elog">(3.2.4.2)</a>
would be satisfied even if we add a factor of <span class="math notranslate nohighlight">\(2\pi i n\)</span> (where <span class="math notranslate nohighlight">\(n\)</span> is an
integer) to the right hand side of <a class="reference internal" href="#equation-def-log">(3.2.4.1)</a>. However, the convention is to
define logarithm using the equation <a class="reference internal" href="#equation-def-log">(3.2.4.1)</a> exactly.</p>
<p>We can now derive a few important formulas:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\log | e^z | = \log | e^{\Re z} e^{i \Im z} | = \log | e^{\Re z} | = \Re z\\\log e^z = \log | e^z | + i \arg e^z = \Re z + i \left(
    \Im z + 2\pi \left\lfloor \pi-\Im z \over 2\pi \right\rfloor
    \right)
    = z + 2\pi i \left\lfloor \pi-\Im z \over 2\pi \right\rfloor\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-log-ab">
<span class="eqno">(3.2.4.3)<a class="headerlink" href="#equation-log-ab" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}\log ab = \log |ab| + i\arg ab =\\= \log |a| + \log |b| + i\arg a + i\arg b + 2\pi i
        \left\lfloor \pi-\arg a-\arg b \over 2\pi \right\rfloor =\\= \log a + \log b + 2\pi i
        \left\lfloor \pi-\arg a-\arg b \over 2\pi \right\rfloor\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-log-a-b">
<span class="eqno">(3.2.4.4)<a class="headerlink" href="#equation-log-a-b" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}\log {a\over b} = \log \left|{a\over b}\right| + i\arg {a\over b} =\\= \log |a| - \log |b| + i\arg a - i\arg b + 2\pi i
        \left\lfloor \pi-\arg a+\arg b \over 2\pi \right\rfloor =\\= \log a - \log b + 2\pi i
        \left\lfloor \pi-\arg a+\arg b \over 2\pi \right\rfloor\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="power">
<h2>3.2.5. Power<a class="headerlink" href="#power" title="Permalink to this headline">¶</a></h2>
<p>A power of two complex numbers is defined as:</p>
<div class="math notranslate nohighlight">
\[z^a = e^{a\log z}\]</div>
<p>From above we can also write the power <span class="math notranslate nohighlight">\(z^a\)</span> in two different ways:</p>
<div class="math notranslate nohighlight">
\[z^a = \left(e^{\log z}\right)^a = e^{\log z^a}\]</div>
<p>But these two cannot be used as a definition of a power, because both require
the knowledge of <span class="math notranslate nohighlight">\(x^a\)</span>, which we are trying to define, where <span class="math notranslate nohighlight">\(x=z\)</span> or <span class="math notranslate nohighlight">\(x=e^{\log
z}\)</span>.</p>
<p>It follows:</p>
<div class="math notranslate nohighlight" id="equation-log-x-a">
<span class="eqno">(3.2.5.1)<a class="headerlink" href="#equation-log-x-a" title="Permalink to this equation">¶</a></span>\[\log x^a = \log e^{a\log x} = a\log x
    + 2\pi i \left\lfloor \pi-\Im a\log x \over 2\pi \right\rfloor\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-x-a-b">
<span class="eqno">(3.2.5.2)<a class="headerlink" href="#equation-x-a-b" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}(x^a)^b = e^{b \log x^a} = e^{b \left(
    a\log x
    + 2\pi i \left\lfloor \pi-\Im a\log x \over 2\pi \right\rfloor
\right)} =\\= e^{a b \log x} e^{
    2\pi i b\left\lfloor \pi-\Im a\log x \over 2\pi \right\rfloor
} =\\= x^{a b} e^{
    2\pi i b\left\lfloor \pi-\Im a\log x \over 2\pi \right\rfloor
}\end{aligned}\end{align} \]</div>
<p>As a special case for <span class="math notranslate nohighlight">\(x=e\)</span> one gets:</p>
<div class="math notranslate nohighlight" id="equation-e-a-b">
<span class="eqno">(3.2.5.3)<a class="headerlink" href="#equation-e-a-b" title="Permalink to this equation">¶</a></span>\[(e^a)^b = e^{a b} e^{
    2\pi i b\left\lfloor \pi-\Im a \over 2\pi \right\rfloor
}\]</div>
<p>Similarly:</p>
<div class="math notranslate nohighlight" id="equation-xy-a">
<span class="eqno">(3.2.5.4)<a class="headerlink" href="#equation-xy-a" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}(xy)^a = e^{a\log xy}
    = e^{a\log x + a\log y + 2\pi i a
        \left\lfloor \pi-\arg x-\arg y \over 2\pi \right\rfloor
        } =\\= x^a y^a e^{2\pi i a
        \left\lfloor \pi-\arg x-\arg y \over 2\pi \right\rfloor
        }\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="examples">
<h2>3.2.6. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>For integer <span class="math notranslate nohighlight">\(n\)</span> we get from <a class="reference internal" href="#equation-x-a-b">(3.2.5.2)</a>:</p>
<div class="math notranslate nohighlight">
\[(x^a)^n
= x^{a n} e^{
    2\pi i n\left\lfloor \pi-\Im a\log x \over 2\pi \right\rfloor
} = x^{a n}\]</div>
<p>Using <a class="reference internal" href="#equation-x-a-b">(3.2.5.2)</a>:</p>
<div class="math notranslate nohighlight">
\[\sqrt{x^2} = (x^2)^{1\over 2} = x^{{1\over 2}\cdot 2}
        e^{
        2\pi i {1\over 2}
        \left\lfloor \pi-\Im 2\log x \over 2\pi \right\rfloor}
    = x e^{
        \pi i
        \left\lfloor \pi-2\arg x \over 2\pi \right\rfloor}
    = (-1)^{\left\lfloor \pi-2\arg x \over 2\pi \right\rfloor} x\]</div>
<p>Using <a class="reference internal" href="#equation-xy-a">(3.2.5.4)</a>:</p>
<div class="math notranslate nohighlight">
\[\sqrt{xy} = (xy)^{1\over2}
    = x^{1\over2} y^{1\over2} e^{2\pi i {1\over2}
            \left\lfloor \pi-\arg x-\arg y \over 2\pi \right\rfloor
            }
    = \sqrt{x} \sqrt{y}
        (-1)^{\left\lfloor \pi-\arg x-\arg y \over 2\pi \right\rfloor}\]</div>
<p>and as a special case:</p>
<div class="math notranslate nohighlight">
\[1 = \sqrt 1 = \sqrt{(-1)(-1)}
    = \sqrt{-1} \sqrt{-1}
        (-1)^{\left\lfloor \pi-\pi-\pi \over 2\pi \right\rfloor}
    = i \cdot i \cdot (-1) = 1\]</div>
<p>Using <a class="reference internal" href="#equation-e-a-b">(3.2.5.3)</a>:</p>
<div class="math notranslate nohighlight">
\[\sqrt {e^x} = (e^x)^{1\over 2} = e^{x\over 2} e^{
    \pi i\left\lfloor \pi-\Im x \over 2\pi \right\rfloor
} =
    (-1)^{\left\lfloor \pi-\Im x \over 2\pi \right\rfloor}
    e^{x\over 2}\]</div>
<p>Using <a class="reference internal" href="#equation-log-ab">(3.2.4.3)</a>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}0 = \log 1 = \log(-1)(-1) =
    \log(-1) + \log(-1) + 2\pi i
        \left\lfloor \pi-\pi-\pi \over 2\pi \right\rfloor =\\  = i\pi + i\pi + 2\pi i \left\lfloor-\half\right\rfloor
  = i\pi + i\pi - 2\pi i = 0\end{aligned}\end{align} \]</div>
<p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">floor</span><span class="p">,</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cmath</span> <span class="k">import</span> <span class="n">log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">0j</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">floor</span><span class="p">((</span><span class="n">pi</span><span class="o">-</span><span class="n">pi</span><span class="o">-</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span>
<span class="go">0j</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="math notranslate nohighlight">
\[i^i = e^{i \log i} = e^{i^2 \arg i} = e^{-{\pi\over 2}}\]</div>
<p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">1</span><span class="n">j</span><span class="o">**</span><span class="mi">1</span><span class="n">j</span>
<span class="go">(0.20787957635076193+0j)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0.20787957635076193</span>
</pre></div>
</div>
<p>Another example, using <a class="reference internal" href="#equation-log-x-a">(3.2.5.1)</a>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\log(\sqrt z)
    = \log(z^{1\over2})
    = \half \log z
    + 2\pi i \left\lfloor \pi-\Im {1\over2}\log z \over 2\pi \right\rfloor =\\= \half \log z
+ 2\pi i \left\lfloor \pi-{1\over2}\arg z \over 2\pi \right\rfloor
= \half \log z\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\log(z^2)
    = 2 \log z
    + 2\pi i \left\lfloor \pi-\Im 2\log z \over 2\pi \right\rfloor =\\= 2 \log z
+ 2\pi i \left\lfloor \pi-2\arg z \over 2\pi \right\rfloor\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\log\left({1\over z}\right)
    = \log(z^{-1})
    = - \log z
    + 2\pi i \left\lfloor \pi-\Im (-1)\log z \over 2\pi \right\rfloor =\\= - \log z
+ 2\pi i \left\lfloor \pi+\arg z \over 2\pi \right\rfloor\end{aligned}\end{align} \]</div>
<p>Another example, following from <a class="reference internal" href="#equation-def-log">(3.2.4.1)</a> and <a class="reference internal" href="#equation-log-a-b">(3.2.4.4)</a>:</p>
<div class="math notranslate nohighlight">
\[\arg z = {1\over i}(\log z - \log|z|)
    = {1\over i}\left(\log {z\over|z|}
      - 2\pi i \left\lfloor \pi-\arg z+\arg |z| \over 2\pi \right\rfloor
      \right)
    = {1\over i} \log {z\over|z|}\]</div>
</div>
<div class="section" id="complex-conjugate">
<h2>3.2.7. Complex Conjugate<a class="headerlink" href="#complex-conjugate" title="Permalink to this headline">¶</a></h2>
<p>The complex conjugate is defined by:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}z = \Re z + i \Im z\\\bar z = \Re z - i \Im z\end{aligned}\end{align} \]</div>
<p>Now we can solve for <span class="math notranslate nohighlight">\(\Re z\)</span> and <span class="math notranslate nohighlight">\(\Im z\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\Re z = {1\over 2}(z + \bar z)\\\Im z = {i\over 2}(-z + \bar z)\end{aligned}\end{align} \]</div>
<p>Any complex function <span class="math notranslate nohighlight">\(f\)</span> can be written using <span class="math notranslate nohighlight">\(\Re z\)</span> and <span class="math notranslate nohighlight">\(\Im z\)</span>, i.e. <span class="math notranslate nohighlight">\(f =
f(\Re z, \Im z)\)</span> or using <span class="math notranslate nohighlight">\(z\)</span> and <span class="math notranslate nohighlight">\(\bar z\)</span>, i.e. <span class="math notranslate nohighlight">\(f=f(z, \bar z)\)</span>.</p>
<div class="section" id="id1">
<h3>Examples<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}|z| = \sqrt{\Re^2 z + \Im^2 z} = \sqrt{
    \left({1\over 2}(z + \bar z)\right)^2 +
    \left({i\over 2}(-z + \bar z)\right)^2}
    =\sqrt{z\bar z}\\|\bar z| = \sqrt{\Re^2 \bar z + \Im^2 \bar z}
    = \sqrt{\Re^2 z + \left(-\Im z\right)^2}
    =|z|\\\arg z = \atan2(\Im z, \Re z)
    =\atan2\left({i\over 2}(-z + \bar z), {1\over 2}(z + \bar z)\right)
    =\atan2\left(i(-z + \bar z), z + \bar z\right)\\\arg \bar z = \atan2(-\Im z, \Re z)
    =-\atan2(\Im z, \Re z) + 2\pi
        \left\lfloor \atan2(\Im z, \Re z)+\pi \over 2\pi \right\rfloor
    =-\arg z + 2\pi \left\lfloor \arg z+\pi \over 2\pi \right\rfloor\\\overline{\log z} = \log|z| -i\arg z
    = \log|\bar z| +i\arg \bar z -2\pi i
        \left\lfloor \arg z+\pi \over 2\pi \right\rfloor
    = \log \bar z -2\pi i
        \left\lfloor \arg z+\pi \over 2\pi \right\rfloor\\\overline{\sqrt z} = \overline{z^\half}
    = \overline{e^{\half\log z}}
    = \overline{e^{\half(\log|z| + i\arg z)}}
    = e^{\half(\log|z| - i\arg z)}
    = e^{\half\left(\log|\bar z| + i\arg \bar z
            - 2\pi i \left\lfloor \arg z+\pi \over 2\pi \right\rfloor
        \right)} =\\    = \left(\bar z\right)^\half
        e^{-\pi i \left\lfloor \arg z+\pi \over 2\pi \right\rfloor}
    = (-1)^{\left\lfloor \arg z+\pi \over 2\pi \right\rfloor} \sqrt{\bar z}\end{aligned}\end{align} \]</div>
</div>
</div>
<div class="section" id="complex-derivatives">
<h2>3.2.8. Complex Derivatives<a class="headerlink" href="#complex-derivatives" title="Permalink to this headline">¶</a></h2>
<p>The complex derivative is defined by</p>
<div class="math notranslate nohighlight" id="equation-complex-deriv-lim">
<span class="eqno">(3.2.8.1)<a class="headerlink" href="#equation-complex-deriv-lim" title="Permalink to this equation">¶</a></span>\[{\d f \over \d z}
    = \lim_{h\to0} {f(z+h)-f(z) \over h}\]</div>
<p>Let’s calculate the complex derivative in the direction <span class="math notranslate nohighlight">\(\theta\)</span>, i.e.
we use <span class="math notranslate nohighlight">\(h=te^{i\theta}\)</span> with real <span class="math notranslate nohighlight">\(t\)</span> and we introduce <span class="math notranslate nohighlight">\(f=f(x, y)\)</span> with <span class="math notranslate nohighlight">\(x=\Re
z\)</span>, <span class="math notranslate nohighlight">\(y=\Im z\)</span> to simplify the notation:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\d f \over \d z}
    = \lim_{t\to0} {f(z+t e^{i\theta})-f(z) \over t e^{i\theta}} =\\    = \lim_{t\to0} {f(x+t\cos\theta, y+t\sin\theta)-f(x, y) \over t}
        e^{-i\theta} =\\    = {\d \over \d t} f(x+t\cos\theta, y+t\sin\theta) e^{-i\theta} =\\    = \left({\partial f \over \partial x} \cos\theta
    + {\partial f \over \partial y} \sin\theta \right) e^{-i\theta} =\\    = \left({\partial f \over \partial x}
        {e^{i\theta}+e^{-i\theta} \over 2}
    + {\partial f \over \partial y} {e^{i\theta}-e^{-i\theta} \over 2i}
        \right) e^{-i\theta} =\\    = {\partial f \over \partial x}
        {1+e^{-2i\theta} \over 2}
    + {\partial f \over \partial y} {1-e^{-2i\theta} \over 2i} =\\    = \half\left({\partial f \over \partial x}
               -i {\partial f \over \partial y}\right)
    + \half\left({\partial f \over \partial x}
               +i {\partial f \over \partial y}\right)e^{-2i\theta} =\\    = {\partial f \over \partial z}
        + {\partial f \over \partial \bar z} e^{-2i\theta}\end{aligned}\end{align} \]</div>
<p>In the last step we have expressed the derivatives with respect to <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> in
terms of derivatives with respect to <span class="math notranslate nohighlight">\(z\)</span>, <span class="math notranslate nohighlight">\(\bar z\)</span>, using the relations:</p>
<div class="math notranslate nohighlight" id="equation-dfdz">
<span class="eqno">(3.2.8.2)<a class="headerlink" href="#equation-dfdz" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}{\partial f \over \partial z}
    = {\partial x \over \partial z} {\partial f \over \partial x}
        + {\partial y \over \partial z} {\partial f \over \partial y} =\\    = {1\over2} {\partial f \over \partial x}
        - {i\over2} {\partial f \over \partial y} =\\    = \half\left( {\partial f \over \partial x}
        - i {\partial f \over \partial y} \right)\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight" id="equation-dfdconjugate-z">
<span class="eqno">(3.2.8.3)<a class="headerlink" href="#equation-dfdconjugate-z" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}{\partial f \over \partial \bar z}
    = {\partial x \over \partial \bar z} {\partial f \over \partial x}
        + {\partial y \over \partial \bar z} {\partial f \over \partial y} =\\    = {1\over2} {\partial f \over \partial x}
        + {i\over2} {\partial f \over \partial y} =\\    = \half\left( {\partial f \over \partial x}
        + i {\partial f \over \partial y} \right)\end{aligned}\end{align} \]</div>
<p>Let’s repeat the important result:</p>
<div class="math notranslate nohighlight" id="equation-complex-deriv">
<span class="eqno">(3.2.8.4)<a class="headerlink" href="#equation-complex-deriv" title="Permalink to this equation">¶</a></span>\[{\d f(z, \bar z) \over \d z}
    = {\partial f(z, \bar z) \over \partial z}
        + {\partial f(z, \bar z) \over \partial \bar z} e^{-2i\theta}\]</div>
<p>The equation <a class="reference internal" href="#equation-complex-deriv">(3.2.8.4)</a> states that the complex derivative along the
direction <span class="math notranslate nohighlight">\(\theta\)</span> of any function can be calculated, but the result in general
depends on <span class="math notranslate nohighlight">\(\theta\)</span>. The derivatives for all possible angles <span class="math notranslate nohighlight">\(\theta\)</span> lie on a
circle, with the center <span class="math notranslate nohighlight">\({\partial f \over \partial z}\)</span> and the radius
<span class="math notranslate nohighlight">\(\left|{\partial f \over \partial \bar z}\right|\)</span>.
When the derivative has different values
for different <span class="math notranslate nohighlight">\(\theta\)</span>, i.e. when <span class="math notranslate nohighlight">\({\partial f \over \partial \bar z}\neq0\)</span>, it
means that the complex limit <a class="reference internal" href="#equation-complex-deriv-lim">(3.2.8.1)</a> does not exist. On the
other hand, if the derivative does not depend on <span class="math notranslate nohighlight">\(\theta\)</span>, i.e.
when <span class="math notranslate nohighlight">\({\partial f \over \partial \bar z}=0\)</span>, then the complex limit
<a class="reference internal" href="#equation-complex-deriv-lim">(3.2.8.1)</a> exists, and the function has a complex derivative —
such functions are called analytic. Analytic functions thus do not depend on
<span class="math notranslate nohighlight">\(\bar z\)</span> and we can write just <span class="math notranslate nohighlight">\(f = f(z)\)</span> for those.</p>
<p>The <span class="math notranslate nohighlight">\({\partial f \over \partial z}\)</span> and <span class="math notranslate nohighlight">\({\partial f \over \partial \bar z}\)</span>
are called Wirtinger derivatives.</p>
<p>We can see that the function is analytic (i.e. has a complex derivative) if and
only if:</p>
<div class="math notranslate nohighlight">
\[{\partial f \over \partial \bar z}
    = \half\left( {\partial f \over \partial x}
        + i {\partial f \over \partial y} \right) = 0\]</div>
<p>We can write <span class="math notranslate nohighlight">\(f = u+iv\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial f \over \partial x} + i {\partial f \over \partial y} = 0\\{\partial (u+iv) \over \partial x}
    + i {\partial (u+iv) \over \partial y} = 0\\\left({\partial u \over \partial x}
-{\partial v \over \partial y}\right)
    + i \left({\partial u \over \partial y}
      + {\partial v \over \partial x}\right)= 0\end{aligned}\end{align} \]</div>
<p>both the real and imaginary parts must be equal to zero:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\partial u \over \partial x} = {\partial v \over \partial y}\\{\partial u \over \partial y} = - {\partial v \over \partial x}\end{aligned}\end{align} \]</div>
<p>These are called the Cauchy-Riemann equations.</p>
<p>We can derive the chain rule:</p>
<div class="math notranslate nohighlight" id="equation-chain-rule">
<span class="eqno">(3.2.8.5)<a class="headerlink" href="#equation-chain-rule" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}{\d f(g) \over \d z}
    = {\partial f(g) \over \partial z}
        + {\partial f(g) \over \partial \bar z} e^{-2i\theta} =\\    = \left({\partial f \over \partial g}{\partial g \over \partial z}
    + {\partial f \over \partial \bar g}{\partial \bar g \over \partial
      z}\right)
    + \left({\partial f \over \partial g}{\partial g \over \partial \bar z}
    + {\partial f \over \partial \bar g}{\partial \bar g \over \partial
      \bar z}\right)
    e^{-2i\theta} =\\    = {\partial f \over \partial g}
    \left({\partial g \over \partial z}+{\partial g \over \partial \bar z}
        e^{-2i\theta} \right)
    +
      {\partial f \over \partial \bar g}
    \left({\partial \bar g \over \partial z}+{\partial \bar g \over \partial \bar z}
        e^{-2i\theta} \right) =\\    = {\partial f \over \partial g} {\d g \over \d z}
    +
      {\partial f \over \partial \bar g} {\d \bar g \over \d z}\end{aligned}\end{align} \]</div>
<p>Another useful formula is the derivative of a conjugate function:</p>
<div class="math notranslate nohighlight" id="equation-deriv-conj">
<span class="eqno">(3.2.8.6)<a class="headerlink" href="#equation-deriv-conj" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}{\d \bar f \over \d z}
    = {\partial \bar f \over \partial z}
        + {\partial \bar f \over \partial \bar z} e^{-2i\theta}
    = \overline{\partial f \over \partial \bar z}
        + \overline{\partial f \over \partial z} e^{-2i\theta} =\\    = \left(\overline{{\partial f \over \partial \bar z} e^{-2i\theta}
        + {\partial f \over \partial z}}\right) e^{-2i\theta}
    = \overline{\d f \over \d z} e^{-2i\theta}\end{aligned}\end{align} \]</div>
<p>Using <a class="reference internal" href="#equation-deriv-conj">(3.2.8.6)</a>, the chain rule <a class="reference internal" href="#equation-chain-rule">(3.2.8.5)</a> can also be written as:</p>
<div class="math notranslate nohighlight" id="equation-chain-rule2">
<span class="eqno">(3.2.8.7)<a class="headerlink" href="#equation-chain-rule2" title="Permalink to this equation">¶</a></span>\[{\d f(g) \over \d z}
    = {\partial f \over \partial g} {\d g \over \d z}
    + {\partial f \over \partial \bar g} {\d \bar g \over \d z}
    = {\partial f \over \partial g} {\d g \over \d z}
    + {\partial f \over \partial \bar g} \overline {\d g \over \d z}
        e^{-2i\theta}\]</div>
<p>Which has the advantage that only the <span class="math notranslate nohighlight">\({\d g \over \d z}\)</span> derivative is needed,
the rest is just conjugation and multiplication. If <span class="math notranslate nohighlight">\(f\)</span> is analytic, then
<span class="math notranslate nohighlight">\({\partial f \over \partial \bar g}=0\)</span>, the second term vanishes and the chain
rule is analogous to real functions.</p>
<div class="section" id="id2">
<h3>Examples<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\d z \over \d z}
     = {\partial z \over \partial z}
     + {\partial z \over \partial \bar z} e^{-2i\theta}
     = 1\\{\d \bar z \over \d z}
     = {\partial \bar z \over \partial z}
     + {\partial \bar z \over \partial \bar z} e^{-2i\theta}
     = e^{-2i\theta}\\{\d \Re z \over \d z} = {\d {1\over 2}(z + \bar z) \over \d z}
     = {\partial {1\over 2}(z + \bar z) \over \partial z}
     + {\partial {1\over 2}(z + \bar z) \over \partial \bar z} e^{-2i\theta}
     = \half + \half e^{-2i\theta}\\{\d \Im z \over \d z} = {\d {i\over 2}(-z + \bar z) \over \d z}
     = {\partial {i\over 2}(-z + \bar z) \over \partial z}
     + {\partial {i\over 2}(-z + \bar z) \over \partial \bar z}
        e^{-2i\theta}
     = -{i\over2} + {i\over2} e^{-2i\theta}\\{\d |z| \over \d z}
    = {\d \sqrt{z\bar z} \over \d z}
    = {\partial \sqrt{z\bar z} \over \partial z}
    + {\partial \sqrt{z\bar z} \over \partial \bar z} e^{-2i\theta}
    = {\bar z + z e^{-2i\theta}\over 2\sqrt{z\bar z}}
    = {\bar z + z e^{-2i\theta}\over 2|z|}\\{\d |f(z)| \over \d z}
    = {\partial |f| \over \partial f} {\d f \over \d z}
    + {\partial |f| \over \partial \bar f} {\d \bar f \over \d z}
    = {\bar f{\d f\over\d z} + f{\d \bar f\over\d z}\over 2|f|}\\{\d \arg z \over \d z}
    ={\d\, \atan2\left(i(-z + \bar z), z + \bar z\right) \over \d z}
    ={\partial\, \atan2\left(i(-z + \bar z), z + \bar z\right) \over
        \partial z}
    +{\partial\, \atan2\left(i(-z + \bar z), z + \bar z\right) \over
        \partial \bar z} e^{-2i\theta} =\\    = {(z+\bar z)(-i)- i(-z+\bar z)\over 4z\bar z}
    + {(z+\bar z)i- i(-z+\bar z)\over 4z\bar z}e^{-2i\theta} =\\    = {i\over2}\left( -{1\over z} + {1\over \bar z} e^{-2i\theta} \right)
    = {i\over2}\left( -\bar z + z e^{-2i\theta} \over | z|^2 \right)\\{\d \log|z| \over \d z}
    = {1\over|z|} {\bar z + z e^{-2i\theta}\over 2|z|}
    = {\bar z + z e^{-2i\theta}\over 2|z|^2}\\{\d \log z \over \d z}
    = {\d (\log|z| +i\arg z) \over \d z}
    = {\bar z + z e^{-2i\theta}\over 2|z|^2}
    +i {i\over2}\left( -\bar z + z e^{-2i\theta} \over | z|^2 \right)
    = {\bar z \over | z|^2} = {\bar z\over z\bar z} = {1\over z}\\{\d \overline{\log z} \over \d z}
    = {\partial \overline{\log z} \over \partial z}
    + {\partial \overline{\log z} \over \partial \bar z} e^{-2i\theta}
    = \overline{\partial \log z \over \partial \bar z}
    + \overline{\partial \log z \over \partial z} e^{-2i\theta}
    = {1\over\bar z} e^{-2i\theta}\\{\d |\log z| \over \d z}
    = {\overline{\log z}{\d \log z\over\d z}
        + \log z{\d \overline{\log z}\over\d z}\over 2|\log z|}
    = {{1\over z}\overline{\log z}
        + {1\over\bar z}(\log z) e^{-2i\theta}\over 2|\log z|}
    = {\bar z\overline{\log z}
        + z (\log z) e^{-2i\theta}\over 2z\bar z|\log z|}\end{aligned}\end{align} \]</div>
<p>Note that if <span class="math notranslate nohighlight">\(z\)</span> is real, i.e. <span class="math notranslate nohighlight">\(z = \bar z\)</span>, we recover the real derivative
results by setting <span class="math notranslate nohighlight">\(\theta=0\)</span>, i.e. taking the derivative along the <span class="math notranslate nohighlight">\(x\)</span>-axis:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\d x \over \d x} = 1\\{\d \Re x \over \d x} = \half + \half = 1\\{\d \Im x \over \d x} = -{i\over2} + {i\over2} = 0\\{\d |x| \over \d x} = {x + x \over 2|x|} = {x \over |x|}\\{\d |f(x)| \over \d x}
    = {f{\d f\over\d x} + f{\d f\over\d z}\over 2|f|}
    = {f{\d f\over\d x} \over |f|}\\{\d \arg x \over \d x} = {i\over2}\left( -{1\over x} + {1\over x}\right) = 0\\{\d \log|x| \over \d x}
    = {x + x \over 2|x|^2}
    = {x \over | x|^2}\\{\d \log x \over \d x} = {1\over x}\\{\d |\log x| \over \d x}
    = {x\log x + x \log x\over 2x^2|\log x|}
    = {\log x\over x|\log x|}\end{aligned}\end{align} \]</div>
<p>The above approach to first express things in terms of <span class="math notranslate nohighlight">\(z\)</span> and <span class="math notranslate nohighlight">\(\bar z\)</span> and
then differentiate is probably the easiest, but we can do things in any order
we want. For example the derivative of <span class="math notranslate nohighlight">\(|z|\)</span> can also be calculated in this
(arguably more complicated) way:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\d |z| \over \d z} = {\d \sqrt{\Re^2 z + \Im^2 z} \over \d z}
    = {\Re z {\d \Re z \over \d z} + \Im z {\d \Im z \over \d z} \over |z|}=\\    = {\left({1\over 2}(z + \bar z)\right)
        \left(\half + \half e^{-2i\theta}\right)
        + \left({i\over 2}(-z + \bar z)\right)
          \left(-{i\over2} + {i\over2} e^{-2i\theta}\right) \over |z|}=\\    = {\bar z + z e^{-2i\theta}\over 2|z|}\end{aligned}\end{align} \]</div>
</div>
</div>
<div class="section" id="testing-identities-using-computer-code">
<h2>3.2.9. Testing Identities Using Computer Code<a class="headerlink" href="#testing-identities-using-computer-code" title="Permalink to this headline">¶</a></h2>
<p>All the complex identities in this chapter can be tested using the following
codes. <a class="reference download internal" href="../_downloads/test_complex.py" download=""><code class="xref download docutils literal notranslate"><span class="pre">test_complex.py</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">arg</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The argument function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">cmath</span> <span class="k">import</span> <span class="n">log</span>
    <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">imag</span>

<span class="k">def</span> <span class="nf">generate_values</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create values to test the function at.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>
    <span class="kn">from</span> <span class="nn">random</span> <span class="k">import</span> <span class="n">random</span>
    <span class="c1"># Generate 3 circles in complex plane, with diameters 0.5, 1 and 2. We</span>
    <span class="c1"># avoid special values like -1, +/- i, etc., because they typically send</span>
    <span class="c1"># the numerical values close to the branch cut, and numerical errors then</span>
    <span class="c1"># flip the sign, e.g.:</span>
    <span class="c1">#    In [1]: sqrt((-0.5j)**2)</span>
    <span class="c1">#    Out[1]: -0.5j</span>
    <span class="c1">#</span>
    <span class="c1">#    In [2]: (-0.5j)**2</span>
    <span class="c1">#    Out[2]: (-0.25-0j)</span>
    <span class="c1">#</span>
    <span class="c1">#    In [3]: sqrt(-0.25)</span>
    <span class="c1">#    Out[3]: 0.5j</span>
    <span class="c1"># Here [3] is the correct value and [1] is incorrect, but that happens due</span>
    <span class="c1"># to the round off errors in [2] (the small negative imaginary part makes</span>
    <span class="c1"># sqrt() return -0.5j instead of +0.5j).</span>
    <span class="c1">#</span>
    <span class="c1"># For this reason, we chose N=7.</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">circle</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> <span class="n">circle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="n">N</span><span class="p">))</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">circle</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">circle</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">circle</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
    <span class="c1"># Add some random points:</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
        <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">random</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">20</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="n">random</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">values</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">generate_values</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">feq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">max_relative_error</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">max_absolute_error</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns True if a==b to the given relative and absolute errors, otherwise</span>
<span class="sd">    False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if the numbers are close enough (absolutely), then they are equal</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_absolute_error</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="c1"># if not, they can still be equal if their relative error is small</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
        <span class="n">relative_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">relative_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="c1">#print abs(a-b), relative_error</span>
    <span class="k">return</span> <span class="n">relative_error</span> <span class="o">&lt;=</span> <span class="n">max_relative_error</span>

<span class="k">def</span> <span class="nf">test_zero1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests that a complex function f(x) of one complex variable is zero.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">feq</span><span class="p">(</span><span class="n">lhs</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s2">&quot;x lhs(x) rhs(x)&quot;</span>
            <span class="nb">print</span> <span class="n">x</span><span class="p">,</span> <span class="n">lhs</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">assert</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">test_zero2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests that a complex function f(x, y) of two complex variables is zero.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">feq</span><span class="p">(</span><span class="n">lhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">:</span>
                <span class="nb">print</span> <span class="s2">&quot;x y lhs(x, y) rhs(x, y)&quot;</span>
                <span class="nb">print</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">lhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                <span class="k">assert</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">test_zero3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests that a complex function f(x, y, z) of three complex variables is zero.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">feq</span><span class="p">(</span><span class="n">lhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="n">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="s2">&quot;x y z lhs(x, y, z) rhs(x, y, z)&quot;</span>
                    <span class="nb">print</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">lhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="n">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
                    <span class="k">assert</span> <span class="kc">False</span>

<span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">floor</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">from</span> <span class="nn">cmath</span> <span class="k">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log</span>
<span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span>

<span class="c1"># Test the various identities</span>
<span class="n">test_zero1</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">floor</span><span class="p">((</span><span class="n">pi</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">arg</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">test_zero1</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">floor</span><span class="p">((</span><span class="n">pi</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="n">test_zero1</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">floor</span><span class="p">((</span><span class="n">pi</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)))</span>
<span class="n">test_zero1</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">test_zero1</span><span class="p">(</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">arg</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>
<span class="n">test_zero1</span><span class="p">(</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">arg</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">z</span><span class="p">)),</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span><span class="o">.</span><span class="n">imag</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">floor</span><span class="p">((</span><span class="n">pi</span><span class="o">-</span><span class="n">z</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)))</span>
<span class="n">test_zero1</span><span class="p">(</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(),</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">floor</span><span class="p">((</span><span class="n">arg</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()))</span>
<span class="n">test_zero1</span><span class="p">(</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">arg</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()),</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="o">-</span><span class="n">arg</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">floor</span><span class="p">((</span><span class="n">arg</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)))</span>

<span class="n">test_zero2</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="n">b</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">floor</span><span class="p">((</span><span class="n">pi</span><span class="o">-</span><span class="n">a</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))))</span>
<span class="n">test_zero2</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">a</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">:</span> <span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">floor</span><span class="p">((</span><span class="n">pi</span><span class="o">-</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)))</span>
<span class="n">test_zero2</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="n">log</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">floor</span><span class="p">((</span><span class="n">pi</span><span class="o">-</span><span class="n">arg</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="n">arg</span><span class="p">(</span><span class="n">b</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)))</span>
<span class="n">test_zero2</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">arg</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">arg</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="n">arg</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">floor</span><span class="p">((</span><span class="n">pi</span><span class="o">-</span><span class="n">arg</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="n">arg</span><span class="p">(</span><span class="n">b</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)))</span>
<span class="n">test_zero2</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">floor</span><span class="p">((</span><span class="n">pi</span><span class="o">-</span><span class="n">arg</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">arg</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)))</span>

<span class="n">test_zero3</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="n">b</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">floor</span><span class="p">((</span><span class="n">pi</span><span class="o">-</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))))</span>
<span class="n">test_zero3</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">a</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="n">a</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">a</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">floor</span><span class="p">((</span><span class="n">pi</span><span class="o">-</span><span class="n">arg</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">arg</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))))</span>
</pre></div>
</div>
<p><a class="reference download internal" href="../_downloads/test_complex_diff.py" download=""><code class="xref download docutils literal notranslate"><span class="pre">test_complex_diff.py</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">arg</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The argument function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">cmath</span> <span class="k">import</span> <span class="n">log</span>
    <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">imag</span>

<span class="k">def</span> <span class="nf">generate_values</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create values to test the function at.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>
    <span class="kn">from</span> <span class="nn">random</span> <span class="k">import</span> <span class="n">random</span>
    <span class="c1"># Generate 3 circles in complex plane, with diameters 0.5, 1 and 2. We</span>
    <span class="c1"># avoid special values like -1, +/- i, etc., because they typically send</span>
    <span class="c1"># the numerical values close to the branch cut, and numerical errors then</span>
    <span class="c1"># flip the sign, e.g.:</span>
    <span class="c1">#    In [1]: sqrt((-0.5j)**2)</span>
    <span class="c1">#    Out[1]: -0.5j</span>
    <span class="c1">#</span>
    <span class="c1">#    In [2]: (-0.5j)**2</span>
    <span class="c1">#    Out[2]: (-0.25-0j)</span>
    <span class="c1">#</span>
    <span class="c1">#    In [3]: sqrt(-0.25)</span>
    <span class="c1">#    Out[3]: 0.5j</span>
    <span class="c1"># Here [3] is the correct value and [1] is incorrect, but that happens due</span>
    <span class="c1"># to the round off errors in [2] (the small negative imaginary part makes</span>
    <span class="c1"># sqrt() return -0.5j instead of +0.5j).</span>
    <span class="c1">#</span>
    <span class="c1"># For this reason, we chose N=7.</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">circle</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> <span class="n">circle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="n">N</span><span class="p">))</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">circle</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">circle</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">circle</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
    <span class="c1"># Add some random points:</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
        <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">random</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">20</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="n">random</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">values</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">generate_values</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">feq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">max_relative_error</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">max_absolute_error</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns True if a==b to the given relative and absolute errors, otherwise</span>
<span class="sd">    False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if the numbers are close enough (absolutely), then they are equal</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_absolute_error</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="c1"># if not, they can still be equal if their relative error is small</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
        <span class="n">relative_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">relative_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="c1">#print abs(a-b), relative_error</span>
    <span class="k">return</span> <span class="n">relative_error</span> <span class="o">&lt;=</span> <span class="n">max_relative_error</span>

<span class="k">def</span> <span class="nf">test_zero1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests that a complex function f(x) of one complex variable is zero.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">feq</span><span class="p">(</span><span class="n">lhs</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s2">&quot;x lhs(x) rhs(x)&quot;</span>
            <span class="nb">print</span> <span class="n">x</span><span class="p">,</span> <span class="n">lhs</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">assert</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">test_zero2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests that a complex function f(x, y) of two complex variables is zero.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">feq</span><span class="p">(</span><span class="n">lhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">:</span>
                <span class="nb">print</span> <span class="s2">&quot;x y lhs(x, y) rhs(x, y)&quot;</span>
                <span class="nb">print</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">lhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                <span class="k">assert</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">test_zero3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests that a complex function f(x, y, z) of three complex variables is zero.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">feq</span><span class="p">(</span><span class="n">lhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="n">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="s2">&quot;x y z lhs(x, y, z) rhs(x, y, z)&quot;</span>
                    <span class="nb">print</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">lhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="n">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
                    <span class="k">assert</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">eps</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">z0</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">z0</span><span class="p">))</span> <span class="o">/</span> <span class="n">h</span>

<span class="k">def</span> <span class="nf">diff2</span><span class="p">(</span><span class="n">dfdz</span><span class="p">,</span> <span class="n">dfdconjz</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">dfdz</span><span class="p">(</span><span class="n">z0</span><span class="p">)</span> <span class="o">+</span> <span class="n">dfdconjz</span><span class="p">(</span><span class="n">z0</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">theta</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test_zero</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dfdz</span><span class="p">,</span> <span class="n">dfdconjz</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">feq</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">eps</span><span class="p">),</span> <span class="n">diff2</span><span class="p">(</span><span class="n">dfdz</span><span class="p">,</span> <span class="n">dfdconjz</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">theta</span><span class="p">),</span>
            <span class="n">max_relative_error</span><span class="o">=</span><span class="n">eps</span><span class="o">*</span><span class="mf">1e2</span><span class="p">,</span> <span class="n">max_absolute_error</span><span class="o">=</span><span class="n">eps</span><span class="o">*</span><span class="mf">1e2</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">floor</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">from</span> <span class="nn">cmath</span> <span class="k">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log</span>
<span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span>

<span class="n">angles</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="p">]</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">angles</span><span class="p">:</span>
        <span class="n">test_zero</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
        <span class="n">test_zero</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
        <span class="n">test_zero</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
        <span class="n">test_zero</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
        <span class="n">test_zero</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3.2. Complex Numbers</a><ul>
<li><a class="reference internal" href="#real-and-imaginary-part">3.2.1. Real and Imaginary Part</a></li>
<li><a class="reference internal" href="#argument-function">3.2.2. Argument Function</a></li>
<li><a class="reference internal" href="#exponential">3.2.3. Exponential</a></li>
<li><a class="reference internal" href="#logarithm">3.2.4. Logarithm</a></li>
<li><a class="reference internal" href="#power">3.2.5. Power</a></li>
<li><a class="reference internal" href="#examples">3.2.6. Examples</a></li>
<li><a class="reference internal" href="#complex-conjugate">3.2.7. Complex Conjugate</a><ul>
<li><a class="reference internal" href="#id1">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#complex-derivatives">3.2.8. Complex Derivatives</a><ul>
<li><a class="reference internal" href="#id2">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-identities-using-computer-code">3.2.9. Testing Identities Using Computer Code</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="integration.html"
                        title="previous chapter">3.1. Integration</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="residue.html"
                        title="next chapter">3.3. Residue Theorem</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/math/complex.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="residue.html" title="3.3. Residue Theorem"
             >next</a> |</li>
        <li class="right" >
          <a href="integration.html" title="3.1. Integration"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" >3. Mathematics</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>