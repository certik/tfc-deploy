
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>3.42. Variational Formulation of PDEs &#8212; Theoretical Physics Reference 0.5 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Classical Mechanics, Special and General Relativity" href="../relativity/main.html" />
    <link rel="prev" title="3.41. Operators" href="operators.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head><body>
    <div style="display:none">
    \(
        \newcommand{\d}{\mathrm{d}}
        \newcommand{\bomega}{\vec\omega}
        \newcommand{\half}{ {1\over 2} }
        \def\mathnot#1{\text{"$#1$"}}

        %operators
        \newcommand{\diag}{\mathrm{diag}}
        \newcommand{\sinc}{\mathrm{sinc}}
        \newcommand{\Sh}{ {\large\style{font-family:Times}{\text{Ш}}} }
        \newcommand{\res}{\mathrm{Res}}
    \)
    </div>
    

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../relativity/main.html" title="4. Classical Mechanics, Special and General Relativity"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="operators.html" title="3.41. Operators"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" accesskey="U">3. Mathematics</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="variational-formulation-of-pdes">
<h1>3.42. Variational Formulation of PDEs<a class="headerlink" href="#variational-formulation-of-pdes" title="Permalink to this headline">¶</a></h1>
<p>Not every equation allows a variational formulation (e.g., Navier-Stokes or
Euler equations do not have such a formulation), but many equations have one,
and we explain how it works on several examples.</p>
<div class="section" id="poisson-equation">
<h2>3.42.1. Poisson Equation<a class="headerlink" href="#poisson-equation" title="Permalink to this headline">¶</a></h2>
<p>The Lagrangian for Poisson equation is:</p>
<div class="math notranslate nohighlight" id="equation-poisson0">
<span class="eqno">(3.42.1.1)<a class="headerlink" href="#equation-poisson0" title="Permalink to this equation">¶</a></span>\[L[u] = \int_a^b \left[ \half u'^2(x) - f(x) u(x) \right] \d x
    - [g(x) u(x)]_a^b\,.\]</div>
<p>Important note: technically, as we will see below, this imposes the Neumann
boundary condition and 1D Poisson equation with two Neumann boundary conditions
does not have a unique solution. At least one Dirichlet boundary condition is
needed for a unique solution. For example with <span class="math notranslate nohighlight">\(u(a) = u_0\)</span> and <span class="math notranslate nohighlight">\(u'(b) = g\)</span> the
boundary term becomes just <span class="math notranslate nohighlight">\(-gu(b)\)</span>. However, for simplicity, we will show the
derivation with two Neumann boundary conditions first and we will discuss how
to impose the Dirichlet boundary condition later.</p>
<p>The variational formulation is:</p>
<div class="math notranslate nohighlight">
\[\delta L = 0\,,\]</div>
<p>which yields:</p>
<div class="math notranslate nohighlight" id="equation-poisson1">
<span class="eqno">(3.42.1.2)<a class="headerlink" href="#equation-poisson1" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}\delta L &amp;= \int_a^b \left[ u'(x) \delta u'(x)
    - f(x) \delta u(x) \right] \d x
    - [g(x) \delta u(x)]_a^b\\         &amp;= \int_a^b \left[-u''(x) \delta u(x)
    - f(x) \delta u(x) \right] \d x
    + [u'(x) \delta u(x)]_a^b
    - [g(x) \delta u(x)]_a^b\\         &amp;= \int_a^b \left[-u''(x) - f(x)\right] \delta u(x) \d x
    + [(u'(x) - g(x)) \delta u(x)]_a^b\\         &amp;= 0\,,\end{aligned}\end{align} \]</div>
<p>where we applied integration by parts.
This equation holds for any <span class="math notranslate nohighlight">\(\delta u(x)\)</span>, and in particular it holds for
<span class="math notranslate nohighlight">\(\delta u(x) = 0\)</span> at the boundary (i.e., for <span class="math notranslate nohighlight">\(\delta u(a) = 0\)</span> and
<span class="math notranslate nohighlight">\(\delta u(b) = 0\)</span>). Then the boundary term in <a class="reference internal" href="#equation-poisson1">(3.42.1.2)</a> vanishes and we
obtain:</p>
<div class="math notranslate nohighlight" id="equation-poisson2">
<span class="eqno">(3.42.1.3)<a class="headerlink" href="#equation-poisson2" title="Permalink to this equation">¶</a></span>\[\int_a^b \left[-u''(x) - f(x)\right] \delta u(x) \d x = 0\,,\]</div>
<p>This equation holds for any <span class="math notranslate nohighlight">\(\delta u(x)\)</span> that is zero at the boundary, and
thus it implies:</p>
<div class="math notranslate nohighlight" id="equation-poisson3">
<span class="eqno">(3.42.1.4)<a class="headerlink" href="#equation-poisson3" title="Permalink to this equation">¶</a></span>\[u''(x) + f(x) = 0\,.\]</div>
<p>Now we substitute <a class="reference internal" href="#equation-poisson3">(3.42.1.4)</a> into <a class="reference internal" href="#equation-poisson1">(3.42.1.2)</a> and obtain:</p>
<div class="math notranslate nohighlight" id="equation-poisson3-boundary">
<span class="eqno">(3.42.1.5)<a class="headerlink" href="#equation-poisson3-boundary" title="Permalink to this equation">¶</a></span>\[[(u'(x) - g(x)) \delta u(x)]_a^b = 0\,.\]</div>
<p>Thus <a class="reference internal" href="#equation-poisson1">(3.42.1.2)</a> implies both <a class="reference internal" href="#equation-poisson3">(3.42.1.4)</a> and <a class="reference internal" href="#equation-poisson3-boundary">(3.42.1.5)</a>.
The equation <a class="reference internal" href="#equation-poisson3-boundary">(3.42.1.5)</a> holds for any <span class="math notranslate nohighlight">\(\delta u(x)\)</span> (generally
not zero at the boundary) and thus it implies:</p>
<div class="math notranslate nohighlight" id="equation-poisson3-boundary2">
<span class="eqno">(3.42.1.6)<a class="headerlink" href="#equation-poisson3-boundary2" title="Permalink to this equation">¶</a></span>\[u'(x) - g(x) = 0\]</div>
<p>at the boundary. Thus <span class="math notranslate nohighlight">\(g(x)\)</span> imposes the Neumann boundary condition, i.e.,
the value of the derivative <span class="math notranslate nohighlight">\(u'(x) = g(x)\)</span> at the boundary. This condition
is imposed variationally.</p>
<p>To impose a Dirichlet boundary condition, we want to impose the value of
<span class="math notranslate nohighlight">\(u(x)=u_0(x)\)</span> at the boundary for some constant <span class="math notranslate nohighlight">\(u_0(x)\)</span>. As such, <span class="math notranslate nohighlight">\(u(x)\)</span>
is not allowed to vary at that part of the boundary, which means that the
variation <span class="math notranslate nohighlight">\(\delta u(x) = 0\)</span> at the boundary. So we restrict the variation
<span class="math notranslate nohighlight">\(\delta u(x)\)</span> to be zero at the Dirichlet part of the boundary in
<a class="reference internal" href="#equation-poisson1">(3.42.1.2)</a> and thus also in <a class="reference internal" href="#equation-poisson3-boundary">(3.42.1.5)</a>. This implies that
<a class="reference internal" href="#equation-poisson3-boundary2">(3.42.1.6)</a> does not hold at the Dirichlet part of the boundary
and we have to set the value <span class="math notranslate nohighlight">\(u(x)\)</span> there directly.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>As a particular example, let <span class="math notranslate nohighlight">\(u(a) = u_0\)</span> and <span class="math notranslate nohighlight">\(u'(b) = g\)</span>. Then the Lagrangian
<a class="reference internal" href="#equation-poisson0">(3.42.1.1)</a> becomes:</p>
<div class="math notranslate nohighlight" id="equation-poisson-example-l">
<span class="eqno">(3.42.1.7)<a class="headerlink" href="#equation-poisson-example-l" title="Permalink to this equation">¶</a></span>\[L[u] = \int_a^b \left[ \half u'^2(x) - f(x) u(x) \right] \d x - g u(b)\,.\]</div>
<p>We can explicitly define the space <span class="math notranslate nohighlight">\(U\)</span> of all trial functions <span class="math notranslate nohighlight">\(u \in U\)</span> that
one can choose (admissible) and substitute in <a class="reference internal" href="#equation-poisson-example-l">(3.42.1.7)</a> as
follows. We have to impose the Dirichlet condition <span class="math notranslate nohighlight">\(u(a) = u_0\)</span> on the space
itself, and we also have to choose how smooth functions we want. For finite
element applications one typically chooses <span class="math notranslate nohighlight">\(H^1\)</span> (i.e., values and first
derivatives are from <span class="math notranslate nohighlight">\(L^2\)</span>) and we obtain:</p>
<div class="math notranslate nohighlight" id="equation-poisson-example-uu">
<span class="eqno">(3.42.1.8)<a class="headerlink" href="#equation-poisson-example-uu" title="Permalink to this equation">¶</a></span>\[U := \{u : u \in H^1(a,b), u(a)=u_0\}\]</div>
<p>Now we derive what space the variation <span class="math notranslate nohighlight">\(\delta u(x)\)</span> belongs to. Let
<span class="math notranslate nohighlight">\(u_\textrm{min}\)</span> be the solution (the extremum of the functional
<a class="reference internal" href="#equation-poisson-example-l">(3.42.1.7)</a>). Then from calculus of variations:</p>
<div class="math notranslate nohighlight" id="equation-poisson-example-u">
<span class="eqno">(3.42.1.9)<a class="headerlink" href="#equation-poisson-example-u" title="Permalink to this equation">¶</a></span>\[u = u_\textrm{min} + \varepsilon \delta u(x)\]</div>
<p>Here <span class="math notranslate nohighlight">\(u\)</span> is called the trial function and <span class="math notranslate nohighlight">\(\delta u(x)\)</span> is called the test
function. Both <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(u_\textrm{min}\)</span> are from the space <span class="math notranslate nohighlight">\(U\)</span>. Thus we can
compute:</p>
<div class="math notranslate nohighlight">
\[\delta u(a) = {u(a) - u_\textrm{min}(a) \over \varepsilon}
= {u_0 - u_0 \over \varepsilon} = 0\,.\]</div>
<p>In addition, both <span class="math notranslate nohighlight">\(u,u_\textrm{min}\in H^1(a,b)\)</span>, so also their difference
<span class="math notranslate nohighlight">\(u(x) - u_\textrm{min}(x)\)</span> and thus also <span class="math notranslate nohighlight">\(\delta u(x)={u(x) - u_\textrm{min}(x)
\over \varepsilon}\)</span> is from <span class="math notranslate nohighlight">\(H^1(a,b)\)</span>. There are no other conditions (<span class="math notranslate nohighlight">\(u(b)\)</span>
and <span class="math notranslate nohighlight">\(u_\textrm{min}(b)\)</span> are generally different, so in general <span class="math notranslate nohighlight">\(\delta u(b) \ne
0\)</span>) and so <span class="math notranslate nohighlight">\(\delta u(x) \in U_0\)</span> where the space <span class="math notranslate nohighlight">\(U_0\)</span> is:</p>
<div class="math notranslate nohighlight" id="equation-poisson-example-u0">
<span class="eqno">(3.42.1.10)<a class="headerlink" href="#equation-poisson-example-u0" title="Permalink to this equation">¶</a></span>\[U_0 := \{w : w \in H^1(a,b), w(a)=0\}\,.\]</div>
<p>The definition of the space <span class="math notranslate nohighlight">\(U_0\)</span> in <a class="reference internal" href="#equation-poisson-example-u0">(3.42.1.10)</a> is derived from
the definition of the space <span class="math notranslate nohighlight">\(U\)</span> in <a class="reference internal" href="#equation-poisson-example-uu">(3.42.1.8)</a>.</p>
<p>To compute the variation of <span class="math notranslate nohighlight">\(L\)</span>, we substitute <a class="reference internal" href="#equation-poisson-example-u">(3.42.1.9)</a> into
<a class="reference internal" href="#equation-poisson-example-l">(3.42.1.7)</a>, differentiate with respect to <span class="math notranslate nohighlight">\(\varepsilon\)</span> and then
set <span class="math notranslate nohighlight">\(\varepsilon=0\)</span> using <a class="reference internal" href="other.html#equation-functional-deriv">(3.17.3.2)</a>:</p>
<div class="math notranslate nohighlight">
\[\delta L[u] = \left.{\d\over\d\varepsilon}L[u_\textrm{min}+\varepsilon
    \delta u] \right|_{\varepsilon=0}\]</div>
<p>as was done in <a class="reference internal" href="#equation-poisson1">(3.42.1.2)</a> and one obtains the weak form (below we drop the
label <span class="math notranslate nohighlight">\(\textrm{min}\)</span> from <span class="math notranslate nohighlight">\(u_\textrm{min}\)</span> and just use <span class="math notranslate nohighlight">\(u\)</span>):</p>
<div class="math notranslate nohighlight" id="equation-poisson-example-weak-form">
<span class="eqno">(3.42.1.11)<a class="headerlink" href="#equation-poisson-example-weak-form" title="Permalink to this equation">¶</a></span>\[\delta L[u] =
\int_a^b \left[ u'(x) \delta u'(x) - f(x) \delta u(x) \right] \d x
    - g \delta u(b) = 0\,.\]</div>
<p>The task is to find such function <span class="math notranslate nohighlight">\(u\in U\)</span> so that
<a class="reference internal" href="#equation-poisson-example-weak-form">(3.42.1.11)</a> holds for all <span class="math notranslate nohighlight">\(\delta u \in U_0\)</span>.  From
<a class="reference internal" href="#equation-poisson-example-weak-form">(3.42.1.11)</a> one obtains (as in <a class="reference internal" href="#equation-poisson1">(3.42.1.2)</a>):</p>
<div class="math notranslate nohighlight" id="equation-poisson-example-2">
<span class="eqno">(3.42.1.12)<a class="headerlink" href="#equation-poisson-example-2" title="Permalink to this equation">¶</a></span>\[\int_a^b \left[-u''(x) - f(x)\right] \delta u(x) \d x
    + (u'(b) - g) \delta u(b) = 0\,.\]</div>
<p>The governing equation <a class="reference internal" href="#equation-poisson3">(3.42.1.4)</a> is the same:</p>
<div class="math notranslate nohighlight" id="equation-poisson-example-strong">
<span class="eqno">(3.42.1.13)<a class="headerlink" href="#equation-poisson-example-strong" title="Permalink to this equation">¶</a></span>\[u''(x) + f(x) = 0\,.\]</div>
<p>The boundary term <a class="reference internal" href="#equation-poisson3-boundary">(3.42.1.5)</a> becomes (see
<a class="reference internal" href="#equation-poisson-example-2">(3.42.1.12)</a>):</p>
<div class="math notranslate nohighlight">
\[(u'(b) - g) \delta u(b) = 0\,.\]</div>
<p>Which implies <span class="math notranslate nohighlight">\(u'(b) = g\)</span>.</p>
<p>The Dirichlet boundary condition is part of the definition of the function
space <a class="reference internal" href="#equation-poisson-example-uu">(3.42.1.8)</a>, so all trial functions <span class="math notranslate nohighlight">\(u\)</span> that one can choose
(admissible) and substitute in <span class="math notranslate nohighlight">\(L[u]\)</span> must lie in <span class="math notranslate nohighlight">\(U\)</span>. From the derivation of
the space <span class="math notranslate nohighlight">\(U_0\)</span> in <a class="reference internal" href="#equation-poisson-example-u0">(3.42.1.10)</a> we can see that since the value of
<span class="math notranslate nohighlight">\(u(a)\)</span> is fixed, we always have <span class="math notranslate nohighlight">\(\delta u(a) = 0\)</span>; on the other hand, since
<span class="math notranslate nohighlight">\(u(b)\)</span> is not fixed, in general we have <span class="math notranslate nohighlight">\(\delta u(b) \ne 0\)</span>.</p>
<p>The Neumann boundary condition is imposed variationally due to the surface term
in the weak form <a class="reference internal" href="#equation-poisson-example-weak-form">(3.42.1.11)</a>.</p>
<div class="section" id="summary">
<h4>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h4>
<p>We have shown above that there are three equivalent formulations which
fully and uniquely determine the solution and boundary conditions (both
Dirichlet and Neumann):</p>
<ol class="arabic simple">
<li>Define the functional <span class="math notranslate nohighlight">\(L[u]\)</span> in <a class="reference internal" href="#equation-poisson-example-l">(3.42.1.7)</a> and the space <span class="math notranslate nohighlight">\(U\)</span>
for the trial functions <span class="math notranslate nohighlight">\(u\in U\)</span> in <a class="reference internal" href="#equation-poisson-example-uu">(3.42.1.8)</a>.</li>
<li>Define the weak form <a class="reference internal" href="#equation-poisson-example-weak-form">(3.42.1.11)</a> and the two spaces <span class="math notranslate nohighlight">\(U\)</span>
and <span class="math notranslate nohighlight">\(U_0\)</span>, where <span class="math notranslate nohighlight">\(u\in U\)</span> and <span class="math notranslate nohighlight">\(\delta u \in U_0\)</span>.</li>
<li>Define the strong form <a class="reference internal" href="#equation-poisson-example-strong">(3.42.1.13)</a> and the boundary
conditions <span class="math notranslate nohighlight">\(u(a) = u_0\)</span> and <span class="math notranslate nohighlight">\(u'(b) = g\)</span>.</li>
</ol>
<p>Let us write down the three formulations in detail.</p>
</div>
<div class="section" id="variational-formulation">
<h4>Variational Formulation<a class="headerlink" href="#variational-formulation" title="Permalink to this headline">¶</a></h4>
<p>The variational formulation is the formulation 1. above.</p>
<div class="math notranslate nohighlight">
\[L[u] = \int_a^b \left[ \half u'^2(x) - f(x) u(x) \right] \d x - g u(b)\,.\]</div>
<p>The task is to find such <span class="math notranslate nohighlight">\(u\in U\)</span> that extremizes this functional
(<span class="math notranslate nohighlight">\(\delta L[u] = 0\)</span>), where:</p>
<div class="math notranslate nohighlight">
\[U := \{u : u \in H^1(a,b), u(a)=u_0\}\,.\]</div>
</div>
<div class="section" id="weak-formulation">
<h4>Weak Formulation<a class="headerlink" href="#weak-formulation" title="Permalink to this headline">¶</a></h4>
<p>Weak formulation is the formulation 2. above, and it is customary to
write <span class="math notranslate nohighlight">\(w(x) \equiv \delta u(x)\)</span> in the weak form
<a class="reference internal" href="#equation-poisson-example-weak-form">(3.42.1.11)</a>:</p>
<div class="math notranslate nohighlight" id="equation-poisson-example-weak-form2">
<span class="eqno">(3.42.1.14)<a class="headerlink" href="#equation-poisson-example-weak-form2" title="Permalink to this equation">¶</a></span>\[\int_a^b \left[ u'(x) w'(x) - f(x) w(x) \right] \d x - g w(b) = 0\,.\]</div>
<p>The task is to find such <span class="math notranslate nohighlight">\(u\in U\)</span> so that <a class="reference internal" href="#equation-poisson-example-weak-form2">(3.42.1.14)</a>
holds for all <span class="math notranslate nohighlight">\(w\in U_0\)</span>, where</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}U   &amp; := \{u : u \in H^1(a,b), u(a)=u_0\}\,,\\U_0 &amp; := \{w : w \in H^1(a,b), w(a)=0\}\,.\end{aligned}\end{align} \]</div>
<p>We can also define:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}a(u,w) &amp;= \int_a^b u'(x) w'(x) \d x\,,\\b(w)   &amp;= \int_a^b f(x) w(x) \d x + g w(b)\end{aligned}\end{align} \]</div>
<p>and write <a class="reference internal" href="#equation-poisson-example-weak-form2">(3.42.1.14)</a> as:</p>
<div class="math notranslate nohighlight">
\[a(u,w) = b(w)\,.\]</div>
</div>
<div class="section" id="strong-formulation">
<h4>Strong Formulation<a class="headerlink" href="#strong-formulation" title="Permalink to this headline">¶</a></h4>
<p>Strong formulation is the formulation 3. above. We are solving the equation:</p>
<div class="math notranslate nohighlight">
\[u''(x) + f(x) = 0\]</div>
<p>subject to boundary conditions <span class="math notranslate nohighlight">\(u(a) = u_0\)</span> and <span class="math notranslate nohighlight">\(u'(b) = g\)</span>.</p>
</div>
</div>
</div>
<div class="section" id="radial-schrodinger-equation">
<h2>3.42.2. Radial Schrödinger Equation<a class="headerlink" href="#radial-schrodinger-equation" title="Permalink to this headline">¶</a></h2>
<p>The derivation is similar as for the Poisson equation, except that we have
<span class="math notranslate nohighlight">\(g(x) = 0\)</span> based on physical reasoning (that we cannot set the derivative
to a given value, or, alternatively, that we require the operator to be
self-adjoint).</p>
<p>The Lagrangian for the radial Schrödinger equation is:</p>
<div class="math notranslate nohighlight" id="equation-schr-radial0">
<span class="eqno">(3.42.2.1)<a class="headerlink" href="#equation-schr-radial0" title="Permalink to this equation">¶</a></span>\[L[R] = \int_0^\infty \left[\half R'^2(r)
    + \left(V(r) + {l(l+1)\over 2 r^2}\right) R^2(r) \right] r^2 \,\d r\,.\]</div>
<p>We minimize the Lagrangian subject to the normalization condition
<span class="math notranslate nohighlight">\(N[R] = \int_0^\infty R^2(r) r^2\, \d r = 1\)</span> as follows:</p>
<div class="math notranslate nohighlight" id="equation-schr-radial1">
<span class="eqno">(3.42.2.2)<a class="headerlink" href="#equation-schr-radial1" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}0 &amp;= \delta (L - \epsilon (N-1))\\&amp;= \delta \int_0^\infty \left[ \half r^2 R'^2
+ (r^2 V + \half l(l+1)) R^2 - \epsilon r^2R^2 \right] \,\d r =\\&amp;= 2\int_0^\infty \left[ \half r^2 R'(\delta R)'
+ (r^2 V + \half l(l+1)) R\delta R - \epsilon r^2 R\delta R \right]
  \,\d r =\\&amp;= 2\int_0^\infty \left[ -\half (r^2 R')'
+ (r^2 V + \half l(l+1)) R - \epsilon r^2 R\right]\delta R \,\d r
  + [r^2 R' \delta R]_0^\infty\end{aligned}\end{align} \]</div>
<p>This equation holds for any <span class="math notranslate nohighlight">\(\delta R(r)\)</span>, and so it also holds when we
restrict <span class="math notranslate nohighlight">\(\delta R(r) = 0\)</span> on the boundary and the boundary term vanishes. Then
it implies the radial Schrödinger equation:</p>
<div class="math notranslate nohighlight" id="equation-schr-radial2">
<span class="eqno">(3.42.2.3)<a class="headerlink" href="#equation-schr-radial2" title="Permalink to this equation">¶</a></span>\[-\half (r^2 R'(r))' + (r^2 V(r) + \half l(l+1)) R(r) = \epsilon r^2 R(r)\]</div>
<p>Substituting <a class="reference internal" href="#equation-schr-radial2">(3.42.2.3)</a> into <a class="reference internal" href="#equation-schr-radial1">(3.42.2.2)</a> we obtain:</p>
<div class="math notranslate nohighlight" id="equation-schr-radial-boundary">
<span class="eqno">(3.42.2.4)<a class="headerlink" href="#equation-schr-radial-boundary" title="Permalink to this equation">¶</a></span>\[  [r^2 R' \delta R]_0^\infty = 0\]</div>
<p>And we can see that <a class="reference internal" href="#equation-schr-radial1">(3.42.2.2)</a> implies both the equation
<a class="reference internal" href="#equation-schr-radial2">(3.42.2.3)</a> and the boundary term <a class="reference internal" href="#equation-schr-radial-boundary">(3.42.2.4)</a>. The
boundary term is zero for <span class="math notranslate nohighlight">\(r=0\)</span>, so it reduces to:</p>
<div class="math notranslate nohighlight" id="equation-schr-radial-boundary2">
<span class="eqno">(3.42.2.5)<a class="headerlink" href="#equation-schr-radial-boundary2" title="Permalink to this equation">¶</a></span>\[\lim_{r\to\infty} r^2 R'(r) \delta R(r) = 0\]</div>
<p>We can see that there is no natural condition at <span class="math notranslate nohighlight">\(r=0\)</span>, and for <span class="math notranslate nohighlight">\(r=\infty\)</span> we
only have two possible options. Either we impose <span class="math notranslate nohighlight">\(\delta R(\infty) = 0\)</span> and
obtain the Dirichlet condition and the boundary term
<a class="reference internal" href="#equation-schr-radial-boundary2">(3.42.2.5)</a> vanishes. Or we allow <span class="math notranslate nohighlight">\(\delta R(\infty)\)</span> to vary,
and then <a class="reference internal" href="#equation-schr-radial-boundary2">(3.42.2.5)</a> implies <span class="math notranslate nohighlight">\(R'(\infty) = 0\)</span>.</p>
<p>Unlike for the Poisson equation we are not allowed to set <span class="math notranslate nohighlight">\(R'(\infty)\)</span> to
anything other than zero, and that’s why <a class="reference internal" href="#equation-schr-radial0">(3.42.2.1)</a> has no surface
term.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3.42. Variational Formulation of PDEs</a><ul>
<li><a class="reference internal" href="#poisson-equation">3.42.1. Poisson Equation</a><ul>
<li><a class="reference internal" href="#example">Example</a><ul>
<li><a class="reference internal" href="#summary">Summary</a></li>
<li><a class="reference internal" href="#variational-formulation">Variational Formulation</a></li>
<li><a class="reference internal" href="#weak-formulation">Weak Formulation</a></li>
<li><a class="reference internal" href="#strong-formulation">Strong Formulation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#radial-schrodinger-equation">3.42.2. Radial Schrödinger Equation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="operators.html"
                        title="previous chapter">3.41. Operators</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../relativity/main.html"
                        title="next chapter">4. Classical Mechanics, Special and General Relativity</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/math/variational-formulation.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../relativity/main.html" title="4. Classical Mechanics, Special and General Relativity"
             >next</a> |</li>
        <li class="right" >
          <a href="operators.html" title="3.41. Operators"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" >3. Mathematics</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>