
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>8.11. Hartree-Fock (HF) Method &#8212; Theoretical Physics Reference 0.5 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8.12. Projector Augmented-Wave Method (PAW)" href="paw.html" />
    <link rel="prev" title="8.10. Ideal Fermi Gas" href="fermi.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head><body>
    <div style="display:none">
    \(
        \newcommand{\d}{\mathrm{d}}
        \newcommand{\bomega}{\vec\omega}
        \newcommand{\half}{ {1\over 2} }
        \def\mathnot#1{\text{"$#1$"}}

        %operators
        \newcommand{\diag}{\mathrm{diag}}
        \newcommand{\sinc}{\mathrm{sinc}}
        \newcommand{\Sh}{ {\large\style{font-family:Times}{\text{Ш}}} }
        \newcommand{\res}{\mathrm{Res}}
    \)
    </div>
    

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="paw.html" title="8.12. Projector Augmented-Wave Method (PAW)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fermi.html" title="8.10. Ideal Fermi Gas"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" accesskey="U">8. Quantum Field Theory and Quantum Mechanics</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="hartree-fock-hf-method">
<h1>8.11. Hartree-Fock (HF) Method<a class="headerlink" href="#hartree-fock-hf-method" title="Permalink to this headline">¶</a></h1>
<div class="section" id="derivation">
<h2>8.11.1. Derivation<a class="headerlink" href="#derivation" title="Permalink to this headline">¶</a></h2>
<p>The interacting Hamiltonian for many body Schrödinger equation
is (see the general QFT notes for derivation):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}i\hbar\partial_t\ket{\Psi(t)} = \hat H\ket{\Psi(t)}\\\hat H = \hat T + \hat V = \sum_{ij} c_i^\dag\braket{i|T|j}c_j +
    \half \sum_{ijkl} c_i^\dag c_j^\dag\braket{ij|V|kl}c_l c_k\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(\ket{i}\)</span> are spin orbitals (thus the integration over <span class="math notranslate nohighlight">\(\omega\)</span> below)
and:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\braket{i|T|j} = \int \chi_i^*({\bf x}) \left(
    -\half\nabla^2 - \sum_n {Z_n\over | {\bf x} -{\bf R}_n | }\right)
        \chi_j({\bf x})\d^3 x\, \d\omega\\\braket{ij|V|kl} = \int \chi_i^*({\bf x}) \chi_j^*({\bf y})
    {1\over | {\bf x} - {\bf y} | } \chi_k({\bf x}) \chi_l({\bf y})
        \d^3 x\, \d\omega_x\,
        \d^3 y\, \d\omega_y\end{aligned}\end{align} \]</div>
<p>We would like to minimize the energy <span class="math notranslate nohighlight">\(E = \braket{\Psi | \hat H | \Psi }\)</span> using
the following basis for <span class="math notranslate nohighlight">\(Z\)</span> electrons:</p>
<div class="math notranslate nohighlight">
\[\ket{\Psi} = c_1^\dag c_2^\dag \cdots c_Z^\dag\ket{0}\]</div>
<p>We express the energy <span class="math notranslate nohighlight">\(E\)</span> in this basis:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}E = \braket{\Psi | \hat H | \Psi } =\\= \bra{0}c_Z\cdots c_2 c_1 \hat H
    c_1^\dag c_2^\dag \cdots c_Z^\dag\ket{0} =\\= \bra{0}c_Z\cdots c_2 c_1
\left(\sum_{i,j=1}^Z c_i^\dag\braket{i|T|j}c_j +
    \half \sum_{i,j,k,l=1}^Z c_i^\dag c_j^\dag\braket{ij|V|kl}c_l c_k\right)
    c_1^\dag c_2^\dag \cdots c_Z^\dag\ket{0} =\\= \sum_{i=1}^Z \braket{i|T|i} +
    \half \sum_{i,j=1}^Z \left(\braket{ij|V|ij}-\braket{ij|V|ji}\right)\end{aligned}\end{align} \]</div>
<p>We minimize it with the constrain <span class="math notranslate nohighlight">\(\braket{i|j} = \delta_{ij}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\delta \left(E - \sum_{i,j=1}^Z \epsilon_{ij} \braket{i|j}\right) = 0\]</div>
<p>We obtain:</p>
<div class="math notranslate nohighlight" id="equation-hfeq0">
<span class="eqno">(8.11.1.1)<a class="headerlink" href="#equation-hfeq0" title="Permalink to this equation">¶</a></span>\[T \ket{i} + \sum_{j=1}^Z \left(\braket{j|V|ij}-\braket{j|V|ji}\right)
    = \epsilon_i \ket{i}\]</div>
<p>in the <span class="math notranslate nohighlight">\(x\)</span>-representation:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\braket{{\bf x} | T | i}
    + \sum_{j=1}^Z \left(\bra{{\bf x}}\braket{j|V|ij}-
        \bra{{\bf x}}\braket{j|V|ji}\right)
    = \epsilon_i \braket{{\bf x} | i}\\\braket{{\bf x} | T | i}
    + \sum_{j=1}^Z \left(\braket{j{\bf x}|V|ij}-
        \braket{j{\bf x}|V|ji}\right)
    = \epsilon_i \braket{{\bf x} | i}\end{aligned}\end{align} \]</div>
<p>And writing the individual terms explicitly (in this section, all orbitals are
<em>spin</em> orbitals):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\braket{{\bf x} | i} = \psi_i({\bf x})\\\braket{{\bf x} | T | i}
    = \left(-\half \nabla^2 -\sum_n {Z_n\over | {\bf x} -{\bf R}_n | }
        \right)\psi_i({\bf x})\\\braket{j{\bf x}|V|ij}
    = \int \psi_j^*({\bf y}){1\over|{\bf x}-{\bf y}|}
        \psi_i({\bf x})\psi_j({\bf y}) \d^3 y
    = \int {|\psi_j({\bf y})|^2\over|{\bf x}-{\bf y}|}
        \d^3 y\,\,\psi_i({\bf x})\\\braket{j{\bf x}|V|ji}
    = \int \psi_j^*({\bf y}){1\over|{\bf x}-{\bf y}|}
        \psi_j({\bf x})\psi_i({\bf y}) \d^3 y
    = \int {\psi_i({\bf y})\psi_j^*({\bf y})\over|{\bf x}-{\bf y}|}
        \d^3 y\,\,\psi_j({\bf x})\end{aligned}\end{align} \]</div>
<p>we get the Hartree-Fock equations:</p>
<div class="math notranslate nohighlight" id="equation-hfeq">
<span class="eqno">(8.11.1.2)<a class="headerlink" href="#equation-hfeq" title="Permalink to this equation">¶</a></span>\[\left(-\half \nabla^2 -{Z\over |{\bf x}|}
+
\int {\sum_{j=1}^Z|\psi_j({\bf y})|^2\over|{\bf x}-{\bf y}|}
        \d^3 y\right)\psi_i({\bf x})
- \sum_{j=1}^Z\int {\psi_i({\bf y})\psi_j^*({\bf y})\over|{\bf x}-{\bf y}|}
        \d^3 y\,\,\psi_j({\bf x})
=
\epsilon_i \psi_i({\bf x})\]</div>
<p>Let’s introduce the number density <span class="math notranslate nohighlight">\(n({\bf x})\)</span>, Hartree potential <span class="math notranslate nohighlight">\(V_H({\bf
x})\)</span> and nonlocal exchange potential <span class="math notranslate nohighlight">\(V_x\)</span> with its kernel <span class="math notranslate nohighlight">\(U({\bf x}, {\bf
y})\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}n({\bf x}) = \sum_{j=1}^Z|\psi_j({\bf y})|^2\\V_H({\bf x}) = \int {\sum_{j=1}^Z|\psi_j({\bf y})|^2\over|{\bf x}-{\bf y}|}
        \d^3 y
    = \int {n({\bf y})\over|{\bf x}-{\bf y}|} \d^3 y\\\hat V_x f({\bf x}) =
- \sum_{j=1}^Z\int {f({\bf y})\psi_j^*({\bf y})\over|{\bf x}-{\bf y}|}
        \d^3 y\,\,\psi_j({\bf x})
= \int U({\bf x}, {\bf y}) f({\bf y}) \d^3 y\\U({\bf x}, {\bf y}) =
- \sum_{j=1}^Z {\psi_j({\bf x})\psi_j^*({\bf y})\over|{\bf x}-{\bf y}|}\end{aligned}\end{align} \]</div>
<p>then we can write the HF equations as:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\left(-\half \nabla^2 -{Z\over |{\bf x}|} + V_H({\bf x})
    + \hat V_x
    \right)\psi_i({\bf x})
=
\epsilon_i \psi_i({\bf x})\\\left(-\half \nabla^2 -{Z\over |{\bf x}|} + V_H({\bf x})
    \right)\psi_i({\bf x})
+ \int U({\bf x}, {\bf y}) \psi_i({\bf y}) \d^3 y
=
\epsilon_i \psi_i({\bf x})\end{aligned}\end{align} \]</div>
<p>The Hartree potential can be calculated by solving the Poisson equation:</p>
<div class="math notranslate nohighlight">
\[\nabla^2V_H({\bf x}) = -4\pi n({\bf x})\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[n({\bf x}) = \sum_{i=1}^Z |\psi_i({\bf x})|^2\]</div>
<p>The application of the exchange potential <span class="math notranslate nohighlight">\(\hat V_x\)</span> on any function
<span class="math notranslate nohighlight">\(f({\bf x})\)</span> can be calculated by:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\hat V_x f({\bf x}) = - \sum_{j=1}^Z W_{fj}({\bf x})\psi_j({\bf x})\\W_{fj}({\bf x}) = \int {f({\bf y})\psi_j^*({\bf y})\over|{\bf x}-{\bf y}|}
        \d^3 y\\\nabla^2 W_{fj}({\bf x}) = -4\pi f({\bf x})\psi_j^*({\bf x})\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="roothaan-equations-for-closed-shell-systems">
<h2>8.11.2. Roothaan Equations For Closed Shell Systems<a class="headerlink" href="#roothaan-equations-for-closed-shell-systems" title="Permalink to this headline">¶</a></h2>
<p>Starting from <a class="reference internal" href="#equation-hfeq0">(8.11.1.1)</a> and integrating over spins we get (here
<span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(k\)</span> are spatial orbitals, not spin orbitals):</p>
<div class="math notranslate nohighlight" id="equation-hfeq01">
<span class="eqno">(8.11.2.1)<a class="headerlink" href="#equation-hfeq01" title="Permalink to this equation">¶</a></span>\[T \ket{i} + \sum_{k=1}^{N/2}
    \left(2\braket{k|V|ik}-\braket{k|V|ki}\right) = \epsilon_i \ket{i}\]</div>
<p>We introduce basis functions <span class="math notranslate nohighlight">\(\ket{\mu}\)</span> by (below the greek letters are basis
functions, latin letters are spatial orbitals):</p>
<div class="math notranslate nohighlight">
\[\ket{i} = \sum_\nu C_{\nu i} \ket{\nu}\]</div>
<p>substitute into <a class="reference internal" href="#equation-hfeq01">(8.11.2.1)</a> and multiply by <span class="math notranslate nohighlight">\(\bra{\mu}\)</span> from the left:</p>
<div class="math notranslate nohighlight" id="equation-hfeq02">
<span class="eqno">(8.11.2.2)<a class="headerlink" href="#equation-hfeq02" title="Permalink to this equation">¶</a></span>\[\sum_\nu \braket{\mu | T | \nu} C_{\nu i}
    + \sum_\nu\sum_{k=1}^{N/2} \left(2\braket{\mu k|V|\nu k}
        -\braket{\mu k|V|k\nu}\right) C_{\nu i}
    = \epsilon_i \sum_\nu \braket{\mu | \nu} C_{\nu i}\]</div>
<p>Now we expand the functions <span class="math notranslate nohighlight">\(\ket{k}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-hfeq03">
<span class="eqno">(8.11.2.3)<a class="headerlink" href="#equation-hfeq03" title="Permalink to this equation">¶</a></span>\[\sum_\nu \braket{\mu | T | \nu} C_{\nu i}
    + \sum_\nu \sum_{\alpha\beta}
        \left(2\sum_{k=1}^{N/2} C_{\alpha k} C_{\beta k}^* \right)
        \left(\braket{\mu \beta|V|\nu \alpha}
            -\half\braket{\mu \beta|V|\alpha \nu}\right) C_{\nu i}
    = \epsilon_i \sum_\nu \braket{\mu | \nu} C_{\nu i}\]</div>
<p>we introduce the density matrix:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\hat\rho
    = 2 \sum_{k=1}^{N/2} \ket{k}\bra{k}
    = \sum_{\alpha\beta} \ket{\alpha} 2 \sum_{k=1}^{N/2}
        C_{\alpha k} C_{\beta k}^*\bra{\beta}
    = \sum_{\alpha\beta} \ket{\alpha}P_{\alpha\beta}\bra{\beta}\\P_{\alpha\beta} = 2 \sum_{k=1}^{N/2} C_{\alpha k} C_{\beta k}^*\end{aligned}\end{align} \]</div>
<p>and get:</p>
<div class="math notranslate nohighlight" id="equation-hfeq04">
<span class="eqno">(8.11.2.4)<a class="headerlink" href="#equation-hfeq04" title="Permalink to this equation">¶</a></span>\[\sum_\nu \left( \braket{\mu | T | \nu}
    + \sum_{\alpha\beta}
        P_{\alpha\beta}
        \left(\braket{\mu \beta|V|\nu \alpha}
            -\half \braket{\mu \beta|V|\alpha \nu}\right) \right) C_{\nu i}
    = \epsilon_i \sum_\nu \braket{\mu | \nu} C_{\nu i}\]</div>
<p>introducing:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}F_{\mu\nu} = H_{\mu\nu}^{\mbox{core}} + G_{\mu\nu}\\H_{\mu\nu}^{\mbox{core}} = \braket{\mu | T | \nu}\\G_{\mu\nu} = \sum_{\alpha\beta} P_{\alpha\beta}
        \left(\braket{\mu \beta|V|\nu \alpha}
            -\half \braket{\mu \beta|V|\alpha \nu}\right)\\S_{\mu\nu} = \braket{\mu | \nu}\end{aligned}\end{align} \]</div>
<p>the equation <a class="reference internal" href="#equation-hfeq04">(8.11.2.4)</a> is:</p>
<div class="math notranslate nohighlight" id="equation-roothaan1">
<span class="eqno">(8.11.2.5)<a class="headerlink" href="#equation-roothaan1" title="Permalink to this equation">¶</a></span>\[\sum_\nu F_{\mu\nu} C_{\nu i}
    = \epsilon_i \sum_\nu S_{\mu\nu} C_{\nu i}\]</div>
<p>These are the Roothaan equations. It is a generalized eigenvalue problem.</p>
<p>Total energy is given by (the <span class="math notranslate nohighlight">\(i,j\)</span> in the first equation are spin orbitals,
in the other equations <span class="math notranslate nohighlight">\(i,j\)</span> are spatial orbitals):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}E = \sum_{i} \braket{i|T|i} +
    \half \sum_{i,j} \left(\braket{ij|V|ij}-\braket{ij|V|ji}\right) =\\= \sum_{i} 2 I(i) + \sum_{i,j} \left(2 J(i, j) - K(i, j)\right) =\\= \sum_{i} 2 \braket{i|T|i} +
    \sum_{i,j} \left(2\braket{ij|V|ij}- \braket{ij|V|ji}\right) =\\= \sum_{i} 2 \braket{i|T|i} +
    2\sum_{i,j} \left(\braket{ij|V|ij}-\half \braket{ij|V|ji}\right) =\\= \sum_{\mu\nu} \sum_{i} 2 \braket{\mu|T|\nu} C_{\nu i} C_{\mu i}^* +
    2\sum_{\mu\nu}\sum_{\alpha\beta}
    \sum_{i,j}
    C_{\nu i} C_{\mu i}^*
    C_{\alpha j} C_{\beta j}^*
    \left(\braket{\mu\beta|V|\nu\alpha}-
        \half \braket{\mu\beta|V|\alpha\nu}\right) =\\= \sum_{\mu\nu} \braket{\mu|T|\nu} P_{\nu\mu} +
    \half \sum_{\mu\nu}\sum_{\alpha\beta}
    P_{\nu\mu}
    P_{\alpha\beta}
    \left(\braket{\mu\beta|V|\nu\alpha}-
        \half \braket{\mu\beta|V|\alpha\nu}\right) =\\= \sum_{\mu\nu} P_{\nu\mu} (H_{\mu\nu}^{\mbox{core}}
    +\half G_{\mu\nu}) =\\= \sum_{\mu\nu} P_{\nu\mu} (\half H_{\mu\nu}^{\mbox{core}}
    +\half (H_{\mu\nu}^{\mbox{core}} + G_{\mu\nu})) =\\= \half \sum_{\mu\nu} P_{\nu\mu} (H_{\mu\nu}^{\mbox{core}}
    +F_{\mu\nu})\end{aligned}\end{align} \]</div>
<p>The same thing can be derived in <span class="math notranslate nohighlight">\(x\)</span>-representation
starting from <a class="reference internal" href="#equation-hfeq">(8.11.1.2)</a> and introducing spatial orbitals:</p>
<div class="math notranslate nohighlight" id="equation-hfeq2">
<span class="eqno">(8.11.2.6)<a class="headerlink" href="#equation-hfeq2" title="Permalink to this equation">¶</a></span>\[\left(-\half \nabla^2 -{Z\over |{\bf x}|}
+
\int {2\sum_{k=1}^{N/2}|\psi_k({\bf y})|^2\over|{\bf x}-{\bf y}|}
        \d^3 y\right)\psi_i({\bf x})
- \sum_{k=1}^{N/2}\int {\psi_i({\bf y})\psi_k^*({\bf y})\over|{\bf x}-{\bf y}|}
        \d^3 y\,\,\psi_k({\bf x})
=
\epsilon_i \psi_i({\bf x})\]</div>
<p>We introduce basis functions <span class="math notranslate nohighlight">\(\phi_\mu\)</span>:</p>
<div class="math notranslate nohighlight">
\[\psi_i({\bf x}) = \sum_\nu C_{\nu i} \phi_\nu({\bf x})\]</div>
<p>substitute into <a class="reference internal" href="#equation-hfeq2">(8.11.2.6)</a> and also multiply the whole equation by
<span class="math notranslate nohighlight">\(\phi_\mu^*\)</span> and integrate over <span class="math notranslate nohighlight">\({\bf x}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-hfeq3">
<span class="eqno">(8.11.2.7)<a class="headerlink" href="#equation-hfeq3" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}\sum_\nu
\int
\phi_\mu^*({\bf x})
\left(-\half \nabla^2 -{Z\over |{\bf x}|}
+
\int {2\sum_{k=1}^{N/2}|\psi_k({\bf y})|^2\over|{\bf x}-{\bf y}|}
        \d^3 y\right)\phi_\nu({\bf x}) \d^3 x\, C_{\nu i}\\-\sum_\nu
\int
\phi_\mu^*({\bf x})
\sum_{k=1}^{N/2}\int {\phi_\nu({\bf y})\psi_k^*({\bf y})\over|{\bf x}-{\bf y}|}
        \d^3 y\,\,\psi_k({\bf x})\d^3 x\, C_{\nu i}
=
\epsilon_i
\sum_\nu
\int \phi_\mu^*({\bf x}) \phi_\nu({\bf x})\d^3 x
\, C_{\nu i}\end{aligned}\end{align} \]</div>
<p>This can be written as:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\sum_\nu F_{\mu\nu} C_{\nu i} = \epsilon_i \sum_\nu S_{\mu\nu} C_{\nu i}\\F_{\mu\nu} = H_{\mu\nu}^{\mbox{core}} + G_{\mu\nu}
    = T_{\mu\nu} + V_{\mu\nu} + G_{\mu\nu}\end{aligned}\end{align} \]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}T_{\mu\nu} =
        \int \phi_\mu^*({\bf x}) \left(-\half \nabla^2 \right)
        \phi_\nu({\bf x}) \d^3 x
    =
        \half \int \nabla \phi_\mu^*({\bf x}) \cdot
            \nabla \phi_\nu({\bf x}) \d^3 x\\V_{\mu\nu} =
    \int \phi_\mu^*({\bf x}) \left(-{Z\over |{\bf x}|}\right)
    \phi_\nu({\bf x}) \d^3 x\\G_{\mu\nu} =
    \int \phi_\mu^*({\bf x}) \left(
\int {2\sum_{k=1}^{N/2}|\psi_k({\bf y})|^2\over|{\bf x}-{\bf y}|}
        \d^3 y\right)\phi_\nu({\bf x}) \d^3 x
-\int
\phi_\mu^*({\bf x})
\sum_{k=1}^{N/2}\int {\phi_\nu({\bf y})\psi_k^*({\bf y})\over|{\bf x}-{\bf y}|}
        \d^3 y\,\,\psi_k({\bf x})\d^3 x\\
S_{\mu\nu} = \int \phi_\mu^*({\bf x}) \phi_\nu({\bf x})\d^3 x\end{aligned}\end{align} \]</div>
<p>Introducing the density matrix and density:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\rho({\bf x}, {\bf y}) = \braket{{\bf x} | \hat \rho | {\bf y}}
= \sum_{\alpha\beta} \braket{{\bf x}|\alpha}P_{\alpha\beta}
    \braket{\beta|{\bf y}}
= \sum_{\alpha\beta} \phi_\alpha({\bf x}) P_{\alpha\beta}
    \phi_\beta^*({\bf y})\\
P_{\alpha\beta} = 2 \sum_{k=1}^{N/2} C_{\alpha k} C_{\beta k}^*\\\rho({\bf x}) = 2 \sum_{k=1}^{N/2} | \psi_k({\bf x})|^2
    = 2 \sum_{k=1}^{N/2} | \braket{{\bf x}|k}|^2
    = 2 \sum_{k=1}^{N/2} \braket{{\bf x}|k}\braket{k|{\bf x}}
    = \braket{{\bf x}|\hat \rho|{\bf x}}
    = \sum_{\alpha\beta} \phi_\alpha({\bf x}) P_{\alpha\beta}
        \phi_\beta^*({\bf x})\end{aligned}\end{align} \]</div>
<p>Expanding the <span class="math notranslate nohighlight">\(\psi_k\)</span> functions and using the density matrix we get for
<span class="math notranslate nohighlight">\(G_{\mu\nu}\)</span>:</p>
<div class="math notranslate nohighlight">
\[G_{\mu\nu} =
    \sum_{\alpha\beta} P_{\alpha\beta}
    \int \phi_\mu^*({\bf x}) \left(
\int {\phi_\beta^*({\bf y})\phi_\alpha({\bf y})\over|{\bf x}-{\bf y}|}
        \d^3 y\right)\phi_\nu({\bf x}) \d^3 x
-\half \sum_{\alpha\beta} P_{\alpha\beta}
\int
\phi_\mu^*({\bf x})
\int {\phi_\nu({\bf y})\phi_\beta^*({\bf y})\over|{\bf x}-{\bf y}|}
        \d^3 y\,\,\phi_\alpha({\bf x})\d^3 x\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}G_{\mu\nu} =
    \sum_{\alpha\beta} P_{\alpha\beta}
    \int {\phi_\mu^*({\bf x}) \phi_\nu({\bf x}) \phi_\beta^*({\bf y})
            \phi_\alpha({\bf y})
        -\half
        \phi_\mu^*({\bf x}) \phi_\alpha({\bf x}) \phi_\beta^*({\bf y})
            \phi_\nu({\bf y}) \over
                    | {\bf x}-{\bf y}|}
        \d^3 x\, \d^3 y\\    \equiv \sum_{\alpha\beta} P_{\alpha\beta}
        \left(\braket{\mu \beta|{1\over r_{12}}|\nu \alpha}
            -\half \braket{\mu \beta|{1\over r_{12}}|\alpha \nu}\right)\end{aligned}\end{align} \]</div>
<p>In physical and chemistry notation this is written as:</p>
<div class="math notranslate nohighlight">
\[G_{\mu\nu} = \sum_{\alpha\beta} P_{\alpha\beta}
        \left(\braket{\mu \beta|\nu \alpha}
            -\half \braket{\mu \beta|\alpha \nu}\right)
    = \sum_{\alpha\beta} P_{\alpha\beta}
        \left((\mu \nu|\beta \alpha) -\half (\mu \alpha|\beta \nu)\right)\]</div>
<p>Note that this notation implicitly assumes the <span class="math notranslate nohighlight">\({1\over r_{12}}\)</span> factor, so
for example <span class="math notranslate nohighlight">\(\braket{\mu \beta|\nu \alpha}\)</span> actually means
<span class="math notranslate nohighlight">\(\braket{\mu \beta|{1\over r_{12}}|\nu \alpha}\)</span> and one has to understand this
from the context.</p>
</div>
<div class="section" id="two-particle-matrix-element">
<h2>8.11.3. Two Particle Matrix Element<a class="headerlink" href="#two-particle-matrix-element" title="Permalink to this headline">¶</a></h2>
<p>The two particle matrix element is:</p>
<div class="math notranslate nohighlight" id="equation-twoint">
<span class="eqno">(8.11.3.1)<a class="headerlink" href="#equation-twoint" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}(ij|kl) =
    \int {\psi_i^*({\bf x})\psi_j({\bf x})\psi_k^*({\bf x}')\psi_l({\bf x}')
        \over | {\bf x} - {\bf x}' |} \d^3 x \d^3 x' =\\= \braket{ik|jl} =
    \int {\psi_i^*({\bf x})\psi_k^*({\bf x}')\psi_j({\bf x})\psi_l({\bf x}')
        \over | {\bf x} - {\bf x}' |} \d^3 x \d^3 x'\end{aligned}\end{align} \]</div>
<p>The <span class="math notranslate nohighlight">\(\braket{ik|jl}\)</span> is called the physicists’ notation because
the <span class="math notranslate nohighlight">\(\ket{jl}\)</span> and <span class="math notranslate nohighlight">\(\ket{ik}\)</span> kets are:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\ket{jl}=\psi_j({\bf x})\psi_l({\bf x}')\\\ket{ik}=\psi_i({\bf x})\psi_k({\bf x}')\end{aligned}\end{align} \]</div>
<p>The <span class="math notranslate nohighlight">\((ij|kl)\)</span> is called the chemists’ notation. From <a class="reference internal" href="#equation-twoint">(8.11.3.1)</a> there
are two types of symmetries — interchanging of the dummy variables:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(ij|kl) = \braket{ik|jl} =
    \int {\psi_i^*({\bf x})\psi_j({\bf x})\psi_k^*({\bf x}')\psi_l({\bf x}')
        \over | {\bf x} - {\bf x}' |} \d^3 x \d^3 x' =\\    = \int {\psi_i^*({\bf x}')\psi_j({\bf x}')
        \psi_k^*({\bf x})\psi_l({\bf x})
        \over | {\bf x}' - {\bf x} |} \d^3 x' \d^3 x
    = (kl|ij) = \braket{ki|lj}\end{aligned}\end{align} \]</div>
<p>and taking complex conjugate:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(ij|kl)^*
= \braket{ik|jl}^* =
    \left(
    \int {\psi_i^*({\bf x})\psi_k^*({\bf x}')\psi_j({\bf x})\psi_l({\bf x}')
        \over | {\bf x} - {\bf x}' |} \d^3 x \d^3 x'\right)^* =\\    =
    \int {\psi_i({\bf x})\psi_k({\bf x}')\psi_j^*({\bf x})\psi_l^*({\bf x}')
        \over | {\bf x} - {\bf x}' |} \d^3 x \d^3 x' =
    \braket{jl|ik} = (ji|lk)\end{aligned}\end{align} \]</div>
<p>If the matrix elements are real, then:</p>
<div class="math notranslate nohighlight">
\[(ij|kl) = \braket{ik|jl} =
    \braket{jl|ik} = (ji|lk)\]</div>
<p>In general those are the only symmetries (4 total).</p>
<p>If however,
the <span class="math notranslate nohighlight">\(\psi_i({\bf x})\)</span> functions are real, then there are additional symmetries:
an exchange <span class="math notranslate nohighlight">\(i \leftrightarrow j\)</span> and <span class="math notranslate nohighlight">\(k \leftrightarrow l\)</span>.
The symmetries of <span class="math notranslate nohighlight">\((ij|kl)\)</span> are exchange of <span class="math notranslate nohighlight">\(i\)</span> with <span class="math notranslate nohighlight">\(j\)</span> or <span class="math notranslate nohighlight">\(k\)</span> with <span class="math notranslate nohighlight">\(l\)</span> or the
<span class="math notranslate nohighlight">\(ij\)</span> and <span class="math notranslate nohighlight">\(kl\)</span> pairs (8 total):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(ij|kl) = (ji|kl) = (ij|lk) = (ji|lk) =\\= (kl|ij) = (lk|ij) = (kl|ji) = (lk|ji)\end{aligned}\end{align} \]</div>
<p>So if we view <span class="math notranslate nohighlight">\((ij|kl)\)</span> as two boxes <span class="math notranslate nohighlight">\((\cdot | \cdot )\)</span> then we can permute the
labels in the given box “<span class="math notranslate nohighlight">\(\cdot\)</span>”, as well as exchange the boxes (the only
thing we cannot do is to take one particle from one box and put it into the
other). As such the box “<span class="math notranslate nohighlight">\(\cdot\)</span>” is a pair of two electrons (in any order) and
the two electron integral assigns a unique number to a pair of such boxes (in
any order). The symmetries of the <span class="math notranslate nohighlight">\(\braket{ik|jl}\)</span> symbol are:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\braket{ik|jl} = \braket{jk|il} = \braket{il|jk} = \braket{jl|ik} =\\= \braket{ki|lj} = \braket{li|kj} = \braket{kj|li} = \braket{lj|ki}\end{aligned}\end{align} \]</div>
<p>Example I: the Slater integral <span class="math notranslate nohighlight">\(R^k(i, j, k, l)\)</span> has all 8 symmetries (Slater
integral uses physical notation).</p>
<p>Example II: In spherical symmetry, the 2-particle integrals can be written as
(see below for derivation):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\braket{\alpha \beta | \gamma \delta}
=
\braket{n_\alpha l_\alpha m_\alpha \ n_\beta l_\beta m_\beta |
n_\gamma l_\gamma m_\gamma \ n_\delta l_\delta m_\delta}
= (n_\alpha  l_\alpha m_\alpha \ n_\gamma l_\gamma m_\gamma |
n_\beta l_\beta m_\beta \ n_\delta l_\delta m_\delta) =\\=
\sum_{k=\max(| l_\alpha-l_\gamma| ,| l_\beta-l_\delta| , | m_\alpha-m_\gamma| )}^{
    \min(l_\alpha+l_\gamma, l_\beta+l_\delta)
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_\alpha, m_\alpha, l_\gamma, m_\gamma)
c^k(l_\delta, m_\delta, l_\beta, m_\beta)\\\delta_{m_\alpha+m_\beta- m_\gamma-m_\delta, 0}\\R^k(n_\alpha l_\alpha, n_\beta l_\beta, n_\gamma l_\gamma,
    n_\delta l_\delta)\end{aligned}\end{align} \]</div>
<p>They only have 4 symmetries, because spherical harmonics are complex. In
particular:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\braket{\beta \alpha | \delta \gamma}
=
\sum_{k=\max(| l_\beta-l_\delta| ,| l_\alpha-l_\gamma| , | m_\beta-m_\delta| )}^{
    \min(l_\beta+l_\delta, l_\alpha+l_\gamma)
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_\beta, m_\beta, l_\delta, m_\delta)
c^k(l_\gamma, m_\gamma, l_\alpha, m_\alpha)\\\delta_{m_\beta+m_\alpha- m_\delta-m_\gamma, 0}\\R^k(n_\beta l_\beta, n_\alpha l_\alpha, n_\delta l_\delta,
    n_\gamma l_\gamma) =\\= \sum_{k=\max(| l_\beta-l_\delta|, | l_\alpha-l_\gamma|,
    | m_\beta-m_\delta| )}^{\min(l_\beta+l_\delta, l_\alpha+l_\gamma)
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_\alpha, m_\alpha, l_\gamma, m_\gamma)
c^k(l_\delta, m_\delta, l_\beta, m_\beta)
(-1)^{m_\alpha-m_\gamma + m_\beta-m_\delta}\\\delta_{m_\beta+m_\alpha- m_\delta-m_\gamma, 0}\\R^k(n_\alpha l_\alpha, n_\beta l_\beta, n_\gamma l_\gamma,
    n_\delta l_\delta) = \braket{\alpha \beta | \gamma \delta}\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\braket{\gamma \delta | \alpha \beta}
=
\braket{n_\gamma l_\gamma m_\gamma \ n_\delta l_\delta m_\delta |
n_\alpha l_\alpha m_\alpha \ n_\beta l_\beta m_\beta}
= (n_\gamma  l_\gamma m_\gamma \ n_\alpha l_\alpha m_\alpha |
n_\delta l_\delta m_\delta \ n_\beta l_\beta m_\beta) =\\=
\sum_{k=\max(| l_\gamma-l_\alpha| ,| l_\delta-l_\beta| , |
m_\gamma-m_\alpha| )}^{
    \min(l_\gamma+l_\alpha, l_\delta+l_\beta)
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_\gamma, m_\gamma, l_\alpha, m_\alpha)
c^k(l_\beta, m_\beta, l_\delta, m_\delta)\\\delta_{m_\gamma+m_\delta- m_\alpha-m_\beta, 0}\\R^k(n_\gamma l_\gamma, n_\delta l_\delta, n_\alpha l_\alpha,
    n_\beta l_\beta)\\=
\braket{\alpha \beta | \gamma \delta}\end{aligned}\end{align} \]</div>
<p>We used the symmetries of the Slater integrals as well as the <span class="math notranslate nohighlight">\(c^k\)</span>
coefficients that change a sign, but thanks to the <span class="math notranslate nohighlight">\(\delta_{m_\gamma+m_\delta-
m_\alpha-m_\beta, 0}\)</span>, the overall sign does not change. The other two
symmetries are missing, i.e.
<span class="math notranslate nohighlight">\(\braket{\gamma \beta | \alpha \delta} \ne
\braket{\alpha \beta | \gamma \delta}\)</span> and
<span class="math notranslate nohighlight">\(\braket{\alpha \delta | \gamma \beta} \ne
\braket{\alpha \beta | \gamma \delta}\)</span>.</p>
</div>
<div class="section" id="general-matrix-elements-in-spherical-symmetry">
<h2>8.11.4. General Matrix Elements in Spherical Symmetry<a class="headerlink" href="#general-matrix-elements-in-spherical-symmetry" title="Permalink to this headline">¶</a></h2>
<p>Spherical symmetry is this particular choice of a basis:</p>
<div class="math notranslate nohighlight">
\[\phi_\mu({\bf x}) =
\phi_{n_\mu l_\mu m_\mu}({\bf x}) =
    {\phi_{n_\mu l_\mu}(r)\over r} Y_{l_\mu m_\mu}(\Omega)\]</div>
<p>It can be shown that the solutions are of the form:</p>
<div class="math notranslate nohighlight">
\[\psi_i({\bf x}) = \psi_{nlm}({\bf x}) = {P_{n l}(r)\over r} Y_{l m}(\Omega)\]</div>
<p>We can now write:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\psi_i({\bf x}) = \sum_\nu C_{\nu i} \phi_\nu({\bf x})\\\int \phi_\mu({\bf x})\psi_i({\bf x}) \d^3 x
    = \sum_\nu S_{\mu\nu} C_{\nu i}\\\sum_{\mu} S_{\mu\nu}^{-1} \int \phi_\mu({\bf x})\psi_i({\bf x}) \d^3 x
    = C_{\nu i}\\\sum_{\mu}
    \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu}
    \left(S_{n_\mu n_\nu}^{l_\mu}\right)^{-1}
    \int \phi_{n_\mu l_\mu m_\mu}({\bf x})
    \psi_{nlm}({\bf x}) \d^3 x
    = C_{n_\nu l_\nu m_\nu; n l m}\\\sum_{\mu}
    \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu}
    \left(S_{n_\mu n_\nu}^{l_\mu}\right)^{-1}
    \int
        {\phi_{n_\mu l_\mu}(r)\over r} Y_{l_\mu m_\mu}(\Omega)
        {P_{n l}(r)\over r} Y_{l m}(\Omega)
    r^2 \d r \d \Omega
    = C_{n_\nu l_\nu m_\nu; n l m}\\\sum_{\mu}
    \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu}
    \left(S_{n_\mu n_\nu}^{l_\mu}\right)^{-1}
    \int
        \phi_{n_\mu l_\mu}(r)
        P_{n l}(r) \d r \delta_{l l_\mu} \delta_{m m_\mu}
    = C_{n_\nu l_\nu m_\nu; n l m}\\    \delta_{l l_\nu} \delta_{m m_\nu}
\sum_{n_\mu}
    \left(S_{n_\mu n_\nu}^{l}\right)^{-1}
    \int
        \phi_{n_\mu l}(r)
        P_{n l}(r) \d r
    = C_{n_\nu l_\nu m_\nu; n l m}\\    \delta_{l l_\nu} \delta_{m m_\nu}
    C_{n_\nu n}^l
    = C_{n_\nu l_\nu m_\nu; n l m}\end{aligned}\end{align} \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[    C_{n_\nu n}^l =
\sum_{n_\mu}
    \left(S_{n_\mu n_\nu}^{l}\right)^{-1}
    \int
        \phi_{n_\mu l}(r)
        P_{n l}(r) \d r\]</div>
<p>Also we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\psi_{nlm}({\bf x}) = \sum_\nu
    C_{n_\nu l_\nu m_\nu; n l m} \phi_{n_\nu l_\nu m_\nu}({\bf x})\\{P_{n l}(r)\over r} Y_{l m}(\Omega) = \sum_\nu
    C_{n_\nu l_\nu m_\nu; n l m}
        {\phi_{n_\nu l_\nu}(r)\over r} Y_{l_\nu m_\nu}(\Omega) =\\= \sum_\nu
    \delta_{l l_\nu} \delta_{m m_\nu}
    C_{n_\nu n}^l
        {\phi_{n_\nu l_\nu}(r)\over r} Y_{l_\nu m_\nu}(\Omega) =\\= \sum_{n_\nu}
    C_{n_\nu n}^l
        {\phi_{n_\nu l}(r)\over r} Y_{l m}(\Omega)\end{aligned}\end{align} \]</div>
<p>From which it follows:</p>
<div class="math notranslate nohighlight">
\[P_{n l}(r) = \sum_{n_\nu} C_{n_\nu n}^l \phi_{n_\nu l}(r)\]</div>
<p>The <span class="math notranslate nohighlight">\(\mu\)</span> index runs over all combinations of <span class="math notranslate nohighlight">\(n l m\)</span>.
In particular, here is an example of one possible way to index the
basis of 12 radial functions for each <span class="math notranslate nohighlight">\(l\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{r|rrr}
    \mu &amp; n_\mu &amp; l_\mu &amp; m_\mu \\
    \hline
    1 &amp; 1 &amp; 0 &amp; 0 \\
    2 &amp; 2 &amp; 0 &amp; 0 \\
    3 &amp; 3 &amp; 0 &amp; 0 \\
    \cdots &amp; \cdots &amp; &amp;  \\
    12 &amp; 12 &amp; 0 &amp; 0 \\
    13 &amp; 1 &amp; 1 &amp; -1 \\
    14 &amp; 2 &amp; 1 &amp; -1 \\
    15 &amp; 3 &amp; 1 &amp; -1 \\
    \cdots &amp; \cdots &amp; &amp;  \\
    24 &amp; 12 &amp; 1 &amp; -1 \\
    25 &amp; 1 &amp; 1 &amp; 0 \\
    26 &amp; 2 &amp; 1 &amp; 0 \\
    27 &amp; 3 &amp; 1 &amp; 0 \\
    \cdots &amp; \cdots &amp; &amp;  \\
    36 &amp; 12 &amp; 1 &amp; 0 \\
    37 &amp; 1 &amp; 1 &amp; 1 \\
    38 &amp; 2 &amp; 1 &amp; 1 \\
    39 &amp; 3 &amp; 1 &amp; 1 \\
    \cdots &amp; \cdots &amp; &amp;  \\
    48 &amp; 12 &amp; 1 &amp; 1 \\
    49 &amp; 1 &amp; 2 &amp; -2 \\
    50 &amp; 2 &amp; 2 &amp; -2 \\
    51 &amp; 3 &amp; 2 &amp; -2 \\
    \cdots &amp; \cdots &amp; &amp;  \\
\end{array}\end{split}\]</div>
<p>So the radial index <span class="math notranslate nohighlight">\(n_\mu\)</span> always starts from 1 for each <span class="math notranslate nohighlight">\(l_\mu\)</span>.</p>
<div class="section" id="overlap">
<h3>Overlap<a class="headerlink" href="#overlap" title="Permalink to this headline">¶</a></h3>
<p>The overlap matrix element</p>
<div class="math notranslate nohighlight">
\[S_{\mu\nu} = \int \phi_\mu^*({\bf x}) \phi_\nu({\bf x})\d^3 x\]</div>
<p>becomes</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}S_{\mu\nu} = S_{n_\mu l_\mu m_\mu n_\nu l_\nu m_\nu}
    = \int {\phi_{n_\mu l_\mu}(r)\over r}
    Y_{l_\mu m_\mu}^*(\Omega)
    {\phi_{n_\nu l_\nu}(r)\over r} Y_{l_\nu m_\nu}(\Omega)
        r^2 \d r \d \Omega=\\= \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu} \int_0^\infty
    \phi_{n_\mu l_\mu}(r) \phi_{n_\nu l_\nu}(r) \d r =\\= \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu} \int_0^\infty
    \phi_{n_\mu l_\mu}(r) \phi_{n_\nu l_\mu}(r) \d r =\\= \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu} S^{l_\mu}_{n_\mu n_\nu}\end{aligned}\end{align} \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[S^l_{n_\mu n_\nu} = \int_0^\infty \phi_{n_\mu l}(r) \phi_{n_\nu l}(r) \d r\]</div>
</div>
<div class="section" id="potential">
<h3>Potential<a class="headerlink" href="#potential" title="Permalink to this headline">¶</a></h3>
<p>The potential matrix element</p>
<div class="math notranslate nohighlight">
\[V_{\mu\nu} = \int \phi_\mu^*({\bf x}) \left(-{Z\over |{\bf x}|}\right)
    \phi_\nu({\bf x})\d^3 x\]</div>
<p>becomes</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}V_{\mu\nu} =
V_{n_\mu l_\mu m_\mu n_\nu l_\nu m_\nu} = \int {\phi_{n_\mu l_\mu}(r)
    \over r}
    Y_{l_\mu m_\mu}^*(\Omega)
    \left(-{Z\over r}\right)
    {\phi_{n_\nu l_\nu}(r)\over r} Y_{l_\nu m_\nu}(\Omega)
        r^2 \d r \d \Omega=\\= \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu} \int_0^\infty
    \phi_{n_\mu l_\mu}(r)
    \left(-{Z\over r}\right)
    \phi_{n_\nu l_\nu}(r) \d r =\\= \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu} \int_0^\infty
    \phi_{n_\mu l_\mu}(r)
    \left(-{Z\over r}\right)
    \phi_{n_\nu l_\mu}(r) \d r =\\= \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu} V^{l_\mu}_{n_\mu n_\nu}\end{aligned}\end{align} \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[V^l_{n_\mu n_\nu} = \int_0^\infty \phi_{n_\mu l}(r)
    \left(-{Z\over r}\right) \phi_{n_\nu l}(r) \d r\]</div>
</div>
<div class="section" id="kinetic">
<h3>Kinetic<a class="headerlink" href="#kinetic" title="Permalink to this headline">¶</a></h3>
<p>The kinetic matrix element</p>
<div class="math notranslate nohighlight">
\[T_{\mu\nu} =
        \int \phi_\mu^*({\bf x}) \left(-\half \nabla^2 \right)
        \phi_\nu({\bf x}) \d^3 x\]</div>
<p>becomes</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}T_{\mu\nu} =
T_{n_\mu l_\mu m_\mu n_\nu l_\nu m_\nu}
    = \int {\phi_{n_\mu l_\mu}(r)\over r} Y_{l_\mu m_\mu}^*(\Omega)
        \left(\left(-\half \nabla^2\right)
        {\phi_{n_\nu l_\nu}(r)\over r} Y_{l_\nu m_\nu}(\Omega)
        \right) r^2 \d r \d \Omega =\\    = \int {\phi_{n_\mu l_\mu}(r)\over r} Y_{l_\mu m_\mu}^*(\Omega)
        \left(\left(-\half {\partial^2\over\partial r^2}
            -{1\over r}{\partial\over\partial r}
            +{l_\nu (l_\nu+1)\over 2r^2}\right)
        {\phi_{n_\nu l_\nu}(r)\over r} Y_{l_\nu m_\nu}(\Omega) \right)
        r^2 \d r \d \Omega =\\    = \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu}
    \int_0^\infty {\phi_{n_\mu l_\mu}(r)\over r}
        \left(\left(-\half {\partial^2\over\partial r^2}
            -{1\over r}{\partial\over\partial r}
            +{l_\mu (l_\mu+1)\over 2r^2}\right)
        {\phi_{n_\nu l_\nu}(r)\over r} \right) r^2 \d r =\\    = \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu} T^{l_\mu}_{\mu\nu}\end{aligned}\end{align} \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}T^l_{n_\mu n_\nu} =
    \int_0^\infty {\phi_{n_\mu l}(r)\over r}
        \left(\left(-\half {\partial^2\over\partial r^2}
            -{1\over r}{\partial\over\partial r}
            +{l (l+1)\over 2r^2}\right)
        {\phi_{n_\nu l}(r)\over r} \right) r^2 \d r =\\    = \int_0^\infty {\phi_{n_\mu l}(r)\over r}
        \left(\left(-{1\over 2r} {\partial^2\over\partial r^2}r
            +{l (l+1)\over 2 r^2}\right)
        {\phi_{n_\nu l}(r)\over r} \right) r^2 \d r =\\    = \int_0^\infty \phi_{n_\mu l}(r)
        \left(-\half {\partial^2\over\partial r^2}
            +{l (l+1)\over 2 r^2}\right)
        \phi_{n_\nu l}(r) \d r =\\    = \int_0^\infty \left( -\half \phi_{n_\mu l}(r) \phi_{n_\nu l}''(r)
            +\phi_{n_\mu l}(r) {l (l+1)\over 2 r^2} \phi_{n_\nu l}(r)\right)
        \d r =\\    = \int_0^\infty \left( \half \phi_{n_\mu l}'(r) \phi_{n_\nu l}'(r)
            +\phi_{n_\mu l}(r) {l (l+1)\over 2 r^2} \phi_{n_\nu l}(r)\right)
        \d r\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="g-matrix">
<h3>G Matrix<a class="headerlink" href="#g-matrix" title="Permalink to this headline">¶</a></h3>
<p>The G matrix is given by:</p>
<div class="math notranslate nohighlight">
\[G_{\mu\nu} = \sum_{\alpha\beta} P_{\alpha\beta}
        \left(\braket{\mu \beta|\nu \alpha}
            -\half \braket{\mu \beta|\alpha \nu}\right)
    = \sum_{\alpha\beta} P_{\alpha\beta}
        \left((\mu \nu|\beta \alpha) -\half (\mu \alpha|\beta \nu)\right)\]</div>
<p>Now we use:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\braket{\alpha \beta | \gamma \delta}
=
\braket{n_\alpha l_\alpha m_\alpha \ n_\beta l_\beta m_\beta |
n_\gamma l_\gamma m_\gamma \ n_\delta l_\delta m_\delta}
= (n_\alpha  l_\alpha m_\alpha \ n_\gamma l_\gamma m_\gamma |
n_\beta l_\beta m_\beta \ n_\delta l_\delta m_\delta) =\\=
\sum_{k=\max(| l_\alpha-l_\gamma| ,| l_\beta-l_\delta| , | m_\alpha-m_\gamma| )}^{
    \min(l_\alpha+l_\gamma, l_\beta+l_\delta)
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_\alpha, m_\alpha, l_\gamma, m_\gamma)
c^k(l_\delta, m_\delta, l_\beta, m_\beta)\\\delta_{m_\alpha+m_\beta- m_\gamma-m_\delta, 0}\\R^k(n_\alpha l_\alpha, n_\beta l_\beta, n_\gamma l_\gamma,
    n_\delta l_\delta)\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P_{\alpha\beta} = 2 \sum_{i} C_{\alpha i} C_{\beta i}\\P_{n_\alpha l_\alpha m_\alpha; n_\beta l_\beta m_\beta}
    = 2 \sum_{i}
        C_{n_\alpha l_\alpha m_\alpha; n_i l_i m_i}
        C_{n_\beta l_\beta m_\beta; n_i l_i m_i} =\\    = 2 \sum_{i}
        \delta_{l_i l_\alpha} \delta_{m_i m_\alpha}
        \delta_{l_i l_\beta} \delta_{m_i m_\beta}
        C_{n_\alpha n_i}^{l_i}
        C_{n_\beta n_i}^{l_i} =\\    = 2 \delta_{l_\alpha l_\beta}\delta_{m_\alpha m_\beta}
        \sum_{n_i}
        C_{n_\alpha n_i}^{l_\alpha}
        C_{n_\beta n_i}^{l_\alpha} =\\    = \delta_{l_\alpha l_\beta}\delta_{m_\alpha m_\beta}
        P^{l_\alpha}_{n_\alpha n_\beta}\end{aligned}\end{align} \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[P^l_{n_\alpha n_\beta} = 2 \sum_{n_i} C_{n_\alpha n_i}^l C_{n_\beta n_i}^l\]</div>
<p>Where the sum over all occupied orbitals <span class="math notranslate nohighlight">\(i\)</span> can be written as:</p>
<div class="math notranslate nohighlight">
\[\sum_i = \sum_{n_i l_i m_i} = \sum_{l=0}^\infty \sum_{m_l=-l}^l
    \sum_{n_l=1}^\infty\]</div>
<p>Where the sum over <span class="math notranslate nohighlight">\(l\)</span> is the outer sum, both <span class="math notranslate nohighlight">\(m=m_l\)</span> and <span class="math notranslate nohighlight">\(n=n_l\)</span> depend on <span class="math notranslate nohighlight">\(l\)</span>.
We get:</p>
<div class="math notranslate nohighlight">
\[G_{\mu\nu} =
G_{n_\mu l_\mu m_\mu n_\nu l_\nu m_\nu} =
        \sum_{n_\alpha l_\alpha m_\alpha n_\beta l_\beta m_\beta}
        P_{n_\alpha l_\alpha m_\alpha n_\beta l_\beta m_\beta}
        \left(\braket{\mu \beta|\nu \alpha}
            -\half \braket{\mu \beta|\alpha \nu}\right)
= J_{\mu\nu} - K_{\mu\nu}\]</div>
<p>The first part is the direct term, the second part the exchange term.
Let’s treat the direct term first:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}J_{\mu\nu} = \sum_{n_\alpha l_\alpha m_\alpha n_\beta l_\beta m_\beta}
        P_{n_\alpha l_\alpha m_\alpha n_\beta l_\beta m_\beta}
        \braket{\mu \beta|\nu \alpha} =\\= \sum_{n_\alpha l_\alpha m_\alpha n_\beta l_\beta m_\beta}
        P_{n_\alpha l_\alpha m_\alpha n_\beta l_\beta m_\beta}
\sum_{k=\max(| l_\mu-l_\nu| ,| l_\beta-l_\alpha|,
    | m_\mu-m_\nu| )}^{
    \min(l_\mu+l_\nu, l_\beta+l_\alpha)
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_\mu, m_\mu, l_\nu, m_\nu)
c^k(l_\alpha, m_\alpha, l_\beta, m_\beta)\\\delta_{m_\mu+m_\beta- m_\nu-m_\alpha, 0}\\R^k(n_\mu l_\mu, n_\beta l_\beta, n_\nu l_\nu, n_\alpha l_\alpha) =\\= \sum_{n_\alpha l_\alpha m_\alpha n_\beta l_\beta m_\beta}
    \delta_{l_\alpha l_\beta} \delta_{m_\alpha m_\beta}
    P^{l_\alpha}_{n_\alpha n_\beta}
\sum_{k=\max(| l_\mu-l_\nu| ,| l_\beta-l_\alpha|,
    | m_\mu-m_\nu| )}^{
    \min(l_\mu+l_\nu, l_\beta+l_\alpha)
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_\mu, m_\mu, l_\nu, m_\nu)
c^k(l_\alpha, m_\alpha, l_\beta, m_\beta)\\\delta_{m_\mu+m_\beta- m_\nu-m_\alpha, 0}\\R^k(n_\mu l_\mu, n_\beta l_\beta, n_\nu l_\nu, n_\alpha l_\alpha) =\\= \sum_{n_\alpha n_\beta} \sum_{l m}
    P^{l}_{n_\alpha n_\beta}
\sum_{k=\max(| l_\mu-l_\nu| , | m_\mu-m_\nu| )}^{
    \min(l_\mu+l_\nu, 2l)
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_\mu, m_\mu, l_\nu, m_\nu)
c^k(l, m, l, m)\\\delta_{m_\mu- m_\nu, 0}\\R^k(n_\mu l_\mu, n_\beta l, n_\nu l_\nu, n_\alpha l) =\\= \delta_{m_\mu  m_\nu}
\sum_{n_\alpha n_\beta} \sum_{l}
    P^{l}_{n_\alpha n_\beta}
c^0(l_\mu, m_\mu, l_\nu, m_\nu)
(2l+1)
R^0(n_\mu l_\mu, n_\beta l, n_\nu l_\nu, n_\alpha l) =\\= \delta_{l_\mu l_\nu} \delta_{m_\mu  m_\nu}
 \sum_{l}
(2l+1)\sum_{n_\alpha n_\beta}
    P^{l}_{n_\alpha n_\beta}
R^0(n_\mu l_\mu, n_\beta l, n_\nu l_\mu, n_\alpha l)\end{aligned}\end{align} \]</div>
<p>For the exchange term we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}K_{\mu\nu} = \half \sum_{n_\alpha l_\alpha m_\alpha n_\beta l_\beta m_\beta}
        P_{n_\alpha l_\alpha m_\alpha n_\beta l_\beta m_\beta}
        \braket{\mu \beta|\alpha \nu} =\\= \half \sum_{n_\alpha l_\alpha m_\alpha n_\beta l_\beta m_\beta}
        P_{n_\alpha l_\alpha m_\alpha n_\beta l_\beta m_\beta}
\sum_{k=\max(| l_\mu-l_\alpha| ,| l_\beta-l_\nu|,
    | m_\mu-m_\alpha| )}^{
    \min(l_\mu+l_\alpha, l_\beta+l_\nu)
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_\mu, m_\mu, l_\alpha, m_\alpha)
c^k(l_\nu, m_\nu, l_\beta, m_\beta)\\\delta_{m_\mu+m_\beta- m_\alpha-m_\nu, 0}\\R^k(n_\mu l_\mu, n_\beta l_\beta, n_\alpha l_\alpha, n_\nu l_\nu) =\\
= \half \sum_{n_\alpha l_\alpha m_\alpha n_\beta l_\beta m_\beta}
    \delta_{l_\alpha l_\beta} \delta_{m_\alpha m_\beta}
    P^{l_\alpha}_{n_\alpha n_\beta}
\sum_{k=\max(| l_\mu-l_\alpha| ,| l_\beta-l_\nu|,
    | m_\mu-m_\alpha| )}^{
    \min(l_\mu+l_\alpha, l_\beta+l_\nu)
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_\mu, m_\mu, l_\alpha, m_\alpha)
c^k(l_\nu, m_\nu, l_\beta, m_\beta)\\\delta_{m_\mu+m_\beta- m_\alpha-m_\nu, 0}\\R^k(n_\mu l_\mu, n_\beta l_\beta, n_\alpha l_\alpha, n_\nu l_\nu) =\\
= \half \delta_{m_\mu m_\nu}
\sum_{n_\alpha n_\beta} \sum_{l m}
    P^l_{n_\alpha n_\beta}
\sum_{k=\max(| l_\mu-l| ,| l-l_\nu|,
    | m_\mu-m| )}^{
    \min(l_\mu+l, l+l_\nu)
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_\mu, m_\mu, l, m)
c^k(l_\nu, m_\nu, l, m)\\R^k(n_\mu l_\mu, n_\beta l, n_\alpha l, n_\nu l_\nu) =\\= \half \delta_{m_\mu m_\nu}
\sum_{n_\alpha n_\beta} \sum_{l m}
    P^l_{n_\alpha n_\beta}
\sum_{k=\max(| l_\mu-l| ,| l-l_\nu|,
    | m_\mu-m| )}^{
    \min(l_\mu+l, l+l_\nu)
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_\mu, m_\mu, l, m)
c^k(l_\nu, m_\mu, l, m)\\R^k(n_\mu l_\mu, n_\beta l, n_\alpha l, n_\nu l_\nu)\end{aligned}\end{align} \]</div>
<p>For <span class="math notranslate nohighlight">\(l_\mu = l_\nu\)</span> this can be written as:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}K_{\mu\nu} = \half \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu}
\sum_{n_\alpha n_\beta} \sum_{l m}
    P^l_{n_\alpha n_\beta}
\sum_{k=\max(| l_\mu-l|,
    | m_\mu-m| )}^{l_\mu+l}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_\mu, m_\mu, l, m)
c^k(l_\mu, m_\mu, l, m)\\R^k(n_\mu l_\mu, n_\beta l, n_\alpha l, n_\nu l_\mu) =\\= \half \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu}
\sum_{n_\alpha n_\beta} \sum_{l}
    P^l_{n_\alpha n_\beta}
\sum_{k=| l_\mu-l|}^{l_\mu+l}
\sqrt{2l+1 \over 2l_\mu +1}
c^k(l_\mu, 0, l, 0)\\R^k(n_\mu l_\mu, n_\beta l, n_\alpha l, n_\nu l_\mu) =\\\begin{split}= \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu}
\sum_{l}
(2l+1)
\sum_{n_\alpha n_\beta}
    P^l_{n_\alpha n_\beta}
\sum_{k=| l_\mu-l|}^{l_\mu+l}
\half
\begin{pmatrix} l_\mu &amp; k &amp; l \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2\end{split}\\R^k(n_\mu l_\mu, n_\beta l, n_\alpha l, n_\nu l_\mu)\end{aligned}\end{align} \]</div>
<p>All together we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}G_{\mu\nu}
= \delta_{l_\mu l_\nu} \delta_{m_\mu  m_\nu}
 \sum_{l}
(2l+1)\sum_{n_\alpha n_\beta}
    P^{l}_{n_\alpha n_\beta}\\\begin{split}\left(
    R^0(n_\mu l_\mu, n_\beta l, n_\nu l_\mu, n_\alpha l)
-
\sum_{k=| l_\mu-l|}^{l_\mu+l}
\half
\begin{pmatrix} l_\mu &amp; k &amp; l \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
R^k(n_\mu l_\mu, n_\beta l, n_\alpha l, n_\nu l_\mu) \right) =\end{split}\\= \delta_{l_\mu l_\nu} \delta_{m_\mu  m_\nu} G^{l_\mu}_{n_\mu n_\nu}\end{aligned}\end{align} \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}G^{l}_{n_\mu n_\nu} =
 \sum_{l'}
(2l'+1)\sum_{n_\alpha n_\beta}
    P^{l'}_{n_\alpha n_\beta}\\\begin{split}\left(
    R^0(n_\mu l, n_\beta l', n_\nu l, n_\alpha l')
-
\sum_{k=| l-l'| }^{l+l'}
\half
\begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
R^k(n_\mu l, n_\beta l', n_\alpha l', n_\nu l) \right)\end{split}\end{aligned}\end{align} \]</div>
<p>Note: performing the sum over <span class="math notranslate nohighlight">\(n_\alpha\)</span> and <span class="math notranslate nohighlight">\(n_\beta\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}G^{l}_{n_\mu n_\nu} =
 \sum_{l'}
2(2l'+1)\sum_{n'}\sum_{n_\alpha n_\beta}
    C^{l'}_{n_\alpha n'}C^{l'}_{n_\beta n'}\\\begin{split}\left(
    R^0(n_\mu l, n_\beta l', n_\nu l, n_\alpha l')
-
\sum_{k=| l-l'| }^{l+l'}
\half
\begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
R^k(n_\mu l, n_\beta l', n_\alpha l', n_\nu l) \right) =\end{split}\\=
 \sum_{l'}
2(2l'+1)\sum_{n'}\\\begin{split}\left(
    R^0(n_\mu l, n' l', n_\nu l, n' l')
-
\sum_{k=| l-l'| }^{l+l'}
\half
\begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
R^k(n_\mu l, n' l', n' l', n_\nu l) \right)\end{split}\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="radial-roothaan-equations">
<h3>Radial Roothaan Equations<a class="headerlink" href="#radial-roothaan-equations" title="Permalink to this headline">¶</a></h3>
<p>The Roothaan equations are:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\sum_\nu (T + V + G)_{\mu\nu} C_{\nu i} = \epsilon_i \sum_\nu S_{\mu\nu}
    C_{\nu i}\\\sum_\nu (T + V + G)_{n_\mu l_\mu m_\mu n_\nu l_\nu m_\nu}
    C_{n_\nu l_\nu m_\nu n_i l_i m_i} = \epsilon_{n_i l_i m_i}
        \sum_\nu S_{n_\mu l_\mu m_\mu n_\nu l_\nu m_\nu}
    C_{n_\nu l_\nu m_\nu n_i l_i m_i}\\\sum_\nu (T + V + G)_{n_\mu l_\mu m_\mu n_\nu l_\nu m_\nu}
    \delta_{l_i l_\nu} \delta_{m_i m_\nu}
    C_{n_\nu n_i}^{l_i} = \epsilon_{n_i l_i m_i}
        \sum_\nu S_{n_\mu l_\mu m_\mu n_\nu l_\nu m_\nu}
    \delta_{l_i l_\nu} \delta_{m_i m_\nu}
    C_{n_\nu n_i}^{l_i}\\\sum_{n_\nu} (T + V + G)_{n_\mu l_\mu m_\mu n_\nu l_i m_i}
    C_{n_\nu n_i}^{l_i} = \epsilon_{n_i l_i m_i}
        \sum_{n_\nu} S_{n_\mu l_\mu m_\mu n_\nu l_i m_i}
    C_{n_\nu n_i}^{l_i}\\\delta_{l_\mu l_i} \delta_{m_\mu m_i}
\sum_{n_\nu}
    (T + V + G)_{n_\mu n_\nu}^{l_i}
    C_{n_\nu n_i}^{l_i} =
        \delta_{l_\mu l_i} \delta_{m_\mu m_i}
    \epsilon_{n_i l_i m_i}
        \sum_{n_\nu}
        S_{n_\mu n_\nu}^{l_i}
    C_{n_\nu n_i}^{l_i}\end{aligned}\end{align} \]</div>
<p>The eigenvalues will be degenerate with respect to <span class="math notranslate nohighlight">\(m_i\)</span>
and so the radial Roothaan equations are to be solved for each <span class="math notranslate nohighlight">\(l\)</span>:</p>
<div class="math notranslate nohighlight">
\[\sum_{n_\nu}
    (T + V + G)_{n_\mu n_\nu}^l
    C_{n_\nu n_i}^l =
    \epsilon_{n_i l}
        \sum_{n_\nu}
        S_{n_\mu n_\nu}^l
    C_{n_\nu n_i}^l\]</div>
<p>The total energy is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}E = \half \sum_{\mu\nu} P_{\nu\mu} (H_{\mu\nu}^{\mbox{core}}
    +F_{\mu\nu}) =\\= \sum_{\mu\nu} P_{\nu\mu} (F_{\mu\nu} - \half G_{\mu\nu}) =\\= \sum_{\mu\nu}
    \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu} P_{n_\mu n_\nu}^{l_\mu}
    \delta_{l_\mu l_\nu} \delta_{m_\mu m_\nu}
    (F - \half G)^{l_\mu}_{n_\mu n_\nu} =\\= \sum_{l_\mu}\sum_{m_\mu}\sum_{n_\mu n_\nu}
    P_{n_\mu n_\nu}^{l_\mu}
    (F - \half G)^{l_\mu}_{n_\mu n_\nu} =\\= \sum_{l_\mu} \sum_{n_\mu n_\nu}
    (2l_\mu+1)
    P_{n_\mu n_\nu}^{l_\mu}
    (F - \half G)^{l_\mu}_{n_\mu n_\nu} =\\= \sum_l \sum_{n_\mu n_\nu}
    (2l+1)
    P_{n_\mu n_\nu}^l
    (F - \half G)^l_{n_\mu n_\nu} =\\= \sum_l \sum_{n_\mu n_\nu}
    (2l+1)
    \sum_n 2 C^l_{n_\mu n} C^l_{n_\nu n}
    (F^l_{n_\mu n_\nu} - \half G^l_{n_\mu n_\nu}) =\\= \sum_l \sum_{n_\mu n_\nu}
    (2l+1)
    \sum_n 2 C^l_{n_\mu n} C^l_{n_\nu n}
    \left(\epsilon_{n l} S^l_{n_\mu n_\nu} - \half
 \sum_{l'}
2(2l'+1)\sum_{n'} \right.\\\begin{split}\left.
\left(
    R^0(n_\mu l, n' l', n_\nu l, n' l')
-
\sum_{k=| l-l'| }^{l+l'}
\half
\begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
R^k(n_\mu l, n' l', n' l', n_\nu l) \right) \right) =\end{split}\\\begin{split}= \sum_l \sum_n 2(2l+1) \left( \epsilon_{n l}
    -\sum_{l'} \sum_{n'} (2l'+1)
    \left(
        R^0(n l, n' l', n l, n' l')
            -\half \sum_{k=|l-l'|}^{k=l+l'}
             \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            R^k(n l, n' l', n' l', n l) \right)
    \right)\end{split}\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="two-particle">
<h3>Two particle<a class="headerlink" href="#two-particle" title="Permalink to this headline">¶</a></h3>
<p>We use the following functions for <span class="math notranslate nohighlight">\(\psi\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\psi_i({\bf x}) = {P_{n_1l_1}(r)\over r} Y_{l_1m_1}(\Omega)\\\psi_j({\bf x}) = {P_{n_1'l_1'}(r)\over r} Y_{l_1'm_1'}(\Omega)\\\psi_k({\bf x}) = {P_{n_2l_2}(r)\over r} Y_{l_2m_2}(\Omega)\\\psi_l({\bf x}) = {P_{n_2'l_2'}(r)\over r} Y_{l_2'm_2'}(\Omega)\end{aligned}\end{align} \]</div>
<p>And the multipole expansion:</p>
<div class="math notranslate nohighlight">
\[{1\over |{\bf x}-{\bf x}'|}
    = \sum_{k,q}{r_{&lt;}^k\over r_{&gt;}^{k+1}}
        {4\pi\over 2k+1}Y_{kq}(\Omega)Y_{kq}^*(\Omega')\]</div>
<p>And we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(ij|kl) = \braket{ik|jl} = (1 1' | 2 2') = \braket{1 2 | 1' 2'} =\\= \braket{l_1 m_1 l_2 m_2 |
    {1\over |{\bf x} - {\bf x}'|} | l_1' m_1' l_2' m_2'} =\\=\int {\psi_i^*({\bf x})\psi_j({\bf x})\psi_k^*({\bf x}')\psi_l({\bf x}')
    \over |{\bf x} - {\bf x}'|} \d^3 x \d^3 x' =\\= \int
    {P_{n_1l_1}(r)\over r} Y_{l_1m_1}^*(\Omega)
    {P_{n_1'l_1'}(r)\over r} Y_{l_1'm_1'}(\Omega)
    {P_{n_2l_2}(r')\over r'} Y_{l_2m_2}^*(\Omega')
    {P_{n_2'l_2'}(r')\over r'} Y_{l_2'm_2'}(\Omega')\\    \sum_{k,q}{r_{&lt;}^k\over r_{&gt;}^{k+1}}
        {4\pi\over 2k+1}Y_{kq}(\Omega)Y_{kq}^*(\Omega')
    r^2 r'^2 \d r \d r' \d \Omega \d \Omega' =\\=
\sum_{k,q}
\int
    Y_{l_1m_1}^*(\Omega)
    Y_{l_1'm_1'}(\Omega)
    Y_{kq}(\Omega)
    \d \Omega
  \int
    Y_{l_2m_2}^*(\Omega')
    Y_{l_2'm_2'}(\Omega')
    Y_{kq}^*(\Omega')
    \d \Omega'\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
        {4\pi\over 2k+1}
    P_{n_1l_1}(r)
    P_{n_1'l_1'}(r)
    P_{n_2l_2}(r')
    P_{n_2'l_2'}(r')
    \d r \d r' =\\=
\sum_{k,q}
(-1)^{m_1+m_2+q}
\int
    Y_{l_1,-m_1}(\Omega)
    Y_{l_1'm_1'}(\Omega)
    Y_{kq}(\Omega)
    \d \Omega
  \int
    Y_{l_2,-m_2}(\Omega')
    Y_{l_2'm_2'}(\Omega')
    Y_{k,-q}(\Omega')
    \d \Omega'\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
        {4\pi\over 2k+1}
    P_{n_1l_1}(r)
    P_{n_1'l_1'}(r)
    P_{n_2l_2}(r')
    P_{n_2'l_2'}(r')
    \d r \d r' =\\\begin{split}=
\sum_{k,q}
(-1)^{m_1+m_2+q}
\sqrt{(2l_1+1)(2l_1'+1)(2k+1)\over 4\pi}
        \begin{pmatrix} l_1 &amp; l_1' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}
                \begin{pmatrix} l_1 &amp; l_1' &amp; k \\ -m_1 &amp; m_1' &amp; q
                \end{pmatrix}\end{split}\\\begin{split}\sqrt{(2l_2+1)(2l_2'+1)(2k+1)\over 4\pi}
        \begin{pmatrix} l_2 &amp; l_2' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}
                \begin{pmatrix} l_2 &amp; l_2' &amp; k \\ -m_2 &amp; m_2' &amp; -q
                \end{pmatrix}\end{split}\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
        {4\pi\over 2k+1}
    P_{n_1l_1}(r)
    P_{n_1'l_1'}(r)
    P_{n_2l_2}(r')
    P_{n_2'l_2'}(r')
    \d r \d r' =\\\begin{split}=
\sum_k
\sqrt{(2l_1+1)(2l_1'+1)(2l_2+1)(2l_2'+1)}
\begin{pmatrix} l_1 &amp; l_1' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}
\begin{pmatrix} l_2 &amp; l_2' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}\end{split}\\\begin{split}\sum_{q=-k}^k (-1)^{m_1+m_2+q}
    \begin{pmatrix} l_1 &amp; l_1' &amp; k \\ -m_1 &amp; m_1' &amp; q \end{pmatrix}
    \begin{pmatrix} l_2 &amp; l_2' &amp; k \\ -m_2 &amp; m_2' &amp; -q \end{pmatrix}\end{split}\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{n_1l_1}(r)
    P_{n_1'l_1'}(r)
    P_{n_2l_2}(r')
    P_{n_2'l_2'}(r')
    \d r \d r' =\\=
\sum_{k=\max(| l_1-l_1'| ,| l_2-l_2'| , | m_1-m_1'| )}^{
    \min(l_1+l_1', l_2+l_2')
}\!\!\!\!\!\!\!\!\!\!\!\!
\sqrt{(2l_1+1)(2l_1'+1)(2l_2+1)(2l_2'+1)}\\\begin{split}(-1)^{m_1+m_2'} \delta_{m_1+m_2- m_1'-m_2', 0}
\begin{pmatrix} l_1 &amp; l_1' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}
\begin{pmatrix} l_2 &amp; l_2' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}\end{split}\\\begin{split}    \begin{pmatrix} l_1 &amp; l_1' &amp; k \\ -m_1 &amp; m_1' &amp; m_1-m_1' \end{pmatrix}
    \begin{pmatrix} l_2 &amp; l_2' &amp; k \\ -m_2 &amp; m_2' &amp; m_2-m_2' \end{pmatrix}\end{split}\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{n_1l_1}(r)
    P_{n_1'l_1'}(r)
    P_{n_2l_2}(r')
    P_{n_2'l_2'}(r')
    \d r \d r'\end{aligned}\end{align} \]</div>
<p>In the last step we used the fact that the <span class="math notranslate nohighlight">\(3j\)</span> symbols are zero unless
<span class="math notranslate nohighlight">\(-m_1+m_1'+q=0\)</span>
and <span class="math notranslate nohighlight">\(-m_2+m_2'-q=0\)</span>, from which it follows
that <span class="math notranslate nohighlight">\(q=m_1-m_1'=-m_2+m_2'\)</span> and so one of the <span class="math notranslate nohighlight">\(3j\)</span> symbols is zero
unless <span class="math notranslate nohighlight">\(m_1+m_2-m_1'-m_2'=0\)</span>, which is expressed by
<span class="math notranslate nohighlight">\(\delta_{m_1+m_2- m_1'-m_2', 0}\)</span>.
Given this condition, the sum over <span class="math notranslate nohighlight">\(q\)</span> must be such
that one <span class="math notranslate nohighlight">\(q\)</span> is equal to <span class="math notranslate nohighlight">\(m_1-m_1'=-m_2+m_2'\)</span>, which means that
<span class="math notranslate nohighlight">\(k \ge |m_1 - m_1'| = |m_2 - m_2'|\)</span> otherwise the <span class="math notranslate nohighlight">\(3j\)</span> symbols will be zero.
Finally, <span class="math notranslate nohighlight">\(k\)</span> must also satisfy the conditions
<span class="math notranslate nohighlight">\(|l_1-l_1'| \le k \le l_1+l_1'\)</span> and <span class="math notranslate nohighlight">\(|l_2-l_2'| \le k \le l_2+l_2'\)</span>.
The sign factor
<span class="math notranslate nohighlight">\((-1)^{m_1+m_2+q} = (-1)^{m_1+m_2+m_1-m_1'} =(-1)^{m_1+m_2-m_2+m_2'}\)</span>
is equal to both <span class="math notranslate nohighlight">\((-1)^{m_1+m_2'}\)</span> and <span class="math notranslate nohighlight">\((-1)^{m_2-m_1'}\)</span> so we just used the
former.</p>
<p>We can write this using the <span class="math notranslate nohighlight">\(c^k\)</span> symbols as:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(ij|kl) =
\sum_{k=\max(| l_1-l_1'| ,| l_2-l_2'| , | m_1-m_1'| )}^{
    \min(l_1+l_1', l_2+l_2')
}\!\!\!\!\!\!\!\!\!\!\!\!
\sqrt{(2l_1+1)(2l_1'+1)(2l_2+1)(2l_2'+1)}\\\begin{split}(-1)^{m_2-m_2'} (-1)^{-m_1} (-1)^{-m_2} \delta_{m_1+m_2- m_1'-m_2', 0}
\begin{pmatrix} l_1 &amp; l_1' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}
\begin{pmatrix} l_2 &amp; l_2' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}\end{split}\\\begin{split}    \begin{pmatrix} l_1 &amp; l_1' &amp; k \\ -m_1 &amp; m_1' &amp; m_1-m_1' \end{pmatrix}
    \begin{pmatrix} l_2 &amp; l_2' &amp; k \\ -m_2 &amp; m_2' &amp; m_2-m_2' \end{pmatrix}\end{split}\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{n_1l_1}(r)
    P_{n_1'l_1'}(r)
    P_{n_2l_2}(r')
    P_{n_2'l_2'}(r')
    \d r \d r' =\\=
\sum_{k=\max(| l_1-l_1'| ,| l_2-l_2'| , | m_1-m_1'| )}^{
    \min(l_1+l_1', l_2+l_2')
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_1, m_1, l_1', m_1')
c^k(l_2, m_2, l_2', m_2')\\(-1)^{m_2-m_2'} \delta_{m_1+m_2- m_1'-m_2', 0}\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{n_1l_1}(r)
    P_{n_1'l_1'}(r)
    P_{n_2l_2}(r')
    P_{n_2'l_2'}(r')
    \d r \d r' =\\=
\sum_{k=\max(| l_1-l_1'| ,| l_2-l_2'| , | m_1-m_1'| )}^{
    \min(l_1+l_1', l_2+l_2')
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_1, m_1, l_1', m_1')
c^k(l_2', m_2', l_2, m_2)\\\delta_{m_1+m_2- m_1'-m_2', 0}\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{n_1l_1}(r)
    P_{n_1'l_1'}(r)
    P_{n_2l_2}(r')
    P_{n_2'l_2'}(r')
    \d r \d r' =\\=
\sum_{k=\max(| l_1-l_1'| ,| l_2-l_2'| , | m_1-m_1'| )}^{
    \min(l_1+l_1', l_2+l_2')
}\!\!\!\!\!\!\!\!\!\!\!\!
c^k(l_1, m_1, l_1', m_1')
c^k(l_2', m_2', l_2, m_2)\\\delta_{m_1+m_2- m_1'-m_2', 0}\\R^k(n_1 l_1, n_2 l_2, n_1' l_1', n_2' l_2')\end{aligned}\end{align} \]</div>
<p>We can also couple the angular momenta as follows:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\ket{l_1 l_2 LM} = \sum_{m_1 m_2} (l_1 m_1 l_2 m_2 | LM)
    \ket{l_1 m_1} \ket{l_2 m_2} =\\\begin{split}= \sum_{m_1 m_2} (-1)^{l_1-l_2+M}\sqrt{2L+1}
    \begin{pmatrix} l_1 &amp; l_2 &amp; L \\ m_1 &amp; m_2 &amp; -M \end{pmatrix}
    \ket{l_1 m_1} \ket{l_2 m_2}\end{split}\end{aligned}\end{align} \]</div>
<p>and we get for the matrix elements:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\braket{l_1 l_2 LM  | {1\over |{\bf x} - {\bf x}'|} | l_1' l_2' L' M'} =\\= \sum_{m_1 m_2} \sum_{m_1' m_2'} (-1)^{l_1-l_2+l_1'-l_2'+M+M'}
    \sqrt{(2L+1)(2L'+1)}\\\begin{split}    \begin{pmatrix} l_1 &amp; l_2 &amp; L \\ m_1 &amp; m_2 &amp; -M \end{pmatrix}
    \begin{pmatrix} l_1' &amp; l_2' &amp; L' \\ m_1' &amp; m_2' &amp; -M' \end{pmatrix}\end{split}\\    \bra{l_1 m_1} \bra{l_2 m_2}
    {1\over |{\bf x} - {\bf x}'|}
    \ket{l_1' m_1'} \ket{l_2 m_2'} =\\= \sum_{m_1 m_2} \sum_{m_1' m_2'} (-1)^{l_1-l_2+l_1'-l_2'+M+M'}
    \sqrt{(2L+1)(2L'+1)}\\\begin{split}    \begin{pmatrix} l_1 &amp; l_2 &amp; L \\ m_1 &amp; m_2 &amp; -M \end{pmatrix}
    \begin{pmatrix} l_1' &amp; l_2' &amp; L' \\ m_1' &amp; m_2' &amp; -M' \end{pmatrix}\end{split}\\    (ij|kl) =\\= \sum_{m_1 m_2} \sum_{m_1' m_2'} (-1)^{l_1-l_2+l_1'-l_2'+M+M'}
    \sqrt{(2L+1)(2L'+1)}\\\begin{split}    \begin{pmatrix} l_1 &amp; l_2 &amp; L \\ m_1 &amp; m_2 &amp; -M \end{pmatrix}
    \begin{pmatrix} l_1' &amp; l_2' &amp; L' \\ m_1' &amp; m_2' &amp; -M' \end{pmatrix}\end{split}\\\begin{split}\sum_k
\sqrt{(2l_1+1)(2l_1'+1)(2l_2+1)(2l_2'+1)}
\begin{pmatrix} l_1 &amp; l_1' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}
\begin{pmatrix} l_2 &amp; l_2' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}\end{split}\\\begin{split}\sum_{q=-k}^k (-1)^{m_1+m_2+q}
    \begin{pmatrix} l_1 &amp; l_1' &amp; k \\ -m_1 &amp; m_1' &amp; q \end{pmatrix}
    \begin{pmatrix} l_2 &amp; l_2' &amp; k \\ -m_2 &amp; m_2' &amp; -q \end{pmatrix}\end{split}\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{n_1l_1}(r)
    P_{n_1'l_1'}(r)
    P_{n_2l_2}(r')
    P_{n_2'l_2'}(r')
    \d r \d r' =\\= \sum_{m_1 m_2} \sum_{m_1' m_2'} (-1)^{l_1-l_2+l_1'-l_2'}
    (2L+1)\\\begin{split}    \delta_{MM'}\delta_{LL'}
    \begin{pmatrix} l_1 &amp; l_2 &amp; L \\ m_1 &amp; m_2 &amp; -M \end{pmatrix}
    \begin{pmatrix} l_1' &amp; l_2' &amp; L \\ m_1' &amp; m_2' &amp; -M \end{pmatrix}\end{split}\\\begin{split}\sum_k
\sqrt{(2l_1+1)(2l_1'+1)(2l_2+1)(2l_2'+1)}
\begin{pmatrix} l_1 &amp; l_1' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}
\begin{pmatrix} l_2 &amp; l_2' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}\end{split}\\\begin{split}\sum_{q=-k}^k (-1)^{m_1+m_2+q}
    \begin{pmatrix} l_1 &amp; l_1' &amp; k \\ -m_1 &amp; m_1' &amp; q \end{pmatrix}
    \begin{pmatrix} l_2 &amp; l_2' &amp; k \\ -m_2 &amp; m_2' &amp; -q \end{pmatrix}\end{split}\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{n_1l_1}(r)
    P_{n_1'l_1'}(r)
    P_{n_2l_2}(r')
    P_{n_2'l_2'}(r')
    \d r \d r' =\\= (-1)^{l_1-l_2+l_1'-l_2'} (2L+1)\\\begin{split}\sum_k
\sqrt{(2l_1+1)(2l_1'+1)(2l_2+1)(2l_2'+1)}
\begin{pmatrix} l_1 &amp; l_1' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}
\begin{pmatrix} l_2 &amp; l_2' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}\end{split}\\\begin{split}    \delta_{MM'}\delta_{LL'} (-1)^{l_1+l_1'+L}
\begin{Bmatrix} l_1 &amp; l_2 &amp; L \\ l_2' &amp; l_1' &amp; k \end{Bmatrix}\end{split}\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{n_1l_1}(r)
    P_{n_1'l_1'}(r)
    P_{n_2l_2}(r')
    P_{n_2'l_2'}(r')
    \d r \d r' =\\= \sum_k
  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{n_1l_1}(r)
    P_{n_1'l_1'}(r)
    P_{n_2l_2}(r')
    P_{n_2'l_2'}(r')
    \d r \d r'\\    (-1)^{L-l_2-l_2'} (2L+1)
    \delta_{MM'}\delta_{LL'}\sqrt{(2l_1+1)(2l_1'+1)(2l_2+1)(2l_2'+1)}\\\begin{split}\begin{pmatrix} l_1 &amp; l_1' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}
\begin{pmatrix} l_2 &amp; l_2' &amp; k \\ 0 &amp; 0 &amp; 0 \end{pmatrix}
\begin{Bmatrix} l_1 &amp; l_2 &amp; L \\ l_2' &amp; l_1' &amp; k \end{Bmatrix} =\end{split}\\= \sum_k
  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{n_1l_1}(r)
    P_{n_1'l_1'}(r)
    P_{n_2l_2}(r')
    P_{n_2'l_2'}(r')
    \d r \d r'\\    (-1)^{l_1 + l_1' + L} (2L+1)\\    \delta_{LL'}\delta_{MM'}\sqrt{(2l_1+1)(2l_1'+1)(2l_2+1)(2l_2'+1)}\\\begin{split}\begin{pmatrix} l_1 &amp; k &amp; l_1' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}
\begin{pmatrix} l_2 &amp; k &amp; l_2' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}
\begin{Bmatrix} l_1 &amp; l_2 &amp; L \\ l_2' &amp; l_1' &amp; k \end{Bmatrix}\end{split}\end{aligned}\end{align} \]</div>
<p>Where we used the <span class="math notranslate nohighlight">\(6j\)</span> symbol:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}\begin{Bmatrix} l_1 &amp; l_2 &amp; L \\ l_2' &amp; l_1' &amp; k \end{Bmatrix}
=\sum_{m_1 m_2 m_1' m_2' M q} (-1)^{l_1+l_2+l_1'+l_2'+L+k
    -m_1-m_2-m_1'-m_2'-M-q}\end{split}\\\begin{split}\begin{pmatrix} l_1 &amp; l_2 &amp; L \\ m_1 &amp; m_2 &amp; -M \end{pmatrix}
\begin{pmatrix} l_1 &amp; l_1' &amp; k \\ -m_1 &amp; m_1' &amp; q \end{pmatrix}
\begin{pmatrix} l_2' &amp; l_1' &amp; L \\ m_2' &amp; -m_1' &amp; M \end{pmatrix}
\begin{pmatrix} l_2' &amp; l_2 &amp; k \\ -m_2' &amp; -m_2 &amp; -q \end{pmatrix}
=\end{split}\\=\sum_{m_1 m_2 m_1' m_2' M q} (-1)^{l_1+l_2+l_1'+l_2'+L+k
    -m_1-m_2-m_1'-m_2'-M-q}\\\begin{split}\begin{pmatrix} l_1 &amp; l_2 &amp; L \\ m_1 &amp; m_2 &amp; -M \end{pmatrix}
\begin{pmatrix} l_1 &amp; l_1' &amp; k \\ -m_1 &amp; m_1' &amp; q \end{pmatrix}
\begin{pmatrix} l_1' &amp; l_2' &amp; L \\ m_1' &amp; -m_2' &amp; -M \end{pmatrix}
(-1)^{l_2+l_2'+k}
\begin{pmatrix} l_2 &amp; l_2' &amp; k \\ -m_2 &amp; -m_2' &amp; -q \end{pmatrix}
=\end{split}\\=\sum_{m_1 m_2 m_1' m_2' q} \delta_{M, m_1' + m_2'}
    (-1)^{l_1+l_1'+L} (-1)^{m_1+m_2+q}\\\begin{split}\begin{pmatrix} l_1 &amp; l_2 &amp; L \\ m_1 &amp; m_2 &amp; -M \end{pmatrix}
\begin{pmatrix} l_1 &amp; l_1' &amp; k \\ -m_1 &amp; m_1' &amp; q \end{pmatrix}
\begin{pmatrix} l_1' &amp; l_2' &amp; L \\ m_1' &amp; +m_2' &amp; -M \end{pmatrix}
\begin{pmatrix} l_2 &amp; l_2' &amp; k \\ -m_2 &amp; +m_2' &amp; -q \end{pmatrix}\end{split}\end{aligned}\end{align} \]</div>
<p>Where we have renamed <span class="math notranslate nohighlight">\(-m_2'\)</span> to <span class="math notranslate nohighlight">\(m_2'\)</span>.</p>
</div>
</div>
<div class="section" id="slater-type-orbitals-sto">
<h2>8.11.5. Slater Type Orbitals (STO)<a class="headerlink" href="#slater-type-orbitals-sto" title="Permalink to this headline">¶</a></h2>
<p>In this section we express the matrix elements in the STO basis.
It turns out that all integrals that we need can be expressed in terms
of the following simple integral (where <span class="math notranslate nohighlight">\(n,\zeta \ge 0\)</span>):</p>
<div class="math notranslate nohighlight" id="equation-slater-basic">
<span class="eqno">(8.11.5.1)<a class="headerlink" href="#equation-slater-basic" title="Permalink to this equation">¶</a></span>\[\int_0^\infty r^n e^{-\zeta r} \d r
    =\int_0^\infty \left(x\over\zeta\right)^n e^{-x} {\d x\over\zeta}
    ={1\over\zeta^{n+1}} \int_0^\infty x^n e^{-x} \d x
    ={\Gamma(n+1)\over\zeta^{n+1}}
    ={n!\over\zeta^{n+1}}\]</div>
<p>The STO basis function for the radial Schrödinger equation for <span class="math notranslate nohighlight">\(P(r)\)</span> is:</p>
<div class="math notranslate nohighlight" id="equation-sto-p">
<span class="eqno">(8.11.5.2)<a class="headerlink" href="#equation-sto-p" title="Permalink to this equation">¶</a></span>\[P_{n\zeta}(r) = N_{n\zeta} r^n e^{-\zeta r}\]</div>
<p>Where the normalization constant <span class="math notranslate nohighlight">\(N_{n\zeta}\)</span> is such that the STO orbital is
normalized as the radial wavefunction <span class="math notranslate nohighlight">\(P(r)\)</span>:</p>
<div class="math notranslate nohighlight">
\[1 = \int_0^\infty P_{n\zeta}^2(r) \d r
    = N_{n\zeta}^2 \int_0^\infty r^{2n} e^{-2\zeta r} \d r
    = N_{n\zeta}^2 {(2n)!\over (2\zeta)^{2n+1}}\]</div>
<p>from which we get:</p>
<div class="math notranslate nohighlight">
\[N_{n\zeta} = \sqrt{(2\zeta)^{2n+1}\over (2n)!}\]</div>
<p>Note that for <span class="math notranslate nohighlight">\(R(r)={P(r)\over r}\)</span> we get the following STO basis function:</p>
<div class="math notranslate nohighlight" id="equation-sto-r">
<span class="eqno">(8.11.5.3)<a class="headerlink" href="#equation-sto-r" title="Permalink to this equation">¶</a></span>\[R_{n\zeta}(r) = {P_{n\zeta}(r)\over r} = N_{n\zeta} r^{n-1} e^{-\zeta r}\]</div>
<p>One uses either <a class="reference internal" href="#equation-sto-p">(8.11.5.2)</a> or <a class="reference internal" href="#equation-sto-r">(8.11.5.3)</a> depending on whether one solves the
radial Schrödinger equation for <span class="math notranslate nohighlight">\(P\)</span> or for <span class="math notranslate nohighlight">\(R={P\over r}\)</span>.</p>
<div class="section" id="id1">
<h3>Overlap<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}S_{ij} =
\int P_{n_i \zeta_i}(r) P_{n_j \zeta_j}(r) \d r =\\    = \int
        N_{n_i\zeta_i} r^{n_i} e^{-\zeta_i r}
        N_{n_j\zeta_j} r^{n_j} e^{-\zeta_j r}
     \d r =\\    = N_{n_i\zeta_i} N_{n_j\zeta_j} \int
         r^{n_i + n_j} e^{-(\zeta_i+\zeta_j) r}
     \d r =\\    = N_{n_i\zeta_i} N_{n_j\zeta_j}
        {(n_i + n_j)! \over  (\zeta_i+\zeta_j)^{n_i+n_j+1}}\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="id2">
<h3>Potential<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}V_{ij} =
\int P_{n_i\zeta_i}(r) \left(-{Z\over r}\right) P_{n_j\zeta_j}(r) \d r =\\= \int
    N_{n_i\zeta_i} r^{n_i} e^{-\zeta_i r}
    \left(-{Z\over r}\right)
    N_{n_j\zeta_j} r^{n_j} e^{-\zeta_j r}
    \d r =\\= -Z N_{n_i\zeta_i} N_{n_j\zeta_j} \int
     r^{n_i+n_j-1} e^{-(\zeta_i+\zeta_j) r}
    \d r =\\= -Z N_{n_i\zeta_i} N_{n_j\zeta_j}
    {(n_i + n_j - 1)! \over  (\zeta_i+\zeta_j)^{n_i+n_j}}\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="id3">
<h3>Kinetic<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}T_{ij} =
\int \left( \half P_{n_i\zeta_i}'(r) P_{n_j\zeta_j}'(r)
        +P_{n_i\zeta_i}(r) {l (l+1)\over 2 r^2} P_{n_j\zeta_j}(r) \right)
    \d r =\\= \half N_{n_i\zeta_i}N_{n_j\zeta_j}\int \left(
        {\d\over\d r}(r^{n_i} e^{-\zeta_i r})
        {\d\over\d r}(r^{n_j} e^{-\zeta_j r})
        +r^{n_i} e^{-\zeta_i r} {l (l+1)\over r^2}
            r^{n_j} e^{-\zeta_j r}
        \right)
    \d r =\\= \half N_{n_i\zeta_i}N_{n_j\zeta_j}\int \left(
        (n_i r^{n_i-1} e^{-\zeta_i r}
                        -\zeta_i r^{n_i} e^{-\zeta_i r})
                    (n_j r^{n_j-1} e^{-\zeta_j r}
                        -\zeta_j r^{n_j} e^{-\zeta_j r})
        +l (l+1) r^{n_i+n_j-2} e^{-(\zeta_i+\zeta_j) r}
        \right)
    \d r =\\= \half N_{n_i\zeta_i}N_{n_j\zeta_j}\int \left(
    \left(
                {n_i n_j\over r^2}
               -{n_i \zeta_j+n_j\zeta_i \over r}
               +\zeta_i \zeta_j
            \right) r^{n_i+n_j} e^{-(\zeta_i+\zeta_j) r}
        +l (l+1) r^{n_i+n_j-2} e^{-(\zeta_i+\zeta_j) r}
        \right)
    \d r =\\= \half N_{n_i\zeta_i}N_{n_j\zeta_j}\int \left(
    (n_i n_j + l(l+1))       r^{n_i+n_j-2} e^{-(\zeta_i+\zeta_j) r}
   -(n_i \zeta_j+n_j\zeta_i) r^{n_i+n_j-1} e^{-(\zeta_i+\zeta_j) r}
   +\zeta_i \zeta_j          r^{n_i+n_j  } e^{-(\zeta_i+\zeta_j) r}
        \right)
    \d r =\\= \half N_{n_i\zeta_i}N_{n_j\zeta_j}\left(
    (n_i n_j + l(l+1))
        {(n_i + n_j - 2)! \over  (\zeta_i+\zeta_j)^{n_i +n_j - 1}}
   -(n_i \zeta_j+n_j\zeta_i)
        {(n_i + n_j - 1)! \over  (\zeta_i+\zeta_j)^{n_i +n_j    }}
   +\zeta_i \zeta_j
        {(n_i + n_j    )! \over  (\zeta_i+\zeta_j)^{n_i +n_j + 1}}
        \right)\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="id4">
<h3>Two particle<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>In this section we also need the following integral:</p>
<div class="math notranslate nohighlight">
\[\int_u^\infty r^n e^{-\zeta r} \d r
    = {1\over\zeta^{n+1}} \int_{\zeta u}^\infty x^n e^{-x} \d x
    = {\Gamma(n+1, \zeta u)\over\zeta^{n+1}}
    = {n!\over \zeta^{n+1}}
    e^{-\zeta u} \sum_{\nu=0}^n {u^\nu \zeta^\nu \over \nu!}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\Gamma(n, x) = \int_x^\infty t^{n-1} e^{-t}\d t
    = (n-1)! e^{-x} \sum_{\nu=0}^{n-1} {x^\nu\over \nu!}\]</div>
<p>is the incomplete gamma function.</p>
<p>The Slater integral is</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}R^k(i, j, k, l) = \int_0^\infty \int_0^\infty
    {r_&lt;^k\over r_&gt;^{k+1}} P_i(r) P_k(r) P_j(r') P_l(r') \d r \d r' =\\= \int_0^\infty \d r \int_0^r \d r'
    {r'^k\over r^{k+1}} P_i(r) P_k(r) P_j(r') P_l(r') +\\+ \int_0^\infty \d r \int_r^\infty \d r'
    {r^k\over r'^{k+1}} P_i(r) P_k(r) P_j(r') P_l(r') =\\= \int_0^\infty \d r \int_0^r \d r'
    {r'^k\over r^{k+1}} P_i(r) P_k(r) P_j(r') P_l(r') +\\+ \int_0^\infty \d r' \int_0^{r'} \d r
    {r^k\over r'^{k+1}} P_i(r) P_k(r) P_j(r') P_l(r') =\\= \int_0^\infty \d r \int_0^r \d r'
    {r'^k\over r^{k+1}} P_i(r) P_k(r) P_j(r') P_l(r') +\\+ \int_0^\infty \d r \int_0^r \d r'
    {r'^k\over r^{k+1}} P_i(r') P_k(r') P_j(r) P_l(r) =\\= R^k_\triangle(i, j, k, l) + R^k_\triangle(j, i, l, k)\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(R^k_\triangle(i, j, k, l)\)</span> is the integral over the lower triangle
(assuming <span class="math notranslate nohighlight">\(r\)</span> is the <span class="math notranslate nohighlight">\(x\)</span>-axis and <span class="math notranslate nohighlight">\(r'\)</span> is the <span class="math notranslate nohighlight">\(y\)</span>-axis), that is <span class="math notranslate nohighlight">\(r&gt;r'\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}R^k_\triangle(i, j, k, l)
    = \int_0^\infty \d r \int_0^{r} \d r'
        {r'^k\over r^{k+1}} P_i(r) P_k(r) P_j(r') P_l(r') =\\    = \int_0^\infty \d r' \int_{r'}^\infty \d r
        {r'^k\over r^{k+1}} P_i(r) P_k(r) P_j(r') P_l(r') =\\    = N_{n_i\zeta_i}N_{n_j\zeta_j}N_{n_k\zeta_k}N_{n_l\zeta_l}
        \int_0^\infty \d r' \int_{r'}^\infty \d r
        {r'^k\over r^{k+1}} r^{n_i + n_k} r'^{n_j+n_l}
        e^{-(\zeta_i+\zeta_k)r}
        e^{-(\zeta_j+\zeta_l)r'}
        =\\    = N_{n_i\zeta_i}N_{n_j\zeta_j}N_{n_k\zeta_k}N_{n_l\zeta_l}
        \int_0^\infty \d r'
        r'^k r'^{n_j+n_l}
        e^{-(\zeta_j+\zeta_l)r'}
            {(n_i+n_k-k-1)!\over (\zeta_i+\zeta_k)^{n_i+n_k-k}}
            e^{-(\zeta_i+\zeta_k) r'} \sum_{\nu=0}^{n_i+n_k-k-1}
            {r'^\nu (\zeta_i+\zeta_k)^\nu \over \nu!}
        =\\    = N_{n_i\zeta_i}N_{n_j\zeta_j}N_{n_k\zeta_k}N_{n_l\zeta_l}
            {(n_i+n_k-k-1)!\over (\zeta_i+\zeta_k)^{n_i+n_k-k}}
            \sum_{\nu=0}^{n_i+n_k-k-1}
            {(n_j+n_l+k+\nu)! (\zeta_i+\zeta_k)^\nu \over \nu!
            (\zeta_i+\zeta_j+\zeta_k+\zeta_l)^{n_j+n_l+k+\nu+1}
            }
        =\\    = N_{n_i\zeta_i}N_{n_j\zeta_j}N_{n_k\zeta_k}N_{n_l\zeta_l}
            {(n_i+n_k-k-1)!\over (\zeta_i+\zeta_k)^{n_i+n_k-k}}
            H^k_{ijkl}\end{aligned}\end{align} \]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[H^k_{ijkl} =
            \sum_{\nu=0}^{n_i+n_k-k-1}{
                (n_j+n_l+k+\nu)! (\zeta_i+\zeta_k)^\nu\over
                \nu!(\zeta_i+\zeta_j+\zeta_k+\zeta_l)^{n_j+n_l+k+\nu+1}}\]</div>
<p>Much more tedious method is the following:</p>
<div class="math notranslate nohighlight">
\[\int_0^u r^n e^{-\zeta r} \d r = \int_0^\infty r^n e^{-\zeta r} \d r
    -\int_u^\infty r^n e^{-\zeta r} \d r =
{n!\over \zeta^{n+1}}\left(1-
    e^{-\zeta u} \sum_{\nu=0}^n {u^\nu \zeta^\nu \over \nu!}\right)\]</div>
<p>The Slater integral is given by:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}R^k(i, j, k, l) = \int_0^\infty {r_&lt;^k\over r_&gt;^{k+1}} P_i(r) P_k(r)
    P_j(r') P_l(r') \d r \d r' =\\    = \int_0^\infty P_i(r) P_k(r) {Y^k(P_j P_l, r)\over r} \d r\end{aligned}\end{align} \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[Y^k(f(r), r) = r \int_0^\infty {r_&lt;^k\over r_&gt;^{k+1}} f(r') \d r'
    = {1\over r^k} \int_0^r r'^k f(r') \d r' + r^{k+1} \int_r^\infty
        {1\over r'^{k+1}} f(r') \d r'\]</div>
<p>and we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}Y^k(P_j(r) P_l(r), r)
    = {1\over r^k} \int_0^r r'^k P_j(r') P_l(r') \d r'
        + r^{k+1} \int_r^\infty {1\over r'^{k+1}} P_j(r') P_l(r') \d r' =\\    = {N_{n_j \zeta_j}N_{n_l \zeta_l}\over r^k} \int_0^r r'^k
            r'^{n_j}e^{-\zeta_j r'}
            r'^{n_l}e^{-\zeta_l r'} \d r'
        + N_{n_j \zeta_j}N_{n_l \zeta_l} r^{k+1}
            \int_r^\infty {1\over r'^{k+1}}
            r'^{n_j}e^{-\zeta_j r'}
            r'^{n_l}e^{-\zeta_l r'} \d r' =\\    = {N_{n_j \zeta_j}N_{n_l \zeta_l}\over r^k} \int_0^r
            r'^{n_j+n_l+k}e^{-(\zeta_j+\zeta_l) r'} \d r'
        + N_{n_j \zeta_j}N_{n_l \zeta_l} r^{k+1}
            \int_r^\infty
            r'^{n_j+n_l-k-1}e^{-(\zeta_j+\zeta_l) r'} \d r' =\\    = {N_{n_j \zeta_j}N_{n_l \zeta_l}\over r^k}
        {(n_j+n_l+k)!\over(\zeta_j+\zeta_l)^{n_j+n_l+k+1}} \left(
            1 - e^{-(\zeta_j+\zeta_l)r} \sum_{\nu=0}^{n_j+n_l+k}
                { r^\nu(\zeta_j+\zeta_l)^\nu \over \nu! }
            \right) +\\        + N_{n_j \zeta_j}N_{n_l \zeta_l} r^{k+1}
            {(n_j+n_l-k-1)!\over (\zeta_j+\zeta_l)^{n_j+n_l-k}}
                e^{-(\zeta_j+\zeta_l)r}
            \sum_{\nu=0}^{n_j+n_l-k-1}{r^\nu(\zeta_j+\zeta_l)^\nu\over \nu!}\end{aligned}\end{align} \]</div>
<p>Putting everything together we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}R^k(i, j, k, l)
    = N_{n_i \zeta_i}N_{n_j \zeta_j}N_{n_k \zeta_k}N_{n_l \zeta_l}
        \int_0^\infty
        r^{n_i}e^{-\zeta_i r}
        r^{n_k}e^{-\zeta_k r}
        {1\over r}
        \left(
    {1\over r^k}
        {(n_j+n_l+k)!\over(\zeta_j+\zeta_l)^{n_j+n_l+k+1}} \left(
            1 - e^{-(\zeta_j+\zeta_l)r} \sum_{\nu=0}^{n_j+n_l+k}
                { r^\nu(\zeta_j+\zeta_l)^\nu \over \nu! }
            \right) + \right.\\    \left.  + r^{k+1}
            {(n_j+n_l-k-1)!\over (\zeta_j+\zeta_l)^{n_j+n_l-k}}
                e^{-(\zeta_j+\zeta_l)r}
            \sum_{\nu=0}^{n_j+n_l-k-1}{r^\nu(\zeta_j+\zeta_l)^\nu\over \nu!}
        \right)
        \d r =\\    = N_{n_i \zeta_i}N_{n_j \zeta_j}N_{n_k \zeta_k}N_{n_l \zeta_l}
        \left(
        {(n_j+n_l+k)!\over(\zeta_j+\zeta_l)^{n_j+n_l+k+1}}
        \int_0^\infty
        r^{n_i+n_k-k-1}e^{-(\zeta_i+\zeta_k) r}
        \left(
            1 - e^{-(\zeta_j+\zeta_l)r} \sum_{\nu=0}^{n_j+n_l+k}
                { r^\nu(\zeta_j+\zeta_l)^\nu \over \nu! }
            \right) \d r + \right.\\    \left.  +
        \int_0^\infty
        e^{-(\zeta_i+\zeta_j+\zeta_k+\zeta_l) r}
            {(n_j+n_l-k-1)!\over (\zeta_j+\zeta_l)^{n_j+n_l-k}}
            \sum_{\nu=0}^{n_j+n_l-k-1}{
                r^{n_i+n_k+k+\nu}(\zeta_j+\zeta_l)^\nu\over \nu!}
        \d r
        \right) =\\    = N_{n_i \zeta_i}N_{n_j \zeta_j}N_{n_k \zeta_k}N_{n_l \zeta_l}
        \left(
        {(n_j+n_l+k)!\over(\zeta_j+\zeta_l)^{n_j+n_l+k+1}}
        \left(
            {(n_i+n_k-k-1)!\over (\zeta_i+\zeta_k)^{n_i+n_k-k}}
            - \sum_{\nu=0}^{n_j+n_l+k}
                {(\zeta_j+\zeta_l)^\nu (n_i+n_k-k+\nu-1)! \over \nu!
                (\zeta_i+\zeta_j+\zeta_k+\zeta_l)^{n_i+n_k-k+\nu}}
            \right) + \right.\\    \left.  +
            {(n_j+n_l-k-1)!\over (\zeta_j+\zeta_l)^{n_j+n_l-k}}
            \sum_{\nu=0}^{n_j+n_l-k-1}{
                (n_i+n_k+k+\nu)! (\zeta_j+\zeta_l)^\nu\over
                \nu!(\zeta_i+\zeta_j+\zeta_k+\zeta_l)^{n_i+n_k+k+\nu+1}}
        \right) =\\    = N_{n_i \zeta_i}N_{n_j \zeta_j}N_{n_k \zeta_k}N_{n_l \zeta_l}
        \left(
        {(n_j+n_l+k)!\over(\zeta_j+\zeta_l)^{n_j+n_l+k+1}}
        \left(
            {(n_i+n_k-k-1)!\over (\zeta_i+\zeta_k)^{n_i+n_k-k}}
            - H^{-k-1}_{jilk}
            \right) + \right.\\    \left.  +
            {(n_j+n_l-k-1)!\over (\zeta_j+\zeta_l)^{n_j+n_l-k}}
            H^k_{jilk}
        \right) =\\    = N_{n_i \zeta_i}N_{n_j \zeta_j}N_{n_k \zeta_k}N_{n_l \zeta_l}
        \left(
            {(n_i+n_k-k-1)!\over (\zeta_i+\zeta_k)^{n_i+n_k-k}}
            H^k_{ijkl}
        +
            {(n_j+n_l-k-1)!\over (\zeta_j+\zeta_l)^{n_j+n_l-k}}
            H^k_{jilk}
        \right)\end{aligned}\end{align} \]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[H^k_{ijkl} =
            \sum_{\nu=0}^{n_i+n_k-k-1}{
                (n_j+n_l+k+\nu)! (\zeta_i+\zeta_k)^\nu\over
                \nu!(\zeta_i+\zeta_j+\zeta_k+\zeta_l)^{n_j+n_l+k+\nu+1}}\]</div>
</div>
</div>
<div class="section" id="gaussian-type-orbitals-gto">
<h2>8.11.6. Gaussian Type Orbitals (GTO)<a class="headerlink" href="#gaussian-type-orbitals-gto" title="Permalink to this headline">¶</a></h2>
<p>In this section we express the matrix elements in the GTO basis.
It turns out that all integrals that we need can be expressed in terms
of the following simple integral (where <span class="math notranslate nohighlight">\(n,\zeta \ge 0\)</span>):</p>
<div class="math notranslate nohighlight" id="equation-gto-basic">
<span class="eqno">(8.11.6.1)<a class="headerlink" href="#equation-gto-basic" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}\int_0^\infty r^n e^{-\zeta r^2} \d r
    = {1\over\sqrt{\zeta^{n+1}}} \int_0^\infty x^n e^{-x^2} \d x
    = {1\over2\sqrt{\zeta^{n+1}}} \int_0^\infty t^{n-1\over 2} e^{-t} \d t
    = {\Gamma({n+1\over2})\over2 \zeta^{n+1\over2}} =\\\begin{split}    = \begin{cases}
    (n-1)!! \sqrt{\pi\over 2 (2\zeta)^{n+1}} &amp; \text{for even $n$} \\
    {\left(n-1\over2\right)!\over 2 \sqrt{\zeta^{n+1}}} &amp;
        \text{for odd $n$} \\
    \end{cases}\end{split}\end{aligned}\end{align} \]</div>
<p>The GTO basis function for the radial Schrödinger equation for <span class="math notranslate nohighlight">\(P(r)\)</span> is:</p>
<div class="math notranslate nohighlight" id="equation-gto-p">
<span class="eqno">(8.11.6.2)<a class="headerlink" href="#equation-gto-p" title="Permalink to this equation">¶</a></span>\[P_{n\zeta}(r) = N_{n\zeta} r^n e^{-\zeta r^2}\]</div>
<p>However, unlike STO, the GTO functions must satisfy the condition
<span class="math notranslate nohighlight">\(n = l + 2i + 1\)</span> where <span class="math notranslate nohighlight">\(i=0, 1, 2, \dots\)</span> (this condition is later used
in <a class="reference internal" href="#equation-gto-basic">(8.11.6.1)</a> to determine whether <span class="math notranslate nohighlight">\(n\)</span> is even or odd).
The normalization constant <span class="math notranslate nohighlight">\(N_{n\zeta}\)</span> is such that the GTO orbital is
normalized as the radial wavefunction <span class="math notranslate nohighlight">\(P(r)\)</span>:</p>
<div class="math notranslate nohighlight">
\[1 = \int_0^\infty P_{n\zeta}^2(r) \d r
    = N_{n\zeta}^2 \int_0^\infty r^{2n} e^{-2\zeta r^2} \d r
    = N_{n\zeta}^2 (2n-1)!! \sqrt{\pi\over 2 (4\zeta)^{2n+1}}\]</div>
<p>from which we get:</p>
<div class="math notranslate nohighlight">
\[N_{n\zeta} = \sqrt{{1\over (2n-1)!!}\sqrt{2 (4\zeta)^{2n+1}\over\pi}}\]</div>
<p>Note that for <span class="math notranslate nohighlight">\(R(r)={P(r)\over r}\)</span> we get the following GTO basis function:</p>
<div class="math notranslate nohighlight" id="equation-gto-r">
<span class="eqno">(8.11.6.3)<a class="headerlink" href="#equation-gto-r" title="Permalink to this equation">¶</a></span>\[R_{n\zeta}(r) = {P_{n\zeta}(r)\over r} = N_{n\zeta} r^{n-1} e^{-\zeta r^2}\]</div>
<p>One uses either <a class="reference internal" href="#equation-sto-p">(8.11.5.2)</a> or <a class="reference internal" href="#equation-sto-r">(8.11.5.3)</a> depending on whether one solves the
radial Schrödinger equation for <span class="math notranslate nohighlight">\(P\)</span> or for <span class="math notranslate nohighlight">\(R={P\over r}\)</span>.</p>
<div class="section" id="id5">
<h3>Overlap<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}S_{ij} = \int P_{n_i \zeta_i}(r) P_{n_j \zeta_j}(r) \d r =\\    = \int
        N_{n_i\zeta_i} r^{n_i} e^{-\zeta_i r^2}
        N_{n_j\zeta_j} r^{n_j} e^{-\zeta_j r^2}
     \d r =\\    = N_{n_i\zeta_i} N_{n_j\zeta_j} \int
         r^{n_i + n_j} e^{-(\zeta_i+\zeta_j) r^2}
     \d r =\\    = N_{n_i\zeta_i} N_{n_j\zeta_j} {\Gamma({n_i+n_j+1\over 2}) \over
        2(\zeta_i+\zeta_j)^{n_i+n_j+1\over 2}} =\\    = N_{n_i\zeta_i} N_{n_j\zeta_j}
        (n_i + n_j -1)!! \sqrt{\pi\over
            2(2\zeta_i+2\zeta_j)^{n_i+n_j+1}}\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="id6">
<h3>Potential<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}V_{ij} =
\int P_{n_i\zeta_i}(r) \left(-{Z\over r}\right) P_{n_j\zeta_j}(r) \d r =\\= \int
    N_{n_i\zeta_i} r^{n_i} e^{-\zeta_i r^2}
    \left(-{Z\over r}\right)
    N_{n_j\zeta_j} r^{n_j} e^{-\zeta_j r^2}
    \d r =\\= -Z N_{n_i\zeta_i} N_{n_j\zeta_j} \int
     r^{n_i+n_j-1} e^{-(\zeta_i+\zeta_j) r^2}
    \d r =\\= -Z N_{n_i\zeta_i} N_{n_j\zeta_j}
    {\Gamma({n_i+n_j\over 2}) \over
        2(\zeta_i+\zeta_j)^{n_i+n_j\over 2}} =\\= -Z N_{n_i\zeta_i} N_{n_j\zeta_j}
    {\left(n_i + n_j - 2\over 2\right)! \over
        2\sqrt{(\zeta_i+\zeta_j)^{n_i+n_j}}}\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="id7">
<h3>Kinetic<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}T_{ij} =
\int \left( \half P_{n_i\zeta_i}'(r) P_{n_j\zeta_j}'(r)
        +P_{n_i\zeta_i}(r) {l (l+1)\over 2 r^2} P_{n_j\zeta_j}(r) \right)
    \d r =\\= \half N_{n_i\zeta_i}N_{n_j\zeta_j}\int \left(
        {\d\over\d r}(r^{n_i} e^{-\zeta_i r^2})
        {\d\over\d r}(r^{n_j} e^{-\zeta_j r^2})
        +r^{n_i} e^{-\zeta_i r^2} {l (l+1)\over r^2}
            r^{n_j} e^{-\zeta_j r^2}
        \right)
    \d r =\\= \half N_{n_i\zeta_i}N_{n_j\zeta_j}\int \left(
        (n_i r^{n_i-1} e^{-\zeta_i r^2}
                        -2\zeta_i r^{n_i+1} e^{-\zeta_i r^2})
                    (n_j r^{n_j-1} e^{-\zeta_j r^2}
                        -2\zeta_j r^{n_j+1} e^{-\zeta_j r^2})
        +l (l+1) r^{n_i+n_j-2} e^{-(\zeta_i+\zeta_j) r^2}
        \right)
    \d r =\\= \half N_{n_i\zeta_i}N_{n_j\zeta_j}\int \left(
    \left(
                {n_i n_j\over r^2}
               -2(n_i \zeta_j+n_j\zeta_i)
               +4\zeta_i \zeta_j r^2
            \right) r^{n_i+n_j} e^{-(\zeta_i+\zeta_j) r^2}
        +l (l+1) r^{n_i+n_j-2} e^{-(\zeta_i+\zeta_j) r^2}
        \right)
    \d r =\\= \half N_{n_i\zeta_i}N_{n_j\zeta_j}\int \left(
    (n_i n_j + l(l+1))       r^{n_i+n_j-2} e^{-(\zeta_i+\zeta_j) r^2}
   -2(n_i \zeta_j+n_j\zeta_i) r^{n_i+n_j} e^{-(\zeta_i+\zeta_j) r^2}
   +4\zeta_i \zeta_j          r^{n_i+n_j+2} e^{-(\zeta_i+\zeta_j) r^2}
        \right)
    \d r =\\= \half N_{n_i\zeta_i}N_{n_j\zeta_j} \left(
    (n_i n_j + l(l+1)) {\Gamma({n_i+n_j-1\over 2}) \over
        2(\zeta_i+\zeta_j)^{n_i+n_j-1\over 2}}
   -2(n_i \zeta_j+n_j\zeta_i) {\Gamma({n_i+n_j+1\over 2}) \over
        2(\zeta_i+\zeta_j)^{n_i+n_j+1\over 2}}
   +4\zeta_i \zeta_j {\Gamma({n_i+n_j+3\over 2}) \over
        2(\zeta_i+\zeta_j)^{n_i+n_j+3\over 2}}
        \right)
    \d r =\\= \half N_{n_i\zeta_i}N_{n_j\zeta_j}\Bigg(
    (n_i n_j + l(l+1))
        {(n_i + n_j - 3)!! \sqrt{\pi\over
            2(2\zeta_i+2\zeta_j)^{n_i + n_j - 1}}} +\\   -2(n_i \zeta_j+n_j\zeta_i)
        {(n_i + n_j - 1)!! \sqrt{\pi\over
            2(2\zeta_i+2\zeta_j)^{n_i + n_j + 1}}} +\\   +4\zeta_i \zeta_j
        {(n_i + n_j + 1)!! \sqrt{\pi\over
            2(2\zeta_i+2\zeta_j)^{n_i + n_j + 3}}}
        \Bigg)\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="id8">
<h3>Two particle<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>We will need the following integral:</p>
<div class="math notranslate nohighlight">
\[\int_u^\infty r^n e^{-\zeta r^2} \d r
    = {1\over2\zeta^{n+1\over2}}
        \int_{\zeta u^2}^\infty x^{n-1\over2} e^{-x} \d x
    = {\Gamma({n+1\over2}, \zeta u^2)\over2\zeta^{n+1\over2}}\]</div>
<p>Just like for STO, we get:</p>
<div class="math notranslate nohighlight">
\[R^k(i, j, k, l)
    = R^k_\triangle(i, j, k, l) + R^k_\triangle(j, i, l, k)\]</div>
<p>where <span class="math notranslate nohighlight">\(R^k_\triangle(i, j, k, l)\)</span> is the integral over the lower triangle
(assuming <span class="math notranslate nohighlight">\(r\)</span> is the <span class="math notranslate nohighlight">\(x\)</span>-axis and <span class="math notranslate nohighlight">\(r'\)</span> is the <span class="math notranslate nohighlight">\(y\)</span>-axis), that is <span class="math notranslate nohighlight">\(r&gt;r'\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}R^k_\triangle(i, j, k, l)
    = \int_0^\infty \d r \int_0^{r} \d r'
        {r'^k\over r^{k+1}} P_i(r) P_k(r) P_j(r') P_l(r') =\\    = \int_0^\infty \d r' \int_{r'}^\infty \d r
        {r'^k\over r^{k+1}} P_i(r) P_k(r) P_j(r') P_l(r') =\\    = N_{n_i\zeta_i}N_{n_j\zeta_j}N_{n_k\zeta_k}N_{n_l\zeta_l}
        \int_0^\infty \d r' \int_{r'}^\infty \d r
        {r'^k\over r^{k+1}} r^{n_i + n_k} r'^{n_j+n_l}
        e^{-(\zeta_i+\zeta_k)r^2}
        e^{-(\zeta_j+\zeta_l)r'^2}
        =\\    = N_{n_i\zeta_i}N_{n_j\zeta_j}N_{n_k\zeta_k}N_{n_l\zeta_l}
        \int_0^\infty \d r' r'^k r'^{n_j+n_l}
        e^{-(\zeta_j+\zeta_l)r'^2}
        {\Gamma({n_i+n_k-k\over2}, (\zeta_i+\zeta_k)r'^2)\over
            2(\zeta_i+\zeta_k)^{n_i+n_k-k\over2}}
        =\\    = N_{n_i\zeta_i}N_{n_j\zeta_j}N_{n_k\zeta_k}N_{n_l\zeta_l}
        \int_0^\infty \d r' r'^k r'^{n_j+n_l}
        e^{-(\zeta_i+\zeta_j+\zeta_k+\zeta_l)r'^2}
        {\left({n_i+n_k-k\over2}-1\right)! \over
            2(\zeta_i+\zeta_k)^{n_i+n_k-k\over2}}
        \sum_{\nu=0}^{n_i+n_k-k-2\over2}{(\zeta_i+\zeta_k)^\nu r'^{2\nu}
            \over \nu!}
        =\\    = N_{n_i\zeta_i}N_{n_j\zeta_j}N_{n_k\zeta_k}N_{n_l\zeta_l}
        {\left({n_i+n_k-k\over2}-1\right)! \over
            2(\zeta_i+\zeta_k)^{n_i+n_k-k\over2}}
        \sum_{\nu=0}^{n_i+n_k-k-2\over2}{(\zeta_i+\zeta_k)^\nu \over \nu!}
        {\Gamma({n_j+n_l+k+2\nu+1\over2})\over 2
            (\zeta_i+\zeta_j+\zeta_k+\zeta_l)^{n_j+n_l+k+2\nu+1\over2}}
        =\\    = N_{n_i\zeta_i}N_{n_j\zeta_j}N_{n_k\zeta_k}N_{n_l\zeta_l}
        {\left({n_i+n_k-k\over2}-1\right)! \over
            2(\zeta_i+\zeta_k)^{n_i+n_k-k\over2}}
        \sum_{\nu=0}^{n_i+n_k-k-2\over2}{(\zeta_i+\zeta_k)^\nu \over \nu!}
        {(n_j+n_l+k+2\nu-1)!!\sqrt{\pi}\over 2^{n_j+n_l+k+2\nu+2\over 2}
            (\zeta_i+\zeta_j+\zeta_k+\zeta_l)^{n_j+n_l+k+2\nu+1\over2}}
        =\\    = N_{n_i\zeta_i}N_{n_j\zeta_j}N_{n_k\zeta_k}N_{n_l\zeta_l}
        {\sqrt{\pi}\over 2^{p+2}\sqrt{(\zeta_i+\zeta_j+\zeta_k
            +\zeta_l)^{2p+1}}}
            H^k_{ijkl}\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(p={n_i+n_j+n_k+n_l-2\over2}\)</span> and:</p>
<div class="math notranslate nohighlight">
\[H^k_{ijkl} =
            \sum_{\nu=0}^{n_i+n_k-k\over2}{
                (2p-2\nu-1)!! \left(n_i+n_k-k\over 2\right)!
                    2^\nu (\zeta_i+\zeta_j+\zeta_k+\zeta_l)^\nu \over
                        (n_i+n_k-\nu)! (\lambda_i + \lambda_k)^{1+\nu}}\]</div>
</div>
</div>
<div class="section" id="exchange-integral-in-spherical-symmetry">
<h2>8.11.7. Exchange Integral in Spherical Symmetry<a class="headerlink" href="#exchange-integral-in-spherical-symmetry" title="Permalink to this headline">¶</a></h2>
<p>Let’s calculate the exchange integral</p>
<div class="math notranslate nohighlight">
\[\int {\psi_i^*({\bf x})\psi_j({\bf x})\psi_j^*({\bf x}')\psi_i({\bf x}')
    \over |{\bf x} - {\bf x}'|} \d^3 x \d^3 x'\]</div>
<p>for the particular choice of the functions <span class="math notranslate nohighlight">\(\psi\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\psi_i({\bf x}) = {P_{nl}(r)\over r} Y_{lm}(\Omega)\\\psi_j({\bf x}) = {P_{n'l'}(r)\over r} Y_{l'm'}(\Omega)\end{aligned}\end{align} \]</div>
<p>We use multipole expansion:</p>
<div class="math notranslate nohighlight">
\[{1\over |{\bf x}-{\bf x}'|}
    = \sum_{k,q}{r_{&lt;}^k\over r_{&gt;}^{k+1}}
        {4\pi\over 2k+1}Y_{kq}(\Omega)Y_{kq}^*(\Omega')\]</div>
<p>And we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\int {\psi_i^*({\bf x})\psi_j({\bf x})\psi_j^*({\bf x}')\psi_i({\bf x}')
    \over |{\bf x} - {\bf x}'|} \d^3 x \d^3 x' =\\= \int
    {P_{nl}(r)\over r} Y_{lm}^*(\Omega)
    {P_{n'l'}(r)\over r} Y_{l'm'}(\Omega)
    {P_{n'l'}(r')\over r'} Y_{l'm'}^*(\Omega')
    {P_{nl}(r')\over r'} Y_{lm}(\Omega')\\    \sum_{k,q}{r_{&lt;}^k\over r_{&gt;}^{k+1}}
        {4\pi\over 2k+1}Y_{kq}(\Omega)Y_{kq}^*(\Omega')
    r^2 r'^2 \d r \d r' \d \Omega \d \Omega' =\\=
\sum_{k,q}
\int
    Y_{lm}^*(\Omega)
    Y_{l'm'}(\Omega)
    Y_{kq}(\Omega)
    \d \Omega
  \int
    Y_{l'm'}^*(\Omega')
    Y_{lm}(\Omega')
    Y_{kq}^*(\Omega')
    \d \Omega'\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
        {4\pi\over 2k+1}
    P_{nl}(r)
    P_{n'l'}(r)
    P_{n'l'}(r')
    P_{nl}(r')
    \d r \d r' =\\=
\sum_{k,q}
\int
    Y_{lm}^*(\Omega)
    Y_{l'm'}(\Omega)
    Y_{kq}(\Omega)
    \d \Omega
    (-1)^{m+m'+q}
  \int
    Y_{l',-m'}(\Omega')
    Y_{l,-m}^*(\Omega')
    Y_{k,-q}(\Omega')
    \d \Omega'\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
        {4\pi\over 2k+1}
    P_{nl}(r)
    P_{n'l'}(r)
    P_{n'l'}(r')
    P_{nl}(r')
    \d r \d r' =\\=
\sum_{k}
    c^k(l, m, l', m') \sqrt{2k+1\over 4\pi}
    (-1)^{m+m'+m-m'}
    c^k(l, -m, l', -m') \sqrt{2k+1\over 4\pi}\\  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
        {4\pi\over 2k+1}
    P_{nl}(r)
    P_{n'l'}(r)
    P_{n'l'}(r')
    P_{nl}(r')
    \d r \d r' =\\=
\sum_{k}
    c^k(l, m, l', m')
    c^k(l, -m, l', -m')
  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{nl}(r)
    P_{n'l'}(r)
    P_{n'l'}(r')
    P_{nl}(r')
    \d r \d r' =\\=
\sum_{k}
    c^k(l, m, l', m')
    c^k(l, m, l', m')
  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{nl}(r)
    P_{n'l'}(r)
    P_{n'l'}(r')
    P_{nl}(r')
    \d r \d r' =\\=
\sum_{k=|l-l'|}^{l+l'}
    \left(
    c^k(l, m, l', m')
    \right)^2
  \int {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{nl}(r)
    P_{n'l'}(r)
    P_{n'l'}(r')
    P_{nl}(r')
    \d r \d r'\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="occupation-numbers">
<h2>8.11.8. Occupation Numbers<a class="headerlink" href="#occupation-numbers" title="Permalink to this headline">¶</a></h2>
<p>We have a sum over <span class="math notranslate nohighlight">\(N\)</span> electron states like this:</p>
<div class="math notranslate nohighlight">
\[\sum_{i=1}^N A_i({\bf x}) = \sum_{nlms} A_{nlms}({\bf x})\]</div>
<p>where <span class="math notranslate nohighlight">\(A_{nlms}({\bf x})\)</span> are some functions that depend on the state numbers
(for example squares of the wavefunctions). Then there are two options —
either there is a way to sum over the <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(s\)</span> degrees of freedom, so that
the sum can be written exactly as:</p>
<div class="math notranslate nohighlight">
\[\sum_{nlms} A_{nlms}({\bf x}) = \sum_{nlms} B_{nl}({\bf x})\]</div>
<p>where <span class="math notranslate nohighlight">\(B_{nl}\)</span> (that don’t depend on <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(s\)</span>) will in general be different
to <span class="math notranslate nohighlight">\(A_{nlms}\)</span>, but the sum will be the same. Or we have to approximate the sum
(for example by averaging over the angles, or in some other way) as:</p>
<div class="math notranslate nohighlight">
\[\sum_{nlms} A_{nlms}({\bf x}) \to \sum_{nlms} B_{nl}({\bf x})\]</div>
<p>In either case, the occupation numbers <span class="math notranslate nohighlight">\(f_{nl}\)</span> are simply the number of times
the functions <span class="math notranslate nohighlight">\(B_{nl}({\bf x})\)</span> appear in the sum for the given <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(l\)</span>:</p>
<div class="math notranslate nohighlight">
\[\sum_{nlms} B_{nl}({\bf x}) = \sum_{nl} f_{nl} B_{nl}({\bf x})\]</div>
<p>So for closed shells atoms, it is always:</p>
<div class="math notranslate nohighlight">
\[f_{nl} = 2(2l+1)\]</div>
<p>because there are two spins, and <span class="math notranslate nohighlight">\(2l+1\)</span> possibilities for <span class="math notranslate nohighlight">\(m\)</span>, for open shell
atoms, <span class="math notranslate nohighlight">\(f_{nl}\)</span> is anything between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(2l+1\)</span>.</p>
<div class="section" id="example-i">
<h3>Example I<a class="headerlink" href="#example-i" title="Permalink to this headline">¶</a></h3>
<p>As an example, let’s say that after some calculation for closed shell systems
we get exactly:</p>
<div class="math notranslate nohighlight">
\[\sum_{nlms} A_{nlms}({\bf x}) = \sum_{nl} 2(2l+1) B_{nl}({\bf x})\]</div>
<p>Then because there are exactly <span class="math notranslate nohighlight">\(2(2l+1)\)</span> states in the <span class="math notranslate nohighlight">\(nl\)</span> shell, we write the
above as:</p>
<div class="math notranslate nohighlight">
\[\sum_{nlms} A_{nlms}({\bf x}) = \sum_{nl} 2(2l+1) B_{nl}({\bf x})
    = \sum_{nl} f_{nl} B_{nl}({\bf x})\]</div>
<p>Then we do similar calculation for the open shell system, and we have to use
some approximations to get the following formula, where the <span class="math notranslate nohighlight">\(B_{nl}({\bf x})\)</span>
happen to be exactly the same as for the closed shell system:</p>
<div class="math notranslate nohighlight">
\[\sum_{nlms} A_{nlms}({\bf x}) \to \sum_{nlm} 2 B_{nl}({\bf x})\]</div>
<p>Then we denote by <span class="math notranslate nohighlight">\(f_{nl}\)</span> the number of electrons in the shell <span class="math notranslate nohighlight">\(nl\)</span> (at least
one of them will be open, for which <span class="math notranslate nohighlight">\(nl\)</span> we have <span class="math notranslate nohighlight">\(f_{nl} &lt; 2(2l+1)\)</span>), and we
can write the above as:</p>
<div class="math notranslate nohighlight">
\[\sum_{nlms} A_{nlms}({\bf x}) \to \sum_{nlm} 2 B_{nl}({\bf x})
    = \sum_{nl} f_{nl} B_{nl}({\bf x})\]</div>
</div>
<div class="section" id="example-ii">
<h3>Example II<a class="headerlink" href="#example-ii" title="Permalink to this headline">¶</a></h3>
<p>The usual chemical occupation numbers for the Uranium atom are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f_{1l} &amp; = 2 (2l+1)    \\
f_{2l} &amp; = 2 (2l+1)    \\
f_{3l} &amp; = 2 (2l+1)    \\
f_{4l} &amp; = 2 (2l+1)    \\
f_{5l} &amp; = 2 (2l+1)\quad\quad\mbox{for $l\le2$}    \\
f_{53} &amp; = 3    \\
f_{60} &amp; = 2    \\
f_{61} &amp; = 6    \\
f_{62} &amp; = 1    \\
f_{70} &amp; = 2    \\\end{split}\]</div>
<p>So the <span class="math notranslate nohighlight">\(n=5\)</span>, <span class="math notranslate nohighlight">\(l=3\)</span> and <span class="math notranslate nohighlight">\(n=6\)</span>, <span class="math notranslate nohighlight">\(l=2\)</span> shells are open, all others are closed.
By summing all these <span class="math notranslate nohighlight">\(f_{nl}\)</span>, we get 92 states as expected:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\sum_{nl} f_{nl} = 2 + (2+6) + (2+6+10) + (2+6+10+14) + (2+6+10) +\\    + 3 + 2 + 6 + 1 + 2 = 92\end{aligned}\end{align} \]</div>
<p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_nl</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">l</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span>
            <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">6</span><span class="p">,</span>
            <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>

<span class="nb">print</span> <span class="s2">&quot;Sum f_nl =&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">([</span><span class="n">f_nl</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span>
</pre></div>
</div>
<p>prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Sum</span> <span class="n">f_nl</span> <span class="o">=</span> <span class="mi">92</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="hartree-screening-functions">
<h2>8.11.9. Hartree Screening Functions<a class="headerlink" href="#hartree-screening-functions" title="Permalink to this headline">¶</a></h2>
<p>Hartree screening function <span class="math notranslate nohighlight">\(Y^k(f, r)\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[Y^k(f, r) = r
\int_0^\infty
{r_{&lt;}^k\over r_{&gt;}^{k+1}}
f(r')
\d r'\]</div>
<p>and it occurs in many formulas in the Hartree Fock theory, so this section shows
how to calculate it. It depends on <span class="math notranslate nohighlight">\(k\)</span> and a function <span class="math notranslate nohighlight">\(f(r)\)</span>.</p>
<p>We first do the integral:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}Y^k(f, r) = r
\int_0^\infty
{r_{&lt;}^k\over r_{&gt;}^{k+1}}
f(r')
\d r'
= r
\int_0^r
{r'^k\over r^{k+1}}
f(r')
\d r'
+
r \int_r^\infty
{r^k\over r'^{k+1}}
f(r')
\d r'
=\\=
{1\over r^k}
\int_0^r
{x^k}
f(x)
\d x
+
r^{k+1}
\int_r^\infty
{1\over x^{k+1}}
f(x)
\d x
=Z^k(r)
+
r^{k+1}
\int_r^\infty {1\over x^{k+1}} f(x) \d x\end{aligned}\end{align} \]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}Z^k(r) =
{1\over r^k}
\int_0^r
{x^k}
f(x)
\d x\\{\d Z^k(r) \over \d r}= -{k\over r} Z^k(r) + f(r)\\Z^k(0) = 0\end{aligned}\end{align} \]</div>
<p>Now we differentiate <span class="math notranslate nohighlight">\(Y^k(r)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\d Y^k(r) \over \d r} = {\d Z^k(r) \over \d r}
    + {k+1\over r} r^{k+1}
    \int_r^\infty {1\over x^{k+1}} f(x) \d x
    -f(r)
=\\=
-{k\over r} Z^k(r) + f(r)
    + {k+1\over r} r^{k+1}
    \int_r^\infty {1\over x^{k+1}} f(x) \d x
    -f(r) =\\=
-{k\over r} Z^k(r)
    + {k+1\over r} r^{k+1}
    \int_r^\infty {1\over x^{k+1}} f(x) \d x =\\=
-{k\over r} Z^k(r)
    + {k+1\over r} (Y^k(r) - Z^k(r)) =\\=
-{2k+1\over r} Z^k(r) + {k+1\over r} Y^k(r)\end{aligned}\end{align} \]</div>
<p>Also <span class="math notranslate nohighlight">\(Y^k(\infty) = Z^k(\infty)\)</span>, so we get the following set of first order
differential equations with boundary conditions:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\left({\d\over\d r} - {k+1\over r}\right) Y^k(r) = -{2k+1\over r} Z^k(r)\\\left({\d\over\d r} + {k\over r}\right) Z^k(r) = f(r)\\Y^k(\infty) = Z^k(\infty)\\Z^k(0) = 0\end{aligned}\end{align} \]</div>
<p>One way to calculate the Hartree screening function is to integrate the second
equation from the left using the boundary condition <span class="math notranslate nohighlight">\(Z^k(0) = 0\)</span> and then
integrate the first equation from the right, using the boundary condition
<span class="math notranslate nohighlight">\(Y^k(\infty) = Z^k(\infty)\)</span>.</p>
<p>Another way is to obtain one second order equation. Expressing <span class="math notranslate nohighlight">\(Z^k\)</span> from the
first equation:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}Z^k(r) = -{r\over 2k+1}\left({\d\over\d r} - {k+1\over r}\right) Y^k(r) =\\=-{r\over 2k+1}{\d Y^k(r)\over \d r} + {k+1\over 2k+1} Y^k(r)\end{aligned}\end{align} \]</div>
<p>and substituting into the second equation we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}-\left({\d\over\d r} + {k\over r}\right)
    \left({r\over 2k+1}{\d Y^k(r)\over \d r} + {k+1\over 2k+1} Y^k\right)
    = f(r)\\-{r\over 2k+1}\left({\d^2\over\d r^2} - {k(k+1)\over r^2}\right)
    Y^k(r)
    = f(r)\\\left(-{\d^2\over\d r^2} + {k(k+1)\over r^2}\right) Y^k(r)
    = {2k+1\over r} f(r)\end{aligned}\end{align} \]</div>
<p>With boundary condition on the left:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}Z^k(0) = {k+1\over 2k+1} Y^k(0) = 0\\Y^k(0) = 0\end{aligned}\end{align} \]</div>
<p>and on the right:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}Z^k(r)
    =-{r\over 2k+1}{\d Y^k(r)\over \d r} + {k+1\over 2k+1} Y^k(r)
    = Y^k(r)\\-{r\over 2k+1}{\d Y^k(r)\over \d r} - {k\over 2k+1} Y^k(r) = 0\\{\d Y^k(r)\over \d r} + {k\over r} Y^k(r) = 0\end{aligned}\end{align} \]</div>
<p>which for <span class="math notranslate nohighlight">\(r\to\infty\)</span> becomes:</p>
<div class="math notranslate nohighlight">
\[\left.{\d Y^k(r)\over \d r}\right|_{r=\infty} = 0\]</div>
<p>but in practise, it’s better to use the former Newton (Robin) boundary
condition. We have obtained one second order equation for <span class="math notranslate nohighlight">\(Y^k(r)\)</span></p>
<div class="math notranslate nohighlight">
\[\left(-{\d^2\over\d r^2} + {k(k+1)\over r^2}\right) Y^k(r)
    = {2k+1\over r} f(r)\]</div>
<p>with boundary conditions:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}Y^k(0) = 0\\{\d Y^k(r)\over \d r} + {k\over r} Y^k(r) = 0\end{aligned}\end{align} \]</div>
<p>The
weak formulation is:</p>
<div class="math notranslate nohighlight">
\[\int_0^{r_{max}} Y^k{}'(r) v'(r) + {k(k+1)\over r^2} Y^k(r) v(r) \d r
    -[Y^k{}'(r)v(r)]_0^{r_{max}}
    = \int_0^{r_{max}} {2k+1\over r}f(r)v(r) \d r\]</div>
<p>The boundary term can be simplified using the boundary conditions as:</p>
<div class="math notranslate nohighlight">
\[-[Y^k{}'(r)v(r)]_0^{r_{max}}
= -Y^k{}'(r_{max})v(r_{max}) + Y^k{}'(0) v(0)
= -Y^k{}'(r_{max})v(r_{max})
= {k\over r_{max}} Y^k(r_{max})v(r_{max})\]</div>
<p>so we get</p>
<div class="math notranslate nohighlight">
\[\int_0^{r_{max}} Y^k{}'(r) v'(r) + {k(k+1)\over r^2} Y^k(r) v(r) \d r
    + {k\over r_{max}} Y^k(r_{max})v(r_{max})
    = \int_0^{r_{max}} {2k+1\over r}f(r)v(r) \d r\]</div>
<p>where the test functions <span class="math notranslate nohighlight">\(v(r)\)</span> have the constrain <span class="math notranslate nohighlight">\(v(0)=0\)</span> on the left
boundary and no constrain on the right.</p>
</div>
<div class="section" id="hartree-potential-in-spherical-symmetry">
<span id="hartree-spherical"></span><h2>8.11.10. Hartree Potential in Spherical Symmetry<a class="headerlink" href="#hartree-potential-in-spherical-symmetry" title="Permalink to this headline">¶</a></h2>
<p>For both open and closed shell atoms we get exactly:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}V_H({\bf x})
    = \int {n({\bf y})\over|{\bf x}-{\bf y}|} \d^3 y
    = \int {\sum_{j=1}^Z|\psi_j({\bf y})|^2\over|{\bf x}-{\bf y}|}
        \d^3 y =\\    = 2\sum_{nlm}\int {|Y_{lm}(\Omega')|^2 P_{nl}^2(r')\over
        |{\bf x}-{\bf y}|} \d\Omega' \d r' =\\    = 2\sum_{nlm}\sum_{l'm'}\int {r_&lt;^{l'}\over r_&gt;^{l'+1}}
        {4\pi\over 2l'+1}
        Y_{lm}^*(\Omega')Y_{lm}(\Omega')
        Y_{l'm'}^*(\Omega)Y_{l'm'}(\Omega') P_{nl}^2(r') \d\Omega' \d r' =\\    = 2\sum_{nlm}\sum_{l'}\int {r_&lt;^{l'}\over r_&gt;^{l'+1}}
        {4\pi\over 2l'+1}
        Y_{l'0}^*(\Omega) \sqrt{2l'+1\over 4\pi}
            c^{l'}(l, m, l, m) P_{nl}^2(r') \d r' =\\    = 2\sum_{nl}\sum_{l'=0}^{2l}\int {r_&lt;^{l'}\over r_&gt;^{l'+1}}
        \sqrt{4\pi\over 2l'+1}
        Y_{l'0}^*(\Omega)
            \sum_m c^{l'}(l, m, l, m) P_{nl}^2(r') \d r' =\\    = 2\sum_{nl}\int {1\over r_&gt;}
        \sqrt{4\pi}
        Y_{00}^*(\Omega)
            \sum_m c^0(l, m, l, m) P_{nl}^2(r') \d r' +\\    + 2\sum_{nl}\sum_{l'=1}^{2l}\int {r_&lt;^{l'}\over r_&gt;^{l'+1}}
        \sqrt{4\pi\over 2l'+1}
        Y_{l'0}^*(\Omega)
            \sum_m c^{l'}(l, m, l, m) P_{nl}^2(r') \d r' =\\    = \sum_{nl}2\sum_m c^0(l, m, l, m) \int {1\over r_&gt;}
             P_{nl}^2(r') \d r' +\\    + 2\sum_{nl}\sum_{l'=1}^{2l}\int {r_&lt;^{l'}\over r_&gt;^{l'+1}}
        \sqrt{4\pi\over 2l'+1}
        Y_{l'0}^*(\Omega)
            \sum_m c^{l'}(l, m, l, m) P_{nl}^2(r') \d r' =\\    = \sum_{nl}2\sum_m \int {1\over r_&gt;}
             P_{nl}^2(r') \d r' +\\    + 2\sum_{nl}\sum_{l'=1}^{2l}\int {r_&lt;^{l'}\over r_&gt;^{l'+1}}
        \sqrt{4\pi\over 2l'+1}
        Y_{l'0}^*(\Omega)
            \sum_m c^{l'}(l, m, l, m) P_{nl}^2(r') \d r' =\\    = \sum_{nl} f_{nl} \int {1\over r_&gt;} P_{nl}^2(r') \d r' +\\    + 2\sum_{nl}\sum_{l'=1}^{2l}
        \sqrt{4\pi\over 2l'+1}
        Y_{l'0}^*(\Omega)\sum_m c^{l'}(l, m, l, m)
      \int {r_&lt;^{l'}\over r_&gt;^{l'+1}} P_{nl}^2(r') \d r'\end{aligned}\end{align} \]</div>
<p>For closed shell atoms we use the fact, that</p>
<div class="math notranslate nohighlight">
\[\sum_{m=-l}^l c^{l'}(l, m, l, m) = (2l+1) \delta_{l' 0}\]</div>
<p>and the second term disappears, and for open shell atoms
we have to use the central field approximation: we average
the integral for <span class="math notranslate nohighlight">\(V_H\)</span> over the angles:</p>
<div class="math notranslate nohighlight">
\[V_H({\bf x}) \to V_H(r) = {1\over 4\pi} \int V_H({\bf x})\, \d \Omega\]</div>
<p>and using the fact, that</p>
<div class="math notranslate nohighlight">
\[\int Y_{l'0}^*(\Omega)\, \d \Omega = \sqrt{4\pi} \delta_{l' 0}\]</div>
<p>the second term disappears as well. We got the same expression for both open
shell (with central field approximation) and closed shell (no approximation)
atoms.  The radial charge density is:</p>
<div class="math notranslate nohighlight">
\[n(r) = {1\over 4\pi} \sum_{nl} f_{nl} \left(P_{nl}(r)\over r\right)^2\]</div>
<p>So we got:</p>
<div class="math notranslate nohighlight">
\[V_H(r) =
   \sum_{nl} f_{nl} \int {1\over r_&gt;} P_{nl}^2(r') \d r'
   =\int {4\pi n(r') r'^2 \over r_&gt;} \d r'
   = {Y^0(4\pi n(r) r^2, r) \over r}\]</div>
<p>The Hartree screening function <span class="math notranslate nohighlight">\(Y^0(4\pi n(r) r^2, r)\)</span> is given by the equation:</p>
<div class="math notranslate nohighlight">
\[-{\d^2\over\d r^2} Y^0(r) = {1\over r} 4\pi n(r) r^2\]</div>
<p>So <span class="math notranslate nohighlight">\(V_H(r)\)</span> satisfies the radial Poisson equation:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(V_H(r) r)'' = -{1\over r} 4\pi n(r) r^2\\V_H''(r) r + 2V_H'(r) = - 4\pi n(r) r\\V_H''(r) + {2\over r}V_H'(r) = -4\pi n(r)\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="nonlocal-exchange-potential-in-spherical-symmetry">
<h2>8.11.11. Nonlocal Exchange Potential in Spherical Symmetry<a class="headerlink" href="#nonlocal-exchange-potential-in-spherical-symmetry" title="Permalink to this headline">¶</a></h2>
<p>Similarly, we calculate:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\sum_{j=1}^Z\int {\psi_i({\bf x'})\psi_j^*({\bf x'})\over|{\bf x}-{\bf x'}|}
        \d^3 x'\,\,\psi_j({\bf x}) =\\= \sum_{n'l'm'}\sum_{k,q}\int
    {P_{nl}(r')\over r'} Y_{lm}(\Omega')
    {P_{n'l'}(r')\over r'} Y_{l'm'}^*(\Omega')
    {P_{n'l'}(r)\over r} Y_{l'm'}(\Omega)\\    {r_{&lt;}^k\over r_{&gt;}^{k+1}}
        {4\pi\over 2k+1}Y_{kq}(\Omega)Y_{kq}^*(\Omega')
    r'^2 \d r' \d \Omega' =\\= \sum_{n'l'm'}\sum_{k,q}
        {P_{n'l'}(r)\over r}
        {4\pi\over 2k+1}
    \int Y_{lm}(\Omega') Y_{l'm'}^*(\Omega') Y_{kq}^*(\Omega')
        Y_{l'm'}(\Omega)
        Y_{kq}(\Omega)
        \d \Omega'
    \int
    {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{nl}(r')
    P_{n'l'}(r')
    \d r'  =\\= \sum_{n'l'}\sum_{k}
        {P_{n'l'}(r)\over r}
        {4\pi\over 2k+1}
        {2k+1\over 4\pi}
            \sqrt{2l'+1\over 2l+1} c^k(l', 0, l, 0)
            Y_{lm}(\Omega)
    \int
    {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{nl}(r')
    P_{n'l'}(r')
    \d r'  =\\=
{Y_{lm}(\Omega)\over r}
\sum_{n'l'}\sum_{k=|l-l'|}^{k=l+l'}
        \sqrt{2l'+1\over 2l+1} c^k(l', 0, l, 0)
    \int
    {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{nl}(r')
    P_{n'l'}(r')
    \d r'\,
        P_{n'l'}(r) =\\\begin{split}=
{Y_{lm}(\Omega)\over r}
\sum_{n'l'}\sum_{k=|l-l'|}^{k=l+l'}
    (2l'+1)
        \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
    \int
    {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{nl}(r')
    P_{n'l'}(r')
    \d r'\,
        P_{n'l'}(r) =\end{split}\\\begin{split}=
{Y_{lm}(\Omega)\over r}
\sum_{n'l'} f_{n'l'} \sum_{k=|l-l'|}^{k=l+l'}
    \half
        \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
    \int
    {r_{&lt;}^k\over r_{&gt;}^{k+1}}
    P_{nl}(r')
    P_{n'l'}(r')
    \d r'\,
        P_{n'l'}(r)\end{split}\end{aligned}\end{align} \]</div>
<p>Functions with different spins don’t contribute to the sum, so there is no
multiplication by 2. We assumed closed shells atoms (we summed over all <span class="math notranslate nohighlight">\(m'\)</span> in
the above). We used the result of the integral in
<a class="reference internal" href="../math/spherical-harmonics.html#five-spherical-harmonics"><span class="std std-ref">Example VI</span></a> and also:</p>
<div class="math notranslate nohighlight" id="equation-using3j">
<span class="eqno">(8.11.11.1)<a class="headerlink" href="#equation-using3j" title="Permalink to this equation">¶</a></span>\[\begin{split}\sqrt{2l'+1\over 2l+1} c^k(l', 0, l, 0)
    = \sqrt{2l'+1\over 2l+1}
        \sqrt{(2l'+1)(2l+1)}
        \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
    = (2l'+1)
        \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2\end{split}\]</div>
</div>
<div class="section" id="radial-hartree-fock-equations">
<h2>8.11.12. Radial Hartree-Fock Equations<a class="headerlink" href="#radial-hartree-fock-equations" title="Permalink to this headline">¶</a></h2>
<p>Using the above integrals, the HF equations become:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}-\half P_{nl}''(r) +
    \left({l(l+1)\over 2r^2} -{Z\over r} + V_H(r)\right)P_{nl}(r) +\\\begin{split}        -\sum_{n'l'}
            f_{n'l'}
            \sum_{k=|l-l'|}^{k=l+l'}
            \half \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            \int
            {r_{&lt;}^k\over r_{&gt;}^{k+1}}
            P_{nl}(r')
            P_{n'l'}(r')
            \d r'\,
                P_{n'l'}(r)
    = \epsilon_{nl} P_{nl}(r)\end{split}\end{aligned}\end{align} \]</div>
<p>with:</p>
<div class="math notranslate nohighlight">
\[V_H(r) =
   \sum_{nl} f_{nl} \int {1\over r_&gt;} P_{nl}^2(r') \d r'\]</div>
<p>Using the Hartree screening functions, the HF equations are:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}-\half P_{nl}''(r) +
    \left({l(l+1)\over 2r^2} -{Z\over r} + V_H(r)\right)P_{nl}(r) +\\\begin{split}        -\sum_{n'l'}
            f_{n'l'}
            \sum_{k=|l-l'|}^{k=l+l'}
            \half \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            {Y^k(P_{nl}(r) P_{n'l'}(r), r) \over r}
            P_{n'l'}(r)
    = \epsilon_{nl} P_{nl}(r)\end{split}\end{aligned}\end{align} \]</div>
<p>with:</p>
<div class="math notranslate nohighlight">
\[V_H(r) = \sum_{nl} f_{nl} {Y^0(P_{nl}^2(r), r) \over r}
    = {Y^0(4\pi n(r) r^2, r) \over r}\]</div>
</div>
<div class="section" id="total-energy">
<h2>8.11.13. Total Energy<a class="headerlink" href="#total-energy" title="Permalink to this headline">¶</a></h2>
<p>The total energy is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}E = \sum_a 2(2l_a+1) \left( \epsilon_a
    -\sum_b (2l_b+1) \left( R_0(a, b, a, b)-\sum_l
        \half \begin{pmatrix} l_a &amp; l &amp; l_b \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
        R_l(a, b, b, a)\right) \right) =\end{split}\\\begin{split}  = \sum_{nl} f_{nl} \left( \epsilon_{nl}
    -\sum_{n'l'} \half f_{n'l'} \left( R_0(nl, n'l', nl, n'l')-\sum_k
        \half \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
        R_l(nl, n'l', n'l', nl)\right) \right) =\end{split}\\\begin{split}  = \sum_{nl} f_{nl} \epsilon_{nl}
    -\sum_{nl}\sum_{n'l'} \half f_{nl} f_{n'l'}
        \left(
    \int_0^\infty P_{nl}^2(r) {Y^0(P_{n'l'}^2(r), r)\over r} \d r
        -\sum_k
        \half \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            \int_0^\infty P_{nl}(r) P_{n'l'}(r)
                    {Y^l(P_{nl}(r) P_{n'l'}(r), r)\over r} \d r
        \right) =\end{split}\\  = \sum_{nl} f_{nl} \epsilon_{nl}
    -\half
    \int_0^\infty 4\pi n(r) r^2 {Y^0(4\pi n(r) r^2, r)\over r} \d r +\\\begin{split}        +\sum_{nl}\sum_{n'l'} \half f_{nl} f_{n'l'} \sum_k
        \half \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            \int_0^\infty P_{nl}(r) P_{n'l'}(r)
                    {Y^l(P_{nl}(r) P_{n'l'}(r), r)\over r} \d r
        =\end{split}\\\begin{split}  = \sum_{nl} f_{nl} \epsilon_{nl}
    -2\pi \int_0^\infty V_H(r) n(r) r^2 \d r
        +\sum_{nl}\sum_{n'l'} \half f_{nl} f_{n'l'} \sum_k
        \half \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            \int_0^\infty P_{nl}(r) P_{n'l'}(r)
                    {Y^l(P_{nl}(r) P_{n'l'}(r), r)\over r} \d r\end{split}\end{aligned}\end{align} \]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[R_l(a, b, c, d) = \int_0^\infty P_a(r) P_c(r) {Y^l(P_b(r) P_d(r), r)\over r} \d r\]</div>
<div class="section" id="example-helium">
<h3>Example: Helium<a class="headerlink" href="#example-helium" title="Permalink to this headline">¶</a></h3>
<p>For Helium atom, the only nonzero occupation numbers are:</p>
<div class="math notranslate nohighlight">
\[f_{10} = 2\]</div>
<p>and the sum over <span class="math notranslate nohighlight">\(n'l'\)</span> simplifies to:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\sum_{n'l'}
    f_{n'l'}
    \sum_{k=|l-l'|}^{k=l+l'}
    \half \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
= f_{10} \half \begin{pmatrix} 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
= f_{10} \half = 1\end{split}\]</div>
<p>so we only need to solve for the <span class="math notranslate nohighlight">\(1s\)</span> state and we get:</p>
<div class="math notranslate nohighlight">
\[-\half P_{10}''(r) +
    \left(-{Z\over r} + V_H(r)\right)P_{10}(r)
        -{Y^0(P_{10}(r) P_{10}(r), r) \over r}
            P_{10}(r)
    = \epsilon_{10} P_{10}(r)\]</div>
<p>with:</p>
<div class="math notranslate nohighlight">
\[V_H(r) = 2 {Y^0(P_{10}^2(r), r) \over r}
    = {Y^0(4\pi n(r) r^2, r) \over r}\]</div>
<p>We can combine the equations:</p>
<div class="math notranslate nohighlight">
\[-\half P_{10}''(r) +
    \left(-{Z\over r} + 2 {Y^0(P_{10}^2(r), r) \over r}\right)P_{10}(r)
        -{Y^0(P_{10}^2(r), r) \over r}
            P_{10}(r)
    = \epsilon_{10} P_{10}(r)\]</div>
<p>and we obtain:</p>
<div class="math notranslate nohighlight">
\[-\half P_{10}''(r) +
    \left(-{Z\over r} + {Y^0(P_{10}^2(r), r) \over r}\right)P_{10}(r)
    = \epsilon_{10} P_{10}(r)\]</div>
</div>
</div>
<div class="section" id="fem">
<h2>8.11.14. FEM<a class="headerlink" href="#fem" title="Permalink to this headline">¶</a></h2>
<p>The weak formulation is (<span class="math notranslate nohighlight">\(u(r) = P_{nl}(r)\)</span>):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\int_0^\infty \left( \half u'(r) v'(r) +
    \left({l(l+1)\over 2r^2} -{Z\over r} + V_H(r)\right)u(r)v(r)
        \right) \d r+\\\begin{split}        -\sum_{n'l'}
            f_{n'l'}
            \sum_{k=|l-l'|}^{k=l+l'}
            \half \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            \int_0^\infty
            v(r)
            P_{n'l'}(r)
            {Y^k(u(r) P_{n'l'}(r), r)\over r}
            \d r
    = \epsilon \int_0^\infty u(r)v(r)\d r\end{split}\end{aligned}\end{align} \]</div>
<p>for closed shell atoms:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\int_0^\infty \left( \half u'(r) v'(r) +
    \left({l(l+1)\over 2r^2} -{Z\over r} + V_H(r)\right)u(r)v(r)
        \right) \d r+\\\begin{split}        -\sum_{n'l'}
            2(2l'+1)
            \sum_{k=|l-l'|}^{k=l+l'}
            \half \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            \int_0^\infty
            v(r)
            P_{n'l'}(r)
            {Y^k(u(r) P_{n'l'}(r), r)\over r}
            \d r
    = \epsilon \int_0^\infty u(r)v(r)\d r\end{split}\end{aligned}\end{align} \]</div>
<p>or (here we use the <span class="math notranslate nohighlight">\(il\)</span> index to label all functions <span class="math notranslate nohighlight">\(u_i\)</span> for the given <span class="math notranslate nohighlight">\(l\)</span>)</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\int_0^\infty \left( \half u_{il}'(r) v'(r) +
    \left({l(l+1)\over 2r^2} -{Z\over r} + V_H(r)\right)u_{il}(r)v(r)
        \right) \d r+\\        -\sum_{n'l'}
            \sum_{k=|l-l'|}^{k=l+l'}
            \sqrt{2l'+1\over 2l+1}c^k(l, 0, l', 0)
            \int_0^\infty
            v(r)
            P_{n'l'}(r)
            {Y^k(u_{il}(r) P_{n'l'}(r), r)\over r}
            \d r
    = \epsilon \int_0^\infty u_{il}(r)v(r)\d r\end{aligned}\end{align} \]</div>
<p>Introducing radial basis <span class="math notranslate nohighlight">\(\phi_{\mu l}(r)\)</span> (where
<span class="math notranslate nohighlight">\(\mu\)</span>, <span class="math notranslate nohighlight">\(\nu\)</span> labels all basis functions for the given <span class="math notranslate nohighlight">\(l\)</span>):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}u_{il}(r) = \sum_\nu C_{\nu i l} \phi_{\nu l}(r)\\v(r) = \phi_{\mu l}(r)\end{aligned}\end{align} \]</div>
<p>we get (here <span class="math notranslate nohighlight">\(i\)</span> is again restricted for the subset corresponding to the given
<span class="math notranslate nohighlight">\(l\)</span>):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\sum_\nu \int_0^\infty \left( \half \phi_{\mu l}'(r) \phi_{\nu l}'(r) +
    \left({l(l+1)\over 2r^2} -{Z\over r} + V_H(r)\right)
        \phi_{\mu l}(r) \phi_{\nu l}(r)
        \right) \d r\,C_{\nu i l}+\\        -\sum_\nu \sum_{n'l'}
            \sum_{k=|l-l'|}^{k=l+l'}
            \sqrt{2l'+1\over 2l+1}c^k(l, 0, l', 0)
            \int_0^\infty
            \phi_{\mu l}(r)
            P_{n'l'}(r)
            {Y^k(\phi_{\nu l}(r) P_{n'l'}(r), r)\over r}
            \d r\,C_{\nu i l}
    = \epsilon \sum_\nu \int_0^\infty
        \phi_{\mu l}(r)\phi_{\nu l}(r) \d r\,C_{\nu i l}\end{aligned}\end{align} \]</div>
<p>This can be written as</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\sum_\nu F_{\mu\nu}^l C_{\nu i l} = \epsilon_i \sum_\nu S_{\mu\nu}^l
    C_{\nu i l}\\F_{\mu\nu}^l = H_{\mu\nu}^{l \mbox{core}} + G_{\mu\nu}^l
    = T_{\mu\nu}^l + V_{\mu\nu}^l + G_{\mu\nu}^l\end{aligned}\end{align} \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}T_{\mu\nu}^l = \int_0^\infty \half \phi_{\mu l}'(r) \phi_{\nu l}'(r)
    + \phi_{\mu l}(r){l(l+1)\over 2r^2} \phi_{\nu l}(r) \d r\\V_{\mu\nu}^l = \int_0^\infty \phi_{\mu l}(r)\left(-{Z\over r}\right)
    \phi_{\nu l}(r) \d r\\G_{\mu\nu}^l = \int_0^\infty \phi_{\mu l}(r) V_H(r) \phi_{\nu l}(r) \d r +\\        -\sum_{n'l'}
            \sum_{k=|l-l'|}^{k=l+l'}
            \sqrt{2l'+1\over 2l+1}c^k(l, 0, l', 0)
            \int_0^\infty
            \phi_{\mu l}(r)
            P_{n'l'}(r)
            {Y^k(\phi_{\nu l}(r) P_{n'l'}(r), r)\over r}
            \d r\\S_{\mu\nu}^l = \int_0^\infty \phi_{\mu l}(r)\phi_{\nu l}(r) \d r\\V_H(r) = \sum_{n'l'} 2(2l'+1) {Y^0(P_{n'l'}^2(r), r) \over r}\end{aligned}\end{align} \]</div>
<p>The indices <span class="math notranslate nohighlight">\(n' l'\)</span> go over all occupied orbitals <span class="math notranslate nohighlight">\(P_{n' l'}\)</span>.
Introducing density:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}n({\bf x}) = 2 \sum_{k=1}^{N/2} | \psi_k({\bf x})|^2
    = 2 \sum_{nlm} | \psi_{nlm}({\bf x})|^2
    = 2 \sum_{nlm} {P_{nl}^2(r)\over r^2} |Y_{lm}(\Omega)|^2 =\\    = 2 \sum_{nl} {P_{nl}^2(r)\over r^2} {2l+1\over 4\pi}
    = {1\over 4\pi} \sum_{nl} 2(2l+1) {P_{nl}^2(r)\over r^2}
    = n(r)\end{aligned}\end{align} \]</div>
<p>We introduce the density matrix <span class="math notranslate nohighlight">\(P_{\alpha\beta}^l\)</span> (where as before <span class="math notranslate nohighlight">\(\alpha\)</span>,
<span class="math notranslate nohighlight">\(\beta\)</span> run over basis functions for the given <span class="math notranslate nohighlight">\(l\)</span> only):</p>
<div class="math notranslate nohighlight">
\[P_{\alpha\beta}^l = 2 \sum_{nm} C_{\alpha nlm} C_{\beta nlm}
    = \sum_{n} 2(2l+1) C_{\alpha nl} C_{\beta nl}\]</div>
<p>where the <span class="math notranslate nohighlight">\(C_{\alpha nl}\)</span> coefficients are the same for all <span class="math notranslate nohighlight">\(m\)</span> corresponding
to the given <span class="math notranslate nohighlight">\(l\)</span>. The index <span class="math notranslate nohighlight">\(n\)</span> runs over all occupied states for the given
<span class="math notranslate nohighlight">\(l\)</span>. We can write <span class="math notranslate nohighlight">\(n(r)\)</span> as</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P_{nl}(r) = \sum_\alpha C_{\alpha nl} \phi_{\alpha l}(r)\\n(r) = {1\over 4\pi} \sum_{nl} 2(2l+1) {P_{nl}^2(r)\over r^2}
    = {1\over 4\pi} \sum_{nl} 2(2l+1) \sum_{\alpha\beta}
        C_{\alpha nl}C_{\beta nl}
        {\phi_{\alpha l}(r)\phi_{\beta l}(r)\over r^2} =\\    = {1\over 4\pi} \sum_l \sum_{\alpha\beta}
        {\phi_{\alpha l}(r) P_{\alpha\beta}^l \phi_{\beta l}(r)\over r^2}\end{aligned}\end{align} \]</div>
<p>Finally we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}V_H(r) = \sum_{nl} 2(2l+1) {Y^0(P_{nl}^2(r), r) \over r}
    = {Y^0(4\pi n(r) r^2, r) \over r}
    = \sum_l \sum_{\alpha\beta} P_{\alpha\beta}^l
        {Y^0(\phi_{\alpha l}(r) \phi_{\beta l}(r), r) \over r}\\\int_0^\infty \phi_{\mu l}(r) V_H(r) \phi_{\nu l}(r) \d r
 = \sum_{l'} \sum_{\alpha\beta} P_{\alpha\beta}^{l'}
    \int_0^\infty \phi_{\mu l}(r) \phi_{\nu l}(r)
        {Y^0(\phi_{\alpha l'}(r) \phi_{\beta l'}(r), r) \over r}\d r
 = \sum_{l'} \sum_{\alpha\beta} P_{\alpha\beta}^{l'}
    R^0(\mu l, \beta l', \nu l, \alpha l')\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}-\sum_{n'l'}
    \sum_{k=|l-l'|}^{k=l+l'}
    \sqrt{2l'+1\over 2l+1}c^k(l, 0, l', 0)
    \int_0^\infty
    \phi_{\mu l}(r)
    P_{n'l'}(r)
    {Y^k(\phi_{\nu l}(r) P_{n'l'}(r), r)\over r}
    \d r =\\\begin{split}= -\sum_{n'l'}
    \sum_{k=|l-l'|}^{k=l+l'}
    2(2l'+1)
    \half \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
    \sum_{\alpha\beta}
    C_{\alpha n'l'}
    C_{\beta n'l'}
    \int_0^\infty
    \phi_{\mu l}(r)
    \phi_{\alpha l'}(r)
    {Y^k(\phi_{\nu l}(r) \phi_{\beta l'}(r), r)\over r}
    \d r =\end{split}\\\begin{split}= -\half
    \sum_{l'}
    \sum_{\alpha\beta}
    P^{l'}_{\alpha\beta}
    \sum_{k=|l-l'|}^{k=l+l'}
     \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
    R^k(\mu l, \beta l', \alpha l', \nu l)\end{split}\end{aligned}\end{align} \]</div>
<p>So we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}G_{\mu\nu}^l
 = \sum_{l'} \sum_{\alpha\beta}
    P_{\alpha\beta}^{l'} R^0(\mu l, \beta l', \nu l, \alpha l')
    -\half \sum_{l'}
            \sum_{\alpha\beta}
            P^{l'}_{\alpha\beta}
            \sum_{k=|l-l'|}^{k=l+l'}
             \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            R^k(\mu l, \beta l', \alpha l', \nu l) =\end{split}\\\begin{split} = \sum_{l'=0}^\infty \sum_{\alpha\beta} P^{l'}_{\alpha\beta} \left(
        R^0(\mu l, \beta l', \nu l, \alpha l')
            -\half \sum_{k=|l-l'|}^{k=l+l'}
             \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            R^k(\mu l, \beta l', \alpha l', \nu l) \right)\end{split}\end{aligned}\end{align} \]</div>
<p>The density matrix is zero if there are no occupied orbitals for the given
<span class="math notranslate nohighlight">\(l'\)</span>.</p>
<p>The total energy is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}E = \half \sum_{\mu\nu} P_{\mu\nu} (H_{\mu\nu}^{\mbox{core}} + F_{\mu\nu}) =\\E = \half \sum_l \sum_{\mu\nu} P^l_{\mu\nu}
    (H^{l\mbox{core}}_{\mu\nu} + F^l_{\mu\nu}) =\\= \sum_l \sum_{\mu\nu} P^l_{\mu\nu} (F^l_{\mu\nu} - \half G^l_{\mu\nu}) =\\\begin{split}= \sum_l \sum_n 2(2l+1) \left( \epsilon_{n l}
    -\sum_{l'} \sum_{n'} (2l'+1)
    \left(
        R^0(n l, n' l', n l, n' l')
            -\half \sum_{k=|l-l'|}^{k=l+l'}
             \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            R^k(n l, n' l', n' l', n l) \right)
    \right)\end{split}\end{aligned}\end{align} \]</div>
<p>where we used:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\sum_l \sum_{\mu\nu} P^l_{\mu\nu} F^l_{\mu\nu} =\\= \sum_l \sum_{\mu\nu} \sum_n 2(2l+1) C_{\mu nl}C_{\nu nl} F^l_{\mu\nu} =\\= \sum_l \sum_{\mu\nu} \sum_n 2(2l+1) C_{\mu nl}\epsilon_{n l}
    S^l_{\mu\nu} C_{\nu n l} =\\= \sum_l \sum_n 2(2l+1) \epsilon_{n l}\end{aligned}\end{align} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\half \sum_l \sum_{\mu\nu} P^l_{\mu\nu} G^l_{\mu\nu} =\\\begin{split}= \half \sum_l \sum_{\mu\nu} P^l_{\mu\nu}
 \sum_{l'} \sum_{\alpha\beta} P^{l'}_{\alpha\beta} \left(
        R^0(\mu l, \beta l', \nu l, \alpha l')
            -\half \sum_{k=|l-l'|}^{k=l+l'}
             \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            R^k(\mu l, \beta l', \alpha l', \nu l) \right) =\end{split}\\= \half \sum_l \sum_{\mu\nu} \sum_n 2(2l+1) C_{\mu nl}C_{\nu nl}
 \sum_{l'} \sum_{\alpha\beta} \sum_{n'} 2(2l'+1)
    C_{\alpha n'l'}C_{\beta n'l'}\\\begin{split}    \left(
        R^0(\mu l, \beta l', \nu l, \alpha l')
            -\half \sum_{k=|l-l'|}^{k=l+l'}
             \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            R^k(\mu l, \beta l', \alpha l', \nu l) \right) =\end{split}\\= \sum_l \sum_n 2(2l+1) \sum_{l'} \sum_{n'} (2l'+1)\\\begin{split}    \left(
        R^0(n l, n' l', n l, n' l')
            -\half \sum_{k=|l-l'|}^{k=l+l'}
             \begin{pmatrix} l &amp; k &amp; l' \\ 0 &amp; 0 &amp; 0 \end{pmatrix}^2
            R^k(n l, n' l', n' l', n l) \right)\end{split}\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="index-transformation">
<h2>8.11.15. 4-Index Transformation<a class="headerlink" href="#index-transformation" title="Permalink to this headline">¶</a></h2>
<p>The 4-index transformation is a way to convert the two particle
integrals over basis functions <span class="math notranslate nohighlight">\((\alpha \beta | \gamma \delta)\)</span> into
two particle integrals over atomic (or molecular) orbitals <span class="math notranslate nohighlight">\((ij|kl)\)</span>:</p>
<div class="math notranslate nohighlight">
\[(ij | kl) = \sum_{\alpha \beta \gamma \delta}
    C_{\alpha i}
    C_{\beta j}
    C_{\gamma k}
    C_{\delta l} (\alpha \beta | \gamma \delta)\]</div>
</div>
<div class="section" id="green-s-functions">
<h2>8.11.16. Green’s Functions<a class="headerlink" href="#green-s-functions" title="Permalink to this headline">¶</a></h2>
<p>The self energy up to a second order is given by:</p>
<div class="math notranslate nohighlight">
\[\Sigma_{ij}(E) =
    \sum_{ars} {(ir|as) (2(jr|as)-(js|ar))\over E + \epsilon_a
        -\epsilon_r - \epsilon_s} +
    \sum_{abr} {(ia|br) (2(ja|br)-(jb|ar))\over E + \epsilon_r
        -\epsilon_a - \epsilon_b}\]</div>
<p>The <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span> are occupied orbitals, <span class="math notranslate nohighlight">\(r\)</span>, <span class="math notranslate nohighlight">\(s\)</span> are virtual orbitals.
The Dyson equation is:</p>
<div class="math notranslate nohighlight" id="equation-dyson">
<span class="eqno">(8.11.16.1)<a class="headerlink" href="#equation-dyson" title="Permalink to this equation">¶</a></span>\[{\bf G}(E) = {\bf G}_0(E) + {\bf G}_0(E) {\boldsymbol\Sigma}(E) {\bf G}(E)\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf G}_0(E) = {1\over E - {\boldsymbol \epsilon}}
    = \sum_k {\ket{k}\bra{k}\over E - \epsilon_k}\\{\bf G}(E) = {1\over E - {\bf E}}
    = \sum_k {\ket{k_{int}}\bra{k_{int}}\over E - E_k}\end{aligned}\end{align} \]</div>
<p>The <span class="math notranslate nohighlight">\(\epsilon_k\)</span> and <span class="math notranslate nohighlight">\(\ket{k}\)</span> are HF energies and eigenvectors, <span class="math notranslate nohighlight">\(E_k\)</span>
and <span class="math notranslate nohighlight">\(\ket{k_{int}}\)</span> are
interacting energies and eigenvectors.
The matrix <span class="math notranslate nohighlight">\(\boldsymbol\epsilon\)</span> is a diagonal matrix of the <span class="math notranslate nohighlight">\(\epsilon_k\)</span>
eigenvalues, <span class="math notranslate nohighlight">\(\bf E\)</span> is a diagonal matrix of the <span class="math notranslate nohighlight">\(E_k\)</span> eigenvalues.
Any Green’s function <span class="math notranslate nohighlight">\({\bf G}(E)\)</span> (interacting or not) can be written using the
spectral density function <span class="math notranslate nohighlight">\({\bf A}(z)\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf G}(E) = {1\over E - {\boldsymbol \epsilon}}
    = \sum_k {\ket{k}\bra{k}\over E - \epsilon_k} =\\    = \sum_k \int_{-\infty}^{\infty}
        {\ket{k}\bra{k}\over E - z} \delta(z-\epsilon_k) \d z =\\    = \int_{-\infty}^{\infty} {{\bf A}(z)\over E-z} \d z\end{aligned}\end{align} \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{\bf A}(z) = \sum_k \ket{k}\bra{k} \delta(z-\epsilon_k) =\\= \sum_k \ket{k}\bra{k} \lim_{\eta\to0} {\eta\over\pi}
    {1\over (z-\epsilon_k)^2 + \eta^2} =\\= \sum_k \ket{k}\bra{k} \lim_{\eta\to0} {i\over 2\pi}
    \left({1\over z-\epsilon_k+i\eta} -{1\over z-\epsilon_k-i\eta}\right) =\\= \lim_{\eta\to0} {i\over 2\pi}
    \left({\bf G}(z+i\eta) - {\bf G}(z-i\eta)\right)\end{aligned}\end{align} \]</div>
<p>From <a class="reference internal" href="#equation-dyson">(8.11.16.1)</a> we get:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}{1\over {\bf G}_0(E)} {\bf G}(E) = 1 + {\boldsymbol \Sigma}(E) {\bf G}(E)\\{1\over {\bf G}_0(E)} = {1\over {\bf G}(E)} + {\boldsymbol\Sigma}(E)\\{\bf G}(E) = {1\over {1\over {\bf G}_0(E)} - {\boldsymbol \Sigma}(E)}
    = {1\over E - {\boldsymbol \epsilon} - {\boldsymbol \Sigma}(E)}\end{aligned}\end{align} \]</div>
<p>The poles <span class="math notranslate nohighlight">\(E_k\)</span> of the Green’s function <span class="math notranslate nohighlight">\({\bf G}(E)\)</span> are then given by:</p>
<div class="math notranslate nohighlight">
\[D(E) =
\det (E - {\boldsymbol \epsilon} - {\boldsymbol \Sigma}(E)) = 0\]</div>
<p>or equivalently:</p>
<div class="math notranslate nohighlight">
\[({\boldsymbol \Sigma}(E_k) + {\boldsymbol \epsilon})\ket{v} = E_k\ket{v}\]</div>
<p>and from the theory of matrices:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\Tr {1\over E-{\bf h}}
= \Tr {{\partial\over\partial E} (E-{\bf h})\over E-{\bf h}}
= \Tr {\partial\over\partial E}\log(E-{\bf h})
= {\partial\over\partial E} \Tr \log(E-{\bf h}) =\\= {\partial\over\partial E} \log | \det(E-{\bf h}) |
= {1\over\det(E-{\bf h})} {\partial \det(E-{\bf h}) \over\partial E}\end{aligned}\end{align} \]</div>
<p>one obtains that</p>
<div class="math notranslate nohighlight">
\[G_{ij}(E) = (-1)^{i+j+1} {\partial \log D(E) \over \partial
  ({\boldsymbol \Sigma}(E_k) + {\boldsymbol \epsilon})_{ji}}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\Tr {\bf G}(E) = \sum_{k} G_{kk}(E)
    = {\partial \log | D(E) | \over\partial E}\]</div>
<p>The number of particles <span class="math notranslate nohighlight">\(N\)</span> can be calculated as follows
(<span class="math notranslate nohighlight">\(a\)</span> are occupied orbitals, <span class="math notranslate nohighlight">\(k\)</span> are all orbitals):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}N = \sum_a | \braket{{\bf r} | a}|^2 =\\= \sum_a \braket{{\bf r} | a}\braket{a | {\bf r}} =\\= \Tr \sum_a \ket{a}\bra{a} =\\= {1\over 2\pi i} \Tr \int_C \sum_k {\ket{k}\bra{k}\over E-E_k}\d E =\\= {1\over 2\pi i} \int_C \Tr {\bf G}(E) \,\d E =\\= {1\over 2\pi i} \int_C {\partial \log | D(E) | \over\partial E} \,\d E\end{aligned}\end{align} \]</div>
<p>The countour <span class="math notranslate nohighlight">\(C\)</span> only encloses poles <span class="math notranslate nohighlight">\(E_a\)</span> corresponding to occupied orbitals
<span class="math notranslate nohighlight">\(a\)</span>.
Similarly for the total energy <span class="math notranslate nohighlight">\(E_{tot}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}E_{tot} = \sum_a E_a | \braket{{\bf r} | a}|^2 =\\= \sum_a \braket{{\bf r} | a} E_a \braket{a | {\bf r}} =\\= \Tr \sum_a \ket{a} E_a \bra{a} =\\= {1\over 2\pi i} \Tr \int_C \sum_k {\ket{k}\bra{k}\over E-E_k}
    E\,\d E =\\= {1\over 2\pi i} \int_C \Tr {\bf G}(E) E\,\d E =\\= {1\over 2\pi i} \int_C {\partial \log | D(E) | \over\partial E} E\,\d E\end{aligned}\end{align} \]</div>
<p>For doubly filled orbitals we multiply the expressions by 2.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">8.11. Hartree-Fock (HF) Method</a><ul>
<li><a class="reference internal" href="#derivation">8.11.1. Derivation</a></li>
<li><a class="reference internal" href="#roothaan-equations-for-closed-shell-systems">8.11.2. Roothaan Equations For Closed Shell Systems</a></li>
<li><a class="reference internal" href="#two-particle-matrix-element">8.11.3. Two Particle Matrix Element</a></li>
<li><a class="reference internal" href="#general-matrix-elements-in-spherical-symmetry">8.11.4. General Matrix Elements in Spherical Symmetry</a><ul>
<li><a class="reference internal" href="#overlap">Overlap</a></li>
<li><a class="reference internal" href="#potential">Potential</a></li>
<li><a class="reference internal" href="#kinetic">Kinetic</a></li>
<li><a class="reference internal" href="#g-matrix">G Matrix</a></li>
<li><a class="reference internal" href="#radial-roothaan-equations">Radial Roothaan Equations</a></li>
<li><a class="reference internal" href="#two-particle">Two particle</a></li>
</ul>
</li>
<li><a class="reference internal" href="#slater-type-orbitals-sto">8.11.5. Slater Type Orbitals (STO)</a><ul>
<li><a class="reference internal" href="#id1">Overlap</a></li>
<li><a class="reference internal" href="#id2">Potential</a></li>
<li><a class="reference internal" href="#id3">Kinetic</a></li>
<li><a class="reference internal" href="#id4">Two particle</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gaussian-type-orbitals-gto">8.11.6. Gaussian Type Orbitals (GTO)</a><ul>
<li><a class="reference internal" href="#id5">Overlap</a></li>
<li><a class="reference internal" href="#id6">Potential</a></li>
<li><a class="reference internal" href="#id7">Kinetic</a></li>
<li><a class="reference internal" href="#id8">Two particle</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exchange-integral-in-spherical-symmetry">8.11.7. Exchange Integral in Spherical Symmetry</a></li>
<li><a class="reference internal" href="#occupation-numbers">8.11.8. Occupation Numbers</a><ul>
<li><a class="reference internal" href="#example-i">Example I</a></li>
<li><a class="reference internal" href="#example-ii">Example II</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hartree-screening-functions">8.11.9. Hartree Screening Functions</a></li>
<li><a class="reference internal" href="#hartree-potential-in-spherical-symmetry">8.11.10. Hartree Potential in Spherical Symmetry</a></li>
<li><a class="reference internal" href="#nonlocal-exchange-potential-in-spherical-symmetry">8.11.11. Nonlocal Exchange Potential in Spherical Symmetry</a></li>
<li><a class="reference internal" href="#radial-hartree-fock-equations">8.11.12. Radial Hartree-Fock Equations</a></li>
<li><a class="reference internal" href="#total-energy">8.11.13. Total Energy</a><ul>
<li><a class="reference internal" href="#example-helium">Example: Helium</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fem">8.11.14. FEM</a></li>
<li><a class="reference internal" href="#index-transformation">8.11.15. 4-Index Transformation</a></li>
<li><a class="reference internal" href="#green-s-functions">8.11.16. Green’s Functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="fermi.html"
                        title="previous chapter">8.10. Ideal Fermi Gas</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="paw.html"
                        title="next chapter">8.12. Projector Augmented-Wave Method (PAW)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/quantum/hf.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="paw.html" title="8.12. Projector Augmented-Wave Method (PAW)"
             >next</a> |</li>
        <li class="right" >
          <a href="fermi.html" title="8.10. Ideal Fermi Gas"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" >8. Quantum Field Theory and Quantum Mechanics</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>