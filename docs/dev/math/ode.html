
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>3.38. Ordinary Differential Equations &#8212; Theoretical Physics Reference 0.5 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.39. Linear Algebra" href="la.html" />
    <link rel="prev" title="3.37. Wigner D Function" href="wigner.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head><body>
    <div style="display:none">
    \(
        \newcommand{\d}{\mathrm{d}}
        \newcommand{\bomega}{\vec\omega}
        \newcommand{\half}{ {1\over 2} }
        \def\mathnot#1{\text{"$#1$"}}

        %operators
        \newcommand{\diag}{\mathrm{diag}}
        \newcommand{\sinc}{\mathrm{sinc}}
        \newcommand{\Sh}{ {\large\style{font-family:Times}{\text{Ш}}} }
        \newcommand{\res}{\mathrm{Res}}
    \)
    </div>
    

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="la.html" title="3.39. Linear Algebra"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="wigner.html" title="3.37. Wigner D Function"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" accesskey="U">3. Mathematics</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="ordinary-differential-equations">
<h1>3.38. Ordinary Differential Equations<a class="headerlink" href="#ordinary-differential-equations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="finite-difference-formulas">
<h2>3.38.1. Finite Difference Formulas<a class="headerlink" href="#finite-difference-formulas" title="Permalink to this headline">¶</a></h2>
<p>We define the backward difference operator <img class="math" src="../_images/math/eac19d4b2566a59448fff5a3ba0130c2c733396b.svg" alt="\nabla_h"/> by:</p>
<div class="math">
<p><img src="../_images/math/695505c7610af55f4ab1c92776a02405ee5a156d.svg" alt="\nabla_h f(a) = f(a) - f(a-h)"/></p>
</div><p>Repeated application gives:</p>
<div class="math">
<p><img src="../_images/math/aaacebcbdc128caf6314831c9e698b0c5fcfe145.svg" alt="\nabla_h^2 f(a) = \nabla_h (f(a) - f(a-h))
    = f(a) - f(a-h) -f(a-h) + f(a-2h)
    = f(a) - 2f(a-h) + f(a-2h)

\nabla_h^3 f(a) = f(a) - 3f(a-h) + 3f(a-2h)-f(a-3h)

\nabla_h^n f(a) = \sum_{k=0}^n \binom{n}{k}(-1)^k f(a-kh)"/></p>
</div><p>We can also derive a formula for <img class="math" src="../_images/math/9cfb833a4c2155df8bcc582b8220eaa165eb62c8.svg" alt="f(a+t)"/> where <img class="math" src="../_images/math/7ad51d6d459e9bbdf9868b0129b30fbf89d35c09.svg" alt="t"/> is any real number,
independent of <img class="math" src="../_images/math/0b043f7a352c706fb702c01f04a66e2643b79eda.svg" alt="h"/>:</p>
<div class="math">
<p><img src="../_images/math/d672c3126daf7c2c487f4628afb0ff28e71a4104.svg" alt="f(a-h) = (1-\nabla_h) f(a)

(1-\nabla_h)^{-1} f(a-h) = f(a)

(1-\nabla_h)^{-1} f(a) = f(a+h)

(1-\nabla_h)^{-n} f(a) = f(a+nh)

(1-\nabla_h)^{-{t\over h}} f(a) = f(a+t)"/></p>
</div><p>Now we can express the following general integral using the function value from
either left (<img class="math" src="../_images/math/e22df456f515d467479f39e2a66a1ec58f80b9e8.svg" alt="f(a)"/>) or right (<img class="math" src="../_images/math/ad1992e3bcb4cf83a6a013b28acac69eeeacd062.svg" alt="f(a+h)"/>) hand side of the interval <img class="math" src="../_images/math/0b043f7a352c706fb702c01f04a66e2643b79eda.svg" alt="h"/>:</p>
<div class="math">
<p><img src="../_images/math/470da191fb3fd30ab97752ce30c012bd89b1a9a0.svg" alt="\int_a^{a+h} f(t) \,\d t
    = \int_0^h f(a+t) \,\d t
    = \int_0^h (1-\nabla_h)^{-{t\over h}} f(a) \,\d t
    =

    = - {h\nabla_h\over (1-\nabla_h) \log(1-\nabla_h)}f(a) =

    = h \left(1+\half\nabla_h + {5\over 12}\nabla_h^2+{3\over8}
        \nabla_h^3+\cdots\right) f(a) =

    = - {h\nabla_h\over \log(1-\nabla_h)} (1-\nabla_h)^{-1}f(a)
    = - {h\nabla_h\over \log(1-\nabla_h)} f(a+h) =

    = h \left(1-\half\nabla_h - {1\over 12}\nabla_h^2-{1\over24}
        \nabla_h^3+\cdots\right) f(a+h)"/></p>
</div><p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">integrate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;nabla t h&quot;</span><span class="p">)</span>
<span class="go">(nabla, t, h)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">nabla</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simplify</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">h*nabla/(-log(1 - nabla) + nabla*log(1 - nabla))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">nabla</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">h + h*nabla/2 + 5*h*nabla**2/12 + 3*h*nabla**3/8 + 251*h*nabla**4/720 + O(nabla**5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nabla</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simplify</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="go">-h*nabla/log(1 - nabla)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">nabla</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">h - h*nabla/2 - h*nabla**2/12 - h*nabla**3/24 - 19*h*nabla**4/720 + O(nabla**5)</span>
</pre></div>
</div>
<p>Keeping terms only to third-order, we obtain:</p>
<div class="math">
<p><img src="../_images/math/6f7b9adcf1da24546db095cdd1dd1f4734cac5cb.svg" alt="\int_a^{a+h} f(t) \,\d t
    = - {h\nabla_h\over (1-\nabla_h) \log(1-\nabla_h)}f(a)
    \approx h \left(1+\half\nabla_h + {5\over 12}\nabla_h^2+{3\over8}
        \nabla_h^3\right) f(a)
    =

    = h f(a) + h\half\left(f(a)-f(a-h)\right)
        +h{5\over 12}\left(f(a)-2f(a-h)+f(a-2h)\right)+

        +h{3\over8}\left(f(a)-3f(a-h)+3f(a-2h)-f(a-3h)\right)
    =

    = h\left(1+\half+{5\over12}+{3\over8}\right)f(a)
      -h\left(\half+{2\cdot5\over12}+{3\cdot3\over8}\right)f(a-h) +

      +h\left({5\over12}+{3\cdot3\over8}\right)f(a-2h)
      -h\left({3\over8}\right)f(a-3h)
    =

    = h{55\over24}f(a) -h{59\over24}f(a-h) +
      h{37\over24}f(a-2h) -h{3\over8}f(a-3h)
    =

    = {h\over24}\left(55f(a) -59f(a-h) + 37f(a-2h) -9f(a-3h)\right)"/></p>
</div><p>Similarly:</p>
<div class="math">
<p><img src="../_images/math/7a3d3b0004653df09a11e25f202493acb00db6b6.svg" alt="\int_a^{a+h} f(t) \,\d t
    = - {h\nabla_h\over\log(1-\nabla_h)}f(a+h)
    \approx h \left(1-\half\nabla_h - {1\over 12}\nabla_h^2-{1\over24}
        \nabla_h^3\right) f(a+h)
    =

    = {h\over24}\left(9f(a+h) +19f(a) -5f(a-h) +f(a-2h)\right)"/></p>
</div><p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">var</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;f0 f1 f2 f3&quot;</span><span class="p">)</span>
<span class="go">(f0, f1, f2, f3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nabla1</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">-</span> <span class="n">f1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nabla2</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nabla3</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">f1</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">f2</span> <span class="o">-</span> <span class="n">f3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">24</span><span class="o">*</span><span class="p">(</span><span class="n">f0</span> <span class="o">+</span> <span class="n">nabla1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">nabla2</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nabla3</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
<span class="go">-59*f1 - 9*f3 + 37*f2 + 55*f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">24</span><span class="o">*</span><span class="p">(</span><span class="n">f0</span> <span class="o">-</span> <span class="n">nabla1</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">nabla2</span><span class="o">/</span><span class="mi">12</span> <span class="o">-</span> <span class="n">nabla3</span><span class="o">/</span><span class="mi">24</span><span class="p">)</span>
<span class="go">f3 - 5*f2 + 9*f0 + 19*f1</span>
</pre></div>
</div>
</div>
<div class="section" id="integrating-ode">
<h2>3.38.2. Integrating ODE<a class="headerlink" href="#integrating-ode" title="Permalink to this headline">¶</a></h2>
<p>Set of linear ODEs can be written in the form:</p>
<div class="math" id="equation-ode-eq">
<p><span class="eqno">(3.38.2.1)<a class="headerlink" href="#equation-ode-eq" title="Permalink to this equation">¶</a></span><img src="../_images/math/a91d76bfd6373960b04a5a6d26e0608556dc3512.svg" alt="{\d y\over\d r} = G y"/></p>
</div><p>For example for the Schrödinger we have</p>
<div class="math">
<p><img src="../_images/math/5f861c09939a302b0e7d7ee0aedc9d58f8afb27b.svg" alt="y = \begin{pmatrix}
    P \\
    Q
    \end{pmatrix}

G = \begin{pmatrix}
    0 &amp; 1 \\
    -2(E-V) - {l(l+1)\over r^2} &amp; 0 \\
    \end{pmatrix}"/></p>
</div><p>Now we need to choose a grid <img class="math" src="../_images/math/cd6f7f5a8267a17ff4482b681469da4ae91b62d8.svg" alt="r = r(t)"/>, where <img class="math" src="../_images/math/7ad51d6d459e9bbdf9868b0129b30fbf89d35c09.svg" alt="t"/> is some uniform grid. For
example <img class="math" src="../_images/math/b34455fa3f914c1a0d8370a9f1dd44f1d2b7c9b0.svg" alt="r = r_0 (e^t-1)"/>:</p>
<div class="math">
<p><img src="../_images/math/156a1d393159dc6d8f674d54282c7fd54a76fe41.svg" alt="r_i = r_0 (e^{t_i} - 1)

t_i = (i-1)h"/></p>
</div><p>where <img class="math" src="../_images/math/4d98375403819e2fcd6251f4336a6f7bdc0b6285.svg" alt="i = 1, 2, 3, \dots, N"/>. We also need the derivative, for the exampe
above we get:</p>
<div class="math">
<p><img src="../_images/math/8ea5298cf647a744d31a4ded3e66e311f4ea83c2.svg" alt="{\d r\over\d t} = r_0 e^t"/></p>
</div><p>Now we substitute this into <a class="reference internal" href="#equation-ode-eq">(3.38.2.1)</a>:</p>
<div class="math">
<p><img src="../_images/math/f145a585234e3354dd430de5076aa3b5851e6087.svg" alt="{\d y\over\d t} = {\d r\over\d t} G y"/></p>
</div><p>We can integrate this system from <img class="math" src="../_images/math/ff066e4162ecea3b1eeadcc4c6fa8ced9cfaf575.svg" alt="a"/> to <img class="math" src="../_images/math/d0ea81424c73777041ee81bea53ccc0565810321.svg" alt="a+h"/> on a uniform grid <img class="math" src="../_images/math/1328d870bc95a9d030bfbb0338f9437884293187.svg" alt="t_i"/>:</p>
<div class="math">
<p><img src="../_images/math/c8b1dddd2c7df68858a347e7ec585d9419fe32a8.svg" alt="y(a+h) = y(a) + \int_a^{a+h} {\d r\over\d t} G y\,\d t
    = y(a) + \int_a^{a+h} f(t)\,\d t"/></p>
</div><p>where <img class="math" src="../_images/math/282ff7dafd467c4e9d26ff1597f34156118a93f5.svg" alt="f(t) = {\d r\over\d t} G y"/> and we use some method to approximate the
integral, see the previous section.</p>
</div>
<div class="section" id="radial-poisson-equation">
<h2>3.38.3. Radial Poisson Equation<a class="headerlink" href="#radial-poisson-equation" title="Permalink to this headline">¶</a></h2>
<p>Radial Poisson equation is:</p>
<div class="math" id="equation-poisson-v">
<p><span class="eqno">(3.38.3.1)<a class="headerlink" href="#equation-poisson-v" title="Permalink to this equation">¶</a></span><img src="../_images/math/fadff7491047b43cdb63dd1616d214d6f154bc9c.svg" alt="V''(r) + {2\over r} V'(r) = -4\pi n(r)"/></p>
</div><p>The left hand side can be written as:</p>
<div class="math">
<p><img src="../_images/math/76fa235d44f3ca27a54410a462a0fa4cce624e68.svg" alt="V'' + {2\over r} V'
    = {1\over r} \left(r V'' + 2V'\right)
    = {1\over r} \left(r V\right)''"/></p>
</div><p>So the Poisson equation can also be written as:</p>
<div class="math" id="equation-poisson-rv">
<p><span class="eqno">(3.38.3.2)<a class="headerlink" href="#equation-poisson-rv" title="Permalink to this equation">¶</a></span><img src="../_images/math/f09e20ec65bbce1c8abbc411451a069a9aa4d542.svg" alt="(rV)'' = -4\pi r\, n"/></p>
</div><p>Now we determine the values of <img class="math" src="../_images/math/26e486b0b3acbada5354da18c4db71306300cda8.svg" alt="V(0)"/>, <img class="math" src="../_images/math/17d9df71a1dc0a39c0ded248e03121cf62faca88.svg" alt="V'(0)"/> and the behavior of
<img class="math" src="../_images/math/d4b3707afe28134cd20bfb7b198dc8970ff762be.svg" alt="V(\infty)"/> and <img class="math" src="../_images/math/264a12ff148eadf01040486ffcb4da1a9200ead8.svg" alt="V'(\infty)"/>. The equation determines <img class="math" src="../_images/math/d2eeb453d8cdb59f1e536084a98b1b40d1bc123f.svg" alt="V"/> up to an
arbitrary constant, so we set <img class="math" src="../_images/math/5409739b7ae63137815dc1c5643fde94ea908e94.svg" alt="V(\infty) = 0"/> and now the potential <img class="math" src="../_images/math/d2eeb453d8cdb59f1e536084a98b1b40d1bc123f.svg" alt="V"/> is
determined uniquely.</p>
<p>The 3D integral of the (number) density is equal to the total (numeric) charge, which is equal to <img class="math" src="../_images/math/11fbe21c5214ca73736644386377c0a20b7dcc6e.svg" alt="Z"/> (number of electrons). We can then use the Poisson equation to rewrite the integral in terms of <img class="math" src="../_images/math/d2eeb453d8cdb59f1e536084a98b1b40d1bc123f.svg" alt="V"/>:</p>
<div class="math">
<p><img src="../_images/math/d68bcd2d14b7c43de99fac6b64d79ffb1651df5e.svg" alt="Z = \int n({\bf x}) \d^3 x
    = \int n(r) r^2\d\Omega\d r
    = \int_0^\infty 4\pi n(r) r^2\d r =

    = -\int_0^\infty (rV)'' r\d r =

    = \int_0^\infty (rV)'\d r - [(rV)'r]_0^\infty =

    = [rV]_0^\infty - [(rV)'r]_0^\infty =

    = [rV - (rV)'r]_0^\infty =

    = -[V'r^2]_0^\infty =

    = \lim_{r\to0} V'(r)r^2 -\lim_{r\to\infty} V'(r)r^2"/></p>
</div><p>Let</p>
<div class="math">
<p><img src="../_images/math/1a9ffe9040cb2c5c56303dea594ef2611f89735c.svg" alt="\lim_{r\to0} V'(r)r^2 = C"/></p>
</div><p>Then around <img class="math" src="../_images/math/71a1de5e6a4341a3a62d3d07d7e73fd452a58c8a.svg" alt="r\to0"/> we get <img class="math" src="../_images/math/8af508151b0b8f292fe7635d4e3360381daecd73.svg" alt="V'(r) = {C\over r^2}"/> and <img class="math" src="../_images/math/1449a7cdc5b435474586c1854cd6c51745bbcdf5.svg" alt="V(r) = -{C\over r}+D"/>
(for some constant <img class="math" src="../_images/math/3fd412c6c80b7a76e8c86d2dfa89ac65668ae1f6.svg" alt="D"/>). As such, <img class="math" src="../_images/math/6e7e2a5448a5278e14f22e7184aba8f70c6d0c58.svg" alt="C"/> is a point charge (delta function) at
the origin. From now on, we will assume no point charge, i.e. <img class="math" src="../_images/math/924f76382938b26e5825b13a19e6fedd40dcbe6a.svg" alt="C=0"/>.</p>
<p>In the limit <img class="math" src="../_images/math/1326a1ccadc4ac3cbda8aeab354139d54531a5c1.svg" alt="r\to\infty"/>, we get the equation:</p>
<div class="math">
<p><img src="../_images/math/c1666af5775ad97fa4df21fa2305ab1df846a29b.svg" alt="V'(r) = -{Z-C\over r^2} = -{Z\over r^2}"/></p>
</div><p>by integrating (and requiring that <img class="math" src="../_images/math/d2eeb453d8cdb59f1e536084a98b1b40d1bc123f.svg" alt="V"/> vanished in infinity to get rid of the
integration constant), we get for <img class="math" src="../_images/math/1326a1ccadc4ac3cbda8aeab354139d54531a5c1.svg" alt="r\to\infty"/>:</p>
<div class="math">
<p><img src="../_images/math/0a00f01c2e54768743b69dadfc972433823ee0b5.svg" alt="V(r) = {Z\over r}"/></p>
</div><p>Integrating <a class="reference internal" href="#equation-poisson-rv">(3.38.3.2)</a> directly, we get:</p>
<div class="math">
<p><img src="../_images/math/dade5c8c2f0328ad2eb87c9cfd5b85c64d7ffe7b.svg" alt="[(rV)']_0^\infty = -4\pi\int_0^\infty r n(r) \d r

[V + rV']_0^\infty = -4\pi\int_0^\infty r n(r) \d r"/></p>
</div><p>We already know that <img class="math" src="../_images/math/cfc4a1e44e3d51ef4e2fbada3818f7af51b80872.svg" alt="V'"/> behaves like <img class="math" src="../_images/math/e76260b2c5acea63fb90c82f510c6516a9ea420f.svg" alt="-{Z\over r^2}"/> in infinity,
so <img class="math" src="../_images/math/00d8df8d7b0b23c4a64eb2d30e0d7794a9006a40.svg" alt="rV'"/> vanishes. Requiring <img class="math" src="../_images/math/d2eeb453d8cdb59f1e536084a98b1b40d1bc123f.svg" alt="V"/> itself to
vanish in infinity, the left hand side simplifies to <img class="math" src="../_images/math/16c65d0f405707862dc55af32f73b561caaf1d65.svg" alt="-V(0)"/> and we get:</p>
<div class="math">
<p><img src="../_images/math/b20147dc75f336f0c4737f54fc9589f8bf906ca1.svg" alt="V(0) = 4\pi\int_0^\infty r n(r) \d r"/></p>
</div><p>Last thing to determine is <img class="math" src="../_images/math/17d9df71a1dc0a39c0ded248e03121cf62faca88.svg" alt="V'(0)"/>. To do that, we expand the charge density
and potential (and it’s derivatives) into a series around the origin:</p>
<div class="math">
<p><img src="../_images/math/d02ba7c94c945e94bb29cb9f09e5631885b6ae03.svg" alt="n(r) = n_0 + n_1 r + n_2 r^2 + \cdots = \sum_{k=0}^\infty n_k r^k

V(r) = V_0 + V_1 r + V_2 r^2 + \cdots = \sum_{k=0}^\infty V_k r^k

V'(r) = \sum_{k=1}^\infty V_k k r^{k-1}

V''(r) = \sum_{k=2}^\infty V_k k(k-1) r^{k-2}"/></p>
</div><p>And substitute into the equation <a class="reference internal" href="#equation-poisson-v">(3.38.3.1)</a>:</p>
<div class="math">
<p><img src="../_images/math/608bd24ba73e39e83682319c4fefd30111004abf.svg" alt="\sum_{k=2}^\infty V_k k(k-1) r^{k-2} +
    {2\over r}\sum_{k=1}^\infty V_k k r^{k-1} =
    -4\pi \sum_{k=0}^\infty n_k r^k

\sum_{k=2}^\infty V_k k(k-1) r^{k-2} + {2\over r} V_1 +
    {2\over r}\sum_{k=2}^\infty V_k k r^{k-1} =
    -4\pi \sum_{k=0}^\infty n_k r^k

\sum_{k=2}^\infty V_k k(k-1) r^{k-2} + {2\over r} V_1 +
    \sum_{k=2}^\infty 2V_k k r^{k-2} =
    -4\pi \sum_{k=0}^\infty n_k r^k

{2\over r} V_1 +
    \sum_{k=2}^\infty V_k k\left((k-1) +2\right)r^{k-2}
    =
    -4\pi \sum_{k=0}^\infty n_k r^k

{2\over r} V_1 +
    \sum_{k=2}^\infty V_k k(k+1)r^{k-2}
    =
    -4\pi \sum_{k=0}^\infty n_k r^k

{2\over r} V_1 +
    \sum_{l=0}^\infty V_{l+2} (l+2)(l+3)r^l
    =
    -4\pi \sum_{k=0}^\infty n_k r^k

{2\over r} V_1
    =
    -\sum_{k=0}^\infty \left(4\pi n_k+V_{k+2} (k+2)(k+3)\right) r^k"/></p>
</div><p>We now multiply the whole equation by <img class="math" src="../_images/math/c3d0937ae47b2f52cec7965ba469ca54a3403a43.svg" alt="r"/> and then set <img class="math" src="../_images/math/3d83df94da83cbdc3b9f3114e724e93767b9e664.svg" alt="r=0"/>. We get
<img class="math" src="../_images/math/8fd20906dd836e15945d7ebacb2433ea796c7026.svg" alt="V_1 = 0"/>, so <img class="math" src="../_images/math/cfed2025643905f37235b32eef198abe7f0f8bd8.svg" alt="V'(0) = V_1 = 0"/>. We put it back into the equation to get:</p>
<div class="math">
<p><img src="../_images/math/457f499b729ee01ebfafb0aef684aa73cc765ee2.svg" alt="\sum_{k=0}^\infty \left(4\pi n_k+V_{k+2} (k+2)(k+3)\right) r^k = 0"/></p>
</div><p>This must hold for all <img class="math" src="../_images/math/c3d0937ae47b2f52cec7965ba469ca54a3403a43.svg" alt="r"/>, so we get the following set of equations for <img class="math" src="../_images/math/e00c3a97420a049ad0cd1902903d8ca496cbe3e5.svg" alt="k=0,
1, \cdots"/>:</p>
<div class="math">
<p><img src="../_images/math/8409ef206cb480c045d40fb7708ca26a2db5530a.svg" alt="4\pi n_k+V_{k+2} (k+2)(k+3) = 0"/></p>
</div><p>from which we express <img class="math" src="../_images/math/0d2bb9f3bf5dc68b8afeeeb65a73a644e23695b9.svg" alt="V_k"/> for all <img class="math" src="../_images/math/9d94ebc5f74d668a50bd132f44ddb70e652fa477.svg" alt="k \ge 2"/>.
We already know the values for <img class="math" src="../_images/math/ca40308a8527b69893f78a385a32488bc34c7e7e.svg" alt="k=1"/> and
<img class="math" src="../_images/math/4cee3a63ffbbea2a53315c9a8ebc0f28a009c6d2.svg" alt="k=0"/> from earlier, so overall we get:</p>
<div class="math">
<p><img src="../_images/math/8ea20d528ab14c2f068e01662d77387e5598d688.svg" alt="V_0 = 4\pi\int_0^\infty r n(r) \d r

V_1 = 0

V_{k+2} = -{4\pi n_k\over (k+2)(k+3)}"/></p>
</div><p>in particular:</p>
<div class="math">
<p><img src="../_images/math/44351c72f5bff4aca5bba9b9a754bd4dd0cb13c9.svg" alt="V_2 = - {4\pi n_0\over 6} = -{2\pi\over 3} n_0

V_3 = - {4\pi n_1\over 12} = -{\pi\over 3} n_1

V_4 = - {4\pi n_2\over 20} = -{\pi\over 5} n_2

V_5 = - {4\pi n_3\over 30} = -{2\pi\over 15} n_3

\cdots"/></p>
</div><p>So we get the following series expansion for <img class="math" src="../_images/math/d2eeb453d8cdb59f1e536084a98b1b40d1bc123f.svg" alt="V"/> and <img class="math" src="../_images/math/cfc4a1e44e3d51ef4e2fbada3818f7af51b80872.svg" alt="V'"/>:</p>
<div class="math">
<p><img src="../_images/math/722c3c9b8f645e9236be8df7ab6f16c99481f49b.svg" alt="V = V_0 -{2\pi\over 3} n_0 r^2 -{\pi\over 3} n_1 r^3-{\pi\over 5} n_2 r^4
    -{2\pi\over 15} n_3 r^5 - \cdots

V' = -{4\pi\over 3} n_0 r -\pi n_1 r^2-{4\pi\over 5} n_2 r^3
    -{2\pi\over 3} n_3 r^4 - \cdots"/></p>
</div><div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>It is useful to have analytic solutions to test the numerical solvers. Here we
present a few.</p>
<div class="section" id="gaussian-charge">
<h4>Gaussian Charge<a class="headerlink" href="#gaussian-charge" title="Permalink to this headline">¶</a></h4>
<p>The Gaussian charge is simply a Gaussian, normalized in such a way that the
total charge is <img class="math" src="../_images/math/11fbe21c5214ca73736644386377c0a20b7dcc6e.svg" alt="Z"/>:</p>
<div class="math" id="equation-gauss-charge">
<p><span class="eqno">(3.38.3.3)<a class="headerlink" href="#equation-gauss-charge" title="Permalink to this equation">¶</a></span><img src="../_images/math/426cbd247845ee9cd690c6dbe9462b27c1964204.svg" alt="n(r) = {Z\alpha^3 \over \pi^{3\over2} } e^{-\alpha^2 r^2}"/></p>
</div><p>Let us verify the normalization by calculating the total charge <img class="math" src="../_images/math/bbf94025659d6b619a223561bfe944c7ecc466eb.svg" alt="Q"/>:</p>
<div class="math">
<p><img src="../_images/math/9c8a3f21c343cbf6bc7d82893d8b00bc564f7e79.svg" alt="Q = \int n({\bf x}) \d^3 x
    = 4\pi \int_0^\infty n(r) r^2 \d r =

= 4\pi \int_0^\infty {Z\alpha^3 \over \pi^{3\over2} } e^{-\alpha^2 r^2}
    r^2 \d r =

= {4 Z \alpha^3 \over \sqrt\pi} \int_0^\infty e^{-\alpha^2 r^2} r^2 \d r =

= {4 Z \alpha^3 \over \sqrt\pi} {\sqrt\pi\over 4\alpha^3} = Z"/></p>
</div><p>So the total charge is <img class="math" src="../_images/math/56ca685ed6a70c0254dbf1e772fc5932b39f454c.svg" alt="Q=Z"/>, as expected. Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="go">r</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span><span class="o">=</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integrate</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">sqrt(pi)/(4*alpha**3)</span>
</pre></div>
</div>
<p>Now we calculate the potential <img class="math" src="../_images/math/9596bff6b74e06753f013f7d6f142dd598f78bd7.svg" alt="V(r)"/> from the Poisson equation
<a class="reference internal" href="#equation-poisson-rv">(3.38.3.2)</a>:</p>
<div class="math">
<p><img src="../_images/math/b5431501f9b1c89b7994da77d39900b0e1dccbdb.svg" alt="\left(rV(r)\right)'' = -4\pi r n(r)
    = -{4\alpha^3 r Z\over \sqrt\pi } e^{-\alpha^2 r^2}

\left(rV(r)\right)' = {2 Z\alpha\over \sqrt\pi } e^{-\alpha^2 r^2} + A

r V(r) = Z \,\mbox{erf}(\alpha r) + Ar + B

V(r) = Z \,{\mbox{erf}(\alpha r) \over r} + A + {B\over r}"/></p>
</div><p>We have two integration constants <img class="math" src="../_images/math/8118ffcbaf4ae98a9fae25d800a304a342eedb8d.svg" alt="A"/> and <img class="math" src="../_images/math/8eb7c8af84dc3945487fc2588e930f59b4aa574c.svg" alt="B"/>. We fix the potential using the
condition <img class="math" src="../_images/math/5409739b7ae63137815dc1c5643fde94ea908e94.svg" alt="V(\infty) = 0"/>, which implies <img class="math" src="../_images/math/b6c1a095491e61daaba64e158f1b9bc2484dd89a.svg" alt="A=0"/>. The other constant <img class="math" src="../_images/math/8eb7c8af84dc3945487fc2588e930f59b4aa574c.svg" alt="B"/> is a
point charge at the origin, which in our case <a class="reference internal" href="#equation-gauss-charge">(3.38.3.3)</a> is zero, so
<img class="math" src="../_images/math/c12e11f20e0f5778d1395f53e6a4a585424b4eb4.svg" alt="B=0"/>.</p>
<p>We finally obtain the potential:</p>
<div class="math">
<p><img src="../_images/math/bc671c9f33ef9ad48fcaf7b7828d4147c96c8172.svg" alt="V(r) = Z \,{\mbox{erf}(\alpha r) \over r}"/></p>
</div><p>We can calculate the electrostatic self-energy, i.e. the energy of
interaction of the charge <img class="math" src="../_images/math/70a3b77789654e5324af7f780f01b7d9a5620954.svg" alt="n(r)"/> with the potential generated by this
charge <img class="math" src="../_images/math/9596bff6b74e06753f013f7d6f142dd598f78bd7.svg" alt="V(r)"/>:</p>
<div class="math">
<p><img src="../_images/math/c93b2a2b0c8cf11e37f78961c7ca63c0ceaf9201.svg" alt="E_\mathrm{self} =
\half \int n({\bf x}) V({\bf x}) \d^3 x
    = {4\pi\over2} \int_0^\infty n(r) V(r) r^2 \d r =

= 2\pi \int_0^\infty {Z\alpha^3 \over \pi^{3\over2} } e^{-\alpha^2 r^2}
    Z \,{\mbox{erf}(\alpha r) \over r} r^2 \d r =

= {2 Z^2 \alpha^3 \over \sqrt\pi}
    \int_0^\infty e^{-\alpha^2 r^2} \mbox{erf}(\alpha r) r \d r =

= {2 Z^2 \alpha^3 \over \sqrt\pi} {\sqrt 2 \over 4\alpha^2} =

= {Z^2 \alpha\over \sqrt{2\pi}}"/></p>
</div><p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">oo</span><span class="p">,</span> <span class="n">erf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="go">r</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span><span class="o">=</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integrate</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">erf</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">sqrt(2)/(4*alpha**2)</span>
</pre></div>
</div>
</div>
<div class="section" id="exponential-charge">
<h4>Exponential Charge<a class="headerlink" href="#exponential-charge" title="Permalink to this headline">¶</a></h4>
<p>The exponential charge is simply an exponential, normalized in such a way that
the total charge is <img class="math" src="../_images/math/11fbe21c5214ca73736644386377c0a20b7dcc6e.svg" alt="Z"/>:</p>
<div class="math" id="equation-exp-charge">
<p><span class="eqno">(3.38.3.4)<a class="headerlink" href="#equation-exp-charge" title="Permalink to this equation">¶</a></span><img src="../_images/math/d04d604c5cddeb1b4716bb1cd3d3ab81464d2d72.svg" alt="n(r) = {Z\alpha^3 \over 8\pi} e^{-\alpha r}"/></p>
</div><p>Let us verify the normalization by calculating the total charge <img class="math" src="../_images/math/bbf94025659d6b619a223561bfe944c7ecc466eb.svg" alt="Q"/>:</p>
<div class="math">
<p><img src="../_images/math/8a5afe105ffad6739b0af38fc739a3385dbbd19f.svg" alt="Q = \int n({\bf x}) \d^3 x
    = 4\pi \int_0^\infty n(r) r^2 \d r =

= 4\pi \int_0^\infty {Z\alpha^3 \over 8\pi} e^{-\alpha r}
    r^2 \d r =

= {Z \alpha^3 \over 2} \int_0^\infty e^{-\alpha r} r^2 \d r =

= {Z \alpha^3 \over 2} {2\over\alpha^3} = Z"/></p>
</div><p>So the total charge is <img class="math" src="../_images/math/56ca685ed6a70c0254dbf1e772fc5932b39f454c.svg" alt="Q=Z"/>, as expected.</p>
<p>Now we calculate the potential <img class="math" src="../_images/math/9596bff6b74e06753f013f7d6f142dd598f78bd7.svg" alt="V(r)"/> from the Poisson equation
<a class="reference internal" href="#equation-poisson-rv">(3.38.3.2)</a>:</p>
<div class="math">
<p><img src="../_images/math/3f0201e987ee522fd48a706326f7b7044a6782e2.svg" alt="\left(rV(r)\right)'' = -4\pi r n(r)
    = -{Z\alpha^3 \over 2} r e^{-\alpha r}

V(r) = - Z \left({\alpha\over2} + {1\over r}\right) e^{-\alpha r} + A + {B\over r}"/></p>
</div><p>Similarly as for the Gaussian charge, we require the potential <img class="math" src="../_images/math/9596bff6b74e06753f013f7d6f142dd598f78bd7.svg" alt="V(r)"/> to vanish
at infinity, which implies <img class="math" src="../_images/math/b6c1a095491e61daaba64e158f1b9bc2484dd89a.svg" alt="A=0"/>. Then we calculate the point charge at the
origin:</p>
<div class="math">
<p><img src="../_images/math/5b383a37a1e8da6b28eefc1ccec03ba97ca72eaf.svg" alt="C = \lim_{r\to0} V'(r)r^2 =

= \lim_{r\to0}
\half \left(- 2 B e^{\alpha r} + Z \alpha r \left(\alpha r + 1\right)
+ Z \left(\alpha r + 2\right)\right) e^{- \alpha r} =

= Z - B"/></p>
</div><p>We do not have any point charge at the origin, so <img class="math" src="../_images/math/11f6c3cc8c794c21db1407375e4e82ceb7e5ba03.svg" alt="C=Z - B = 0"/>, from which it
follows <img class="math" src="../_images/math/d1c9a1d021e03bf9f9080197f65e9e136be85ccb.svg" alt="B = Z"/>. We finally obtain:</p>
<div class="math">
<p><img src="../_images/math/40ac8e180313b00b393cccba518f699a484a8440.svg" alt="V(r) = - Z \left({\alpha\over2} + {1\over r}\right) e^{-\alpha r}
    + {Z \over r}
    = Z \left({1-e^{-\alpha r} \over r} - {\alpha e^{-\alpha r}
        \over 2}\right)"/></p>
</div><p>Let us calculate the self-energy:</p>
<div class="math">
<p><img src="../_images/math/44a4d71c010d23cc4cfa7e18532d47255085ef6d.svg" alt="E_\mathrm{self} =
\half \int n({\bf x}) V({\bf x}) \d^3 x
    = {4\pi\over2} \int_0^\infty n(r) V(r) r^2 \d r =

= 2\pi \int_0^\infty
{Z\alpha^3 \over 8\pi} e^{-\alpha r}
Z \left({1-e^{-\alpha r} \over r} - {\alpha e^{-\alpha r}
        \over 2}\right)
r^2 \d r =

= {Z^2 \alpha^3 \over 4}
    \int_0^\infty e^{-\alpha r}
   \left({1-e^{-\alpha r} \over r} - {\alpha e^{-\alpha r}
        \over 2}\right)
    r^2 \d r =

= {Z^2 \alpha^3 \over 4}
    \left({5\over 8\alpha^2}\right) =

= {5Z^2 \alpha \over 32}"/></p>
</div><p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;r Z B&quot;</span><span class="p">)</span>
<span class="go">(r, Z, B)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span><span class="o">=</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integrate</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">2/alpha**3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">alpha</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">r</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">-Z*(alpha*r + 2)*exp(-alpha*r)/(2*r)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="n">V</span><span class="o">+</span><span class="n">B</span><span class="o">/</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">(-2*B*exp(alpha*r) + Z*alpha*r*(alpha*r + 1) + Z*(alpha*r +</span>
<span class="go">2))*exp(-alpha*r)/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="n">V</span><span class="o">+</span><span class="n">B</span><span class="o">/</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">-B + Z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integrate</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">r</span><span class="p">))</span><span class="o">/</span><span class="n">r</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">5/(8*alpha**2)</span>
</pre></div>
</div>
</div>
<div class="section" id="piecewise-polynomial-charge">
<h4>Piecewise Polynomial Charge<a class="headerlink" href="#piecewise-polynomial-charge" title="Permalink to this headline">¶</a></h4>
<p>We will use a second-derivative continuous piecewise polynomial for <img class="math" src="../_images/math/70a3b77789654e5324af7f780f01b7d9a5620954.svg" alt="n(r)"/>,
normalized in such a way that the total charge is <img class="math" src="../_images/math/11fbe21c5214ca73736644386377c0a20b7dcc6e.svg" alt="Z"/>:</p>
<div class="math" id="equation-poly-charge">
<p><span class="eqno">(3.38.3.5)<a class="headerlink" href="#equation-poly-charge" title="Permalink to this equation">¶</a></span><img src="../_images/math/61d6c943b705043ce061f03be0ee8422db0ac736.svg" alt="n(r) = \begin{cases}
-21Z(r-r_c)^3(6r^2+3rr_c+r_c^2)/(5\pi r_c^8) &amp;\quad\mbox{for $0\le r \le r_c$}\cr
0&amp;\quad\mbox{for $r&gt;r_c$}\cr
\end{cases}"/></p>
</div><p>Let us verify the normalization by calculating the total charge <img class="math" src="../_images/math/bbf94025659d6b619a223561bfe944c7ecc466eb.svg" alt="Q"/>:</p>
<div class="math">
<p><img src="../_images/math/5bcfabf7ec7d5cc9c3e5332ee74cad264ca43dbb.svg" alt="Q = \int n({\bf x}) \d^3 x
    = 4\pi \int_0^\infty n(r) r^2 \d r =

= 4\pi \int_0^{r_c} -21Z(r-r_c)^3(6r^2+3rr_c+r_c^2)/(5\pi r_c^8)
    r^2 \d r =

= Z"/></p>
</div><p>So the total charge is <img class="math" src="../_images/math/56ca685ed6a70c0254dbf1e772fc5932b39f454c.svg" alt="Q=Z"/>, as expected.</p>
<p>Now we calculate the potential <img class="math" src="../_images/math/9596bff6b74e06753f013f7d6f142dd598f78bd7.svg" alt="V(r)"/> from the Poisson equation
<a class="reference internal" href="#equation-poisson-rv">(3.38.3.2)</a>:</p>
<div class="math">
<p><img src="../_images/math/21fe1704b3b611027b6af77c0e3e460ef6b089fb.svg" alt="\left(rV(r)\right)'' = -4\pi r n(r)
    = 4\pi r \cdot 21Z(r-r_c)^3(6r^2+3rr_c+r_c^2)/(5\pi r_c^8)

V(r) = \begin{cases}
\frac{Z r^{2}}{5 r_{c}^{8}} \left(9 r^{5} - 30 r^{4} r_{c} + 28
r^{3} r_{c}^{2} - 14 r_{c}^{5}\right) + A_1 + {B_1\over r}
&amp;\quad\mbox{for $0\le r \le r_c$}\cr
A_2 + {B_2\over r}&amp;\quad\mbox{for $r&gt;r_c$}\cr
\end{cases}"/></p>
</div><p>Similarly as for the Gaussian charge, we require the potential <img class="math" src="../_images/math/9596bff6b74e06753f013f7d6f142dd598f78bd7.svg" alt="V(r)"/> to vanish
at infinity, which implies <img class="math" src="../_images/math/21665e78e2592da85abf34de0e4d4b9f3c49ac46.svg" alt="A_2=0"/>. Then we calculate the point charge at the
origin:</p>
<div class="math">
<p><img src="../_images/math/4186bdf3d18161f233352392d4d64dc933f3eb4e.svg" alt="C = \lim_{r\to0} V'(r)r^2 =

= \lim_{r\to0}\left(
- B_1 + \frac{63 Z r^{8}}{5 r_{c}^{8}} - \frac{36 Z}{r_{c}^{7}} r^{7} +
  \frac{28 Z}{r_{c}^{6}} r^{6} - \frac{28 Z r^{3}}{5 r_{c}^{3}}
  \right)

= -B_1"/></p>
</div><p>We do not have any point charge at the origin, so <img class="math" src="../_images/math/462b43037fd9905f513fb33011b0579f6962b327.svg" alt="C=-B_1 = 0"/>, from which it
follows <img class="math" src="../_images/math/f243496c16db306487fa757b89b733d282f020de.svg" alt="B_1 = 0"/>. Then <img class="math" src="../_images/math/c54a97a538289819f88751f7ce2cbcad5dcec32a.svg" alt="B_2"/> is calculated from the condition of a continuous
first derivative at <img class="math" src="../_images/math/dd16b4dae251ca807ab2566e342cb2f19b4852c5.svg" alt="r=r_c"/>:</p>
<div class="math">
<p><img src="../_images/math/c07f809c742c1ee64e72c73521968ce215d8aaaa.svg" alt="V'(r_c) = \begin{cases}
-{Z\over r_c^2} &amp;\quad\mbox{for $0\le r \le r_c$}\cr
-{B_2\over r_c^2}&amp;\quad\mbox{for $r&gt;r_c$}\cr
\end{cases}"/></p>
</div><p>So <img class="math" src="../_images/math/ea40ba54198c302d9062b15175ea45517a774b66.svg" alt="B_2=Z"/>. Finally, <img class="math" src="../_images/math/5246b7c40ca8f7f0f41040d8c5d6f8304add9c13.svg" alt="A_1"/> is calculated from the continuous
values of <img class="math" src="../_images/math/e49c01c6ba3483accc02eb0497a910ed4a65d516.svg" alt="V(r_c)"/>:</p>
<div class="math">
<p><img src="../_images/math/be4bfd91ac7ac07cff98c39c465446e850d24ce3.svg" alt="V(r_c) = \begin{cases}
A_1-{7Z\over 5r_c} &amp;\quad\mbox{for $0\le r \le r_c$}\cr
{Z\over r_c}&amp;\quad\mbox{for $r&gt;r_c$}\cr
\end{cases}"/></p>
</div><p>which implies <img class="math" src="../_images/math/f6ec96dfb3ec0a1667b62120c1b30755d15908d6.svg" alt="A_1={12Z\over 5r_c}"/>. We finally obtain:</p>
<div class="math">
<p><img src="../_images/math/a81505280feca46e12e50f98883e9941c74bfbfd.svg" alt="V(r) = \begin{cases}
\frac{Z}{5 r_{c}^{8}} \left(9r^7 - 30r^6r_c + 28r^5r_c^2 - 14r^2r_c^5
    + 12 r_c^7\right) &amp;\quad\mbox{for $0\le r \le r_c$}\cr
{Z\over r}&amp;\quad\mbox{for $r&gt;r_c$}\cr
\end{cases}"/></p>
</div><p>Let us calculate the self-energy:</p>
<div class="math">
<p><img src="../_images/math/ea47c670017d72db6547792a02248c1f8b13bdcd.svg" alt="E_\mathrm{self} =
\half \int n({\bf x}) V({\bf x}) \d^3 x
    = {4\pi\over2} \int_0^\infty n(r) V(r) r^2 \d r =

= 2\pi \int_0^{r_c}
-21Z(r-r_c)^3(6r^2+3rr_c+r_c^2)/(5\pi r_c^8)
\frac{Z}{5 r_{c}^{8}} \left(9r^7 - 30r^6r_c + 28r^5r_c^2 - 14r^2r_c^5
    + 12 r_c^7\right)
r^2 \d r =

= {15962 Z^2 \over 17875 r_c}"/></p>
</div><p>Let us also calculate the following integral:</p>
<div class="math">
<p><img src="../_images/math/e2e6e873b910b0ce7dd17c035f462d2486d212f9.svg" alt="I_g =
\int n({\bf x}) \left({Z\over r}-V({\bf x})\right) \d^3 x
    = 4\pi \int_0^\infty n(r) \left({Z\over r}-V(r)\right) r^2 \d r =

= {10976 Z^2 \over 17875 r_c}"/></p>
</div><p>Which agrees with <a class="reference internal" href="#pask2012" id="id1">[Pask2012]</a>, equation (10c). The following integral over the
sphere of radius <img class="math" src="../_images/math/c2a6d69d3430bba2a967e76d66abe898c2856899.svg" alt="r_c"/>:</p>
<div class="math">
<p><img src="../_images/math/63b1408d14bdca17d2525d9aa0104d62d36ebaa4.svg" alt="I_{sph} =
\int_{\Omega: r &lt; r_c} \left({Z\over r}-V({\bf x})\right) \d^3 x
    = 4\pi \int_0^{r_c} \left({Z\over r}-V(r)\right) r^2 \d r =

= {14 \pi Z r_c^2 \over 75}"/></p>
</div><p>Again in agreement with <a class="reference internal" href="#pask2012" id="id2">[Pask2012]</a>, the paragraph after equation (17).</p>
<p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">solve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;r r_c Z A B&quot;</span><span class="p">)</span>
<span class="go">(r, r_c, Z, A, B)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="mi">21</span><span class="o">*</span><span class="n">Z</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">r_c</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">r_c</span><span class="o">+</span><span class="n">r_c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span> <span class="n">r_c</span><span class="o">**</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">integrate</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r_c</span><span class="p">))</span>
<span class="go">Z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">r</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">Z*r**2*(9*r**5 - 30*r**4*r_c + 28*r**3*r_c**2 - 14*r_c**5)/(5*r_c**8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="n">V</span><span class="o">+</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">/</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">-B + 63*Z*r**8/(5*r_c**8) - 36*Z*r**7/r_c**7 + 28*Z*r**6/r_c**6 - 28*Z*r**3/(5*r_c**3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">V</span><span class="o">+</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">r_c</span><span class="p">)</span>
<span class="go">-Z/r_c**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">V</span><span class="o">+</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">r_c</span><span class="p">)</span>
<span class="go">A - 7*Z/(5*r_c)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">solve</span><span class="p">((</span><span class="n">V</span><span class="o">+</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">r_c</span><span class="p">)</span><span class="o">-</span><span class="n">Z</span><span class="o">/</span><span class="n">r_c</span><span class="p">,</span> <span class="n">A</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span>
<span class="go">12*Z/(5*r_c)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span> <span class="o">+</span> <span class="n">A</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">Z*(r**2*(9*r**5 - 30*r**4*r_c + 28*r**3*r_c**2 - 14*r_c**5) + 12*r_c**7)/(5*r_c**8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">integrate</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r_c</span><span class="p">))</span>
<span class="go">15962*Z**2/(17875*r_c)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">integrate</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="o">/</span><span class="n">r</span><span class="o">-</span><span class="n">V</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r_c</span><span class="p">))</span>
<span class="go">10976*Z**2/(17875*r_c)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">integrate</span><span class="p">((</span><span class="n">Z</span><span class="o">/</span><span class="n">r</span><span class="o">-</span><span class="n">V</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r_c</span><span class="p">))</span>
<span class="go">14*pi*Z*r_c**2/75</span>
</pre></div>
</div>
<p>Alternatively, one can also calculate this using a <code class="docutils literal notranslate"><span class="pre">Piecewise</span></code> function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">solve</span><span class="p">,</span> <span class="n">Piecewise</span><span class="p">,</span> <span class="n">oo</span><span class="p">,</span> <span class="n">Symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;r Z A B&quot;</span><span class="p">)</span>
<span class="go">(r, Z, A, B)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_c</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;r_c&quot;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">((</span><span class="o">-</span><span class="mi">21</span><span class="o">*</span><span class="n">Z</span><span class="o">*</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_c</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">r_c</span> <span class="o">+</span> <span class="n">r_c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r_c</span><span class="o">**</span><span class="mi">8</span><span class="p">),</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">r_c</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">integrate</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">Z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">r</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">Piecewise((Z*r**2*(9*r**5 - 30*r**4*r_c + 28*r**3*r_c**2 - 14*r_c**5)/(5*r_c**8), r &lt;= r_c), (0, True))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="n">V</span><span class="o">+</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">/</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">Piecewise((-B + 63*Z*r**8/(5*r_c**8) - 36*Z*r**7/r_c**7 + 28*Z*r**6/r_c**6 - 28*Z*r**3/(5*r_c**3), r &lt;= r_c), (-B, True))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">V</span><span class="o">+</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">r_c</span><span class="p">)</span>
<span class="go">-Z/r_c**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">V</span><span class="o">+</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">r_c</span><span class="p">)</span>
<span class="go">A - 7*Z/(5*r_c)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">solve</span><span class="p">((</span><span class="n">V</span><span class="o">+</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">r_c</span><span class="p">)</span><span class="o">-</span><span class="n">Z</span><span class="o">/</span><span class="n">r_c</span><span class="p">,</span> <span class="n">A</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span>
<span class="go">12*Z/(5*r_c)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span> <span class="o">+</span> <span class="n">Piecewise</span><span class="p">((</span><span class="n">A</span><span class="p">,</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">r_c</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">Piecewise((Z*(r**2*(9*r**5 - 30*r**4*r_c + 28*r**3*r_c**2 - 14*r_c**5)/r_c**7 + 12)/(5*r_c), r &lt;= r_c), (0, True))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">integrate</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">15962*Z**2/(17875*r_c)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">integrate</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="o">/</span><span class="n">r</span><span class="o">-</span><span class="n">V</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">10976*Z**2/(17875*r_c)</span>
</pre></div>
</div>
<table class="docutils citation" frame="void" id="pask2012" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Pask2012]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> Pask, J. E., Sukumar, N., Mousavi, S. E. (2012). Linear scaling solution of the all-electron Coulomb problem in solids. International Journal for Multiscale Computational Engineering, 10(1), 83–99.  doi:10.1615/IntJMultCompEng.2011002201</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3.38. Ordinary Differential Equations</a><ul>
<li><a class="reference internal" href="#finite-difference-formulas">3.38.1. Finite Difference Formulas</a></li>
<li><a class="reference internal" href="#integrating-ode">3.38.2. Integrating ODE</a></li>
<li><a class="reference internal" href="#radial-poisson-equation">3.38.3. Radial Poisson Equation</a><ul>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#gaussian-charge">Gaussian Charge</a></li>
<li><a class="reference internal" href="#exponential-charge">Exponential Charge</a></li>
<li><a class="reference internal" href="#piecewise-polynomial-charge">Piecewise Polynomial Charge</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="wigner.html"
                        title="previous chapter">3.37. Wigner D Function</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="la.html"
                        title="next chapter">3.39. Linear Algebra</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/math/ode.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="la.html" title="3.39. Linear Algebra"
             >next</a> |</li>
        <li class="right" >
          <a href="wigner.html" title="3.37. Wigner D Function"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" >3. Mathematics</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>