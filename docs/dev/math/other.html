
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>3.15. Delta Function &#8212; Theoretical Physics Reference 0.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.29. Legendre Polynomials" href="spherical-harmonics.html" />
    <link rel="prev" title="3.10. Periodic Functions" href="trig.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head><body>
    <div style="display:none">
    \(
        \newcommand{\d}{\mathrm{d}}
        \newcommand{\bomega}{\vec\omega}
        \newcommand{\half}{ {1\over 2} }
        \def\mathnot#1{\text{"$#1$"}}

        %operators
        \newcommand{\diag}{\mathrm{diag}}
        \newcommand{\sinc}{\mathrm{sinc}}
        \newcommand{\Sh}{ {\large\style{font-family:Times}{\text{Ш}}} }
        \newcommand{\res}{\mathrm{Res}}
    \)
    </div>
    

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="spherical-harmonics.html" title="3.29. Legendre Polynomials"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="trig.html" title="3.10. Periodic Functions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" accesskey="U"><span class="section-number">3. </span>Mathematics</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.15. </span>Delta Function</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="delta-function">
<h1><span class="section-number">3.15. </span>Delta Function<a class="headerlink" href="#delta-function" title="Permalink to this heading">¶</a></h1>
<p>Delta function <img class="math" src="../_images/math/ba07b46fc31ecead08366c493b723d90df40f83b.svg" alt="\delta(x)"/> is defined such that this relation holds:</p>
<div class="math" id="equation-deltadef">
<p><span class="eqno">(3.15.1)<a class="headerlink" href="#equation-deltadef" title="Permalink to this equation">¶</a></span><img src="../_images/math/291429d6fe983714a9b8733bf8155bdc7b46611a.svg" alt="\int f(x)\delta(x-t)\d x=f(t)"/></p>
</div><p>No such function exists, but one can find many sequences “converging” to a delta function:</p>
<div class="math" id="equation-deltalim">
<p><span class="eqno">(3.15.2)<a class="headerlink" href="#equation-deltalim" title="Permalink to this equation">¶</a></span><img src="../_images/math/a7d8a54ecd99c09d528682b760fe96a67323e530.svg" alt="\lim_{\alpha\to\infty}\delta_\alpha(x) = \delta(x)"/></p>
</div><p>more precisely:</p>
<div class="math" id="equation-deltaprec">
<p><span class="eqno">(3.15.3)<a class="headerlink" href="#equation-deltaprec" title="Permalink to this equation">¶</a></span><img src="../_images/math/68ec9684cfa4665e362493d141ea3bc6ea03d796.svg" alt="\lim_{\alpha\to\infty}\int f(x)\delta_\alpha(x)\d x = \int f(x)\lim_{\alpha\to\infty}\delta_\alpha(x)\d x = f(0)"/></p>
</div><p>one example of such a sequence is:</p>
<div class="math">
<p><img src="../_images/math/570cfd75566d09fe96093116247d1dc831648b9d.svg" alt="\delta_\alpha(x) = {1\over\pi x}\sin(\alpha x)"/></p>
</div><p>It’s clear that <a class="reference internal" href="#equation-deltaprec">(3.15.3)</a> holds for any well behaved function <img class="math" src="../_images/math/42400ab3531de67b04c236cdcd05a6ce003d6369.svg" alt="f(x)"/>.
Some mathematicians like to say that it’s incorrect to use such a notation when
in fact the integral <a class="reference internal" href="#equation-deltadef">(3.15.1)</a> doesn’t “exist”, but we will not follow
their approach, because it is not important if something “exists” or not,
but rather if it is clear what we mean by our notation: <a class="reference internal" href="#equation-deltadef">(3.15.1)</a> is a
shorthand for <a class="reference internal" href="#equation-deltaprec">(3.15.3)</a> and <a class="reference internal" href="#equation-deltalim">(3.15.2)</a> gets a mathematically rigorous
meaning when you integrate both sides and use <a class="reference internal" href="#equation-deltadef">(3.15.1)</a> to arrive at
<a class="reference internal" href="#equation-deltaprec">(3.15.3)</a>.  Thus one uses the relations <a class="reference internal" href="#equation-deltadef">(3.15.1)</a>, <a class="reference internal" href="#equation-deltalim">(3.15.2)</a>,
<a class="reference internal" href="#equation-deltaprec">(3.15.3)</a> to derive all properties of the delta function.</p>
<p>Let’s give an example. Let <img class="math" src="../_images/math/0e799af4604f2461f6ee590bf22d52a522693102.svg" alt="{\bf\hat r}"/> be the unit vector in 3D and we can
label it using spherical coordinates <img class="math" src="../_images/math/6938da36d799faf50f21fdbbf15cddd6f979f26e.svg" alt="{\bf\hat r}={\bf\hat r}(\theta,\phi)"/>.
We can also express it in cartesian coordinates as <img class="math" src="../_images/math/3f596af15aa63ae59976260c1585e47138a710c7.svg" alt="{\bf\hat
r}(\theta,\phi)=(\cos\phi\sin\theta,\sin\phi\sin\theta,\cos\theta)"/>.</p>
<div class="math" id="equation-deltar">
<p><span class="eqno">(3.15.4)<a class="headerlink" href="#equation-deltar" title="Permalink to this equation">¶</a></span><img src="../_images/math/87a1f2850f03291a44880cc452dfdf64a7a027d5.svg" alt="f({\bf\hat r'})=\int\delta({\bf\hat r}-{\bf\hat r'})f({\bf\hat r})\,\d {\bf\hat r}"/></p>
</div><p>Expressing <img class="math" src="../_images/math/1416030af1909e0bfcc425e98f80272ccb90e10c.svg" alt="f({\bf\hat r})=f(\theta,\phi)"/> as a function of <img class="math" src="../_images/math/6fb7931886034ccad92f96457979b906fad8ea0c.svg" alt="\theta"/> and
<img class="math" src="../_images/math/9245f1100f089a4aed7c6f6bee3ce84343b2194f.svg" alt="\phi"/> we have</p>
<div class="math" id="equation-deltaangles">
<p><span class="eqno">(3.15.5)<a class="headerlink" href="#equation-deltaangles" title="Permalink to this equation">¶</a></span><img src="../_images/math/eefa59be5bb74cc4a79b98a35b50fa00ea9091e4.svg" alt="f(\theta',\phi')=\int\delta(\theta-\theta')\delta(\phi-\phi') f(\theta,\phi)\,\d\theta\d\phi"/></p>
</div><p>Expressing <a class="reference internal" href="#equation-deltar">(3.15.4)</a> in spherical coordinates we get</p>
<div class="math">
<p><img src="../_images/math/50bcd70f14b4025414154cfa4065116ded176df7.svg" alt="f(\theta',\phi')=\int\delta({\bf\hat r}-{\bf\hat r'}) f(\theta,\phi)\sin\theta\,\d\theta\d\phi"/></p>
</div><p>and comparing to <a class="reference internal" href="#equation-deltaangles">(3.15.5)</a> we finally get</p>
<div class="math">
<p><img src="../_images/math/614335537fd0f9dcfc6e15bf413b9c16636b7390.svg" alt="\delta({\bf\hat r}-{\bf\hat r'})={1\over\sin\theta} \delta(\theta-\theta')\delta(\phi-\phi')"/></p>
</div><p>In exactly the same manner we get</p>
<div class="math">
<p><img src="../_images/math/a9bb16a5abf977135c86a6d4e402e8e5224104f1.svg" alt="\delta({\bf r}-{\bf r'})=\delta({\bf\hat r}-{\bf\hat r'}) {\delta(\rho-\rho')\over\rho^2}"/></p>
</div><p>See also <a class="reference internal" href="#equation-functionalderdel">(3.17.4.1)</a> for an example of how to deal with more
complex expressions involving the delta function like <img class="math" src="../_images/math/c2aaee70f1edf6b5aa55e294bee5225757e43037.svg" alt="\delta^2(x)"/>.</p>
<p>When integrating over finite interval, this formula is very useful:</p>
<div class="math">
<p><img src="../_images/math/27f4a40bc0cfb15f6eae6a23ee6f2496a923fc37.svg" alt="\int_a^b f(x)\delta(x-t)\d x = f(t) \theta(b-t) \theta(t-a)"/></p>
</div><p>in other words, the integral vanishes unless <img class="math" src="../_images/math/7b051d811256eeb33d4ed9167e9b4f1210e94da7.svg" alt="a &lt; t &lt; b"/>. In the limit <img class="math" src="../_images/math/894a1c93c97c4f00534ead82e9976f3fec3d05a1.svg" alt="a\to
-\infty"/> and <img class="math" src="../_images/math/f9bc09284c2c63dbc6bf9ce798da607d88744d0f.svg" alt="b\to\infty"/> we get:</p>
<div class="math">
<p><img src="../_images/math/933c062025ad2732c8c6cfa0289234f07a4cc895.svg" alt="\theta(b-t) \to \theta(\infty - t) = 1

\theta(t-a) \to \theta(t - (-\infty)) = \theta(t+\infty) = 1"/></p>
</div><p>Another integral that converges to a delta function is:</p>
<div class="math">
<p><img src="../_images/math/776e25a7fc1825a51a6450f14cda6ebb1333bab4.svg" alt="{1\over 2\pi} \int_{-\infty}^\infty e^{i\omega x} \d x
    = \lim_{L\to\infty} {1\over 2\pi} \int_{-L}^L e^{i\omega x} \d x
    = \lim_{L\to\infty} {\sin \omega L \over \pi \omega} = \delta(\omega)"/></p>
</div></section>
<section id="distributions">
<h1><span class="section-number">3.16. </span>Distributions<a class="headerlink" href="#distributions" title="Permalink to this heading">¶</a></h1>
<p>Some mathematicians like to use distributions and a mathematical notation for
that, which I think is making things less clear, but nevertheless it’s
important to understand it too, so the notation is explained in this section,
but I discourage to use it – I suggest to only use the physical notation as
explained below. The math notation below is put into quotation marks, so that
it’s not confused with the physical notation.</p>
<p>The distribution is a functional and each function <img class="math" src="../_images/math/42400ab3531de67b04c236cdcd05a6ce003d6369.svg" alt="f(x)"/> can be identified
with a distribution <img class="math" src="../_images/math/43b36a69dc6f89b974804e15641bd2295a13be3b.svg" alt="\mathnot{T_f}"/> that it generates using this definition
(<img class="math" src="../_images/math/6a9488b91c4ee7258e175188cfcca317099f67ae.svg" alt="\varphi(x)"/>
is a test function):</p>
<div class="math">
<p><img src="../_images/math/940cea84230abb3696dbca39c5fa26719c8c768e.svg" alt="\mathnot{T_f(\phi(x))} \equiv \int f(x)\varphi(x) \d x \equiv
\mathnot{f(\varphi(x))} \equiv \mathnot{(f(x), \varphi(x))}"/></p>
</div><p>besides that, one can also define distributions that can’t be identified with
regular functions, one example is a delta distribution (Dirac delta function):</p>
<div class="math">
<p><img src="../_images/math/656efb7bdd364b5db234c5f1d789b993dd8d450c.svg" alt="\mathnot{\delta(\phi(x))} \equiv \phi(0) \equiv \int \delta(x) \phi(x) \d x"/></p>
</div><p>The last integral is not used in mathematics, in physics on the other hand, the
first expressions (<img class="math" src="../_images/math/1a95cefd1d519492456408fcc9a56d61fd3eeed9.svg" alt="\mathnot{\delta(\phi(x))}"/>) is not used, so <img class="math" src="../_images/math/ba07b46fc31ecead08366c493b723d90df40f83b.svg" alt="\delta(x)"/> always means
that you have to integrate it, as explained in the previous section, so it
behaves like a regular function (except that such a function doesn’t exist and
the precise mathematical meaning is only after you integrate it, or through the
identification above with distributions).</p>
<p>One then defines common operations via acting on the generating function, then
observes the pattern and defines it for all distributions. For example
differentiation:</p>
<div class="math">
<p><img src="../_images/math/25b5ae5b598cbc388bc8941672a7fa3fb871a5cf.svg" alt="\mathnot{{\d\over\d x}T_f(\varphi)} =
\mathnot{T_{f'}(\varphi)} =
\int f'\varphi \d x =
-\int f\varphi' \d x =
\mathnot{-T_f(\varphi')}"/></p>
</div><p>so:</p>
<div class="math">
<p><img src="../_images/math/f2f3bf9a915b07dd3d040a6b2d840b50b920f1e5.svg" alt="\mathnot{{\d\over\d x}T(\varphi)} =
\mathnot{-T(\varphi')}"/></p>
</div><p>Multiplication:</p>
<div class="math">
<p><img src="../_images/math/22974f0813eb288e592ed6ae2bf977b87878e927.svg" alt="\mathnot{gT_f(\varphi)} =
\mathnot{T_{gf}(\varphi)} =
\int gf\varphi \d x =
\mathnot{T_f(g\varphi)}"/></p>
</div><p>so:</p>
<div class="math">
<p><img src="../_images/math/90c4dc8028bfc9569af5497c0816adeea20a0697.svg" alt="\mathnot{gT(\varphi)} =
\mathnot{T(g\varphi)}"/></p>
</div><p>Fourier transform:</p>
<div class="math">
<p><img src="../_images/math/a73984d54650afc5ac33f17542b0e5a5407aed2e.svg" alt="\mathnot{FT_f(\varphi)} =
\mathnot{T_{Ff}(\varphi)} =
\int F(f)\varphi \d x =

=\int\left[\int e^{-ikx} f(k) \d k\right] \varphi(x) \d x
=\int f(k)\left[\int e^{-ikx} \varphi(x) \d x\right] \d k
=\int f(x)\left[\int e^{-ikx} \varphi(k) \d k\right] \d x
=

=
\int f F(\varphi) \d x =
\mathnot{T_f(F\varphi)}"/></p>
</div><p>so:</p>
<div class="math">
<p><img src="../_images/math/8f848090377d9c5bdd95c0124b70d588da6e7a1b.svg" alt="\mathnot{FT(\varphi)} =
\mathnot{T(F\varphi)}"/></p>
</div><p>But as you can see, the notation is just making things more complex, since it’s
enough to just work with the integrals and forget about the rest. One can then
even omit the integrals, with the understanding that they are implicit.</p>
<p>Some more examples:</p>
<div class="math">
<p><img src="../_images/math/fa2cc93254045b3ff75b285fe0224bf0a168a883.svg" alt="\int \delta(x-x_0)\varphi(x) \d x = \int \delta(x)\varphi(x+x_0) \d x
= \varphi(x_0) \equiv \mathnot{\delta(\varphi(x+x_0))}"/></p>
</div><p>Proof of <img class="math" src="../_images/math/a5cd1483975fb10b41c7177f1a3d98b947646be1.svg" alt="\delta(-x) = \delta(x)"/>:</p>
<div class="math">
<p><img src="../_images/math/6f525856c46fb47aeb488c8f4073714e3c86b40a.svg" alt="\int_{-\infty}^\infty \delta(-x)\varphi(x)\d x =
-\int_{\infty}^{-\infty} \delta(y)\varphi(-y)\d y =
\int_{-\infty}^\infty \delta(x)\varphi(-x)\d x
\equiv \mathnot{\delta(\varphi(-x))} = \varphi(0)
=\mathnot{\delta(\phi(x))}
\equiv
\int_{-\infty}^\infty \delta(x)\varphi(x)\d x"/></p>
</div><p>Proof of <img class="math" src="../_images/math/d4c2e67038772fcb0d389f80ed27c0a1ebc7c98a.svg" alt="x\delta(x) = 0"/>:</p>
<div class="math">
<p><img src="../_images/math/e7f2151a98a6c9934262bec5db89c55eba691434.svg" alt="\int x\delta(x)\varphi(x)\d x = \mathnot{\delta(x\varphi(x))}
= 0 \cdot \varphi(0) = 0"/></p>
</div><p>Proof of <img class="math" src="../_images/math/c802d74559910cf8d286f1751e3eaa75578c09ba.svg" alt="\delta(cx) = {\delta(x)\over |c|}"/>:</p>
<div class="math">
<p><img src="../_images/math/80c4b23ed18357331814573cecf67d216fa207a4.svg" alt="\int \delta(cx)\varphi(x)\d x = {1\over|c|}\int\delta(x)\varphi\left({x\over
c}\right)\d x
=\mathnot{\delta\left(\varphi\left({x\over c}\right)\over|c|\right)}
={\delta(0)\over|c|}
=\mathnot{{\delta(\varphi(x))\over|c|}}
=
\int {\delta(x)\over |c|}\varphi(x)\d x"/></p>
</div><p>To prove that <img class="math" src="../_images/math/484d69278505f1116490150a335012866089d5f7.svg" alt="\lim_{L\to\infty} {1\over\pi x}\sin(L x)=\delta(x)"/> we do the
following calculation:</p>
<div class="math">
<p><img src="../_images/math/85e15b27fc628b0698d2a6829ba7ed71db1f3913.svg" alt="\left[\int_{-\infty}^\infty \lim_{L\to\infty} {1\over\pi x}\sin(L x)
    \varphi(x) \d x\right] - \varphi(0) =

= \lim_{L\to\infty} \int_{-\infty}^\infty {1\over\pi x}\sin(L x)
    (\varphi(x)-\varphi(0)) \d x =

= \lim_{L\to\infty} {1\over\pi} \int_{-\infty}^\infty
    {\varphi(x)-\varphi(0)\over x} \sin(L x) \d x =

= \lim_{L\to\infty} {1\over\pi} \int_{-\infty}^\infty
    h(x) \sin(L x) \d x = 0"/></p>
</div><p>where the function <img class="math" src="../_images/math/800be31b5b97bd57118788d6f8552d1cfca443f0.svg" alt="h(x) = {\varphi(x)-\varphi(0)\over x}"/> is bounded and <img class="math" src="../_images/math/fcaac0392b76a863bcefc7a8dba88fa137919317.svg" alt="h(0)
=\lim_{x\to0}{\varphi(x)-\varphi(0)\over x}=\varphi'(0)"/> is finite since the
test function <img class="math" src="../_images/math/6a9488b91c4ee7258e175188cfcca317099f67ae.svg" alt="\varphi(x)"/> is infinitely differentiable. From the
Riemann–Lebesgue lemma, the integral then converges towards zero as
<img class="math" src="../_images/math/23057d8ea9b2d1d0f07562c46606664ba6a7012c.svg" alt="L\to\infty"/>.</p>
</section>
<section id="variations-and-functional-derivatives">
<span id="index-0"></span><h1><span class="section-number">3.17. </span>Variations and Functional Derivatives<a class="headerlink" href="#variations-and-functional-derivatives" title="Permalink to this heading">¶</a></h1>
<p>Variations and functional derivatives are generalization of differentials and
partial derivatives to functionals. It is important to master this subject just
like regular differentials/derivatives in calculus.</p>
<section id="functions-of-one-variable">
<h2><span class="section-number">3.17.1. </span>Functions of One Variable<a class="headerlink" href="#functions-of-one-variable" title="Permalink to this heading">¶</a></h2>
<p>Let’s first review differentials and derivatives of functions of one variable.
We will use an approach that directly generalizes to multivariable functions
and functionals.
The differential <img class="math" src="../_images/math/c094518e1eaaf3c9d8f544b5349c198fdf8db26e.svg" alt="\d f"/> is defined as:</p>
<div class="math">
<p><img src="../_images/math/c7f718b73694552879a937fdb970c5010e7a8965.svg" alt="\d f
    \equiv \lim_{\varepsilon\to0} {f(x+\varepsilon h)
        -f(x)\over\varepsilon}
    = a h"/></p>
</div><p>Last equality follows from the fact, that the limit is a linear function of
<img class="math" src="../_images/math/f71061053cef1ed9bc338c3a4738d2ab353ee2b9.svg" alt="h"/>:</p>
<div class="math">
<p><img src="../_images/math/19923e50636c7ce143190fd865772176cd1a5c8d.svg" alt="\lim_{\varepsilon\to0} {f(x+\varepsilon h) -f(x)\over\varepsilon}
    = \lim_{\eta\to0} {f(x+\eta) -f(x)\over\left(\eta\over h\right)}
    = \left(\lim_{\eta\to0} {f(x+\eta) -f(x)\over\eta}\right) h"/></p>
</div><p>Where we used the substitution <img class="math" src="../_images/math/a833b440ec5d4d59b13d1d960c5ec557ac4e4c75.svg" alt="\eta = \varepsilon h"/>.
We define the derivative <img class="math" src="../_images/math/d8396ad401293e31651c6f2827af9694e292c359.svg" alt="\d f\over \d x"/> as:</p>
<div class="math">
<p><img src="../_images/math/da29daa320e891f255f471538393fe08fb4ad362.svg" alt="{\d f\over \d x} = a"/></p>
</div><p>To get a formula for <img class="math" src="../_images/math/64cb342c11d686a721a2fb1014c692c869507e7a.svg" alt="{\d f\over \d x}"/>, we set <img class="math" src="../_images/math/2de31b16092204692f6d06ae6f32df7e02ceef28.svg" alt="h=1"/> and get:</p>
<div class="math">
<p><img src="../_images/math/a08ebcd4f8f7d714928040ded732ca6e677c5857.svg" alt="{\d f\over \d x} = a = a \cdot 1
    = \lim_{\varepsilon\to0} {f(x+\varepsilon \cdot 1)-f(x)\over\varepsilon}
    = \lim_{\varepsilon\to0} {f(x+\varepsilon)-f(x)\over\varepsilon}"/></p>
</div><p>Using the formulas above we get an equivalent expression for the
differential:</p>
<div class="math">
<p><img src="../_images/math/7fee4329c87d4a4bb373ccaee35a0d704869a6d7.svg" alt="\left.{\d\over\d\varepsilon}f(x+\varepsilon h) \right|_{\varepsilon=0}
    = \left.\lim_{\eta\to0} {f(x+(\varepsilon+\eta) h)
        -f(x+\varepsilon h)\over\eta}\right|_{\varepsilon=0} =

    = \lim_{\eta\to0} {f(x+\eta h) -f(x)\over\eta} =

    = \lim_{\varepsilon\to0} {f(x+\varepsilon h) -f(x)\over\varepsilon}"/></p>
</div><p>So we get a general formula (the analogy of which we will use later):</p>
<div class="math">
<p><img src="../_images/math/9c3c5e32ac56e77052474665fce07cd59e49623e.svg" alt="\d f
    \equiv\left.{\d\over\d\varepsilon}f(x+\varepsilon h)
        \right|_{\varepsilon=0}
    = \lim_{\varepsilon\to0} {f(x+\varepsilon h)
        -f(x)\over\varepsilon}
    = a h"/></p>
</div><p>The variable <img class="math" src="../_images/math/74d80b1f8754374202dc72f351096af63dd5da6c.svg" alt="x"/> can be treated as a function (a very simple one):</p>
<div class="math">
<p><img src="../_images/math/d28c08c79d26192489e017f955789b02562ab638.svg" alt="x = g(x)"/></p>
</div><p>So we define <img class="math" src="../_images/math/9973646df7ef061afb775288eb7028437180939c.svg" alt="\d x"/> as:</p>
<div class="math">
<p><img src="../_images/math/957e875365328f7d5c4bd7cfe4beec8d9637729b.svg" alt="\d x \equiv \d g = {\d g\over\d x} h = h"/></p>
</div><p>As such, <img class="math" src="../_images/math/9973646df7ef061afb775288eb7028437180939c.svg" alt="\d x"/> can have two meanings: either <img class="math" src="../_images/math/9583d93edc1ec53fdf1330e294635ea873622976.svg" alt="\d x = h = x-x_0"/> (a finite
change in the variable <img class="math" src="../_images/math/74d80b1f8754374202dc72f351096af63dd5da6c.svg" alt="x"/>) or a differential (if <img class="math" src="../_images/math/74d80b1f8754374202dc72f351096af63dd5da6c.svg" alt="x"/> depends on another
variable, thanks to the chain rule everything will work).
With this understanding,
for all calculations, we only need the following two formulas —
the definition of the differential (using a limit):</p>
<div class="math">
<p><img src="../_images/math/e9e0ca73d143238ba2f85134b4028b89b763cd69.svg" alt="\d f = \lim_{\varepsilon\to0} {f(x+\varepsilon \d x) -f(x)\over\varepsilon}"/></p>
</div><p>and the definition of the derivative (using the differential):</p>
<div class="math">
<p><img src="../_images/math/3f256b737254337b7019ae49ac0df1be8accdb83.svg" alt="\d f = {\d f\over \d x} \d x"/></p>
</div><p>where <img class="math" src="../_images/math/9973646df7ef061afb775288eb7028437180939c.svg" alt="\d x"/> is either a differential or a finite change in the variable <img class="math" src="../_images/math/74d80b1f8754374202dc72f351096af63dd5da6c.svg" alt="x"/>.</p>
<p>If for example <img class="math" src="../_images/math/c1ae8ceac481fa1195e080a5740bd3c76db55ac9.svg" alt="x=p(y)"/> is a function of <img class="math" src="../_images/math/b27a6e505ab16a1e68c6ecb7b9c9861c58122ee0.svg" alt="y"/> then in the above <img class="math" src="../_images/math/9973646df7ef061afb775288eb7028437180939c.svg" alt="\d x"/> is a
differential and we get:</p>
<div class="math">
<p><img src="../_images/math/875babe83e45b7a1a5a339e249bb9a4e8a5359df.svg" alt="\d f = {\d f\over \d x} \d x = {\d f\over \d x}{\d x\over \d y} \d y"/></p>
</div><p>Thanks to the chain rule, this can also be written as:</p>
<div class="math">
<p><img src="../_images/math/1ba161352b0db64b4560a98f9d8bfe40f6be4424.svg" alt="\d f = {\d f\over \d y} \d y"/></p>
</div><p>and so the notation is consistent.</p>
</section>
<section id="functions-of-several-variables">
<h2><span class="section-number">3.17.2. </span>Functions of several variables<a class="headerlink" href="#functions-of-several-variables" title="Permalink to this heading">¶</a></h2>
<p>Let’s have <img class="math" src="../_images/math/0e897908e378ee6808e574e987244c26b39e4280.svg" alt="\x=(x_1,x_2,\dots,x_N)"/>. The function <img class="math" src="../_images/math/6ae7a6e6c8dccaa9470bde1d80d3274a203027ce.svg" alt="f(\x)"/> assigns a number to
each <img class="math" src="../_images/math/a106291e55dd225c424152142d420f36f5687ed2.svg" alt="\x"/>. We define a differential of <img class="math" src="../_images/math/1f452f41a59b567841d283cefbd554ac64e88795.svg" alt="f"/> in the direction of <img class="math" src="../_images/math/67afecdb4e7bc9d4341a9303aa4881a5a93f43ce.svg" alt="{\bf h}"/> as:</p>
<div class="math">
<p><img src="../_images/math/0486c2ec700becae6b1d0c2af1044696cd73ab81.svg" alt="\d f
    \equiv\left.{\d\over\d\varepsilon}f({\bf x}+\varepsilon{\bf h})
        \right|_{\varepsilon=0}
    = \lim_{\varepsilon\to0} {f({\bf x}+\varepsilon{\bf h})
        -f(\x)\over\varepsilon}
    = {\bf a} \cdot {\bf h}"/></p>
</div><p>The last equality follows from the fact, that
<img class="math" src="../_images/math/e50b8fd7be29b23102e221ba7e1a85bc99915147.svg" alt="\left.{\d\over\d\varepsilon}f({\bf x}+\varepsilon{\bf h}) \right|_{\varepsilon=0}"/> is a
linear function of <img class="math" src="../_images/math/67afecdb4e7bc9d4341a9303aa4881a5a93f43ce.svg" alt="{\bf h}"/>. We define the partial derivative <img class="math" src="../_images/math/c3b59d1eb3fc8a7c14c036425e6ec5a1ada52640.svg" alt="{\partial
f\over\partial x_i}"/> of <img class="math" src="../_images/math/1f452f41a59b567841d283cefbd554ac64e88795.svg" alt="f"/> with respect to <img class="math" src="../_images/math/ef4029b1049ac96627c5440f110d454df7f5de0d.svg" alt="x_i"/> as the <img class="math" src="../_images/math/26e02951ffb851bd3a9b32dd1e10e6de935a0c7f.svg" alt="i"/>-th component of
the vector <img class="math" src="../_images/math/2c01f25e3c311257bc55f5c4d84e26767a97edb0.svg" alt="{\bf a}"/>:</p>
<div class="math">
<p><img src="../_images/math/b04dd985349d06b2d311bfc08c8728a40cb3680f.svg" alt="{\bf a}
    \equiv \left({\partial f\over\partial x_1},
        {\partial f\over\partial x_2}, \dots,
        {\partial f\over\partial x_N}\right)
    \equiv \nabla f"/></p>
</div><p>This also gives a formula for computing <img class="math" src="../_images/math/b9e76ddb13fef43bcd3c5cd368290471db5a8333.svg" alt="{\partial f\over\partial x_i}"/>: we set <img class="math" src="../_images/math/5c797289aa0217c900c837ef0fad6676c61c85db.svg" alt="h_j=\delta_{ij}h_i"/> and</p>
<div class="math">
<p><img src="../_images/math/41b11a4ddf404dc0080b4ef320a7bcd92c0a0992.svg" alt="{\partial f\over\partial x_i}
    = a_i
    = {\bf a}\cdot{\bf h}
    = \left.{\d\over\d\varepsilon} f(\x+\varepsilon(0,0,\dots,1,\dots,0))
        \right|_{\varepsilon=0} =

    = \lim_{\varepsilon\to0} {f(x_1,x_2,\dots,x_i+\varepsilon,\dots,x_N)
        -f(x_1,x_2,\dots,x_i,\dots,x_N) \over\varepsilon}"/></p>
</div><p>The usual way to define partial derivatives is to use the last formula as the
definition, but here this formula is a consequence of our definition in terms
of the components of <img class="math" src="../_images/math/2c01f25e3c311257bc55f5c4d84e26767a97edb0.svg" alt="{\bf a}"/>.
Every variable can be treated as a function (very simple one):</p>
<div class="math">
<p><img src="../_images/math/324ab4ae1b9585f056ac3de0e9eb433744cec3ce.svg" alt="x_i=g(x_1,\dots,x_N)=\delta_{ij}x_j"/></p>
</div><p>and so we define</p>
<div class="math">
<p><img src="../_images/math/2ca1d01fa1cd59c8e3ee2c398153b5055326d324.svg" alt="\d x_i\equiv\d g=\d(\delta_{ij}x_j)=h_i"/></p>
</div><p>and thus we write <img class="math" src="../_images/math/96e85399a037a7df4727711ae11616bc7ea9972a.svg" alt="h_i=\d x_i"/> and <img class="math" src="../_images/math/d75fdf8170c86278b4e0161f5811128350f4ad94.svg" alt="{\bf h}=\d\x"/> and</p>
<div class="math">
<p><img src="../_images/math/fa96d28b3f30dbf311399e210fe880868bd9bac7.svg" alt="\d f={\d f\over\d x_i}\d x_i = (\nabla f) \cdot \d {\bf x}"/></p>
</div><p>So <img class="math" src="../_images/math/5895c2f024453a266362892fb676c1879ed2fbe6.svg" alt="\d{\bf x}"/> has two meanings — it’s either <img class="math" src="../_images/math/a272e8366d0722e9feeceb4e042ac0685a1ba18d.svg" alt="{\bf h}={\bf x}-{\bf x}_0"/> (a
finite change in the independent variable <img class="math" src="../_images/math/45d9694d60e7810ecbdcbca7ce4ee5f280d4f1cc.svg" alt="{\bf x}"/>) or a differential,
depending on the context. The above is a detailed explanation why things
are defined the way they are and what the exact meaning is. With this
understanding, the only things that are actually needed for any calculations
are the following – the definition of a differential:</p>
<div class="math">
<p><img src="../_images/math/041098c37e0b3f4ceb67d6dfcaf1f18eea556553.svg" alt="\d f = \left.{\d\over\d\varepsilon}f({\bf x}+\varepsilon\d {\bf x})
        \right|_{\varepsilon=0}"/></p>
</div><p>Only a regular derivative (defined in the previous section) is needed for this
definition. The definition of a partial derivative (and a gradient):</p>
<div class="math">
<p><img src="../_images/math/fa96d28b3f30dbf311399e210fe880868bd9bac7.svg" alt="\d f={\d f\over\d x_i}\d x_i = (\nabla f) \cdot \d {\bf x}"/></p>
</div><p>And finally the understanding that <img class="math" src="../_images/math/5895c2f024453a266362892fb676c1879ed2fbe6.svg" alt="\d{\bf x}"/> means
either <img class="math" src="../_images/math/a272e8366d0722e9feeceb4e042ac0685a1ba18d.svg" alt="{\bf h}={\bf x}-{\bf x}_0"/> or a differential depending on the context.
That’s all there is to it.</p>
</section>
<section id="functionals">
<h2><span class="section-number">3.17.3. </span>Functionals<a class="headerlink" href="#functionals" title="Permalink to this heading">¶</a></h2>
<p>Let’s now define functional derivatives and variations.
Functional <img class="math" src="../_images/math/d4a4734bb301ade9a974bf751765bb9317fb42ca.svg" alt="F[f]"/> assigns a number to each function <img class="math" src="../_images/math/42400ab3531de67b04c236cdcd05a6ce003d6369.svg" alt="f(x)"/>. The variation is
defined as</p>
<div class="math">
<p><img src="../_images/math/5c55a5dc50fcc2dc102727596d0549498cfd2b51.svg" alt="\delta F[f]\equiv\left.{\d\over\d\varepsilon}F[f+\varepsilon h] \right|_{\varepsilon=0}=\lim_{\epsilon\to0}{F[f+\epsilon h]-F[f]\over\epsilon}= \int a(x)h(x)\d x"/></p>
</div><p>We define <img class="math" src="../_images/math/051ba5b06b3d918f23dec51c2c9d6813ceed28cb.svg" alt="{\delta F\over\delta f(x)}"/> as</p>
<div class="math">
<p><img src="../_images/math/db397df4791284922c0f97aa0398e1817db0ff84.svg" alt="a(x)\equiv{\delta F\over\delta f(x)}"/></p>
</div><p>This also gives a formula for computing <img class="math" src="../_images/math/051ba5b06b3d918f23dec51c2c9d6813ceed28cb.svg" alt="{\delta F\over\delta f(x)}"/>: we set
<img class="math" src="../_images/math/150275cbb7751503f6111e9e39dfc314231cc57b.svg" alt="h(y)=\delta(x-y)"/> and</p>
<div class="math" id="equation-functional-derivative-def">
<p><span class="eqno">(3.17.3.1)<a class="headerlink" href="#equation-functional-derivative-def" title="Permalink to this equation">¶</a></span><img src="../_images/math/e6374f99736831d10346973c3644714e6caef812.svg" alt="{\delta F\over\delta f(x)}=a(x)=\int a(y)\delta(x-y)\d y= \left.{\d\over\d\varepsilon}F[f(y)+\varepsilon\delta(x-y)] \right|_{\varepsilon=0}=

   =\lim_{\varepsilon\to0} {F[f(y)+\varepsilon\delta(x-y)]-F[f(y)]\over\varepsilon}"/></p>
</div><p>Sometimes the functional derivative is defined using the last formula, here
this formula just follows from our definition.
Every function can be treated as a functional (although a very simple one):</p>
<div class="math">
<p><img src="../_images/math/21647d69a2572fb6de6d8985855786e1a572e5b5.svg" alt="f(x)=G[f]=\int f(y)\delta(x-y)\d y"/></p>
</div><p>and so we define</p>
<div class="math">
<p><img src="../_images/math/4dbab314d06fe70e9630eedfef0c8d57cbd0f006.svg" alt="\delta f\equiv\delta G[f]= \left.{\d\over\d\varepsilon}G[f(x)+\varepsilon h(x)] \right|_{\varepsilon=0}= \left.{\d\over\d\varepsilon}(f(x)+\varepsilon h(x)) \right|_{\varepsilon=0}= h(x)"/></p>
</div><p>thus we write <img class="math" src="../_images/math/2588257d01df6259e50dad8321e23fdc76455d64.svg" alt="h=\delta f"/> and</p>
<div class="math">
<p><img src="../_images/math/94bb4ed6ae8ece32798b9219c38866defd6b6040.svg" alt="\delta F[f]=\int {\delta F\over\delta f(x)}\delta f(x)\d x"/></p>
</div><p>so <img class="math" src="../_images/math/56b17b159525a6e25cb00503e8e095af9630c11b.svg" alt="\delta f"/> have two meanings — it’s either
<img class="math" src="../_images/math/340ef2c2d9dc5a3e1234e8d90c96569681f4f950.svg" alt="h(x)=f(x) - f_0(x)"/> (a finite change in the function <img class="math" src="../_images/math/1f452f41a59b567841d283cefbd554ac64e88795.svg" alt="f"/>) or a variation
of a functional, depending on the context.
It is completely analogous to <img class="math" src="../_images/math/b357a5b327a03a680dc5325cedf557777e08a7ea.svg" alt="\d\x"/>. Let’s summarize the only formulas needed
in actual calculations – the definition of a variation (using a regular
derivative):</p>
<div class="math" id="equation-functional-deriv">
<p><span class="eqno">(3.17.3.2)<a class="headerlink" href="#equation-functional-deriv" title="Permalink to this equation">¶</a></span><img src="../_images/math/eae304b78c6f847f991c8aa9b0919166b453a210.svg" alt="\delta F[f] = \left.{\d\over\d\varepsilon}F[f+\varepsilon \delta f]
    \right|_{\varepsilon=0}"/></p>
</div><p>the definition of the functional derivative:</p>
<div class="math">
<p><img src="../_images/math/e82b01f0fcf2afe4a6dddbd599cb9df27b51e90e.svg" alt="\delta F[f]=\int {\delta F\over\delta f(x)} \delta f(x) \d x"/></p>
</div><p>and the understanding that <img class="math" src="../_images/math/56b17b159525a6e25cb00503e8e095af9630c11b.svg" alt="\delta f"/> means either
<img class="math" src="../_images/math/340ef2c2d9dc5a3e1234e8d90c96569681f4f950.svg" alt="h(x)=f(x) - f_0(x)"/> or a variation. The last equation is the best way to
calculate functional derivative — apply <img class="math" src="../_images/math/d3eba29d795252212afb9268c5afa550b0249815.svg" alt="\delta"/> variation, until you get the
integral into the form <img class="math" src="../_images/math/5a32dfaee9d0f28f5ef1cf545e6be281c47c983f.svg" alt="\int \big(\ \ \big) \delta f(x) \d x"/> and then you read off
the functional derivative from the expression in the parentheses.</p>
<p>The correspondence between the finite and infinite dimensional case can be
summarized using a functional <img class="math" src="../_images/math/62f3229ce93043cc41c56574d27265441b0c8abc.svg" alt="F[n]"/>, function <img class="math" src="../_images/math/3a12e9964ff967b84be6240b248ed7fdb95dd4b8.svg" alt="n({\bf x})"/> of continuous
parameter <img class="math" src="../_images/math/45d9694d60e7810ecbdcbca7ce4ee5f280d4f1cc.svg" alt="{\bf x}"/> (which can be a scalar or a vector) and its discretized
version <img class="math" src="../_images/math/fbf46054ec7b90f7bb1725ae10e58348a9b84b06.svg" alt="n_i \equiv n({\bf x}_i)"/>, together with a function <img class="math" src="../_images/math/d5f57ff319c830357531e1a16134fef589b7508c.svg" alt="F(n)"/>:</p>
<div class="math">
<p><img src="../_images/math/20a33dd919e13420c2ad0b7e42e60656d87cb9ba.svg" alt="i \quad &amp; \Longleftrightarrow \quad {\bf x} \\
n_i \quad &amp; \Longleftrightarrow \quad n({\bf x}) \\
F(n_i) \quad &amp; \Longleftrightarrow \quad F[n] \\
\d F = 0 \quad &amp; \Longleftrightarrow \quad \delta F = 0 \\
{\partial F\over\partial n_i} = 0 \quad &amp; \Longleftrightarrow \quad
    {\delta F \over \delta n({\bf x})} = 0 \\"/></p>
</div><p>In other words, the basic difference is that the continuous parameter <img class="math" src="../_images/math/45d9694d60e7810ecbdcbca7ce4ee5f280d4f1cc.svg" alt="{\bf x}"/>
has been replaced with a discrete parameter <img class="math" src="../_images/math/26e02951ffb851bd3a9b32dd1e10e6de935a0c7f.svg" alt="i"/>. Then the function <img class="math" src="../_images/math/3a12e9964ff967b84be6240b248ed7fdb95dd4b8.svg" alt="n({\bf x})"/>
becomes a vector of values <img class="math" src="../_images/math/1f1f19780ed9c5a0ec6fca8b5617a323ce8d5c4c.svg" alt="n_i"/>, variation becomes a differential and
functional derivative becomes a partial derivative. To minimize a functional,
one must search for zero functional derivative, while in the discrete case one
searches for zero partial derivatives (gradient).</p>
<p>We now extend the <img class="math" src="../_images/math/d3eba29d795252212afb9268c5afa550b0249815.svg" alt="\delta"/>-variation notation to any any function <img class="math" src="../_images/math/b84b9f94c2f0135455ea2ce1cb5c69081a61f72f.svg" alt="g"/> which
contains the function <img class="math" src="../_images/math/42400ab3531de67b04c236cdcd05a6ce003d6369.svg" alt="f(x)"/> being varied, you just need to replace <img class="math" src="../_images/math/1f452f41a59b567841d283cefbd554ac64e88795.svg" alt="f"/> by
<img class="math" src="../_images/math/509a1fc3ee572f821d5b81f66885e2c1e7ac9e14.svg" alt="f+\epsilon \delta f"/> and apply <img class="math" src="../_images/math/6c853e8bf0cd4e2421165a553c1a569d25b2abf2.svg" alt="{\d\over\d\epsilon}"/> to the whole <img class="math" src="../_images/math/b84b9f94c2f0135455ea2ce1cb5c69081a61f72f.svg" alt="g"/>, for
example (here <img class="math" src="../_images/math/feca9bb6d96bfeed1a43863bcee529e5fa1e0e2c.svg" alt="g=\partial_\mu\phi"/> and <img class="math" src="../_images/math/292a60453cd388c0452d5bb59a7a8f1c8931b017.svg" alt="f=\phi"/>):</p>
<div class="math">
<p><img src="../_images/math/6dd354d2c8e52156942108792533f8d0bb9d1df6.svg" alt="\delta\partial_\mu\phi
    = \left.{\d\over\d\varepsilon}\partial_\mu(\phi+\varepsilon \delta\phi) \right|_{\varepsilon=0}
    = \partial_\mu\left.{\d\over\d\varepsilon}(\phi+\varepsilon \delta\phi) \right|_{\varepsilon=0}
    =\partial_\mu \delta\phi"/></p>
</div><p>As such, the <img class="math" src="../_images/math/29299e3a5c5371587bf08cbf7a2c1f80e8b37d0f.svg" alt="F"/> in <a class="reference internal" href="#equation-functional-deriv">(3.17.3.2)</a> can be either a functional or any
expression that contains the function <img class="math" src="../_images/math/1f452f41a59b567841d283cefbd554ac64e88795.svg" alt="f"/>.
This notation allows us a very convenient computation, as shown in the
following examples.</p>
<p>First, when computing a variation of some integral, we
can interchange <img class="math" src="../_images/math/d3eba29d795252212afb9268c5afa550b0249815.svg" alt="\delta"/> and <img class="math" src="../_images/math/bf80b70a79e8638fc90f4c11131266ccbcd43bd4.svg" alt="\int"/>:</p>
<div class="math">
<p><img src="../_images/math/699bd472b887e633065a9205e62ed51e4b886b49.svg" alt="F[f]=\int K(x) f(x) \d x"/></p>
</div><div class="math">
<p><img src="../_images/math/ee093bd0f5f695881ae60a1b0ee5ee01a357a144.svg" alt="\delta F=\delta \int K(x) f(x) \d x = \left.{\d\over\d\varepsilon}\int K(x) (f+\varepsilon h)\d x\right|_{\varepsilon=0}= \left.\int{\d\over\d\varepsilon} (K(x) (f+\varepsilon h))\d x\right|_{\varepsilon=0}="/></p>
</div><div class="math">
<p><img src="../_images/math/2e8ea364a798392a3e265f2115545f841941a056.svg" alt="=\int\delta(K(x) f(x))\d x"/></p>
</div><p>In the expression <img class="math" src="../_images/math/1f8a0962c2548a11a7162e35ea16dcfe3088738c.svg" alt="\delta(K(x) f(x))"/> we must understand from the context if
we are treating it as a functional of <img class="math" src="../_images/math/1f452f41a59b567841d283cefbd554ac64e88795.svg" alt="f"/> or <img class="math" src="../_images/math/fa823d43fd9496f2d4a53493a042a7a63bf63b54.svg" alt="K"/>. In our case it’s a
functional of <img class="math" src="../_images/math/1f452f41a59b567841d283cefbd554ac64e88795.svg" alt="f"/>, so we have <img class="math" src="../_images/math/eaefaadfde322ce89689cee744131bded23891e1.svg" alt="\delta(K f)=K\delta f"/>.</p>
<p>The second very important note is when taking variation of expression like:</p>
<div class="math">
<p><img src="../_images/math/d12323c761cca9774e5e558cb42860094c405fcf.svg" alt="\delta \int f(t_1)f(t_2) \d t_1 \d t_2 =

= \int \delta (f(t_1)f(t_2)) \d t_1 \d t_2 =

= \int \left.{\d\over\d\varepsilon}(f(t_1)+\varepsilon\delta f(t_1))
    (f(t_2)+\varepsilon\delta f(t_2)) \right|_{\varepsilon=0}
    \d t_1 \d t_2 =

= \int (\delta f(t_1))f(t_2)+f(t_1)(\delta f(t_2)) \d t_1 \d t_2 =

= \int (\delta f(t_1))f(t_2)+f(t_2)(\delta f(t_1)) \d t_1 \d t_2 =

= 2 \int f(t_2) \delta f(t_1) \d t_1 \d t_2"/></p>
</div><p>then when <img class="math" src="../_images/math/1f452f41a59b567841d283cefbd554ac64e88795.svg" alt="f"/> is replaced by <img class="math" src="../_images/math/509a1fc3ee572f821d5b81f66885e2c1e7ac9e14.svg" alt="f+\epsilon \delta f"/>, one has to keep track of
the independent variable, so <img class="math" src="../_images/math/12757d36664cfa5a051a7d6435598ccfe2ca5c3f.svg" alt="f(t_1)"/> gets replaced by <img class="math" src="../_images/math/7edbdcbad3c7ffd7bd9b9d951cea21038d3c06b3.svg" alt="f(t_1)+\epsilon \delta
f(t_1)"/> and <img class="math" src="../_images/math/2472eda70a1515bcb458580c7f8d470b39f79caf.svg" alt="f(t_2)"/> gets replaced by <img class="math" src="../_images/math/eca036685f8c83a30a6cfe4eec35b9e1ab7bbb7d.svg" alt="f(t_2)+\epsilon \delta f(t_2)"/>. Thus the
two variations <img class="math" src="../_images/math/ede7b9f636e4b85dbf908de09cd812394fb78c65.svg" alt="\delta f(t_1)"/> and <img class="math" src="../_images/math/32989ce61afddd3cde479e4d0c7b0b322f5b72f6.svg" alt="\delta f(t_2)"/> are different (independent).
If there is only one indepenent variable, one can simply write <img class="math" src="../_images/math/56b17b159525a6e25cb00503e8e095af9630c11b.svg" alt="\delta f"/> as it
is clear what the independent variable is. This is analogous to using
differentials, e.g. <img class="math" src="../_images/math/5508112d6ec84d6bf5d5495ab0653d743e5e2903.svg" alt="\d (f(x) f(y)) = (\d f(x)) f(y) + f(x) \d f(y)
=f'(x) \d x f(y) + f(x) f'(y) \d y"/>, where one has to keep track of the
independent variable as well for each <img class="math" src="../_images/math/c094518e1eaaf3c9d8f544b5349c198fdf8db26e.svg" alt="\d f"/>.</p>
<p>Another useful formula is differentiation of a functional <img class="math" src="../_images/math/5604f742ff64f726e2f04af45b997ec29e07fff3.svg" alt="F[\psi(\theta)]"/>
where the function <img class="math" src="../_images/math/bdcb1409612537e8009a6d07f73743243ae91586.svg" alt="\psi(\theta)"/> depends on a parameter <img class="math" src="../_images/math/6fb7931886034ccad92f96457979b906fad8ea0c.svg" alt="\theta"/>:</p>
<div class="math">
<p><img src="../_images/math/6da88d7851256e47ca2cadebbf773a9157725985.svg" alt="{\d F[\psi(\theta)] \over \d \theta}
=\left.{\d\over\d\epsilon} F[\psi(\theta+\epsilon)] \right|_{\epsilon=0}
=\left.{\d\over\d\epsilon} F\left[\psi(\theta)+\epsilon {d \psi(\theta)
    \over d \theta} + O(\epsilon^2)\right] \right|_{\epsilon=0}
=\left.{\d\over\d\epsilon} F\left[\psi(\theta)+\epsilon {d \psi(\theta)
    \over d \theta}\right] \right|_{\epsilon=0}
= \int {\delta F[\psi] \over \delta \psi} {\d\psi(\theta)\over\d\theta}\d x"/></p>
</div><p>where we used the definition of a variation and a functional derivative with
<img class="math" src="../_images/math/304bd83fbacda51f15d9ea3e859efae6664bc7f2.svg" alt="\delta\psi={\d\psi(\theta) \over\d\theta}"/>:</p>
<div class="math">
<p><img src="../_images/math/a7f8cad6996867cf3869d73d421cd65bb73f5ad1.svg" alt="\delta F = \left.{\d\over\d\epsilon}
    F[\psi+\epsilon\delta\psi]\right|_{\epsilon=0}
= \int{\delta F\over\delta\psi}\delta\psi\d x"/></p>
</div></section>
<section id="examples">
<h2><span class="section-number">3.17.4. </span>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<p>Some of these examples show how to use the delta function definition of the
functional derivative in equation <a class="reference internal" href="#equation-functional-derivative-def">(3.17.3.1)</a>. However, the
simplest way is to calculate variation first and then read off the functional
derivative from the result, as explained above.</p>
<div class="math">
<p><img src="../_images/math/83105718bf27526940661cf91e9f8cd75b9291dd.svg" alt="{\delta\over\delta f(t)}\int\d t'f(t')g(t')= \left.{\d\over\d\varepsilon}\int\d t'(f(t')+\varepsilon\delta(t-t'))g(t') \right|_{\varepsilon=0}=g(t)

\delta \int \d t f(t)g(t) = \left.{\d\over\d\varepsilon}\int\d
    t(f(t)+\varepsilon \delta f(t))g(t) \right|_{\varepsilon=0}
 = \int g(t) (\delta f(t)) \d t"/></p>
</div><div class="math">
<p><img src="../_images/math/9b809896c9cb82fa63f41d701bcbc45eec4c346c.svg" alt="{\delta f(t')\over\delta f(t)}= \left.{\d\over\d\varepsilon}(f(t')+\varepsilon\delta(t-t')) \right|_{\varepsilon=0}=\delta(t-t')"/></p>
</div><div class="math">
<p><img src="../_images/math/59ca587842c7d707c427ba10ba070834587ce5b9.svg" alt="{\delta f(t_1)f(t_2)\over\delta f(t)}= \left.{\d\over\d\varepsilon}(f(t_1)+\varepsilon\delta(t-t_1)) (f(t_2)+\varepsilon\delta(t-t_2)) \right|_{\varepsilon=0}=\delta(t-t_1)f(t_2)+f(t_1)\delta(t-t_2)"/></p>
</div><p>The next example shows that when taking variation of an expression containing
the function <img class="math" src="../_images/math/1f452f41a59b567841d283cefbd554ac64e88795.svg" alt="f"/> of different independent variables, one has to keep track of
these variables in the variations:</p>
<div class="math">
<p><img src="../_images/math/12dc937f55050f288fe091c5d95c54f2c8d9ffda.svg" alt="\delta (f(t_1)f(t_2))
    = \left.{\d\over\d\varepsilon}(f(t_1)+\varepsilon\delta f(t_1))
        (f(t_2)+\varepsilon\delta f(t_2)) \right|_{\varepsilon=0}
    =(\delta f(t_1))f(t_2)+f(t_1)(\delta f(t_2))"/></p>
</div><div class="math">
<p><img src="../_images/math/85ee630a1ded0a825a7f8fa8dff1c690650690b6.svg" alt="{\delta\over\delta f(t)}\half\int\d t_1\d t_2K(t_1,t_2)f(t_1)f(t_2)= \half\int\d t_1\d t_2K(t_1,t_2){\delta f(t_1)f(t_2)\over\delta f(t)}=

=\half\left(\int\d t_1 K(t_1,t)f(t_1)+\int\d t_2 K(t,t_2)f(t_2)\right) =\int\d t_2 K(t,t_2)f(t_2)"/></p>
</div><div class="math">
<p><img src="../_images/math/dcad36b3e08d61de9b7034e385cbb092ccc73712.svg" alt="\delta \half\int\d t_1\d t_2K(t_1,t_2)f(t_1)f(t_2)= \half\int\d t_1\d
t_2K(t_1,t_2)(\delta f(t_1)f(t_2))=

= \half\int\d t_1\d t_2K(t_1,t_2) ((\delta f(t_1))f(t_2)
    +f(t_1)(\delta f(t_2))=

= \int\d t_1\d t_2 K(t_1,t_2) f(t_2) (\delta f(t_1))"/></p>
</div><p>The last equality follows from <img class="math" src="../_images/math/80e46fb31ed76bc93663a1182b1138227c0f0501.svg" alt="K(t_1,t_2)=K(t_2,t_1)"/> (any antisymmetrical
part of a <img class="math" src="../_images/math/fa823d43fd9496f2d4a53493a042a7a63bf63b54.svg" alt="K"/> would not contribute to the symmetrical integration).</p>
<p>Another example is the derivation of Euler-Lagrange equations for the
Lagrangian density <img class="math" src="../_images/math/a9f00a88f9bf368bb0513d9ab150988c498aa991.svg" alt="\L=\L(\eta_\rho, \partial_\nu \eta_\rho, x^\nu)"/>:</p>
<div class="math">
<p><img src="../_images/math/ed6ce843a3273b9b1d723b19c49ce33f8e04a7dc.svg" alt="0 = \delta S = \delta \int \L \,\d^4x^\mu
= \int \delta \L \,\d^4x^\mu
= \int { \partial \L\over\partial \eta_\rho}\delta\eta_\rho
    +
    { \partial \L\over\partial (\partial_\nu \eta_\rho)}
    \delta(\partial_\nu\eta_\rho)
    \,\d^4x^\mu
=

= \int { \partial \L\over\partial \eta_\rho}\delta\eta_\rho
    +
    { \partial \L\over\partial (\partial_\nu \eta_\rho)}
    \partial_\nu(\delta\eta_\rho)
    \,\d^4x^\mu
=

= \int { \partial \L\over\partial \eta_\rho}\delta\eta_\rho
    -
    \partial_\nu\left(
    { \partial \L\over\partial (\partial_\nu \eta_\rho)}
    \right)
    \delta\eta_\rho
    \,\d^4x^\mu
    +\int \partial_\nu \left(
    { \partial \L\over\partial (\partial_\nu \eta_\rho)}
    \delta\eta_\rho
    \right)
    \,\d^4x^\mu
=

= \int \left[{ \partial \L\over\partial \eta_\rho}
    -
    \partial_\nu\left(
    { \partial \L\over\partial (\partial_\nu \eta_\rho)}
    \right)
    \right]
    \delta\eta_\rho
    \,\d^4x^\mu"/></p>
</div><p>We can also write it using a functional derivative <img class="math" src="../_images/math/131bc8197599faf9cd9d3d3eef0641616a051fd7.svg" alt="{\delta
S\over\delta\eta_\rho}"/> as:</p>
<div class="math">
<p><img src="../_images/math/88382705b566428e987c93469a38e3c66366be04.svg" alt="{\delta S\over\delta\eta_\rho}
    = { \partial \L\over\partial \eta_\rho}
    -
    \partial_\nu\left(
    { \partial \L\over\partial (\partial_\nu \eta_\rho)}
    \right)"/></p>
</div><p>Another example:</p>
<div class="math">
<p><img src="../_images/math/db6f3405737b6dc43ea6b703e110c81a6b4c0e28.svg" alt="{\delta\over\delta f(t)}\int f^3(x)\d x= \left.{\d\over\d\varepsilon}\int(f(x)+\varepsilon\delta(x-t))^3\d x \right|_{\varepsilon=0}="/></p>
</div><div class="math">
<p><img src="../_images/math/a3f7e2a381ec4b258c139d259412e15065bf777d.svg" alt="=\left.\int3(f(x)+\varepsilon\delta(x-t))^2\delta(x-t)\d x \right|_{\varepsilon=0}=\int3f^2(x)\delta(x-t)\d x=3f^2(t)"/></p>
</div><p>One might think that the above calculation is incorrect, because
<img class="math" src="../_images/math/78893bb3ae0a4e65bb05d2023fbce62c313df58e.svg" alt="\delta^2(x-t)"/> is undefined. In case of
such problems the above notation automatically implies working with some
sequence <img class="math" src="../_images/math/b8c5ade71dcc40f0cec1f8edb523d61432a1931a.svg" alt="\delta_\alpha(x) \to \delta(x)"/> (for example <img class="math" src="../_images/math/9d664e894221851fa16a7fdbdda8569184b33ba3.svg" alt="\delta_\alpha(x) =
{1\over\pi x}\sin(\alpha x)"/>) and taking the limit <img class="math" src="../_images/math/9647782ee499e032d0653dd47f75f41424ecaa9d.svg" alt="\alpha\to\infty"/>:</p>
<div class="math">
<p><img src="../_images/math/7f800cddff46ac89905e0de4ba8449e81d2c5efa.svg" alt="{\delta\over\delta f(t)}\int f^3(x)\d x= \left.\lim_{\alpha\to\infty}{\d\over\d\varepsilon}\int(f(x)+\varepsilon\delta_\alpha(x-t))^3\d x \right|_{\varepsilon=0}="/></p>
</div><div class="math">
<p><img src="../_images/math/5da5c96edf5245adffc75767edfb6df165fdebed.svg" alt="=\left.\lim_{\alpha\to\infty}\int3(f(x)+\varepsilon\delta_\alpha(x-t))^2\delta_\alpha(x-t)\d x \right|_{\varepsilon=0}=\lim_{\alpha\to\infty}\int3f^2(x)\delta_\alpha(x-t)\d x="/></p>
</div><div class="math" id="equation-functionalderdel">
<p><span class="eqno">(3.17.4.1)<a class="headerlink" href="#equation-functionalderdel" title="Permalink to this equation">¶</a></span><img src="../_images/math/da77a37cfad0ef754d5af83fb450a68ed624e485.svg" alt="=\int3f^2(x)\lim_{\alpha\to\infty}\delta_\alpha(x-t)\d x= \int3f^2(x)\delta(x-t)\d x=3f^2(t)"/></p>
</div><p>As you can see, we got the same result, with the same rigor, but using an
obfuscating notation. That’s why such obvious manipulations with
<img class="math" src="../_images/math/26469b60d720f1c3fa03e2118c20e271042e5c84.svg" alt="\delta_\alpha"/> are tacitly implied. However, the best method is to first
calculate the variation:</p>
<div class="math">
<p><img src="../_images/math/c7eb8188bd4a73421287eae5c7c15ad6f69a1c4f.svg" alt="\delta \int f^3(x) \d x = \int \delta f^3(x) \d x
=\int 3 f^2(x) \delta f(x) \d x"/></p>
</div><p>and immediately read off the functional derivative:</p>
<div class="math">
<p><img src="../_images/math/a005b65a8d846b8e353c559cf927411f142e5897.svg" alt="{\delta\over\delta f(t)} \int f^3(x) \d x = 3 f^2(t)"/></p>
</div><p>Another example with a metric as a function of coordinates
<img class="math" src="../_images/math/6127bf0cda988971e74ccdaf1a4b116397673684.svg" alt="g_{\mu\nu} = g_{\mu\nu}(x^\mu)"/>:</p>
<div class="math">
<p><img src="../_images/math/5f6f81a71ffc307b82e18fa178796db7f750957c.svg" alt="\delta g_{\mu\nu}
    = \delta g_{\mu\nu}(x^\mu)
    = \left.{\d\over\d\varepsilon} g_{\mu\nu}(x^\mu+\varepsilon
            (\delta x^\mu)) \right|_{\varepsilon=0}
    = \left.{\d\over\d\varepsilon}
            (x^\sigma+\varepsilon(\delta x^\sigma)) \right|_{\varepsilon=0}
        \partial_\sigma g_{\mu\nu}
    = (\delta x^\sigma) \partial_\sigma g_{\mu\nu}"/></p>
</div><p>And an example of varying with respect to a metric:</p>
<div class="math">
<p><img src="../_images/math/63458477970f4212e09978196ce05f970780ef0d.svg" alt="\delta \sqrt{ |\det g_{\mu\nu}| }
    =\sqrt{ |\det g_{\mu\nu}| }\, \delta \log \sqrt{ |\det g_{\mu\nu}| }
    =\half \sqrt{ |\det g_{\mu\nu}| }\, \delta \log |\det g_{\mu\nu}| =

    =\half \sqrt{ |\det g_{\mu\nu}| }\, \delta \Tr \log g_{\mu\nu}
    =\half \sqrt{ |\det g_{\mu\nu}| }\, \Tr \delta \log g_{\mu\nu} =

    =\half \sqrt{ |\det g_{\mu\nu}| }\, \Tr g^{\mu\nu} \delta g_{\mu\nu}
    =\half \sqrt{ |\det g_{\mu\nu}| }\, g^{\mu\nu} \delta g_{\mu\nu} =

    =-\half \sqrt{ |\det g_{\mu\nu}| }\, g_{\mu\nu} \delta g^{\mu\nu}"/></p>
</div><p>Another example (varying energy functional):</p>
<div class="math">
<p><img src="../_images/math/c37cdbd1bae7e8d8c39b49a5bcbeb5a2da19877b.svg" alt="E[\rho] = 4\pi\int {a \rho(r)\over b + r_s(r)} r^2 \d r

r_s(r) = \left(3\over 4\pi (-\rho)\right)^{1\over 3}

{\d r_s\over\d \rho} =
        {1\over 3}\left(3\over 4\pi (-\rho)\right)^{-{2\over 3}}
        {3\over 4\pi \rho^2}
    =
        -{1\over 3\rho}\left(3\over 4\pi (-\rho)\right)^{1\over 3}
    =
        -{r_s\over 3\rho}

\delta E[\rho] = 4\pi \delta \int {a \rho\over b + r_s} r^2 \d r =

    = 4\pi \int\left({a \delta \rho\over b + r_s}
        - {a \rho\over (b + r_s)^2 }\delta r_s\right) r^2 \d r =

    = 4\pi \int\left({a \delta \rho\over b + r_s}
        - {a \rho\over (b + r_s)^2 }\left(-{r_s\over 3\rho}\right)
          \delta\rho\right)
          r^2 \d r =

    = 4\pi \int\left({a \over b + r_s}
        +{1\over3} {a r_s\over (b + r_s)^2 }\right) (\delta\rho) r^2 \d r

{\delta E[\rho]\over\delta\rho}
    = 4\pi r^2 \left({a \over b + r_s}
        +{1\over3} {a r_s\over (b + r_s)^2 }\right)"/></p>
</div><p>Another example (Hartree energy):</p>
<div class="math">
<p><img src="../_images/math/46549c0496d074dd7b4359c1745ca7c5dafc02ac.svg" alt="E[n] = \half \int {n({\bf r}') n({\bf r}'')\over
    | {\bf r}' - {\bf r}''| } \d^3 r' \d^3 r''"/></p>
</div><p>we calculate the variation first:</p>
<div class="math">
<p><img src="../_images/math/660263b103bd6d35de607f1615a6b89913c7de1d.svg" alt="\delta E[n] = \half \delta \int {n({\bf r}') n({\bf r}'')\over
    | {\bf r}' - {\bf r}''| } \d^3 r' \d^3 r'' =

    = \half \int { (\delta n({\bf r}')) n({\bf r}'')
        + n({\bf r}') (\delta n({\bf r}''))\over
    | {\bf r}' - {\bf r}''| } \d^3 r' \d^3 r'' =

    = \int { n({\bf r}') \over | {\bf r}' - {\bf r}''| }
        (\delta n({\bf r}'')) \d^3 r' \d^3 r'' =

    = \int { n({\bf r}') \over | {\bf r} - {\bf r}'| }
        (\delta n({\bf r})) \d^3 r' \d^3 r"/></p>
</div><p>so the functional derivative is:</p>
<div class="math">
<p><img src="../_images/math/fda5bb8000e079f140b3f3670f9548d3d23912b3.svg" alt="{\delta E[n]\over \delta n({\bf r})}
    = \int { n({\bf r}') \over | {\bf r} - {\bf r}'| } \d^3 r'"/></p>
</div><p>Another example (functional with gradients):</p>
<div class="math">
<p><img src="../_images/math/87fc6eed8ea952ad30510257f752e0c8ae8ad577.svg" alt="F[n] = \int h(n) {| \nabla n|^2 \over n} \d^3 r"/></p>
</div><p>the variation is:</p>
<div class="math">
<p><img src="../_images/math/f857983e6697e2fd3eccb5669286792c3fb85bf9.svg" alt="\delta F[n]
    = \int \delta \left( h(n) {| \nabla n|^2 \over n} \right) \d^3 r =

    = \int {\d h \over \d n} {| \nabla n|^2 \over n} \delta n
        + h(n)\left(2n\nabla n \cdot \nabla \delta n - | \nabla n|^2
          \delta n
          \over n^2\right) \d^3 r =

    = \int \left({\d h \over \d n} - {h(n)\over n}\right)
        {| \nabla n|^2 \over n}
        \delta n
        + 2 h(n){\nabla n \cdot \nabla \delta n \over n} \d^3 r =

    = \int \left({\d h \over \d n} - {h(n)\over n} \right)
        {| \nabla n|^2 \over n}
        \delta n
        - 2 \nabla\cdot\left(h(n){\nabla n \over n}\right)\delta n\ \d^3 r =

    = \int \left({\d h \over \d n} - {h(n)\over n} \right)
        {| \nabla n|^2 \over n}
        \delta n
        - 2 \left({\d h \over \d n}{| \nabla n|^2 \over n}
          +h(n){\nabla^2 n \over n}
          -h(n){| \nabla n|^2 \over n^2}
          \right)\delta n\ \d^3 r =

    = \int \left[ \left({h(n)\over n} - {\d h \over \d n}\right)
        {| \nabla n|^2 \over n}
        - 2 h(n){\nabla^2 n \over n}\right]
          \delta n\ \d^3 r"/></p>
</div><p>from which we read off the functional derivative:</p>
<div class="math">
<p><img src="../_images/math/bb6c5d8d2afe8c7abb3e77084f9d611eb300c8a7.svg" alt="{\delta F[n] \over \delta n({\bf r})}
    = \left({h(n)\over n} - {\d h \over \d n}\right)
        {| \nabla n|^2 \over n}
        - 2 h(n){\nabla^2 n \over n}"/></p>
</div></section>
</section>
<section id="dirac-notation">
<span id="index-1"></span><h1><span class="section-number">3.18. </span>Dirac Notation<a class="headerlink" href="#dirac-notation" title="Permalink to this heading">¶</a></h1>
<p>The Dirac notation allows a very compact and powerful way of writing
equations that describe a function expansion into a basis, both discrete
(e.g. a Fourier series expansion) and continuous (e.g. a Fourier transform)
and related things. The notation is designed so that it is very easy to
remember and it just guides you to write the correct equation.</p>
<p>Let’s have a function <img class="math" src="../_images/math/42400ab3531de67b04c236cdcd05a6ce003d6369.svg" alt="f(x)"/>. We define</p>
<div class="math">
<p><img src="../_images/math/de8863a306e08cd92ff9f3948ed2703d0e94b97f.svg" alt="\begin{eqnarray*} \braket{x|f}&amp;\equiv&amp; f(x) \\ \braket{x'|f}&amp;\equiv&amp; f(x') \\ \braket{x'|x}&amp;\equiv&amp;\delta(x'-x) \\ \int\ket{x}\bra{x}\d x&amp;\equiv&amp;\one \\ \end{eqnarray*}"/></p>
</div><p>The following equation</p>
<div class="math">
<p><img src="../_images/math/01da5124cb43bf5e63cc816cfb5f141fdd8eca49.svg" alt="f(x')=\int\delta(x'-x)f(x)\d x"/></p>
</div><p>then becomes</p>
<div class="math">
<p><img src="../_images/math/d477c42d63cebc14b3455d6b9bd04acd302a5c0b.svg" alt="\braket{x'|f}=\int\braket{x'|x}\braket{x|f}\d x"/></p>
</div><p>and thus we can interpret <img class="math" src="../_images/math/b74358aa0be1520c7c9bead72e963592d0481456.svg" alt="\ket{f}"/> as a vector, <img class="math" src="../_images/math/f86d196772cb426e361837ab47635f8cdd8310be.svg" alt="\ket{x}"/> as a basis and <img class="math" src="../_images/math/423db40f33b302fdee2e487cf773bf1a7ef7e488.svg" alt="\braket{x|f}"/> as the coefficients in the basis expansion:</p>
<div class="math">
<p><img src="../_images/math/98deb1208a11eb2283e271d7dc1ebcdf1ecb24fe.svg" alt="\ket{f}=\one\ket{f}=\int\ket{x}\bra{x}\d x\ket{f}= \int\ket{x}\braket{x|f}\d x"/></p>
</div><p>That’s all there is to it. Take the above rules as the operational definition
of the Dirac notation. It’s like with the delta function - written alone it
doesn’t have any meaning, but there are clear and non-ambiguous rules to
convert any expression with <img class="math" src="../_images/math/d3eba29d795252212afb9268c5afa550b0249815.svg" alt="\delta"/> to an expression which even mathematicians
understand (i.e. integrating, applying test functions and using other relations
to get rid of all <img class="math" src="../_images/math/d3eba29d795252212afb9268c5afa550b0249815.svg" alt="\delta"/> symbols in the expression – but the result is
usually much more complicated than the original formula). It’s the same with
the ket <img class="math" src="../_images/math/b74358aa0be1520c7c9bead72e963592d0481456.svg" alt="\ket{f}"/>: written alone it doesn’t have any meaning, but you can
always use the above rules to get an expression that make sense to everyone
(i.e. attaching any bra to the left and rewriting all brackets <img class="math" src="../_images/math/538b2d7737d0ffbc13f936a9da97b1ad5a3046cf.svg" alt="\braket{a|b}"/>
with their equivalent expressions) – but it will be more complex and harder to
remember and – that is important – less general.</p>
<p>Now, let’s look at the spherical harmonics:</p>
<div class="math">
<p><img src="../_images/math/799ff28d1a1d2ec41f69975b607a4ec36a02060a.svg" alt="Y_{lm}({\bf\hat r})\equiv\braket{{\bf\hat r}|lm}"/></p>
</div><p>on the unit sphere, we have</p>
<div class="math">
<p><img src="../_images/math/7f0a2d8fa9b503434c17e8ec10ac8267ebd97e3e.svg" alt="\int\ket{\bf\hat r}\bra{\bf\hat r}\d{\bf\hat r}= \int\ket{\bf\hat r}\bra{\bf\hat r}\d\Omega=\one"/></p>
</div><div class="math">
<p><img src="../_images/math/6bd814f424bd94e28e058315646ffa72c1e9a8d5.svg" alt="\delta({\bf\hat r}-{\bf\hat r'})=\braket{{\bf\hat r}|{\bf\hat r'}}"/></p>
</div><p>thus</p>
<div class="math">
<p><img src="../_images/math/c989accc72f807d7a1e2dae3a40a94d80feee6e9.svg" alt="\int_0^{2\pi}\int_0^{\pi} Y_{lm}(\theta,\phi)\,Y^*_{l'm'}(\theta,\phi)\sin\theta\,\d\theta\,\d\phi = \int\braket{l'm'|{\bf\hat r}}\braket{{\bf\hat r}|lm}\d\Omega= \braket{l'm'|lm}"/></p>
</div><p>and from <a class="reference internal" href="spherical-harmonics.html#equation-yorto">(3.30.1)</a> we get</p>
<div class="math">
<p><img src="../_images/math/f8a35906e7b18fcd27dba7a211a30508f3583e8b.svg" alt="\braket{l'm'|lm}=\delta_{mm'}\delta_{ll'}"/></p>
</div><p>now</p>
<div class="math">
<p><img src="../_images/math/3dce7a9322ff2737157c760e2cbfd2eed7533665.svg" alt="\sum_{lm}Y_{lm}(\theta,\phi)Y_{lm}^*(\theta',\phi')= \sum_{lm}\braket{{\bf\hat r}|lm}\braket{lm|{\bf\hat r'}}"/></p>
</div><p>from <a class="reference internal" href="spherical-harmonics.html#equation-ycomplete">(3.30.3)</a> we get</p>
<div class="math">
<p><img src="../_images/math/23be63ef005021743d70a9926670002c47aaed48.svg" alt="\sum_{lm}\braket{{\bf\hat r}|lm}\braket{lm|{\bf\hat r'}}= \braket{{\bf\hat r}|{\bf\hat r'}}"/></p>
</div><p>so we have</p>
<div class="math">
<p><img src="../_images/math/70b34aa2761f74e2f3d5b4f593e9185670e95a05.svg" alt="\sum_{lm}\ket{lm}\bra{lm}=\one"/></p>
</div><p>so <img class="math" src="../_images/math/c6b5b3bac13e2ea0f1e245f6cda3943797e0a9b1.svg" alt="\ket{lm}"/> forms an orthonormal basis. Any function defined on the sphere <img class="math" src="../_images/math/69f3d35f957f7a266e21571e13e0b083624544a3.svg" alt="f({\bf\hat r})"/> can be written using this basis:</p>
<div class="math">
<p><img src="../_images/math/980b213b347cb4e1086e5b000cbdc543ca557837.svg" alt="f({\bf\hat r}) =\braket{{\bf\hat r}|f} =\sum_{lm}\braket{{\bf\hat r}|lm}\braket{lm|f} =\sum_{lm}Y_{lm}({\bf\hat r})f_{lm}"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/a6c1280dd2db32640f2ff727c58d3dcf726076ad.svg" alt="f_{lm}=\braket{lm|f}=\int\braket{lm|{\bf\hat r}}\braket{{\bf\hat r}|f}\d\Omega =\int Y_{lm}^*({\bf\hat r}) f({\bf\hat r})\d\Omega"/></p>
</div><p>If we have a function <img class="math" src="../_images/math/5834a3a9a5d888d83d8b8be65cf63af8a8b46cdc.svg" alt="f({\bf r})"/> in 3D, we can write it as a function of <img class="math" src="../_images/math/3c77dea29128643eecf479e904b1d27115e05e5c.svg" alt="\rho"/> and <img class="math" src="../_images/math/0e799af4604f2461f6ee590bf22d52a522693102.svg" alt="{\bf\hat r}"/> and expand only with respect to the variable <img class="math" src="../_images/math/0e799af4604f2461f6ee590bf22d52a522693102.svg" alt="{\bf\hat r}"/>:</p>
<div class="math">
<p><img src="../_images/math/5ac4e775d128993ffc604db23d7b29c2a3a754ca.svg" alt="f({\bf r})=f(\rho{\bf\hat r})\equiv g(\rho,{\bf\hat r})= \sum_{lm}Y_{lm}({\bf\hat r})g_{lm}(\rho)"/></p>
</div><p>In Dirac notation we are doing the following: we decompose the space into the angular and radial part</p>
<div class="math">
<p><img src="../_images/math/b80d5889078d816ac808897cd75258a735758cfc.svg" alt="\ket{{\bf r}}=\ket{{\bf\hat r}}\otimes\ket{\rho} \equiv\ket{{\bf\hat r}}\ket{\rho}"/></p>
</div><p>and write</p>
<div class="math">
<p><img src="../_images/math/2747c3f4d310ee11853476855fe4cf07d6c10759.svg" alt="f({\bf r})=\braket{{\bf r}|f}=\bra{{\bf\hat r}}\braket{\rho|f}= \sum_{lm}Y_{lm}({\bf\hat r})\bra{lm}\braket{\rho|f}"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/eea54150ce4e4dff964ba1fb005c985f522fa233.svg" alt="\bra{lm}\braket{\rho|f}= \int\braket{lm|{\bf\hat r}}\bra{{\bf\hat r}}\braket{\rho|f}\d\Omega =\int Y_{lm}^*({\bf\hat r}) f({\bf r})\d\Omega"/></p>
</div><p>Let’s calculate <img class="math" src="../_images/math/8e174e67345d76deae0ab48748c472d15711b8be.svg" alt="\braket{\rho|\rho'}"/></p>
<div class="math">
<p><img src="../_images/math/5d9d1c4cae17353af8d752daf6885e73c176db7a.svg" alt="\braket{{\bf r}|{\bf r'}}=\bra{\bf\hat r}\braket{\rho|\rho'}\ket{{\bf\hat r'}} =\braket{{\bf\hat r}|{\bf\hat r'}}\braket{\rho|\rho'}"/></p>
</div><p>so</p>
<div class="math">
<p><img src="../_images/math/449ff06ae49fdcda197a3d20acc4f88bbd2d9df5.svg" alt="\braket{\rho|\rho'} ={\braket{{\bf r}|{\bf r'}}\over\braket{{\bf\hat r}|{\bf\hat r'}}} ={\delta(\rho-\rho')\over\rho^2}"/></p>
</div><p>We must stress that <img class="math" src="../_images/math/c6b5b3bac13e2ea0f1e245f6cda3943797e0a9b1.svg" alt="\ket{lm}"/> only acts in the <img class="math" src="../_images/math/62223caf880f266cdb23fb73712d940e7a98fd12.svg" alt="\ket{{\bf\hat r}}"/> space
(not the <img class="math" src="../_images/math/6c436e5d1bb36bb373d3f3b406ece9779700bbbf.svg" alt="\ket\rho"/> space) which means that</p>
<div class="math">
<p><img src="../_images/math/c5d26f56eb29fdb639d38162f033387193cebcf6.svg" alt="\braket{{\bf r}|lm} =\bra{\bf\hat r}\braket{\rho|lm} =\braket{{\bf\hat r}|lm}\bra{\rho} =Y_{lm}({\bf\hat r})\bra{\rho}"/></p>
</div><p>and <img class="math" src="../_images/math/d4f1690127757c614a88b028ee9646bd32cf97ea.svg" alt="V\ket{lm}"/> leaves <img class="math" src="../_images/math/e945eaee64878f7a8b48ef22ac7621515825aa5c.svg" alt="V\ket\rho"/> intact. Similarly,</p>
<div class="math">
<p><img src="../_images/math/b237a3b08aea9a6ae4945fca5a08b62ba8fddc71.svg" alt="\sum_{lm} \ket{lm}\bra{lm}=\one"/></p>
</div><p>is a unity in the <img class="math" src="../_images/math/1698e65fe850e1f27244e7ec59b93a026b437266.svg" alt="\ket{\bf\hat r}"/> space only (i.e. on the unit sphere).</p>
<p>Let’s rewrite the equation <a class="reference internal" href="spherical-harmonics.html#equation-lsum">(3.30.4)</a>:</p>
<div class="math">
<p><img src="../_images/math/b669535c3262c9a3047434e38e286ae1856970a1.svg" alt="\sum_m\braket{{\bf\hat r}|lm}\braket{lm|{\bf\hat r'}}= {4\pi\over 2l+1} \braket{{\bf\hat r}\cdot{\bf\hat r'}|P_l}"/></p>
</div><p>Using the completeness relation <a class="reference internal" href="spherical-harmonics.html#equation-lorto">(3.29.1)</a>:</p>
<div class="math">
<p><img src="../_images/math/d01b58d2b38bca0936eba28e1c12e5e656d618b8.svg" alt="\sum_l {2l+1\over2}\braket{x'|P_l}\braket{P_l|x}=\braket{x'|x}"/></p>
</div><div class="math">
<p><img src="../_images/math/aa987e746b2dbb3a9bbfc8b510b77dc9abb52b05.svg" alt="\sum_l \ket{P_l}{2l+1\over2}\bra{P_l}=\one"/></p>
</div><p>we can now derive a very important formula true for every function <img class="math" src="../_images/math/41e55c4c4cce84be17bf2a395316a6c8eae63e44.svg" alt="f({\bf\hat r}\cdot{\bf\hat r'})"/>:</p>
<div class="math">
<p><img src="../_images/math/71b6d1d41ca6af48fbc77f5f9c5d26da921b5acc.svg" alt="f({\bf\hat r}\cdot{\bf\hat r'})=\braket{{\bf\hat r}\cdot{\bf\hat r'}|f}= \sum_l \braket{{\bf\hat r}\cdot{\bf\hat r'}|P_l}{2l+1\over2}\braket{P_l|f}= \sum_{lm}\braket{{\bf\hat r}|lm}\braket{lm|{\bf\hat r'}}{(2l+1)^2\over8\pi} \braket{P_l|f}="/></p>
</div><div class="math">
<p><img src="../_images/math/94a7bf6218892e0b2ac727126baf5889b3090724.svg" alt="=\sum_{lm}\braket{{\bf\hat r}|lm}f_l \braket{lm|{\bf\hat r'}}"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/d20cea61866c1dc63a9c5d58d3bea6aeadaafeb5.svg" alt="f_l={(2l+1)^2\over8\pi}\braket{P_l|f} ={(2l+1)^2\over8\pi}\int_{-1}^1 \braket{P_l|x}\braket{x|f}\d x ={(2l+1)^2\over8\pi}\int_{-1}^1 P_l(x)f(x)\d x"/></p>
</div><p>or written explicitly</p>
<div class="math" id="equation-fylm">
<p><span class="eqno">(3.18.1)<a class="headerlink" href="#equation-fylm" title="Permalink to this equation">¶</a></span><img src="../_images/math/a1ca9aab1e03be7ac3262b232bfc8b80926b757e.svg" alt="f({\bf\hat r}\cdot{\bf\hat r'})= \sum_{l=0}^\infty\sum_{m=-l}^l Y_{lm}({\bf\hat r}) f_l Y_{lm}^*({\bf\hat r'})"/></p>
</div></section>
<section id="homogeneous-functions-euler-s-theorem">
<span id="homogeneous-functions"></span><span id="index-2"></span><h1><span class="section-number">3.19. </span>Homogeneous Functions (Euler’s Theorem)<a class="headerlink" href="#homogeneous-functions-euler-s-theorem" title="Permalink to this heading">¶</a></h1>
<p>A function of several variables <img class="math" src="../_images/math/43c9e7d81e8e935d1ced22d0f306e173ec368508.svg" alt="f(x_1, x_2, \dots) \equiv f(x_i)"/> is
homogeneous of degree <img class="math" src="../_images/math/0dabd76e82ded83eabfba509508649f4b47ca55e.svg" alt="k"/> if</p>
<div class="math">
<p><img src="../_images/math/23af365638ac076c927607f5c7fca84818c0b55c.svg" alt="f(\lambda x_i) = \lambda^k f(x_i)"/></p>
</div><p>By differentiating with respect to <img class="math" src="../_images/math/165b0c434b8455be67011f1327cba822ddf25e63.svg" alt="\lambda"/>:</p>
<div class="math">
<p><img src="../_images/math/f6b31728b7636595614166013a8d73a82322f225.svg" alt="x_i {\partial f(\lambda x_i)\over\partial x_i} = k\lambda^{k-1} f(x_i)"/></p>
</div><p>and setting <img class="math" src="../_images/math/670e8e1c3d05c372457acf6065b737623eaaaeda.svg" alt="\lambda=1"/> we get the so called Euler equation:</p>
<div class="math">
<p><img src="../_images/math/5743f6861489a375bcd78f641fbdbdf22f0091b5.svg" alt="x_i {\partial f(x_i)\over\partial x_i} = k f(x_i)"/></p>
</div><p>in 3D this can also be written as:</p>
<div class="math">
<p><img src="../_images/math/948d18c7567de4e95a7382bb952d44c912da15e6.svg" alt="{\bf x} \cdot \nabla f({\bf x}) = k f({\bf x})"/></p>
</div><section id="example-1">
<h2><span class="section-number">3.19.1. </span>Example 1<a class="headerlink" href="#example-1" title="Permalink to this heading">¶</a></h2>
<p>The function <img class="math" src="../_images/math/8aed01e062c9eb1e8f3bf935d432ecc1a7e95e95.svg" alt="f(x, y, z) = {xy\over z}"/> is homogeneous of degree 1, because:</p>
<div class="math">
<p><img src="../_images/math/a6ae00af87d5a6b8f1f53c39869c891e8aebbf3f.svg" alt="f(\lambda x, \lambda y, \lambda z) = {\lambda x\lambda y\over \lambda z}
= \lambda {xy\over z}
= \lambda f(x, y, z)"/></p>
</div><p>and the Euler equation is:</p>
<div class="math">
<p><img src="../_images/math/27bf6c60c2de32863bdba7e4f8dbeedacee639fc.svg" alt="x{\partial f\over\partial x} +
y{\partial f\over\partial y} +
z{\partial f\over\partial z}
=
f"/></p>
</div><p>or</p>
<div class="math">
<p><img src="../_images/math/05f98fe63be8edb06a7167537d6438b074359a03.svg" alt="x{y\over z} +
y{x\over z} +
z\left(-{xy\over z^2}\right)
={xy\over z}"/></p>
</div><p>Which is true.</p>
</section>
<section id="example-2">
<h2><span class="section-number">3.19.2. </span>Example 2<a class="headerlink" href="#example-2" title="Permalink to this heading">¶</a></h2>
<p>The function <img class="math" src="../_images/math/0be6d1efdf5dd62c4a0dfa6bd32c149e5712f83e.svg" alt="V(r) = -{Z \over r}"/> is homogeneous of degree -1, because:</p>
<div class="math">
<p><img src="../_images/math/788a061d086a012369477ebf618d639fa3587337.svg" alt="V(\lambda r) = -{Z\over \lambda r} = \lambda^{-1} V(r)"/></p>
</div><p>and the Euler equation is:</p>
<div class="math">
<p><img src="../_images/math/8aa662241debabc39cb85a078ea416ff130d9204.svg" alt="r{\d V\over\d r} = -V"/></p>
</div><p>or</p>
<div class="math">
<p><img src="../_images/math/570ec25e47d764ec0e6f1effd659e01147d73117.svg" alt="r{Z\over r^2} = -\left(-{Z\over r}\right)"/></p>
</div><p>Which is true.</p>
</section>
</section>
<section id="green-functions">
<h1><span class="section-number">3.20. </span>Green Functions<a class="headerlink" href="#green-functions" title="Permalink to this heading">¶</a></h1>
<p>Green functions are an excellent tool for working with a solution to any ODE or
PDE. In this text we explain how it works and then show how one can calculate
them using FEM.</p>
<section id="introduction">
<h2><span class="section-number">3.20.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>Let’s put any ODE or PDE in the form:</p>
<div class="math" id="equation-pde">
<p><span class="eqno">(3.20.1.1)<a class="headerlink" href="#equation-pde" title="Permalink to this equation">¶</a></span><img src="../_images/math/3fbb73c734f38dfec71cb78b96f3fa592fb8e535.svg" alt="Lu(x)=f(x)"/></p>
</div><p>Here <img class="math" src="../_images/math/961a0c55563970ae0b0074c740f76046460c654a.svg" alt="L"/> is a differential operator and <img class="math" src="../_images/math/74d80b1f8754374202dc72f351096af63dd5da6c.svg" alt="x"/> can have any dimension, e.g. 1D
(ODE), 2D, 3D or more (PDE). Then we can express the solution as</p>
<div class="math" id="equation-solution">
<p><span class="eqno">(3.20.1.2)<a class="headerlink" href="#equation-solution" title="Permalink to this equation">¶</a></span><img src="../_images/math/6d1ea5e58d943c83bf769bc2d3961fd4610a1e9b.svg" alt="u(x) = L^{-1}f(x) = \int G(x, x')f(x')\d x'"/></p>
</div><p>where <img class="math" src="../_images/math/1019ea20d99841b13c26731a5a720a10ad33088a.svg" alt="G(x, x')"/> is a Green function, that needs to satisfy the equation:</p>
<div class="math" id="equation-green">
<p><span class="eqno">(3.20.1.3)<a class="headerlink" href="#equation-green" title="Permalink to this equation">¶</a></span><img src="../_images/math/39059a62f535915c983f8da017807a207bea8588.svg" alt="LG(x, x')=\delta(x-x')"/></p>
</div><p>Remember, that <img class="math" src="../_images/math/961a0c55563970ae0b0074c740f76046460c654a.svg" alt="L"/> acts on <img class="math" src="../_images/math/74d80b1f8754374202dc72f351096af63dd5da6c.svg" alt="x"/> only, so we can check, that <a class="reference internal" href="#equation-solution">(3.20.1.2)</a>
indeed solves the PDE <a class="reference internal" href="#equation-pde">(3.20.1.1)</a>:</p>
<div class="math">
<p><img src="../_images/math/d94c4678e6e4b56d34cc980ddafbebe91a7b7fc1.svg" alt="Lu(x)
= L\int G(x, x')f(x')\d x'
= \int LG(x, x')f(x')\d x'
= \int \delta(x-x')f(x')\d x'
= f(x)"/></p>
</div></section>
<section id="boundary-conditions">
<h2><span class="section-number">3.20.2. </span>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this heading">¶</a></h2>
<p>The equation <a class="reference internal" href="#equation-green">(3.20.1.3)</a> doesn’t determine the Green function uniquely,
because one can add to it any solution of the homogeneous equation <img class="math" src="../_images/math/f3fcf6f148e67c704f99819e98520c6fd110949b.svg" alt="Lu(x)=0"/>.
We can use this freedom to solve <a class="reference internal" href="#equation-green">(3.20.1.3)</a> for any boundary condition.
So we prescribe a boundary condition
and find the Green function (by solving <a class="reference internal" href="#equation-green">(3.20.1.3)</a>) that satisfies the
boundary condition. It can be shown, that <img class="math" src="../_images/math/d78ecf4cc8a1d1e9466abf94f1ae4a8a12692206.svg" alt="u(x)"/> determined from
<a class="reference internal" href="#equation-solution">(3.20.1.2)</a> then also needs to satisfy the same boundary condition.</p>
</section>
<section id="symmetry">
<h2><span class="section-number">3.20.3. </span>Symmetry<a class="headerlink" href="#symmetry" title="Permalink to this heading">¶</a></h2>
<p>We write the equation for Green functions at two different points <img class="math" src="../_images/math/3cbaf5c63029b99eef876930b1e0a32ba5f4d5a9.svg" alt="x_1"/>
and <img class="math" src="../_images/math/694d6790ae97386776b4f37d46a9c00ddc9cd9e2.svg" alt="x_2"/>:</p>
<div class="math">
<p><img src="../_images/math/a5140bf8a4341303337c83a470d05f4d65b98210.svg" alt="L G(x, x_1) = \delta(x-x_1)

L G(x, x_2) = \delta(x-x_2)"/></p>
</div><p>and multiply the first equation by <img class="math" src="../_images/math/84804401c59a30632bffd6c9163dbef1d9c12148.svg" alt="G(x, x_2)"/>, second by <img class="math" src="../_images/math/b4de8ea276662a4290d7b43b7fae8e248bac6f5b.svg" alt="G(x, x_1)"/>:</p>
<div class="math">
<p><img src="../_images/math/68b33d64162c7f4d890187c3ac2480787a72c3db.svg" alt="G(x, x_2) L G(x, x_1) = \delta(x-x_1) G(x, x_2)

G(x, x_1) L G(x, x_2) = \delta(x-x_2) G(x, x_1)"/></p>
</div><p>substract them and integrate over <img class="math" src="../_images/math/74d80b1f8754374202dc72f351096af63dd5da6c.svg" alt="x"/>:</p>
<div class="math">
<p><img src="../_images/math/bf3c195d81973a6b80cd88ec889a71ee03f59f29.svg" alt="G(x, x_2) L G(x, x_1) - G(x, x_1) L G(x, x_2)
    = \delta(x-x_1) G(x, x_2) - \delta(x-x_2) G(x, x_1)

\int \left(G(x, x_2) L G(x, x_1) - G(x, x_1) L G(x, x_2) \right) \d x
    = \int \left(\delta(x-x_1) G(x, x_2) - \delta(x-x_2) G(x, x_1)
        \right)\d x

\int \left(G(x, x_2) L G(x, x_1) - G(x, x_1) L G(x, x_2) \right) \d x
    = G(x_1, x_2) - G(x_2, x_1)"/></p>
</div><p>Assuming that the operator <img class="math" src="../_images/math/961a0c55563970ae0b0074c740f76046460c654a.svg" alt="L"/> is Hermitean, we get:</p>
<div class="math">
<p><img src="../_images/math/b769c4799baec3ae47677b408032ea840cbe9b01.svg" alt="\int \left((L G(x, x_2)) G(x, x_1) - G(x, x_1) L G(x, x_2) \right) \d x
    = G(x_1, x_2) - G(x_2, x_1)

0 = G(x_1, x_2) - G(x_2, x_1)"/></p>
</div><p>So the Green function is symmetric for Hermitean operators <img class="math" src="../_images/math/961a0c55563970ae0b0074c740f76046460c654a.svg" alt="L"/>.</p>
</section>
<section id="id1">
<h2><span class="section-number">3.20.4. </span>Examples<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h2>
<section id="poisson-equation-in-1d">
<h3>Poisson Equation in 1D<a class="headerlink" href="#poisson-equation-in-1d" title="Permalink to this heading">¶</a></h3>
<p>Poisson equation:</p>
<div class="math">
<p><img src="../_images/math/231c8473b5b197b235987eb48dd8dff46c72f4a4.svg" alt="-{\d^2\over\d x^2} u(x) = f(x)"/></p>
</div><p>We calculate the Green function using the Fourier transform:</p>
<div class="math">
<p><img src="../_images/math/2f9be26e061c1f8346a68e269dced29ee1de0fe9.svg" alt="-{\partial^2\over\partial x^2} G(x, x') = \delta(x-x')

-(ik)^2 \tilde G(k, x') = {e^{ikx'}\over\sqrt{2\pi}}

\tilde G(k, x') = {e^{ikx'}\over\sqrt{2\pi}\,k^2}

G(x, x') = -\half (x-x') \sign(x-x')
    = -\half (x-x') (2H(x-x')-1)
    = H(x-x') (x'-x) +\half(x-x')"/></p>
</div><p>Check:</p>
<div class="math">
<p><img src="../_images/math/57c26f07e5c21e4f77aaab86321f15ea0eedcd93.svg" alt="{\partial\over\partial x} G(x, x')
    = \delta(x-x') (x'-x) + H(x-x') (-1) + \half
    = - H(x-x') + \half

{\partial^2\over\partial x^2} G(x, x')
    = - \delta(x-x')"/></p>
</div><p>Then:</p>
<div class="math">
<p><img src="../_images/math/bf4d9c824bd6cf2c809cd58949175fe0a94beb05.svg" alt="u(x) = \int G(x, x') f(x') \d x'
    = \int \left(H(x-x') (x'-x) +\half(x-x')\right) f(x') \d x'"/></p>
</div><p>The green function can also be written using <img class="math" src="../_images/math/bc3bc8d2708eb77863dbb311047a1de29d9d2fdd.svg" alt="x_&lt;=\min(x, x')"/> and
<img class="math" src="../_images/math/27830262d2e007539616a6fd820561b37845d5c2.svg" alt="x_&gt; = \max(x, x')"/>:</p>
<div class="math">
<p><img src="../_images/math/6a47dd96fc9df362bc2bc101a6c5949ccb0d4fee.svg" alt="G(x, x') = H(x-x') (x'-x) +\half(x-x')
    = \half(x_&lt; - x_&gt;)"/></p>
</div></section>
<section id="radial-poisson-equation">
<h3>Radial Poisson Equation<a class="headerlink" href="#radial-poisson-equation" title="Permalink to this heading">¶</a></h3>
<p>Let’s write <img class="math" src="../_images/math/11791cde0279a38386c2043e1c8317bad24d1810.svg" alt="r_&gt;"/> and <img class="math" src="../_images/math/fb76f7108ba6bc433fcc9d64c0776a3b016c3e2d.svg" alt="r_&lt;"/> using the Heaviside step function:</p>
<div class="math">
<p><img src="../_images/math/0ba609ca56fd14269f2149bd7e4c52f5f369b206.svg" alt="r_&gt; = \max(r, r')
    =
\begin{cases}
r&amp;\quad\mbox{for $r&gt;r'$}\cr
r'&amp;\quad\mbox{for $r&lt;r'$}\cr
\end{cases}
= H(r-r') r + H(r'-r)r' =

= H(r-r') r + (1-H(r-r'))r'
= H(r-r') (r-r') + r'"/></p>
</div><p>and:</p>
<div class="math">
<p><img src="../_images/math/95875676a9ebfadea6b024195f4000c9e7a3e0a6.svg" alt="r_&lt; = \min(r, r')
    =
\begin{cases}
r'&amp;\quad\mbox{for $r&gt;r'$}\cr
r&amp;\quad\mbox{for $r&lt;r'$}\cr
\end{cases}
= H(r-r') r' + H(r'-r)r =

= H(r-r') r' + (1-H(r-r'))r
= H(r-r') (r'-r) + r"/></p>
</div><p>Then we can differentiate:</p>
<div class="math">
<p><img src="../_images/math/af84ae56060c3a3330cf0d50e3a4e046a535a8f2.svg" alt="{\partial\over\partial r} r_&gt;
    = \delta(r-r')(r-r') + H(r-r')
    = H(r-r')

{\partial^2\over\partial r^2} r_&gt;
    = \delta(r-r')

{\partial\over\partial r} r_&lt;
    = \delta(r-r')(r'-r) - H(r-r') + 1
    = 1-H(r-r') = H(r'-r)

{\partial^2\over\partial r^2} r_&lt;
    = -\delta(r-r')"/></p>
</div><p>Given:</p>
<div class="math" id="equation-rad-integral-u">
<p><span class="eqno">(3.20.4.1)<a class="headerlink" href="#equation-rad-integral-u" title="Permalink to this equation">¶</a></span><img src="../_images/math/84b2154f558fe634bee980e7c37475a9d9fb0c0e.svg" alt="u(r) = \int_0^\infty {f(r') r'^2 \over r_&gt;} \d r'"/></p>
</div><p>The Green function is</p>
<div class="math">
<p><img src="../_images/math/08ef5fab9a6102311ef6686b371dd8e1368a4a2f.svg" alt="G(r, r') = {r'^2\over r_&gt;}"/></p>
</div><p>Let’s differentiate:</p>
<div class="math">
<p><img src="../_images/math/e7a7a7d954a851e742dfbb8ce98d964094f87546.svg" alt="{\partial\over\partial r} G(r, r') = -{r'^2\over r_&gt;^2}
        {\partial\over\partial r} r_&gt;
= -{r'^2\over r_&gt;^2} H(r-r')
= -{r'^2\over r^2} H(r-r')"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/a776f83e8a2f4c8e85a2d2a39d3cb56b2732e27c.svg" alt="{\partial^2\over\partial r^2} G(r, r') = +{2\over r}{r'^2\over r^2}
    H(r-r') -{r'^2\over r^2} \delta(r-r')"/></p>
</div><p>So we get:</p>
<div class="math">
<p><img src="../_images/math/2251972b7827f00a8ee4875682f3e38824f0f981.svg" alt="-{\partial^2\over\partial r^2} G(r, r')
    -{2\over r}{\partial\over\partial r} G(r, r')
    =-{2\over r}{r'^2\over r^2} H(r-r') +{r'^2\over r^2} \delta(r-r')
        +{2\over r}{r'^2\over r^2} H(r-r')
    ={r'^2\over r^2} \delta(r-r') = \delta(r-r')"/></p>
</div><p>So <img class="math" src="../_images/math/e8e7a8dd7e5c9f14d784dea8950f2bdae82d3dda.svg" alt="u(r)"/> from <a class="reference internal" href="#equation-rad-integral-u">(3.20.4.1)</a> is a solution to the radial Poisson
equation:</p>
<div class="math">
<p><img src="../_images/math/935ad162b78dffe389cc6970fbd47b5211db0956.svg" alt="-{\d^2\over\d r^2} u(r) - {2\over r}{\d\over\d r}u(r) = f(r)"/></p>
</div></section>
<section id="helmholtz-equation-in-1d">
<h3>Helmholtz Equation in 1D<a class="headerlink" href="#helmholtz-equation-in-1d" title="Permalink to this heading">¶</a></h3>
<div class="math">
<p><img src="../_images/math/4226791627ed50a8e0f53353e4628bf510322d2a.svg" alt="\left({\d^2\over\d x^2}+1\right)u(x)=f(x)

\left({\d^2\over\d x^2}+1\right)G(x, x')=\delta(x-x')"/></p>
</div><p>with boundary conditions <img class="math" src="../_images/math/521baf55d125abe95b28f56946da0a0f820abca9.svg" alt="u(0)=u({\pi\over2})=0"/>.
We use the Fourier transform:</p>
<div class="math">
<p><img src="../_images/math/81cff790d0a2d0f7fec14b6fe8a6dfba8a7d0996.svg" alt="\left((ik)^2+1\right)\tilde G(k, x')={e^{ikx'}\over\sqrt{2\pi}}

\tilde G(k, x')={e^{ikx'}\over \sqrt{2\pi} (1-k^2)}

G(x, x') = \half\sign(x-x')\sin(x-x')"/></p>
</div><p>Check:</p>
<div class="math">
<p><img src="../_images/math/fb3fce60d2435e9b86b0f5427acb95a3bfdd2816.svg" alt="{\partial\over\partial x} G(x, x') = \delta(x-x')\sin(x-x')
    +\half\sign(x-x')\cos(x-x') =

    = \half\sign(x-x')\cos(x-x')

{\partial^2\over\partial x^2} G(x, x') = \delta(x-x')\cos(x-x')
    -\half\sign(x-x')\sin(x-x') =

    = -\half\sign(x-x')\sin(x-x') + \delta(x-x')

{\partial^2\over\partial x^2} G(x, x')
+{\partial\over\partial x} G(x, x') = \delta(x-x')"/></p>
</div><p>The general solution of the homogeneous equation is:</p>
<div class="math">
<p><img src="../_images/math/5ef875b9b280083bfe5b5d630d8bdfb0363f9043.svg" alt="u(x) = C_1 \sin x + C_2 \cos x"/></p>
</div><p>so the general Green function is:</p>
<div class="math">
<p><img src="../_images/math/777636326b00f7896dfe4c7b588fdf170cc4471b.svg" alt="G(x, x') = \half\sign(x-x')\sin(x-x') + C_1 \sin (x+x')
    + C_2 \cos (x+x')"/></p>
</div><p>Satisfying the boundary conditions (for all <img class="math" src="../_images/math/3a90500c574a45c657d46e758bccbb334f82795e.svg" alt="x' \ne 0"/>):</p>
<div class="math">
<p><img src="../_images/math/4204ea84c3cb342623e06e140c5f00d1b6e253a4.svg" alt="G(0, x') = G({\pi\over 2}, x') = 0"/></p>
</div><p>we get:</p>
<div class="math">
<p><img src="../_images/math/7cf4dd9338fbeb35286189dc9d23dbd5ed2e528e.svg" alt="C_1 &amp; = -\half \\
C_2 &amp; = 0"/></p>
</div><p>and:</p>
<div class="math">
<p><img src="../_images/math/27b56406c57e2d29be9e567f4b98f0356ae8e4ea.svg" alt="G(x, x') = \half\sign(x-x')\sin(x-x') -\half \sin (x+x') =

=-H(x'-x)\sin x\cos x' - H(x - x') \cos x \sin x' =

=
\begin{cases}
-\sin x\cos x'&amp;\quad x&lt;x'\cr
-\cos x\sin x'&amp;\quad x&gt;x'\cr
\end{cases}
=-\sin x_&lt; \cos x_&gt;"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/2fe186778ef8e40ce6917010746a507abe1ec82e.svg" alt="u(x) = \int G(x, x')f(x')\d x'
=-\cos x\int_0^xf(x')\sin x'\d x'
-\sin x\int_x^{\pi\over2}f(x')\cos x'\d x'"/></p>
</div><p>To show that this really works, let’s take for example <img class="math" src="../_images/math/f1e27079f9f526b5aa7844436c7f8c68d23c6455.svg" alt="f(x)=3\sin2x"/>. Then</p>
<div class="math">
<p><img src="../_images/math/3341db962e288e92f3b3a4316a5eeb16d32d6caa.svg" alt="u(x)
=-\cos x\int_0^x3\sin 2x'\sin x'\d x'
-\sin x\int_x^{\pi\over2}3\sin 2x'\cos x'\d x'"/></p>
</div><p>We can use SymPy to evaluate the integrals:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">u</span> <span class="o">=</span> <span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">integrate</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span> <span class="o">-</span> \
    <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">integrate</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">u</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="o">-</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">simplify</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
     <span class="mi">2</span>                  <span class="mi">2</span>
<span class="o">-</span> <span class="n">cos</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">sin</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">trigsimp</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>And we get</p>
<div class="math">
<p><img src="../_images/math/e4082f3582e0e19e5df58882946f27313772d154.svg" alt="u(x)=-\sin 2x"/></p>
</div><p>We can easily check, that <img class="math" src="../_images/math/1dae5226e961ccbd25c0bdda85d8b4b4a89e09e9.svg" alt="u''+u=3\sin2x"/>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span>
<span class="go">3*sin(2*x)</span>
</pre></div>
</div>
<p>and since <img class="math" src="../_images/math/dded0d8cabd6ff181128a5f4979dde78fd80c80b.svg" alt="f(x) = 3\sin2x"/>, we have verified, that <img class="math" src="../_images/math/36d7b9c3c1ebef64b947252a45d13cad2f6f143a.svg" alt="u(x)=-\sin 2x"/> is the correct
solution.</p>
</section>
<section id="poisson-equation-in-2d">
<h3>Poisson Equation in 2D<a class="headerlink" href="#poisson-equation-in-2d" title="Permalink to this heading">¶</a></h3>
<p>Let <img class="math" src="../_images/math/d0bb51765cf89e40902de9de4a95dc9e8cce1bf2.svg" alt="{\bf x}=(x, y)"/> and we want to solve:</p>
<div class="math">
<p><img src="../_images/math/5a9110a6087efc86214ca105fdbaa21f9268f956.svg" alt="\nabla^2u({\bf x})=f({\bf x})"/></p>
</div><p>So we have:</p>
<div class="math">
<p><img src="../_images/math/e855060c0fed5ea843bb580a27d6eac53fcee5ed.svg" alt="\nabla^2G({\bf x}, {\bf x'})=\delta({\bf x}-{\bf x'})"/></p>
</div><p>The solution is:</p>
<div class="math">
<p><img src="../_images/math/e71a268d8ba5d81f6b13c9b02130d5c77922765c.svg" alt="G({\bf x}, {\bf x'})
={1\over2\pi}\log|{\bf x}-{\bf x'}|
={1\over4\pi}\log|{\bf x}-{\bf x'}|^2
={1\over4\pi}\log((x-x')^2+(y-y')^2)"/></p>
</div></section>
<section id="poisson-equation-in-3d">
<h3>Poisson Equation in 3D<a class="headerlink" href="#poisson-equation-in-3d" title="Permalink to this heading">¶</a></h3>
<div class="math">
<p><img src="../_images/math/c5bce6f03363d7ea8eec764f3ea5480a07374d80.svg" alt="\nabla^2u(x)=f(x)

\nabla^2G(x, x')=\delta(x-x')"/></p>
</div><p>with boundary condition <img class="math" src="../_images/math/5a76faf15b1885479927fad02b47e402dddf3988.svg" alt="G(x) = 0"/> at infinity. Then:</p>
<div class="math">
<p><img src="../_images/math/5d8d4bec462fb387b339c2bdcbfff272b20d0e73.svg" alt="G(x, x')=-{1\over4\pi}{1\over|x-x'| }"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/db1894c1417405d22fd8553f610aa7e5c27ead59.svg" alt="u(x) = -{1\over4\pi}\int {f(x')\over|x-x'| }\d x'"/></p>
</div></section>
<section id="helmholtz-equation-in-3d">
<h3>Helmholtz Equation in 3D<a class="headerlink" href="#helmholtz-equation-in-3d" title="Permalink to this heading">¶</a></h3>
<div class="math">
<p><img src="../_images/math/205ba32ed31e81b130b22bd9af812abcf687e74f.svg" alt="(\nabla^2+k^2)u(x)=f(x)

(\nabla^2+k^2)G(x, x')=\delta(x-x')"/></p>
</div><p>with boundary condition <img class="math" src="../_images/math/5a76faf15b1885479927fad02b47e402dddf3988.svg" alt="G(x) = 0"/> at infinity. Then:</p>
<div class="math">
<p><img src="../_images/math/d370f25928c28716e7d66f953ed99b4a02ad01d6.svg" alt="G(x, x')=-{1\over4\pi}{e^{ik|x-x'| }\over|x-x'| }

u(x) = -{1\over4\pi}\int {f(x')e^{ik|x-x'| }\over|x-x'| }\d x'"/></p>
</div></section>
<section id="finite-element-method">
<h3>Finite Element Method<a class="headerlink" href="#finite-element-method" title="Permalink to this heading">¶</a></h3>
<p>Let’s show it on the Laplace equation. We want to solve:</p>
<div class="math">
<p><img src="../_images/math/b6c53bcf24f43adfd67ef7f1165fbe32cfe056e2.svg" alt="\nabla^2G(x, x')=\delta(x-x')"/></p>
</div><p>We will treat <img class="math" src="../_images/math/00edc22e5087916dc1b84166688385d211cb500e.svg" alt="x'"/> as a parameter, so we define <img class="math" src="../_images/math/381430f5bd5551d34e338f595769e88ad974f134.svg" alt="g_{x'}(x)\equiv G(x, x')"/>:</p>
<div class="math">
<p><img src="../_images/math/ddb3855a3f48054ae07d802bf48a5a88b7e5e013.svg" alt="\nabla^2g_{x'}(x)=\delta(x-x')"/></p>
</div><p>We set <img class="math" src="../_images/math/d38258ecc32191ea51d6c26239bfc46cccb5971c.svg" alt="g_{x'}(x)=0"/> on the boundary and we get:</p>
<div class="math">
<p><img src="../_images/math/899a458f210c2a84c2889b51e3bdccd6fcacc207.svg" alt="-\int\nabla g_{x'}(x) \cdot \nabla v(x) \d x = \int v(x)\delta(x-x')\d x

-\int\nabla g_{x'}(x) \cdot \nabla v(x) \d x = v(x')"/></p>
</div><p>So we choose <img class="math" src="../_images/math/00edc22e5087916dc1b84166688385d211cb500e.svg" alt="x'"/> and then solve for <img class="math" src="../_images/math/43220daebb0302bba174e337dffb887d9a4dcedc.svg" alt="g_{x'}(x)"/> using FEM and we get the
Green function <img class="math" src="../_images/math/1019ea20d99841b13c26731a5a720a10ad33088a.svg" alt="G(x, x')"/> for all <img class="math" src="../_images/math/74d80b1f8754374202dc72f351096af63dd5da6c.svg" alt="x"/> and one particular <img class="math" src="../_images/math/00edc22e5087916dc1b84166688385d211cb500e.svg" alt="x'"/>. We can then
evaluate the integral <a class="reference internal" href="#equation-solution">(3.20.1.2)</a> numerically – one would have to use FEM
for all <img class="math" src="../_images/math/00edc22e5087916dc1b84166688385d211cb500e.svg" alt="x'"/> that are needed in the integral, so that is not efficient, but it
should work. One will then be able to play with Green functions and be able to
calculate them numerically for any boundary condition (which is not possible
analytically).</p>
</section>
</section>
</section>
<section id="binomial-coefficients">
<h1><span class="section-number">3.21. </span>Binomial Coefficients<a class="headerlink" href="#binomial-coefficients" title="Permalink to this heading">¶</a></h1>
<p>For <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/> and <img class="math" src="../_images/math/0dabd76e82ded83eabfba509508649f4b47ca55e.svg" alt="k"/> integers, the binomial coefficients are defined by:</p>
<div class="math">
<p><img src="../_images/math/b90cd8b08e4d0e52f959771ee56a28bb7ecabf1f.svg" alt="\binom{n}{k} = {n!\over k! (n-k)!} =
    {n (n-1) \cdots (n-k+1)\over k!}"/></p>
</div><p>For <img class="math" src="../_images/math/4143a785963d35a54e3a8fafaef2d319728ec056.svg" alt="r"/> real, one just uses the second formula as a definition:</p>
<div class="math">
<p><img src="../_images/math/1543c8326d5d76dddc34ad46b7f8328cb3053674.svg" alt="\binom{r}{k} = {r (r-1) \cdots (r-k+1)\over k!}"/></p>
</div><p>Example I:</p>
<div class="math">
<p><img src="../_images/math/cb6453796f650a65d9e4fb05fd07feae262657d7.svg" alt="\binom{-n}{k}
    = {(-n) (-n-1) \cdots (-n-k+1)\over k!}
    = (-1)^{k} {n (n+1) \cdots (n+k-1)\over k!}
    = (-1)^{k}\binom{n+k-1}{k}"/></p>
</div><p>Example II:</p>
<div class="math">
<p><img src="../_images/math/2a655a64fb664c7378eb1ba9b96141612463ae0b.svg" alt="\binom{k-\half}{k}
    = {(k-\half) (k-\half-1) \cdots (k-\half-k+1)\over k!}
    = {(k-\half) (k-\half-1) \cdots \half\over k!} =

    = {(2k-1) (2k-3) \cdots 1\over 2^k k!}
    = {(2k-1)!!\over 2^k k!}
    = {(2k)!\over (2^k k!)^2}
    = {1\over 4^k}\binom{2k}{k}"/></p>
</div><p>The binomial formula is for <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/> integer:</p>
<div class="math">
<p><img src="../_images/math/dc372cf3777891ce72f51f878d459a2f14f031ef.svg" alt="(x+y)^n = \sum_{k=0}^n \binom{n}{k} x^k y^{n-k}"/></p>
</div><p>and for <img class="math" src="../_images/math/4143a785963d35a54e3a8fafaef2d319728ec056.svg" alt="r"/> real and <img class="math" src="../_images/math/aacb08543edd1fe69d99b421d6f8bd02bc0eb36f.svg" alt="|x| &lt; |y|"/> this can be generalized to:</p>
<div class="math">
<p><img src="../_images/math/e8ae67373e8b5bef94d2e6fe35a1406eae3fbd9c.svg" alt="(x+y)^r = \sum_{k=0}^\infty \binom{r}{k} x^k y^{r-k}"/></p>
</div><p>Example: (for <img class="math" src="../_images/math/1024b20256a4035940664a4b4a683eeac24d2ef7.svg" alt="|x| &lt; 1"/>)</p>
<div class="math">
<p><img src="../_images/math/c56ece5a913d71ebeb420c0c347962ca81af6677.svg" alt="(1 + x)^{-n} = \sum_{k=0}^\infty \binom{-n}{k} x^k
    = \sum_{k=0}^\infty (-1)^k\binom{n+k-1}{k} x^k
    = \sum_{k=0}^\infty \binom{n+k-1}{k} (-x)^k"/></p>
</div><p>so:</p>
<div class="math">
<p><img src="../_images/math/c662753687ba8af86f22e547355003ac972ac91b.svg" alt="(1 - x)^{-n} = \sum_{k=0}^\infty \binom{n+k-1}{k} x^k

(1 - x)^{-1} = \sum_{k=0}^\infty \binom{1+k-1}{k} x^k
    = \sum_{k=0}^\infty \binom{k}{k} x^k
    = \sum_{k=0}^\infty x^k

(1 - x)^{-\half} = \sum_{k=0}^\infty \binom{\half+k-1}{k} x^k
= \sum_{k=0}^\infty \binom{k-\half}{k} x^k
= \sum_{k=0}^\infty {1\over 4^k}\binom{2k}{k} x^k"/></p>
</div><p>Another example:</p>
<div class="math">
<p><img src="../_images/math/02a0e8eac359c23fcfc64d599cc540351bd33ff8.svg" alt="{1\over\sqrt{1-2xt+t^2}} = \left(1-(2xt-t^2)\right)^{-\half}
    = \sum_{n=0}^\infty {1\over 4^n}\binom{2n}{n} (2xt-t^2)^n =

    = \sum_{n=0}^\infty {1\over 4^n}\binom{2n}{n} \sum_{k=0}^n
        \binom{n}{k} (-t^2)^k (2xt)^{n-k} =

    = \sum_{n=0}^\infty {1\over 4^n}\binom{2n}{n} \sum_{k=0}^n
        \binom{n}{k} (-1)^k t^{2k} (2x)^{n-k} t^{n-k} =

    = \sum_{n=0}^\infty {1\over 4^n}\binom{2n}{n} \sum_{k=0}^n
        \binom{n}{k} (-1)^k t^{n+k} (2x)^{n-k} =

    = \sum_{n=0}^\infty \sum_{k=0}^{\left\lfloor n\over 2 \right\rfloor}
        {1\over 4^{n-k}}\binom{2n-2k}{n-k}
        \binom{n-k}{k} (-1)^k t^{n} (2x)^{n-2k} =

    = \sum_{n=0}^\infty \left(
        {1\over 2^n}
        \sum_{k=0}^{\left\lfloor n\over 2 \right\rfloor}
        (-1)^k
        \binom{n}{k}
        \binom{2n-2k}{n}
        x^{n-2k} \right) t^{n} =

    = \sum_{n=0}^\infty \left(
        {1\over 2^n}
        \sum_{k=0}^{\left\lfloor n\over 2 \right\rfloor}
        (-1)^k
        \binom{n}{k}
        {1\over n!}{\d^n \over \d x^n} x^{2n-2k}
        \right) t^{n} =

    = \sum_{n=0}^\infty \left(
        {1\over 2^n}
        \sum_{k=0}^n
        (-1)^k
        \binom{n}{k}
        {1\over n!}{\d^n \over \d x^n} x^{2n-2k}
        \right) t^{n} =

    = \sum_{n=0}^\infty \left(
        {1\over 2^n n!}
        {\d^n \over \d x^n} (x^2 - 1)^n
        \right) t^{n} =

    = \sum_{n=0}^\infty P_n(x) t^{n}"/></p>
</div><p>where we used <a class="reference internal" href="#equation-double-sum-2">(3.22.2)</a> and</p>
<div class="math">
<p><img src="../_images/math/62b66779b5a1f7b04171021e00fbb699507222bd.svg" alt="\binom{2n-2k}{n-k} \binom{n-k}{k} = \binom{2n-2k}{n} \binom{n}{k}"/></p>
</div><p>The <img class="math" src="../_images/math/ed9ea62e1e363c5a2f62d4124e53ebea897094af.svg" alt="P_n(x)"/> are <a class="reference internal" href="spherical-harmonics.html#legendre-polynomials"><span class="std std-ref">Legendre Polynomials</span></a>.</p>
</section>
<section id="double-sums">
<h1><span class="section-number">3.22. </span>Double Sums<a class="headerlink" href="#double-sums" title="Permalink to this heading">¶</a></h1>
<p>When evaluating double sums, one can use triangular summation to reorder them:</p>
<div class="math" id="equation-double-sum-1">
<p><span class="eqno">(3.22.1)<a class="headerlink" href="#equation-double-sum-1" title="Permalink to this equation">¶</a></span><img src="../_images/math/802dd8ac517431dd0e12106830c3dbd906e73983.svg" alt="\sum_{n=0}^\infty \sum_{k=0}^\infty a_{n k} =
\sum_{n=0}^\infty \sum_{k=0}^n a_{n-k, k}"/></p>
</div><p>Also it holds</p>
<div class="math" id="equation-double-sum-2">
<p><span class="eqno">(3.22.2)<a class="headerlink" href="#equation-double-sum-2" title="Permalink to this equation">¶</a></span><img src="../_images/math/38a0b91b7228a4027c527d9758d834b91bd3ab3c.svg" alt="\sum_{n=0}^\infty \sum_{k=0}^n a_{n k} =
    \sum_{n=0}^\infty \sum_{k=0}^{\left\lfloor n\over 2 \right\rfloor}
        a_{n-k, k}"/></p>
</div></section>
<section id="triangle-inequality">
<h1><span class="section-number">3.23. </span>Triangle Inequality<a class="headerlink" href="#triangle-inequality" title="Permalink to this heading">¶</a></h1>
<p>Triangle inequality (condition) means that none of the three
quantities <img class="math" src="../_images/math/176491867d42bcba67e7d0fe56094e8fdd8807fe.svg" alt="a"/>, <img class="math" src="../_images/math/de059b8e0317d9f56bbfd2567f5d09337bc3901c.svg" alt="b"/>, <img class="math" src="../_images/math/126df75c6af8ea7f4b2fd80e7c903eb6be492525.svg" alt="c"/> is greater than the sum of the other two:</p>
<div class="math" id="equation-trig-three">
<p><span class="eqno">(3.23.1)<a class="headerlink" href="#equation-trig-three" title="Permalink to this equation">¶</a></span><img src="../_images/math/1a639d6eb28e143a8b60a5a958360405b3722815.svg" alt="a + b \ge c

b + c \ge a

c + a \ge b"/></p>
</div><p>This is equivalent to just one equation:</p>
<div class="math" id="equation-trig-one">
<p><span class="eqno">(3.23.2)<a class="headerlink" href="#equation-trig-one" title="Permalink to this equation">¶</a></span><img src="../_images/math/4d86ea686d9a80592810b89286c10da6a0e4666c.svg" alt="|a-b| \le c \le a+b"/></p>
</div><p>we can do any permutation of the symbols, i.e. the above equation is equivalent
to any of these:</p>
<div class="math">
<p><img src="../_images/math/f5cc392e23c5bf7aabec8ed03b91fc39b9fdb03e.svg" alt="|b-c| \le a \le b+c

|c-a| \le b \le c+a"/></p>
</div><p>So instead of stating the three inequalities <a class="reference internal" href="#equation-trig-three">(3.23.1)</a> it is more
convenient to just write <a class="reference internal" href="#equation-trig-one">(3.23.2)</a>, using any permutation that we like.</p>
<p>To show, that <a class="reference internal" href="#equation-trig-three">(3.23.1)</a> implies <a class="reference internal" href="#equation-trig-one">(3.23.2)</a> we rewrite
<a class="reference internal" href="#equation-trig-three">(3.23.1)</a>:</p>
<div class="math">
<p><img src="../_images/math/d65b7ddb0d264cd6baf1b8c4bf78a4489793f8b6.svg" alt="a + b \ge c

c \ge a-b

c \ge b-a"/></p>
</div><p>so</p>
<div class="math">
<p><img src="../_images/math/6d43d7e2322b3a4e90002d15ee6a226b1eb0e1af.svg" alt="a + b \ge c

c \ge |a-b|"/></p>
</div><p>and we get <a class="reference internal" href="#equation-trig-one">(3.23.2)</a>.
To show, that <a class="reference internal" href="#equation-trig-one">(3.23.2)</a> implies <a class="reference internal" href="#equation-trig-three">(3.23.1)</a> we rewrite
<a class="reference internal" href="#equation-trig-one">(3.23.2)</a> for <img class="math" src="../_images/math/21e92f661637008afb368b32a34e50ca8da3e090.svg" alt="a\ge b"/> first:</p>
<div class="math">
<p><img src="../_images/math/92099bc43656469a55d488958523f40441fed83b.svg" alt="a \ge b

|a-b| \le c \le a+b"/></p>
</div><p>so:</p>
<div class="math">
<p><img src="../_images/math/279ff1db81fd7c94236d4d8821923e5603dc4376.svg" alt="a \ge b

a-b \le c \le a+b"/></p>
</div><p>rearranging:</p>
<div class="math">
<p><img src="../_images/math/9148592e2b2f386a5cdb94b01c556039c8c7c793.svg" alt="a + b \ge c

b + c \ge a

a \ge b"/></p>
</div><p>since <img class="math" src="../_images/math/126df75c6af8ea7f4b2fd80e7c903eb6be492525.svg" alt="c"/> is positive, if <img class="math" src="../_images/math/21e92f661637008afb368b32a34e50ca8da3e090.svg" alt="a\ge b"/> then also <img class="math" src="../_images/math/62246992506c706034bc45dfef304f2fbdb69a1b.svg" alt="c+a\ge b"/> and we get
<a class="reference internal" href="#equation-trig-three">(3.23.1)</a>. Finally, for <img class="math" src="../_images/math/d06a2e10214cdc54d2ddb4075cbde1af32be38be.svg" alt="a &lt; b"/>:</p>
<div class="math">
<p><img src="../_images/math/7acfe60f625b95159a2dbe61280553548fce7f69.svg" alt="a &lt; b

|a-b| \le c \le a+b"/></p>
</div><p>so:</p>
<div class="math">
<p><img src="../_images/math/a2eb8c45f2eac2f89b726ad10d4750fda296a522.svg" alt="a &lt; b

-(a-b) \le c \le a+b"/></p>
</div><p>rearranging:</p>
<div class="math">
<p><img src="../_images/math/11330019c81e049fb913acb5d2e3305d5f8df67d.svg" alt="a + b \ge c

b &gt; a

c + a \ge b"/></p>
</div><p>since <img class="math" src="../_images/math/126df75c6af8ea7f4b2fd80e7c903eb6be492525.svg" alt="c"/> is positive, if <img class="math" src="../_images/math/f9fbfa906950542936604ca8fa837594c6ddbd9f.svg" alt="b &gt; a"/> then also <img class="math" src="../_images/math/294b4066a5cf0359f83a6ca5d36feebd67a1addf.svg" alt="b+c\ge a"/> and we get
<a class="reference internal" href="#equation-trig-three">(3.23.1)</a>.</p>
</section>
<section id="gamma-function">
<h1><span class="section-number">3.24. </span>Gamma Function<a class="headerlink" href="#gamma-function" title="Permalink to this heading">¶</a></h1>
<p>The Gamma function <img class="math" src="../_images/math/2f07f97e8b4a8910bcbd7eb0e537638f1c8db675.svg" alt="\Gamma(x)"/> is defined by the following properties
for <img class="math" src="../_images/math/2116578b0829c6be1c70a0486e1eb0fbc7f50415.svg" alt="x &gt; 0"/>:</p>
<div class="math" id="equation-gamma1">
<p><span class="eqno">(3.24.1)<a class="headerlink" href="#equation-gamma1" title="Permalink to this equation">¶</a></span><img src="../_images/math/299dadfb3575d5b64c0dfd6d8629685fbf19ccfb.svg" alt="\Gamma(1) = 1"/></p>
</div><div class="math" id="equation-gamma2">
<p><span class="eqno">(3.24.2)<a class="headerlink" href="#equation-gamma2" title="Permalink to this equation">¶</a></span><img src="../_images/math/9d471e02cf7734612fe23522d6843377ededdc4a.svg" alt="\Gamma(x+1) = x \Gamma(x)"/></p>
</div><div class="math" id="equation-gamma3">
<p><span class="eqno">(3.24.3)<a class="headerlink" href="#equation-gamma3" title="Permalink to this equation">¶</a></span><img src="../_images/math/43d20367b403c154b055f7cb1f62cbd89cfe7c0e.svg" alt="\log\Gamma(x) \quad\mbox{is convex}"/></p>
</div><p>It can be shown that this determines the function uniquely for <img class="math" src="../_images/math/2116578b0829c6be1c70a0486e1eb0fbc7f50415.svg" alt="x &gt; 0"/> (this is
called the Bohr-Mollerup theorem) and then it can be extended analytically to
the whole complex plane.</p>
<p>The most common formula for <img class="math" src="../_images/math/96e7c1b1372fd670a2b58aeb7d266763834c9f48.svg" alt="\Gamma(z)"/> that satisfies <a class="reference internal" href="#equation-gamma1">(3.24.1)</a>,
<a class="reference internal" href="#equation-gamma2">(3.24.2)</a> and <a class="reference internal" href="#equation-gamma3">(3.24.3)</a>
is:</p>
<div class="math" id="equation-gamma-int">
<p><span class="eqno">(3.24.4)<a class="headerlink" href="#equation-gamma-int" title="Permalink to this equation">¶</a></span><img src="../_images/math/c112c088ca39f097fbc1d9075409f759bd506088.svg" alt="\Gamma(z) = \int_0^\infty t^{z-1} e^{-t} \d t"/></p>
</div><p>It satisfies <a class="reference internal" href="#equation-gamma1">(3.24.1)</a> because:</p>
<div class="math">
<p><img src="../_images/math/308617e40cf275a7de759ef17e47c44868d22759.svg" alt="\Gamma(1)
    = \int_0^\infty t^{1-1} e^{-t} \d t
    = \int_0^\infty e^{-t} \d t
    = [-e^{-t}]_0^\infty
    = 1"/></p>
</div><p>It satisfies <a class="reference internal" href="#equation-gamma2">(3.24.2)</a> by integrating by parts:</p>
<div class="math">
<p><img src="../_images/math/73610f0faa49e840bb490b5bb287015cfc46ba7a.svg" alt="\Gamma(z)
    = \int_0^\infty t^{z-1} e^{-t} \d t
    = (z-1)\int_0^\infty t^{z-2} e^{-t} \d t-[t^{z-1}e^{-t}]_0^\infty
    = (z-1)\Gamma(z-1)"/></p>
</div><p>Finally it satisfies <a class="reference internal" href="#equation-gamma3">(3.24.3)</a> by verifying the convex condition
directly (<img class="math" src="../_images/math/02d7b2cb35f269a81a869e86ee624e62dd8da818.svg" alt="x, y &gt; 0"/> and <img class="math" src="../_images/math/cf2ed28601010b3612766fca769e922a9dc10fef.svg" alt="0\le \lambda \le 1"/>):</p>
<div class="math">
<p><img src="../_images/math/7966bb1faf6090fa3de50687925819203adeae0f.svg" alt="\log\Gamma(\lambda x + (1-\lambda) y)
    = \log\int_0^\infty t^{\lambda x + (1-\lambda) y - 1} e^{-t} \d t =

    = \log \int_0^\infty (t^{x-1} e^{-t})^\lambda
        (t^{y-1} e^{-t})^{1-\lambda} \d t \le

    \le \log \left(
        \left(\int_0^\infty t^{x-1} e^{-t} \d t\right)^\lambda
        \left(\int_0^\infty t^{y-1} e^{-t} \d t\right)^{1-\lambda}\right) =

    = \lambda \log\Gamma(x) + (1-\lambda) \log \Gamma(y)"/></p>
</div><p>And thus <a class="reference internal" href="#equation-gamma-int">(3.24.4)</a> uniquely determines the Gamma function.
We can use <a class="reference internal" href="#equation-gamma-int">(3.24.4)</a> to calculate <img class="math" src="../_images/math/234e94e6745d9e3f8f29fd8c91da6f56132be3b8.svg" alt="\Gamma(\half)"/>:</p>
<div class="math">
<p><img src="../_images/math/ca8b0647edc0baf6383ad4d95b736700af3e9eab.svg" alt="\Gamma(\half)
    = \int_0^\infty t^{{1\over2}-1} e^{-t} \d t
    = \int_0^\infty {e^{-t}\over\sqrt t} \d t
    = \int_0^\infty {e^{-x^2}\over x} 2x\, \d x
    = 2\int_0^\infty e^{-x^2} \d x =

    = \int_{-\infty}^\infty e^{-x^2} \d x
    = \sqrt{
        \int_{-\infty}^\infty e^{-x^2} \d x
        \int_{-\infty}^\infty e^{-y^2} \d y
        }
    = \sqrt{2\pi \int_0^\infty e^{-r^2} r\d r} =

    = \sqrt{2\pi \int_0^\infty e^{-u} \half\d u}
    = \sqrt\pi"/></p>
</div><p>From this and the definition of the Gamma function we get
for integer <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/>:</p>
<div class="math" id="equation-gamma-fact">
<p><span class="eqno">(3.24.5)<a class="headerlink" href="#equation-gamma-fact" title="Permalink to this equation">¶</a></span><img src="../_images/math/5e54a5cb34310e118d94b39e2f7ee77c2893cf9e.svg" alt="\Gamma(n+1) = n\Gamma(n) = n(n-1)\Gamma(n-1)
    = n(n-1)(n-2)\cdots 2\cdot1\cdot\Gamma(1) =

    = n(n-1)(n-2)\cdots 1
    = n!"/></p>
</div><p>and</p>
<div class="math" id="equation-gamma-double-fact">
<p><span class="eqno">(3.24.6)<a class="headerlink" href="#equation-gamma-double-fact" title="Permalink to this equation">¶</a></span><img src="../_images/math/1058b3c5488165eef80ee2f99ced572eca774d45.svg" alt="\Gamma(n+\half) = (n-\half)\Gamma(n-\half)
    = (n-\half)(n-1-\half)\Gamma(n-1-\half)
    = (n-\half)(n-1-\half)\cdots\half\Gamma(\half) =

    = {2n-1\over2}{2n-3\over2}{2n-5\over2}\cdots{1\over2}\Gamma(\half)
    = {(2n-1)!!\over 2^n}\Gamma(\half)
    = {(2n-1)!!\over 2^n}\sqrt\pi"/></p>
</div></section>
<section id="incomplete-gamma-function">
<h1><span class="section-number">3.25. </span>Incomplete Gamma Function<a class="headerlink" href="#incomplete-gamma-function" title="Permalink to this heading">¶</a></h1>
<p>The upper incomplete gamma function is defined by:</p>
<div class="math">
<p><img src="../_images/math/b2d6e99f3ac4e25d5d14a286b4582749f9516abf.svg" alt="\Gamma(z, x) = \int_x^\infty t^{z-1} e^{-t} \d t"/></p>
</div><p>Integrating by parts we get:</p>
<div class="math">
<p><img src="../_images/math/6d8489bf8339e66e4f2cc114477eda7264bb3e22.svg" alt="\Gamma(z+1, x)
    = \int_x^\infty t^z e^{-t} \d t
    = z\int_x^\infty t^{z-1} e^{-t} \d t-[t^ze^{-t}]_x^\infty
    = z\Gamma(z, x) + x^z e^{-x}"/></p>
</div><p>Some special values are:</p>
<div class="math">
<p><img src="../_images/math/0d7abdb37e14300c9992663dc04e95c8dd7ca50a.svg" alt="\Gamma(z, 0) = \int_0^\infty t^{z-1} e^{-t} \d t = \Gamma(z)

\Gamma(1, x) = \int_x^\infty e^{-t} \d t = -[e^{-t}]_x^\infty = e^{-x}

\Gamma(\half, x)
    = \int_x^\infty t^{-\half} e^{-t} \d t
    = 2\int_{\sqrt{x}}^\infty e^{-s^2} \d s
    = \sqrt{\pi} \mbox{erfc}(\sqrt{x})"/></p>
</div><p>For integer <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/> we get:</p>
<div class="math">
<p><img src="../_images/math/1ff514776072819c4d45d898bc136142891c48d0.svg" alt="\Gamma(n+1, x)
    = n\Gamma(n, x) + x^n e^{-x}
    = n(n-1)\Gamma(n-1, x) + (n x^{n-1} + x^n) e^{-x} =

    = n(n-1)(n-2)\Gamma(n-2, x) + (n (n-1) x^{n-2}
        + n x^{n-1} + x^n) e^{-x} =

    = n(n-1)(n-2)\cdots 2\cdot 1\cdot \Gamma(1, x)
        + (n(n-1)\cdots 2 x^1 + \cdots
          + n (n-1) x^{n-2} + n x^{n-1} + x^n) e^{-x} =

    = n! e^{-x} + (n(n-1)\cdots 2 x^1 + \cdots
          + n (n-1) x^{n-2} + n x^{n-1} + x^n) e^{-x} =

    = n! e^{-x}\sum_{\nu=0}^n {x^\nu\over\nu!}"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/be0a3a138eaaef6aaaccbc758fc772250d78d9a7.svg" alt="\Gamma(n+\half, x)
    = (n-\half)\Gamma(n-\half, x) + x^{n-\half} e^{-x}
    = (n-\half)(n-1-\half)\Gamma(n-1-\half, x)
        + ((n-\half) x^{n-1-\half} + x^{n-\half})) e^{-x} =

    = (n-\half)(n-1-\half)\cdots\half\Gamma(\half, x)
        + ((n-\half)(n-1-\half)\cdots(1+\half) x^\half + \cdots +
            (n-\half) x^{n-1-\half} + x^{n-\half})) e^{-x} =

    = {(2n-1)!!\over 2^n}\Gamma(\half, x)
        +
        {(2n-1)!!\over 2^n} e^{-x}\sum_{\nu=1}^n
            {2^\nu x^{\nu-\half}\over(2\nu-1)!!} =

    = {(2n-1)!!\over 2^n}\left(\sqrt\pi \mbox{erfc}(\sqrt x)
        +
        e^{-x}\sum_{\nu=1}^n
            {2^\nu x^{\nu-\half}\over(2\nu-1)!!} \right)"/></p>
</div><p>The lower incomplete gamma function is defined by:</p>
<div class="math">
<p><img src="../_images/math/00c1d79b05a36d579f62384c8e80071e02722710.svg" alt="\gamma(z, x) = \int_0^x t^{z-1} e^{-t} \d t = \Gamma(z) - \Gamma(z, x)"/></p>
</div><p>and as such all expressions can be easily derived using the gamma and upper
incomplete gamma functions.
The recursion relation is then:</p>
<div class="math">
<p><img src="../_images/math/ef3b3c45acc7df0b7fa19869c5e32a3b895aa48b.svg" alt="\gamma(z+1, x) = \Gamma(z+1) - \Gamma(z+1, x)
    = z \Gamma(z) - (z\Gamma(z, x) + x^z e^{-x})
    = z \gamma(z, x) - x^z e^{-x}"/></p>
</div><p>Some special values are:</p>
<div class="math">
<p><img src="../_images/math/adb3b04aece3af12d9a602c58d33fce86e64dcd0.svg" alt="\gamma(z, 0) = \Gamma(z) - \Gamma(z, 0) = \Gamma(z) - \Gamma(z) = 0

\gamma(1, x) = \Gamma(1) - \Gamma(1, x) = 1 - e^{-x}

\gamma(\half, x) = \Gamma(\half) - \Gamma(\half, x)
    = \sqrt\pi - \sqrt\pi \mbox{erfc}(\sqrt x)
    = \sqrt\pi \mbox{erf}(\sqrt x)"/></p>
</div><p>By repeated application of the recursion formula we get:</p>
<div class="math">
<p><img src="../_images/math/99d344ffd8f63164be8b26e77b0f8228a0d60506.svg" alt="\gamma(z, x)
    = {1\over z}\gamma(z+1, x) + e^{-x} {x^z\over z}
    = {1\over z(z+1)}\gamma(z+2, x) + e^{-x} \left({x^z\over z}
        + {x^{z+1}\over z(z+1)}\right) =

    = {1\over z(z+1)\cdots(z+n)}\gamma(z+n+1, x) + e^{-x}
        \sum_{k=0}^n {x^{z+k}\over z(z+1)\cdots(z+k)} =

    = {\Gamma(z)\over \Gamma(z+n+1)}\gamma(z+n+1, x) + x^z
        \Gamma(z) e^{-x} \sum_{k=0}^n {x^k\over \Gamma(z+k+1)} ="/></p>
</div><div class="math" id="equation-gamma-series">
<p><span class="eqno">(3.25.1)<a class="headerlink" href="#equation-gamma-series" title="Permalink to this equation">¶</a></span><img src="../_images/math/873ea0e7cda4b649ed09d0c477cc48530d948da9.svg" alt="= x^z \Gamma(z) e^{-x} \sum_{k=0}^\infty {x^k\over \Gamma(z+k+1)}"/></p>
</div><p>where we used:</p>
<div class="math">
<p><img src="../_images/math/67fc7c32e94ef3fddd9fbb8f3dda9fa20d1a8d83.svg" alt="\lim_{z\to\infty} {\gamma(z, x)\over\Gamma(z)} = 0"/></p>
</div><p>which can be proven by the following inequality which uses the fact that the
function <img class="math" src="../_images/math/c23e7c7fc62d2620259e7f7a7675cbb4874516c1.svg" alt="f(t) = t^{z-1} e^{-t}"/> is an increasing function for <img class="math" src="../_images/math/550d1545450bf4008501a536c0c3f83fbda1cfe4.svg" alt="t &lt; z-1"/>, so as
long as <img class="math" src="../_images/math/7eb477f9941be40134e9fd899b17b7601d8582b9.svg" alt="x &lt; z-1"/> we get:</p>
<div class="math">
<p><img src="../_images/math/3ea3b05c2e3389239d165c92e1c897e1eaac066c.svg" alt="\gamma(z, x)
    = \int_0^x t^{z-1} e^{-t} \d t
    = \int_0^x f(t) \d t &lt;

    &lt; \int_0^x f(x) \d t = x f(x) =

    = {x \over z - 1 - x} \int_x^{z-1} f(x) \d t &lt;

    &lt; {x \over z - 1 - x} \int_x^{z-1} f(t) \d t &lt;

    &lt; {x \over z - 1 - x} \int_0^\infty f(t) \d t =

    = {x \over z - 1 - x} \Gamma(z)"/></p>
</div><p>Using <a class="reference internal" href="#equation-gamma-series">(3.25.1)</a> we can now write <img class="math" src="../_images/math/c0e6705a5ada014eed0bb26fdff458a098671fa3.svg" alt="\gamma(z, x)"/> using the Kummer
confluent hypergeometric function <img class="math" src="../_images/math/17b2b8f95b2203975fc83710b2f1433ec6594fc5.svg" alt="{}_1F_1(a, b, z)"/> as follows:</p>
<div class="math">
<p><img src="../_images/math/c3fe9e1dac8c6424d9d74cfaf75286f338bb9911.svg" alt="\gamma(z, x)
    = x^z \Gamma(z) e^{-x} \sum_{k=0}^\infty {x^k\over \Gamma(z+k+1)}
    = x^z z^{-1} e^{-x}\, {}_1F_1(1, z+1, x)
    = x^z z^{-1}\, {}_1F_1(z, z+1, -x)"/></p>
</div><section id="example">
<h2><span class="section-number">3.25.1. </span>Example<a class="headerlink" href="#example" title="Permalink to this heading">¶</a></h2>
<p>Consider the class of integrals:</p>
<div class="math">
<p><img src="../_images/math/88726bd8aa7adf72decf67950c72f47f298b352c.svg" alt="F_m(t) = \int_0^1 u^{2m} e^{-tu^2} \d u, \quad\quad
    \mbox{($t&gt;0$; $m=0,1,2,\dots$)}"/></p>
</div><p>We write them using the lower incomplete gamma function as:</p>
<div class="math">
<p><img src="../_images/math/40ca29fb4275f6c7393b9fdc0a111aac880b6fdf.svg" alt="F_m(t) = \int_0^t \left(v\over t\right)^m e^{-v}
        \left(v\over t\right)^{-\half}{\d v\over 2 t}
    = {1\over 2 t^{m+\half}}\int_0^t v^{m-\half} e^{-v} \d v
    = {\gamma(m+\half, t)\over 2 t^{m+\half}}"/></p>
</div><p>We can also write it using the confluent hypergeometric function as follows:</p>
<div class="math">
<p><img src="../_images/math/7e7f017f7dd41ba44a36ae4d6e28415090e39993.svg" alt="F_m(t) = {\gamma(m+\half, t)\over 2 t^{m+\half}}
    = {t^{m+\half}(m+\half)^{-1} \over 2 t^{m+\half}}
        \,{}_1F_1(m+\half, m+{\textstyle{3\over2}}, -t)
    = {{}_1F_1(m+\half, m+{\textstyle{3\over2}}, -t)\over 2m+1}"/></p>
</div><p>For <img class="math" src="../_images/math/9a2afef6e9ec9b0fbf326742478b32ccc5a913ae.svg" alt="m=0"/> we get:</p>
<div class="math">
<p><img src="../_images/math/1843539dab4d5ea3d12b289959704bcddd24d570.svg" alt="F_0(t) = {\gamma(\half, t)\over 2 t^{\half}}
    = \half \sqrt{\pi\over t} \mbox{erf}(\sqrt t)"/></p>
</div><p>Using the recursion relation we get:</p>
<div class="math">
<p><img src="../_images/math/740052d3a80b8af68f6ac7a920fd0ce3e1d1abd2.svg" alt="F_{m+1}(t)
    = {\gamma(m+\half+1, t)\over 2 t^{m+\half+1}}
    = {(m+\half)\gamma(m+\half, t)-t^{m+\half}e^{-t}\over 2 t^{m+\half} t}
    = {(m+\half)\over t}F_m(t)-{e^{-t}\over 2 t} =

    = {(2m+1) F_m(t)-e^{-t}\over 2 t}"/></p>
</div><p>By expressing <img class="math" src="../_images/math/c986f32fbd940f1c02d51698f79e73be88d05732.svg" alt="F_m(t)"/> from the equation we obtain the inverse relation:</p>
<div class="math">
<p><img src="../_images/math/f2a682b14f03870f97346b7043751dd2a06e048b.svg" alt="F_m(t) = {2t F_{m+1}(t) + e^{-t}\over 2m+1}"/></p>
</div><p>From <a class="reference internal" href="#equation-gamma-series">(3.25.1)</a> we get:</p>
<div class="math">
<p><img src="../_images/math/1a9b599640ff6a3660cd38f71f732f340bbfae3b.svg" alt="F_m(t)
    = {\gamma(m+\half, t)\over 2 t^{m+\half}}
    = {1\over 2 t^{m+\half}}
    t^{m+\half} \Gamma(m+\half) e^{-t} \sum_{k=0}^\infty {t^k\over
        \Gamma(m+\half+k+1)} =

    = \half \Gamma(m+\half) e^{-t} \sum_{k=0}^\infty {t^k\over
        \Gamma(m+k+{3\over2})} =

    = \half {(2m-1)!! \sqrt\pi\over 2^m} e^{-t} \sum_{k=0}^\infty {t^k\over
        {(2m+2k+1)!!\sqrt\pi\over 2^{m+k+1}}} =

    = e^{-t} \sum_{k=0}^\infty {(2m-1)!! (2t)^k\over (2m+2k+1)!!} =

    = e^{-t} \sum_{k=0}^\infty {(2t)^k\over (2m+1)(2m+3)\cdots(2m+2k+1)}"/></p>
</div></section>
</section>
<section id="factorial">
<h1><span class="section-number">3.26. </span>Factorial<a class="headerlink" href="#factorial" title="Permalink to this heading">¶</a></h1>
<p>The factorial <img class="math" src="../_images/math/263a2e9122a68808bb42885f9e4c34bddc14fbbd.svg" alt="n!"/> is defined as</p>
<div class="math">
<p><img src="../_images/math/728a69c9bc0aac7aa52041a3ae1631b48e5e2fa8.svg" alt="n! = n(n-1)(n-2)\cdots 3\cdot2\cdot 1"/></p>
</div><p>By <a class="reference internal" href="#equation-gamma-fact">(3.24.5)</a> it can be written using the Gamma function as:</p>
<div class="math">
<p><img src="../_images/math/7bd7e587bc49f1538cb600c206d19b7e1e8efb82.svg" alt="n! = \Gamma(n+1)"/></p>
</div></section>
<section id="double-factorial">
<h1><span class="section-number">3.27. </span>Double Factorial<a class="headerlink" href="#double-factorial" title="Permalink to this heading">¶</a></h1>
<p>The double factorial <img class="math" src="../_images/math/38a3f42c7e0a73933501bfa1a33432c85e986067.svg" alt="n!!"/> is defined as:</p>
<div class="math">
<p><img src="../_images/math/cb9d06c3237c7db7ef2667bed06c98839c203324.svg" alt="n!! = \begin{cases}
    n(n-2)(n-4)(n-6)\cdots 5\cdot3\cdot1\quad\quad\mbox{for odd $n=2k+1$} \\
    n(n-2)(n-4)(n-6)\cdots 6\cdot4\cdot2\quad\quad\mbox{for even $n=2k$}
\end{cases}"/></p>
</div><p>One can rewrite double factorial using a factorial as:</p>
<div class="math">
<p><img src="../_images/math/0c3393b9e793975a775850827cd7ed82c3287475.svg" alt="(2k)!! = 2\cdot4\cdot6\cdots (2k)
    = 2^k (1\cdot2\cdot3\cdots k)
    = 2^k k!

(2k-1)!!
    = 1\cdot3\cdot5\cdots(2k-1)
    = {1\cdot2\cdot3\cdot4\cdot5\cdots(2k) \over 2\cdot4\cdot6\cdots (2k)}
    = {(2k)!\over (2k)!!} = {(2k)!\over 2^k k!}"/></p>
</div><p>For odd <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/> it can be written using the Gamma function, see <a class="reference internal" href="#equation-gamma-double-fact">(3.24.6)</a>:</p>
<div class="math">
<p><img src="../_images/math/cd28a3fb999fc90527a7b5781638411b6734b69c.svg" alt="(2k-1)!! = {1\over\sqrt\pi} 2^k \Gamma\left(k+\half\right)"/></p>
</div><section id="id2">
<h2><span class="section-number">3.27.1. </span>Example<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h2>
<div class="math">
<p><img src="../_images/math/99aced09411d0f7b909e1de4a8e5cd91f0ed5df5.svg" alt="A(n) = {1\cdot3\cdot5 \cdot \dots \cdot (2n-1) \over
    1\cdot 2\cdot 3\cdot \dots \cdot n}
    = {(2n-1)!!\over n!}
    = {(2n)!\over 2^n (n!)^2}
    = {1\over 2^n}\binom{2n}{n}

B(n) = {1\cdot3\cdot5 \cdot \dots \cdot (2n-1) \over
    2\cdot 4\cdot\cdot6 \dots \cdot 2n}
    = {(2n-1)!!\over (2n)!!}
    = {(2n)!\over (2^n n!)^2}
    = {1\over 4^n}\binom{2n}{n}"/></p>
</div></section>
</section>
<section id="fermi-dirac-integral">
<span id="fermi-integral"></span><h1><span class="section-number">3.28. </span>Fermi-Dirac Integral<a class="headerlink" href="#fermi-dirac-integral" title="Permalink to this heading">¶</a></h1>
<p>The Fermi-Dirac integral (sometimes just called a Fermi integral) is defined
as:</p>
<div class="math">
<p><img src="../_images/math/3b47b90d0f385a9dd437336ced8a843b177fb2f4.svg" alt="I_\alpha(\mu) = \int_0^\infty {\epsilon^\alpha \d\epsilon \over
    e^{\epsilon-\mu} + 1}"/></p>
</div><p>Examples:</p>
<div class="math">
<p><img src="../_images/math/0c976b06d4e15fb9286fc1a535e6850ff262f958.svg" alt="I_{1\over 2}(\mu) = \int_0^\infty {\sqrt \epsilon \d\epsilon \over
    e^{\epsilon-\mu} + 1}

I_{3\over 2}(\mu) = \int_0^\infty {\epsilon^{3\over2} \d\epsilon \over
    e^{\epsilon-\mu} + 1}"/></p>
</div><p>The Fermi-Dirac integral can also be written using the polylogarithm, see
<a class="reference internal" href="hyper.html#fermi-dirac-poly"><span class="std std-ref">The Series pFq</span></a> for details.</p>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">3.15. Delta Function</a></li>
<li><a class="reference internal" href="#distributions">3.16. Distributions</a></li>
<li><a class="reference internal" href="#variations-and-functional-derivatives">3.17. Variations and Functional Derivatives</a><ul>
<li><a class="reference internal" href="#functions-of-one-variable">3.17.1. Functions of One Variable</a></li>
<li><a class="reference internal" href="#functions-of-several-variables">3.17.2. Functions of several variables</a></li>
<li><a class="reference internal" href="#functionals">3.17.3. Functionals</a></li>
<li><a class="reference internal" href="#examples">3.17.4. Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dirac-notation">3.18. Dirac Notation</a></li>
<li><a class="reference internal" href="#homogeneous-functions-euler-s-theorem">3.19. Homogeneous Functions (Euler’s Theorem)</a><ul>
<li><a class="reference internal" href="#example-1">3.19.1. Example 1</a></li>
<li><a class="reference internal" href="#example-2">3.19.2. Example 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#green-functions">3.20. Green Functions</a><ul>
<li><a class="reference internal" href="#introduction">3.20.1. Introduction</a></li>
<li><a class="reference internal" href="#boundary-conditions">3.20.2. Boundary Conditions</a></li>
<li><a class="reference internal" href="#symmetry">3.20.3. Symmetry</a></li>
<li><a class="reference internal" href="#id1">3.20.4. Examples</a><ul>
<li><a class="reference internal" href="#poisson-equation-in-1d">Poisson Equation in 1D</a></li>
<li><a class="reference internal" href="#radial-poisson-equation">Radial Poisson Equation</a></li>
<li><a class="reference internal" href="#helmholtz-equation-in-1d">Helmholtz Equation in 1D</a></li>
<li><a class="reference internal" href="#poisson-equation-in-2d">Poisson Equation in 2D</a></li>
<li><a class="reference internal" href="#poisson-equation-in-3d">Poisson Equation in 3D</a></li>
<li><a class="reference internal" href="#helmholtz-equation-in-3d">Helmholtz Equation in 3D</a></li>
<li><a class="reference internal" href="#finite-element-method">Finite Element Method</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#binomial-coefficients">3.21. Binomial Coefficients</a></li>
<li><a class="reference internal" href="#double-sums">3.22. Double Sums</a></li>
<li><a class="reference internal" href="#triangle-inequality">3.23. Triangle Inequality</a></li>
<li><a class="reference internal" href="#gamma-function">3.24. Gamma Function</a></li>
<li><a class="reference internal" href="#incomplete-gamma-function">3.25. Incomplete Gamma Function</a><ul>
<li><a class="reference internal" href="#example">3.25.1. Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#factorial">3.26. Factorial</a></li>
<li><a class="reference internal" href="#double-factorial">3.27. Double Factorial</a><ul>
<li><a class="reference internal" href="#id2">3.27.1. Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fermi-dirac-integral">3.28. Fermi-Dirac Integral</a></li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="trig.html"
                          title="previous chapter"><span class="section-number">3.10. </span>Periodic Functions</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="spherical-harmonics.html"
                          title="next chapter"><span class="section-number">3.29. </span>Legendre Polynomials</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/math/other.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="spherical-harmonics.html" title="3.29. Legendre Polynomials"
             >next</a> |</li>
        <li class="right" >
          <a href="trig.html" title="3.10. Periodic Functions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" ><span class="section-number">3. </span>Mathematics</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.15. </span>Delta Function</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
  </body>
</html>