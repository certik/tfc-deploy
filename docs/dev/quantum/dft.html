
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>8.9. Density Functional Theory (DFT) &#8212; Theoretical Physics Reference 0.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8.10. Ideal Fermi Gas" href="fermi.html" />
    <link rel="prev" title="8.8. Radial Schrödinger and Dirac Equations" href="radial.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head><body>
    <div style="display:none">
    \(
        \newcommand{\d}{\mathrm{d}}
        \newcommand{\bomega}{\vec\omega}
        \newcommand{\half}{ {1\over 2} }
        \def\mathnot#1{\text{"$#1$"}}

        %operators
        \newcommand{\diag}{\mathrm{diag}}
        \newcommand{\sinc}{\mathrm{sinc}}
        \newcommand{\Sh}{ {\large\style{font-family:Times}{\text{Ш}}} }
        \newcommand{\res}{\mathrm{Res}}
    \)
    </div>
    

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="fermi.html" title="8.10. Ideal Fermi Gas"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="radial.html" title="8.8. Radial Schrödinger and Dirac Equations"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" accesskey="U"><span class="section-number">8. </span>Quantum Field Theory and Quantum Mechanics</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">8.9. </span>Density Functional Theory (DFT)</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="density-functional-theory-dft">
<h1><span class="section-number">8.9. </span>Density Functional Theory (DFT)<a class="headerlink" href="#density-functional-theory-dft" title="Permalink to this headline">¶</a></h1>
<section id="many-body-schrodinger-equation">
<h2><span class="section-number">8.9.1. </span>Many Body Schrödinger Equation<a class="headerlink" href="#many-body-schrodinger-equation" title="Permalink to this headline">¶</a></h2>
<p>We use (Hartree) atomic units in this whole section about DFT.
We use the Born-Oppenheimer approximation, which says that the nuclei of the
treated atoms are seen as fixed. A stationary electronic state (for <img class="math" src="../_images/math/d4fb8efa128c4d0f6faa0fa4afce07a0463795e2.svg" alt="N"/>
electrons) is then described by a wave function
<img class="math" src="../_images/math/481270a473e96969c3cae65c6c30679211ec085e.svg" alt="\Psi({\bf r_1},{\bf r_2},\cdots,{\bf r}_N)"/>
fulfilling the many-body Schrödinger equation</p>
<div class="math">
<p><img src="../_images/math/c60b491751e8cab2c26262437ae3b86641a903f2.svg" alt="\hat H\ket\Psi=(\hat T+\hat U+\hat V)\ket\Psi=E\ket\Psi"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/101fbad7c9216086c2020ef3af5cc584409e3a7f.svg" alt="\hat T = \sum_i^N -{1\over2}\nabla_i^2"/></p>
</div><p>is the kinetic term,</p>
<div class="math">
<p><img src="../_images/math/447c63afd5479664f3c6a06c8c8192260f1d28c6.svg" alt="\hat U = \sum_{i&lt;j}U({\bf r_i},{\bf r_j})= {1\over2}\sum_{i,j}U({\bf r_i},{\bf r_j})

U({\bf r_i},{\bf r_j})=U({\bf r_j},{\bf r_i})={1\over|{\bf r_i}-{\bf r_j}|}"/></p>
</div><p>is the electron-electron interaction term and</p>
<div class="math">
<p><img src="../_images/math/cc77c899a2d787d18b22d686bf48424ee90be8cc.svg" alt="\hat V = \sum_i^N v({\bf r_i})

v({\bf r_i})=\sum_k -{Z_k\over|{\bf r_i}-{\bf R_k}|}"/></p>
</div><p>is the interaction term between electrons and nuclei, where <img class="math" src="../_images/math/e82ec8ef9e6e64fc5eef1927a867fd9ddc8a7b01.svg" alt="R_k"/> are positions
of nuclei and <img class="math" src="../_images/math/08a4becb8aa2609489fc50bbee5cec73e2f67125.svg" alt="Z_k"/> the atomic number of each nucleus (we are using atomic
units). So for one atomic calculation with the atom nucleus in the origin, we
have just <img class="math" src="../_images/math/cdab129eea4a391963ea4d58625a3cdaa6a7a1af.svg" alt="v({\bf r_i})=-{Z\over|{\bf r_i}|}"/>.</p>
<p><img class="math" src="../_images/math/eb3aa698879e0fd7eb2aff641eb1682a05fcb94c.svg" alt="|\Psi|^2=\Psi^*\Psi"/> gives the probability density of measuring the first
electron at the position <img class="math" src="../_images/math/4efe1a982a43e7635096dcb4ad8a111305166f6b.svg" alt="\bf r_1"/>, the second at <img class="math" src="../_images/math/4046e126fcab7e4e503fe475e8090b1733980d47.svg" alt="\bf r_2"/>, dots and the Nth
electron at the position <img class="math" src="../_images/math/36da46c326316678d2ff90a995a3425788ac6154.svg" alt="{\bf r}_N"/>. The normalization is such that
<img class="math" src="../_images/math/08ebe9b08c1dc5d659611f356f389fef53582fb9.svg" alt="\int|\Phi|^2\d^3 r_1\d^3 r_2\dots\d^3 r_N=1"/>. The <img class="math" src="../_images/math/4c7a75495501558907b75e291c954c45c6e91a80.svg" alt="\Psi"/> is antisymmetric,
i.e.  <img class="math" src="../_images/math/95b25df7f767abe3ab1622a72008daec7272b76c.svg" alt="\Psi({\bf r_1},{\bf r_2},\cdots,{\bf r}_N)= -\Psi({\bf r_2},{\bf
r_1},\cdots,{\bf r}_N)= -\Psi({\bf r_1},{\bf r}_N,\cdots,{\bf r_2})"/> etc.</p>
<p>Integrating <img class="math" src="../_images/math/5b3ff6bed0e4aade76859508b7a035e1f2b70254.svg" alt="|\Psi|^2"/> over the first <img class="math" src="../_images/math/c8ae8554796b5a0f3c26a5e06139b0619f1a06ff.svg" alt="N-1"/> electrons is the probability
density that the <img class="math" src="../_images/math/d4fb8efa128c4d0f6faa0fa4afce07a0463795e2.svg" alt="N"/>-th electron is at the position <img class="math" src="../_images/math/36da46c326316678d2ff90a995a3425788ac6154.svg" alt="{\bf r}_N"/>. Thus the
probability density <img class="math" src="../_images/math/650e88b81731f3a86c736a7714657e0a866ff3c5.svg" alt="n({\bf r})"/> that any of the N electrons (i.e the first, or
the second, or the third, dots, or the <img class="math" src="../_images/math/d4fb8efa128c4d0f6faa0fa4afce07a0463795e2.svg" alt="N"/>-th) is at the position <img class="math" src="../_images/math/7eee83f9346c3cb54c6309166a5f4fc0af20db5a.svg" alt="\bf r"/> is
called the particle (or number) density and is therefore given by:</p>
<div class="math">
<p><img src="../_images/math/bf8af6d963e16ac503377c9680b29f6e9e31970b.svg" alt="n({\bf r})= \int \Psi^*({\bf r},{\bf r}_2,\cdots,{\bf r}_N) \Psi ({\bf r},{\bf r}_2,\cdots,{\bf r}_N) \,\d^3 r_2\,\d^3 r_3\cdots\d^3 r_N+

+\int \Psi^*({\bf r}_1,{\bf r},\cdots,{\bf r}_N) \Psi ({\bf r}_1,{\bf r},\cdots,{\bf r}_N) \,\d^3 r_1\,\d^3 r_3\cdots\d^3 r_N+\cdots

+\int \Psi^*({\bf r}_1,{\bf r}_2,\cdots,{\bf r}) \Psi ({\bf r}_1,{\bf r}_2,\cdots,{\bf r}) \,\d^3 r_1\,\d^3 r_2\,\d^3 r_3\cdots\d^3 r_{N-1}=

=\int(\delta({\bf r}-{\bf r}_1)+\delta({\bf r}-{\bf r}_2)+\cdots+\delta({\bf r}-{\bf r}_N))

\Psi^*({\bf r}_1,{\bf r}_2,\cdots,{\bf r}_N) \Psi ({\bf r}_1,{\bf r}_2,\cdots,{\bf r}_N) \,\d^3 r_1\,\d^3 r_2\,\d^3 r_3\cdots\d^3 r_{N}=

=\sum_{i=1}^N\int \braket{\Psi|{\bf r}_1,{\bf r}_2,\cdots,{\bf r}_N}\delta({\bf r}-{\bf r}_i) \braket{{\bf r}_1,{\bf r}_2,\cdots,{\bf r}_N|\Psi} \,\d^3 r_1\,\d^3 r_2\,\d^3 r_3\cdots\d^3 r_{N}=

=N\int \braket{\Psi|{\bf r}_1,{\bf r}_2,\cdots,{\bf r}_N}\delta({\bf r}-{\bf r}_1) \braket{{\bf r}_1,{\bf r}_2,\cdots,{\bf r}_N|\Psi} \,\d^3 r_1\,\d^3 r_2\,\d^3 r_3\cdots\d^3 r_{N}="/></p>
</div><div class="math" id="equation-chargedensity">
<p><span class="eqno">(8.9.1.1)<a class="headerlink" href="#equation-chargedensity" title="Permalink to this equation">¶</a></span><img src="../_images/math/031d224b638ff712d8eb5be7909c8b28be9c750d.svg" alt="=N\int \Psi^*({\bf r},{\bf r}_2,\cdots,{\bf r}_N) \Psi ({\bf r},{\bf r}_2,\cdots,{\bf r}_N) \,\d^3 r_2\,\d^3 r_3\cdots\d^3 r_N"/></p>
</div><p>Thus <img class="math" src="../_images/math/f04153bc46fe693938f4ea20e138268c41ed0a96.svg" alt="\int_\Omega n({\bf r})\,\d^3r"/> gives the number of particles
in the region of integration <img class="math" src="../_images/math/c7080a6364482c5654d3e33992a59f803f887a7a.svg" alt="\Omega"/>. Obviously <img class="math" src="../_images/math/cca79ffa47261331fe1958bf06e9a482aaac6075.svg" alt="\int
n({\bf r})\,\d^3r=N"/>.</p>
<p>Note that the number density <img class="math" src="../_images/math/650e88b81731f3a86c736a7714657e0a866ff3c5.svg" alt="n({\bf r})"/> and potential <img class="math" src="../_images/math/f727cfbca2ea2c2a422e3e87569ca334f955ae79.svg" alt="V({\bf r})"/> in the
Schroedinger equation is related to the electron charge density <img class="math" src="../_images/math/ccf778cd867552c926684a2e7855a77447972842.svg" alt="\rho({\bf r})"/>
and electrostatic potential energy <img class="math" src="../_images/math/91e35ff900e65d927c78760657c9935b3cc1012d.svg" alt="\phi({\bf r})"/> by:</p>
<div class="math">
<p><img src="../_images/math/31d692104bb6c8c725c226850ca74000c8c8a884.svg" alt="\rho({\bf r}) = q n({\bf r})

q\phi({\bf r}) = V({\bf r})"/></p>
</div><p>where <img class="math" src="../_images/math/4fe2c00f66c77092e4bfb2d1b19fb0e20c404322.svg" alt="q"/> is the particle elementary charge,
which for electrons is <img class="math" src="../_images/math/ac98600b773f14f0a601ad7109d42884835a2f10.svg" alt="q=-e=-1"/> in atomic units.
The amount of electronic charge in the region <img class="math" src="../_images/math/c7080a6364482c5654d3e33992a59f803f887a7a.svg" alt="\Omega"/> is given by:</p>
<div class="math">
<p><img src="../_images/math/ac1b28a41abd2754b32c8ce092c7f8602463d5bd.svg" alt="Q
    = \int_\Omega \rho({\bf r})\,\d^3r
    = q\int_\Omega n({\bf r})\,\d^3r
    = -\int_\Omega n({\bf r})\,\d^3r"/></p>
</div><p>The energy of the system is given by</p>
<div class="math" id="equation-emanybody">
<p><span class="eqno">(8.9.1.2)<a class="headerlink" href="#equation-emanybody" title="Permalink to this equation">¶</a></span><img src="../_images/math/30c3f20efe22006f164b54207677cd638522dc5b.svg" alt="E=\braket{\Psi|\hat H|\Psi}= \braket{\Psi|\hat T|\Psi}+\braket{\Psi|\hat U|\Psi}+\braket{\Psi|\hat V|\Psi}= T+U+V"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/925917f130772278a99f20279a70b673dd56c003.svg" alt="T=\braket{\Psi|\hat T|\Psi}=\sum_i^N\int \Psi^*({\bf r_1},{\bf r_2},\cdots,{\bf r_N})(-\half\nabla_i^2) \Psi({\bf r_1},{\bf r_2},\cdots,{\bf r_N})\,\d^3 r_1\,\d^3 r_2\cdots\d^3 r_N

U=\braket{\Psi|\hat U|\Psi}

V=\braket{\Psi|\hat V|\Psi}=\sum_i^N\int \Psi^*({\bf r_1},{\bf r_2},\cdots,{\bf r_N})v({\bf r_i}) \Psi({\bf r_1},{\bf r_2},\cdots,{\bf r_N})\,\d^3 r_1\,\d^3 r_2\cdots\d^3 r_N=

=\sum_i^N\int \Psi^*({\bf r_1},{\bf r_2},\cdots,{\bf r_N})v({\bf r_1}) \Psi({\bf r_1},{\bf r_2},\cdots,{\bf r_N})\,\d^3 r_1\,\d^3 r_2\cdots\d^3 r_N=

=N\int \Psi^*({\bf r_1},{\bf r_2},\cdots,{\bf r_N})v({\bf r_1}) \Psi({\bf r_1},{\bf r_2},\cdots,{\bf r_N})\,\d^3 r_1\,\d^3 r_2\cdots\d^3 r_N="/></p>
</div><div class="math" id="equation-v-n">
<p><span class="eqno">(8.9.1.3)<a class="headerlink" href="#equation-v-n" title="Permalink to this equation">¶</a></span><img src="../_images/math/cdafeca05e882f050b338c686cfda57141c98ab5.svg" alt="=\int v({\bf r}) n({\bf r})\d^3 r=V[n]"/></p>
</div><p>It needs to be stressed, that <img class="math" src="../_images/math/b612343772caac6cfb5771ef755ef11f37d794f2.svg" alt="E"/> generally is <em>not</em> a functional of <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/>
alone, only the <img class="math" src="../_images/math/35d45c1ed5809de14e400e4f17d19691ef3a7d0c.svg" alt="V[n]"/> is. In the next section we show however, that if the
<img class="math" src="../_images/math/46bc65a1af2ec57db471173248f2af20dd0d36ad.svg" alt="\ket{\Psi}"/> is a ground state (of any system), then <img class="math" src="../_images/math/b612343772caac6cfb5771ef755ef11f37d794f2.svg" alt="E"/> becomes a functional
of <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/>.</p>
</section>
<section id="the-hohenberg-kohn-theorem">
<h2><span class="section-number">8.9.2. </span>The Hohenberg-Kohn Theorem<a class="headerlink" href="#the-hohenberg-kohn-theorem" title="Permalink to this headline">¶</a></h2>
<p>The Schrödinger equation gives the map</p>
<div class="math">
<p><img src="../_images/math/baba783330e167959d3968728add217901ec1442.svg" alt="C: V \to \Psi"/></p>
</div><p>where <img class="math" src="../_images/math/4c7a75495501558907b75e291c954c45c6e91a80.svg" alt="\Psi"/> is the ground state. C is bijective (one-to-one correspondence),
because to every <img class="math" src="../_images/math/f0fda77a3d47de294c8afeda566ae7bee314a6c3.svg" alt="V"/> we can compute the corresponding <img class="math" src="../_images/math/4c7a75495501558907b75e291c954c45c6e91a80.svg" alt="\Psi"/> from Schrödinger
equation and two different <img class="math" src="../_images/math/f0fda77a3d47de294c8afeda566ae7bee314a6c3.svg" alt="V"/> and <img class="math" src="../_images/math/2d534f403082e6ce318a5c895efce37749f60866.svg" alt="V'"/> (differing by more than a constant)
give two different <img class="math" src="../_images/math/4c7a75495501558907b75e291c954c45c6e91a80.svg" alt="\Psi"/>, because if <img class="math" src="../_images/math/f0fda77a3d47de294c8afeda566ae7bee314a6c3.svg" alt="V"/> and <img class="math" src="../_images/math/2d534f403082e6ce318a5c895efce37749f60866.svg" alt="V'"/> gave the same <img class="math" src="../_images/math/4c7a75495501558907b75e291c954c45c6e91a80.svg" alt="\Psi"/>, then
by substracting</p>
<div class="math">
<p><img src="../_images/math/ace67ff4c77b8d3cb6556c90ad4d377810ba222e.svg" alt="\hat H\ket{\Psi}=E_{gs}\ket{\Psi}"/></p>
</div><p>from</p>
<div class="math">
<p><img src="../_images/math/917c5dd2d6baa62bf2406e9e03244d168c30bab3.svg" alt="\hat H'\ket{\Psi}=(\hat H-\hat V+\hat V')\ket{\Psi}=E_{gs}'\ket{\Psi}"/></p>
</div><p>we would get <img class="math" src="../_images/math/4e0729064a67b2688777f512aa5b95a4ffec30fc.svg" alt="V-V'=E-E'"/>, which is a contradiction with the assumption that <img class="math" src="../_images/math/f0fda77a3d47de294c8afeda566ae7bee314a6c3.svg" alt="V"/> and <img class="math" src="../_images/math/2d534f403082e6ce318a5c895efce37749f60866.svg" alt="V'"/> differ by more than a constant.</p>
<p>Similarly, from the ground state wavefunction <img class="math" src="../_images/math/4c7a75495501558907b75e291c954c45c6e91a80.svg" alt="\Psi"/> we can compute the charge
density <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/> giving rise to the map</p>
<div class="math">
<p><img src="../_images/math/6ce267e2c886dafe6175c5ce148842705c505249.svg" alt="D: \Psi \to n"/></p>
</div><p>which is also bijective, because to every <img class="math" src="../_images/math/4c7a75495501558907b75e291c954c45c6e91a80.svg" alt="\Psi"/> we can compute <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/> from
<a class="reference internal" href="#equation-chargedensity">(8.9.1.1)</a> and two different <img class="math" src="../_images/math/4c7a75495501558907b75e291c954c45c6e91a80.svg" alt="\Psi"/> and <img class="math" src="../_images/math/136092248ad12740cfe0478747902ef33f985813.svg" alt="\Psi'"/> give two different
<img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/> and <img class="math" src="../_images/math/7d340a64acce330eb9d40a0cef2b1711ed760b87.svg" alt="n'"/>, because different <img class="math" src="../_images/math/4c7a75495501558907b75e291c954c45c6e91a80.svg" alt="\Psi"/> and <img class="math" src="../_images/math/136092248ad12740cfe0478747902ef33f985813.svg" alt="\Psi'"/> give</p>
<div class="math">
<p><img src="../_images/math/6c7d15ebf72a5d1c2f1d8ddd1dbef96342057a1d.svg" alt="E_{gs}=\braket{\Psi|\hat H|\Psi}&lt;\braket{\Psi'|\hat H|\Psi'}= \braket{\Psi'|\hat H'+\hat V-\hat V'|\Psi'}=E_{gs}'+\int n'({\bf r}) (v({\bf r})-v'({\bf r}))\,\d^3 r

E_{gs}'=\braket{\Psi'|\hat H'|\Psi'}&lt;\braket{\Psi|\hat H'|\Psi}= \braket{\Psi|\hat H+\hat V'-\hat V|\Psi}=E_{gs}+\int n({\bf r}) (v'({\bf r})-v({\bf r}))\,\d^3 r"/></p>
</div><p>adding these two inequalities together gives</p>
<div class="math">
<p><img src="../_images/math/9a77b3cc3d01a16d60d8895524581c0c4dd4aaaf.svg" alt="0&lt;\int n'({\bf r}) (v({\bf r})-v'({\bf r}))\,\d^3 r + \int n({\bf r}) (v'({\bf r})-v({\bf r}))\,\d^3 r= \int (n({\bf r})-n'({\bf r}))(v'({\bf r})-v({\bf r}))\,\d^3 r"/></p>
</div><p>which for <img class="math" src="../_images/math/70ed7b37f6766f657bbe3877b36bcffa64abb6aa.svg" alt="n=n'"/> gives <img class="math" src="../_images/math/7468d679cda8b21a6e5b8f5332ffeb9842f92439.svg" alt="0&lt;0"/>, which is nonsense, so <img class="math" src="../_images/math/9203e4d739974103b23bd57d0b9a6c7afa036479.svg" alt="n\neq n'"/>.</p>
<p>So we have proved that for a given ground state density <img class="math" src="../_images/math/72a31883058351efc52081a0e2bacb875881b07d.svg" alt="n_0({\bf r})"/>
(generated by a potential <img class="math" src="../_images/math/e3ff67460295bf0a0cc21f9c7e35a7eb69c52292.svg" alt="\hat V_0"/>) it is possible to calculate the
corresponding ground state wavefunction <img class="math" src="../_images/math/d280763ffe68217e9436487845c97d4cc7d009ae.svg" alt="\Psi_0({\bf r_1},{\bf r_2},\cdots,{\bf
r_N})"/>, in other words, <img class="math" src="../_images/math/be489b70bff97d69679186497b1bc7a8444d3e7a.svg" alt="\Psi_0"/> is a unique functional of <img class="math" src="../_images/math/79a8991ec04161e94a83e656d4a341a86eb3e9da.svg" alt="n_0"/>:</p>
<div class="math">
<p><img src="../_images/math/3cf7c1620888c9ff9d1f7e4d498e6e3362cd5909.svg" alt="\Psi_0=\Psi_0[n_0]"/></p>
</div><p>so the ground state energy <img class="math" src="../_images/math/56dd613f4ccb33995a32bf8cacec6b44154e9206.svg" alt="E_0"/> is also a functional of <img class="math" src="../_images/math/79a8991ec04161e94a83e656d4a341a86eb3e9da.svg" alt="n_0"/></p>
<div class="math">
<p><img src="../_images/math/5c6943115eb14ee3dece6e94e277635be69162d1.svg" alt="E_0=\braket{\Psi_0[n_0]|\hat T+\hat U+\hat V_0|\Psi_0[n_0]}=E[n_0]"/></p>
</div><p>We define an energy functional</p>
<div class="math" id="equation-efunct">
<p><span class="eqno">(8.9.2.1)<a class="headerlink" href="#equation-efunct" title="Permalink to this equation">¶</a></span><img src="../_images/math/9b861933ed9261ac61b0e662ebbe2751faa1a2bb.svg" alt="E_{v_0}[n]=\braket{\Psi[n]|\hat T+\hat U+\hat V_0|\Psi[n]}= \braket{\Psi[n]|\hat T+\hat U|\Psi[n]}+\int v_0({\bf r})n({\bf r})\d^3r"/></p>
</div><p>where <img class="math" src="../_images/math/9c598a9aa7556bc7d27a80b46b6999a727330c2b.svg" alt="\ket{\Psi[n]}"/> is any ground state wavefunction (generated by an
arbitrary potential), that is, <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/> is a ground state density belonging to an
arbitrary system. <img class="math" src="../_images/math/56dd613f4ccb33995a32bf8cacec6b44154e9206.svg" alt="E_0"/> which is generated by the potential <img class="math" src="../_images/math/c16729e155a62c568de462097110e9dae7594dc3.svg" alt="V_0"/> can then be
expressed as</p>
<div class="math">
<p><img src="../_images/math/7291254c49b66f119fc8f89a4228b20d5ef37956.svg" alt="E_0=E_{v_0}[n_0]"/></p>
</div><p>and for <img class="math" src="../_images/math/896a20819254dcfe7951fe9d657f6e9edb9befc5.svg" alt="n\neq n_0"/> we have (from the Ritz principle)</p>
<div class="math">
<p><img src="../_images/math/f02e320056a871e58dd7af22370fbd5193e5a624.svg" alt="E_0&lt;E_{v_0}[n]"/></p>
</div><p>and one has to minimize the functional <img class="math" src="../_images/math/e6aa2fe6084516116017014022f0461d254779a7.svg" alt="E_{v_0}[n]"/>:</p>
<div class="math" id="equation-emin">
<p><span class="eqno">(8.9.2.2)<a class="headerlink" href="#equation-emin" title="Permalink to this equation">¶</a></span><img src="../_images/math/5ec0be8b28cdccbecbabe9097be065e83cd5fb5c.svg" alt="E_0=\min_n E_{v_0}[n]"/></p>
</div><p>The term</p>
<div class="math">
<p><img src="../_images/math/4dec0755b15cf858521e0b5975bebe7238c99965.svg" alt="\braket{\Psi[n]|\hat T+\hat U|\Psi[n]}\equiv F[n]"/></p>
</div><p>in <a class="reference internal" href="#equation-efunct">(8.9.2.1)</a> is universal in the sense that it doesn’t depend on <img class="math" src="../_images/math/4d185e0cbdaf341e57665739774ad6db5036e224.svg" alt="\hat
V_0"/>. It can be proven <a class="reference internal" href="#dft" id="id1"><span>[DFT]</span></a>, that <img class="math" src="../_images/math/62f3229ce93043cc41c56574d27265441b0c8abc.svg" alt="F[n]"/> is a functional of <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/> for
degenerated ground states too, so <a class="reference internal" href="#equation-emin">(8.9.2.2)</a> stays true as well.</p>
<p>The ground state densities in <a class="reference internal" href="#equation-efunct">(8.9.2.1)</a> and <a class="reference internal" href="#equation-emin">(8.9.2.2)</a> are called
<em>pure-state v-representable</em> because they are the densities of (possible
degenerate) ground state of the Hamiltonian with some local potential <img class="math" src="../_images/math/9b4baab4713c3e20bd2fb88138e6e66f703bbfdd.svg" alt="v({\bf
r})"/>. One may ask a question if all possible functions are v-representable
(this is called the v-representability problem). The question is relevant,
because we need to know which functions to take into account in the
minimization process <a class="reference internal" href="#equation-emin">(8.9.2.2)</a>. Even though not every function is
v-representable <a class="reference internal" href="#dft" id="id2"><span>[DFT]</span></a>, every density defined on a grid (finite of
infinite) which is strictly positive, normalized and consistent with the Pauli
principle is ensemble v-representable. Ensemble v-representation is just a
simple generalization of the above, for details see <a class="reference internal" href="#dft" id="id3"><span>[DFT]</span></a>.</p>
<p>The functional <img class="math" src="../_images/math/e6aa2fe6084516116017014022f0461d254779a7.svg" alt="E_{v_0}[n]"/> in <a class="reference internal" href="#equation-emin">(8.9.2.2)</a> depends on the particle number <img class="math" src="../_images/math/d4fb8efa128c4d0f6faa0fa4afce07a0463795e2.svg" alt="N"/>,
so in order to get <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/>, we need to solve the variational formulation</p>
<div class="math">
<p><img src="../_images/math/4b8ac40400a198f206683a2d06c54818afb255ae.svg" alt="{\delta\over\delta n}\left(E_v[n]-\mu(N)\int n(\bf r)\d^3r\right)=0"/></p>
</div><p>so</p>
<div class="math" id="equation-euler">
<p><span class="eqno">(8.9.2.3)<a class="headerlink" href="#equation-euler" title="Permalink to this equation">¶</a></span><img src="../_images/math/ced007aaed02281c9e7cdc07d619dab4db356851.svg" alt="{\delta E_v[n]\over\delta n}=\mu(N)"/></p>
</div><p>Let the <img class="math" src="../_images/math/f56c80849b3fde2b0144342fac082ebbcb674e24.svg" alt="n_N(\bf r)"/> be the solution of <a class="reference internal" href="#equation-euler">(8.9.2.3)</a> with a particle number
<img class="math" src="../_images/math/d4fb8efa128c4d0f6faa0fa4afce07a0463795e2.svg" alt="N"/> and the energy <img class="math" src="../_images/math/4fb6ecd3d5d29cb9adaa4db9b4433017a9b14810.svg" alt="E_N"/>:</p>
<div class="math">
<p><img src="../_images/math/ba3b5dc6fa84b7b2c47c5b89e8f4977863c043f5.svg" alt="E_N=E_v[n_N]"/></p>
</div><p>The Lagrangian multiplier <img class="math" src="../_images/math/ad1b5e1523a12eb371617b6364fa0be5af2d4520.svg" alt="\mu"/> is the exact chemical potential of the system</p>
<div class="math">
<p><img src="../_images/math/311d613ca2d9b6d2c7442a63bda80d9a23a4dcd6.svg" alt="\mu(N)={\partial E_N\over\partial N}"/></p>
</div><p>becuase</p>
<div class="math">
<p><img src="../_images/math/17cbd8830e35afd042a2382694f3b95c41f64c10.svg" alt="E_{N+\epsilon}-E_N=E_v[n_{N+\epsilon}]-E_v[n_N] =\int {\delta E_v\over\delta n} (n_{N+\epsilon}-n_N)\d^3r=

=\int \mu(N) (n_{N+\epsilon}-n_N)\d^3r =\mu(N)(N+\epsilon-N)=\mu(N)\epsilon"/></p>
</div><p>so</p>
<div class="math">
<p><img src="../_images/math/9a0917db4a9d77ed210dfb8290b9b670fd53b813.svg" alt="\mu(N)={E_{N+\epsilon}-E_N\over\epsilon} \ \longrightarrow \ {\partial E_N\over\partial N}"/></p>
</div></section>
<section id="the-kohn-sham-equations">
<h2><span class="section-number">8.9.3. </span>The Kohn-Sham Equations<a class="headerlink" href="#the-kohn-sham-equations" title="Permalink to this headline">¶</a></h2>
<p>Consider an auxiliary system of <img class="math" src="../_images/math/d4fb8efa128c4d0f6faa0fa4afce07a0463795e2.svg" alt="N"/> noninteracting electrons (noninteracting
gas):</p>
<div class="math">
<p><img src="../_images/math/7ca15585f883673ae0bd1f70c32db1a4dc4c0764.svg" alt="\hat H_s=\hat T+\hat V_s"/></p>
</div><p>the Schrödinger equation then becomes:</p>
<div class="math">
<p><img src="../_images/math/1ae9eb47583390021ad2233053e31df42eb4f365.svg" alt="(-\half\nabla^2+v_s({\bf r}))\psi_i({\bf r}) =\epsilon_i\psi_i({\bf r})

n_s({\bf r})=\sum_i^N|\psi_i({\bf r})|^2"/></p>
</div><p>and the total energy is:</p>
<div class="math">
<p><img src="../_images/math/914547f6856a2183ea8840d842950deadcd3ecc0.svg" alt="E_s[n]=T_s[\{\psi_i[n]\}]+V_s[n]"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/9792990c081e074c13ab3e4e986c514501ebfcbd.svg" alt="T_s[n]=\braket{\Psi[n]|\hat T|\Psi[n]}= \sum_i\braket{\psi_i|-\half\nabla^2|\psi_i}

V_s[n]=\braket{\Psi[n]|\hat V|\Psi[n]}=\int v_s({\bf r})n({\bf r})\d^3r"/></p>
</div><p>So:</p>
<div class="math">
<p><img src="../_images/math/acb5997ffed9e6444b9d934ec3608d326e989bfd.svg" alt="E_s[n] = \sum_i\braket{\psi_i|-\half\nabla^2|\psi_i} +
    \int v_s({\bf r})n({\bf r})\d^3r
    =

    = \sum_i\int \psi_i^* \left(-\half\nabla^2\right)\psi_i\,\d^3 r +
        \int v_s({\bf r})\sum_i\psi_i^* \psi_i\, \d^3r
    =

    = \sum_i\int \psi_i^* \left(-\half\nabla^2 + v_s({\bf r})\right)
        \psi_i\,\d^3 r
    =

    = \sum_i \epsilon_i\int \psi_i^* \psi_i\,\d^3 r =

    = \sum_i \epsilon_i"/></p>
</div><p>The total energy is the sum of eigenvalues (energies of the individual
independent particles) as expected. From the last equation it follows:</p>
<div class="math">
<p><img src="../_images/math/fb68ca61251db0773d424163ab9ab6110c409a80.svg" alt="T_s[n] = \sum_i\braket{\psi_i|-\half\nabla^2|\psi_i}
    = \sum_i \epsilon_i -\int v_s({\bf r})n({\bf r})\d^3r"/></p>
</div><p>In other words, the kinetic energy of the noninteracting particles is equal to
the sum of eigenvalues minus the potential energy coming from the total
effective potential <img class="math" src="../_images/math/0b0c3dc7b71b5ed3cf068e0234eedadece3bc57a.svg" alt="v_s"/> used to construct the single particle orbitals
<img class="math" src="../_images/math/e17b7e0245f15cec8065c676a7ebb5836380d98f.svg" alt="\psi_i"/>.</p>
<p>From <a class="reference internal" href="#equation-euler">(8.9.2.3)</a> we get</p>
<div class="math" id="equation-noninteract">
<p><span class="eqno">(8.9.3.1)<a class="headerlink" href="#equation-noninteract" title="Permalink to this equation">¶</a></span><img src="../_images/math/e4b9e096cef166e2db52ec55af13c5abdf3608d7.svg" alt="\mu={\delta E_s[n]\over\delta n({\bf r})}= {\delta T_s[n]\over\delta n({\bf r})}+{\delta V_s[n]\over\delta n({\bf r})}= {\delta T_s[n]\over\delta n({\bf r})}+v_s({\bf r})"/></p>
</div><p>Solution to this equation gives the density <img class="math" src="../_images/math/3e61f41de7481d018379afab379fe282f18f9156.svg" alt="n_s"/>.</p>
<p>Now we want to express the energy in <a class="reference internal" href="#equation-emanybody">(8.9.1.2)</a> using <img class="math" src="../_images/math/f0e759956150702783d0a580caeabc80741bad47.svg" alt="T_s"/> and <img class="math" src="../_images/math/f64f4ca640fe38585105abc1f6232aa400f020f4.svg" alt="E_H"/>
for convenience, where <img class="math" src="../_images/math/f64f4ca640fe38585105abc1f6232aa400f020f4.svg" alt="E_H"/> is the classical electrostatic interaction energy
of the charge distribution <img class="math" src="../_images/math/ccf778cd867552c926684a2e7855a77447972842.svg" alt="\rho({\bf r})"/>, defined using following relations
- we start with a Poisson equation in atomic units</p>
<div class="math">
<p><img src="../_images/math/aadc3dc29a2ab03fa49a7b2387d254230f912628.svg" alt="\nabla^2 \phi_H({\bf r})=-4\pi \rho({\bf r})"/></p>
</div><p>and substitute <img class="math" src="../_images/math/228dbf1d9c8c05d70f26a00cd08dab60c7072120.svg" alt="\rho({\bf r}) = q n({\bf r})"/>,
<img class="math" src="../_images/math/f8495a472f36be3876097b58c15e001ad733231f.svg" alt="V_H({\bf r}) = q \phi_H({\bf r})"/> and we use the fact that <img class="math" src="../_images/math/6b79986d9b297fa4b073ecdcaa447f2408c0669c.svg" alt="q^2=1"/> in atomic
units:</p>
<div class="math">
<p><img src="../_images/math/bb64179fd9ec4edffe45f125aec1c2b982a477cb.svg" alt="\nabla^2 V_H({\bf r})=-4\pi q^2 n({\bf r}) = -4\pi n({\bf r})"/></p>
</div><p>or equivalently by expressing <img class="math" src="../_images/math/e1fa8fc95396332ac02b1218af9ed6b919a5b120.svg" alt="V_H"/> using the Green function:</p>
<div class="math" id="equation-v-h">
<p><span class="eqno">(8.9.3.2)<a class="headerlink" href="#equation-v-h" title="Permalink to this equation">¶</a></span><img src="../_images/math/5c941da29464e2eaf1c6211b72ef6ab81426a9c4.svg" alt="V_H({\bf r})
    = -{1\over 4\pi} \int {-4\pi n({\bf r'})\over|{\bf r}-{\bf r'}|} \d^3r'
    = \int {n({\bf r'})\over|{\bf r}-{\bf r'}|} \d^3r'"/></p>
</div><p>and finally <img class="math" src="../_images/math/f64f4ca640fe38585105abc1f6232aa400f020f4.svg" alt="E_H"/> is related to <img class="math" src="../_images/math/e1fa8fc95396332ac02b1218af9ed6b919a5b120.svg" alt="V_H"/> using:</p>
<div class="math">
<p><img src="../_images/math/dea3ed6ad93363f474afcfe817cd21df28cadbf4.svg" alt="V_H({\bf r})={\delta E_H\over\delta n({\bf r})}"/></p>
</div><p>so we get:</p>
<div class="math">
<p><img src="../_images/math/b6e7457399dfb8365f66a391a970c03c4516d8eb.svg" alt="E_H[n]=\half\int\int {n({\bf r})n({\bf r'})\over|{\bf r}-{\bf r'}|} \d^3r\d^3r'"/></p>
</div><p>Using the rules for functional differentiation, we can check that:</p>
<div class="math">
<p><img src="../_images/math/8f8d4e5cc32c2476dd2038809649e7cb25b69967.svg" alt="V_H({\bf r})
    ={\delta E_H\over\delta n({\bf r})}
    ={\delta \over\delta n({\bf r})}
        \half\int\int {n({\bf r'})n({\bf r''})\over|{\bf r'}-{\bf r''}|}
        \d^3r'\d^3r''
    =

    =\int {n({\bf r'})\over|{\bf r}-{\bf r'}|}
        \d^3r'"/></p>
</div><p>Using the above relations, we can see that</p>
<div class="math">
<p><img src="../_images/math/193557d299579c7530141c18505d7e2ca53dae73.svg" alt="E_H[n]=\half\int V_H({\bf r}) n({\bf r}) \d^3r"/></p>
</div><p>So from <a class="reference internal" href="#equation-efunct">(8.9.2.1)</a> we get</p>
<div class="math" id="equation-efunctxc">
<p><span class="eqno">(8.9.3.3)<a class="headerlink" href="#equation-efunctxc" title="Permalink to this equation">¶</a></span><img src="../_images/math/b6631f71175300e9d331979e83ebcb9c2f0ea0c2.svg" alt="E[n]=(T+U)[n]+V[n]=T_s[n]+E_H[n]+(T-T_s+U-E_H)[n]+V[n]=

=T_s[n]+E_H[n]+E_{xc}[n]+V[n]"/></p>
</div><p>The rest of the energy is denoted by <img class="math" src="../_images/math/c8d6fe22fd6b94bc33809ba203c69147bf196151.svg" alt="E_{xc}=U-E_H+T-T_s"/> and it is called is
the exchange and correlation energy functional. From <a class="reference internal" href="#equation-euler">(8.9.2.3)</a></p>
<div class="math">
<p><img src="../_images/math/83c143c4aa9ae94c5ff69b522d9ca974da6096d8.svg" alt="\mu={\delta E[n]\over\delta n({\bf r})}= {\delta T_s[n]\over\delta n({\bf r})}+ {\delta E_H[n]\over\delta n({\bf r})}+ {\delta E_{xc}[n]\over\delta n({\bf r})}+ {\delta V[n]\over\delta n({\bf r})}"/></p>
</div><p>From <a class="reference internal" href="#equation-v-h">(8.9.3.2)</a> we have</p>
<div class="math">
<p><img src="../_images/math/9f5ab296e6fed7fada30242c6f0e553af14ab1f1.svg" alt="{\delta E_H\over\delta n({\bf r})}=V_H({\bf r})"/></p>
</div><p>from <a class="reference internal" href="#equation-v-n">(8.9.1.3)</a> we get</p>
<div class="math">
<p><img src="../_images/math/d80f709b1643f7e8f86073c5506d57f2151dc07c.svg" alt="{\delta V[n]\over\delta n({\bf r})}=v({\bf r})"/></p>
</div><p>we define</p>
<div class="math" id="equation-vxcpot">
<p><span class="eqno">(8.9.3.4)<a class="headerlink" href="#equation-vxcpot" title="Permalink to this equation">¶</a></span><img src="../_images/math/9531f9fb1e02996588aad7f23d75d2d7cae7c7f3.svg" alt="{\delta E_{xc}[n]\over\delta n({\bf r})}=V_{xc}({\bf r})"/></p>
</div><p>so we arrive at</p>
<div class="math" id="equation-interact">
<p><span class="eqno">(8.9.3.5)<a class="headerlink" href="#equation-interact" title="Permalink to this equation">¶</a></span><img src="../_images/math/9c9d377481a7c0324d5fec27443f4fab91b7f793.svg" alt="\mu={\delta E[n]\over\delta n({\bf r})}= {\delta T_s[n]\over\delta n({\bf r})}+V_H({\bf r})+V_{xc}({\bf r})+v({\bf r})"/></p>
</div><p>Solution to this equation gives the density <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/>. Comparing <a class="reference internal" href="#equation-interact">(8.9.3.5)</a> to
<a class="reference internal" href="#equation-noninteract">(8.9.3.1)</a> we see that if we choose</p>
<div class="math" id="equation-v-in">
<p><span class="eqno">(8.9.3.6)<a class="headerlink" href="#equation-v-in" title="Permalink to this equation">¶</a></span><img src="../_images/math/d5dd5e269fd0f2e5a4e56e2cb3b66384c3d55c0a.svg" alt="v_s\equiv V_H+V_{xc}+v"/></p>
</div><p>then <img class="math" src="../_images/math/f3b5be7571596507aa0ce844ec7c5b6d4b73e274.svg" alt="n_s({\bf r})\equiv n({\bf r})"/>. So we solve the Kohn-Sham equations of
this auxiliary non-interacting system</p>
<div class="math" id="equation-kseq">
<p><span class="eqno">(8.9.3.7)<a class="headerlink" href="#equation-kseq" title="Permalink to this equation">¶</a></span><img src="../_images/math/0d0d5df9b7d78cba96cfadbc44804e5d9657b80e.svg" alt="(-\half\nabla^2+v_s({\bf r}))\psi_i({\bf r}) \equiv(-\half\nabla^2+V_H({\bf
r})+V_{xc}({\bf r})+v({\bf r}))\psi_i({\bf r}) =\epsilon_i\psi_i({\bf r})"/></p>
</div><p>which yield the orbitals <img class="math" src="../_images/math/e17b7e0245f15cec8065c676a7ebb5836380d98f.svg" alt="\psi_i"/> that reproduce the density <img class="math" src="../_images/math/650e88b81731f3a86c736a7714657e0a866ff3c5.svg" alt="n({\bf r})"/> of the original interacting system</p>
<div class="math" id="equation-ksdensity">
<p><span class="eqno">(8.9.3.8)<a class="headerlink" href="#equation-ksdensity" title="Permalink to this equation">¶</a></span><img src="../_images/math/8466170cd0a46a587a316d339c184732b596a8d7.svg" alt="n({\bf r})\equiv n_s({\bf r})=\sum_i^N|\psi_i({\bf r})|^2"/></p>
</div><p>The sum is taken over the lowest <img class="math" src="../_images/math/d4fb8efa128c4d0f6faa0fa4afce07a0463795e2.svg" alt="N"/> energies. Some of the <img class="math" src="../_images/math/e17b7e0245f15cec8065c676a7ebb5836380d98f.svg" alt="\psi_i"/> can be
degenerated, but it doesn’t matter - the index <img class="math" src="../_images/math/26e02951ffb851bd3a9b32dd1e10e6de935a0c7f.svg" alt="i"/> counts every eigenfunction
including all the degenerated. In plain words, the trick is in realizing, that
the ground state energy can be found by minimizing the energy functional
<a class="reference internal" href="#equation-efunct">(8.9.2.1)</a> and in rewriting this functional into the form <a class="reference internal" href="#equation-efunctxc">(8.9.3.3)</a>,
which shows that the interacting system can be treated as a noninteracting one
with a special potential.</p>
</section>
<section id="the-xc-term">
<h2><span class="section-number">8.9.4. </span>The XC Term<a class="headerlink" href="#the-xc-term" title="Permalink to this headline">¶</a></h2>
<p>The exchange and correlation functional</p>
<div class="math">
<p><img src="../_images/math/a2c36efd04bd4513b20771c47a3410631e78dabf.svg" alt="E_{xc}[n]=(T+U)[n]-E_H[n]-T_S[n]"/></p>
</div><p>can always be written in the form</p>
<div class="math">
<p><img src="../_images/math/09315936ddd5cb8eb0e20a6b321f0c03ad2e641d.svg" alt="E_{xc}[n]=\int n({\bf r}')\epsilon_{xc}({\bf r}';n)\d^3r'"/></p>
</div><p>where the <img class="math" src="../_images/math/16e03bd005577d4b0798300d1f79094502af4461.svg" alt="\epsilon_{xc}({\bf r}';n)"/> is called the XC energy density.
The XC potential is defined as:</p>
<div class="math">
<p><img src="../_images/math/86f66879abc90302db04ef7aff26f4963787ba9b.svg" alt="V_{xc}({\bf r};n) = {\delta E_{xc}[n]\over\delta n({\bf r})}
    = \epsilon_{xc}({\bf r};n)+ \int n({\bf r}')
        {\delta \epsilon_{xc}({\bf r}';n)\over\delta n({\bf r})}\d^3r'"/></p>
</div></section>
<section id="total-energy">
<h2><span class="section-number">8.9.5. </span>Total Energy<a class="headerlink" href="#total-energy" title="Permalink to this headline">¶</a></h2>
<p>We already derived all the necessary things above, so we just summarize it here.
The total energy is given by:</p>
<div class="math">
<p><img src="../_images/math/b6631f71175300e9d331979e83ebcb9c2f0ea0c2.svg" alt="E[n]=(T+U)[n]+V[n]=T_s[n]+E_H[n]+(T-T_s+U-E_H)[n]+V[n]=

=T_s[n]+E_H[n]+E_{xc}[n]+V[n]"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/014fc8d6ed167d57c419a689f8c55e2bc100759f.svg" alt="T_s[n] = \sum_i \epsilon_i -\int v_s({\bf r})n({\bf r})\d^3r

E_H[n] = \half\int V_H({\bf r}) n({\bf r}) \d^3r

E_{xc}[n]=\int \epsilon_{xc}({\bf r};n) n({\bf r}) \d^3r

V[n]=\int v({\bf r}) n({\bf r}) \d^3r"/></p>
</div><p>This is the correct, quadratically convergent expression for the total energy.
We use the whole input potential <img class="math" src="../_images/math/1a6d16120b6f985730ecc8e39877e61328cfb0ac.svg" alt="V_{in}\equiv v_s"/> and its associated
eigenvalues <img class="math" src="../_images/math/5f43fd2698b451c7e71ce748a21170359148ae9d.svg" alt="\epsilon_i"/> to calculate the kinetic energy <img class="math" src="../_images/math/bfd811f99937bc26d38a3165ca85e62cc6438044.svg" alt="T_s[n]"/>, this follows
from the derivation of the expression for <img class="math" src="../_images/math/bfd811f99937bc26d38a3165ca85e62cc6438044.svg" alt="T_s[n]"/>. Then we use the calculated
charge density to express <img class="math" src="../_images/math/497e4d1e23c498d1dd298c78cdeb201657e82733.svg" alt="E_H[n]"/>, <img class="math" src="../_images/math/b7c12b8fbbcbbf5de847c28891c2e22267ac4689.svg" alt="E_{xc}[n]"/> and <img class="math" src="../_images/math/35d45c1ed5809de14e400e4f17d19691ef3a7d0c.svg" alt="V[n]"/>.</p>
<p>If one is not careful about the potential associated with the eigenvalues,
i.e., confusing <img class="math" src="../_images/math/8e81f83c238a8f8940f255ab2a7078368b046507.svg" alt="V_{in}"/> with <img class="math" src="../_images/math/77f75c1cee56729c45c7774f3f410ee43f16a37b.svg" alt="V_{out}"/>, one gets a slowly converging formula
for the total energy. By expanding <img class="math" src="../_images/math/0b0c3dc7b71b5ed3cf068e0234eedadece3bc57a.svg" alt="v_s"/> using <a class="reference internal" href="#equation-v-in">(8.9.3.6)</a>:</p>
<div class="math">
<p><img src="../_images/math/8e415f1769b40d2ce460eb9b88366f2f8d839927.svg" alt="\int v_s n({\bf r})\d^3 r
    = \int (V_H + V_{xc} + v) n({\bf r})\d^3 r
    = 2 \half\int V_H n({\bf r})\d^3 r
    + \int V_{xc} n({\bf r})\d^3 r
    + \int v n({\bf r})\d^3 r =

    = 2 E_H[n] + \int V_{xc} n({\bf r})\d^3 r + V[n]"/></p>
</div><p>So <img class="math" src="../_images/math/f0e759956150702783d0a580caeabc80741bad47.svg" alt="T_s"/> is equal to:</p>
<div class="math">
<p><img src="../_images/math/fff4fad6b76f1f68055ee611ec1ef91dd724ae9b.svg" alt="T_s[n] = \sum_i \epsilon_i -\int v_s({\bf r})n({\bf r})\d^3r =

    = \sum_i \epsilon_i - 2 E_H[n] - \int V_{xc} n({\bf r})\d^3 r - V[n]"/></p>
</div><p>And then the slowly converging form of total energy is:</p>
<div class="math">
<p><img src="../_images/math/c29e1bbe7d696bda55e55990aba98dce4e36d98e.svg" alt="E[n] = T_s[n]+E_H[n]+E_{xc}[n]+V[n]
    = \sum_i \epsilon_i - 2 E_H[n] - \int V_{xc} n({\bf r})\d^3 r - V[n]
        +E_H[n]+E_{xc}[n]+V[n] =

    = \sum_i \epsilon_i - E_H[n] + E_{xc}[n]
        -\int V_{xc}({\bf r};n) n({\bf r}) \d^3r"/></p>
</div><p>The reason it is slowly converging is because the new formula for kinetic
energy is mixing <img class="math" src="../_images/math/8e81f83c238a8f8940f255ab2a7078368b046507.svg" alt="V_{in}"/> with <img class="math" src="../_images/math/77f75c1cee56729c45c7774f3f410ee43f16a37b.svg" alt="V_{out}"/>, so it is not as precise (see above)
and converges much slower with SCF iterations. Once self-consistency has been
achieved (i.e. <img class="math" src="../_images/math/cdb298e1fd67de3bde3221afaa317872efb2dffd.svg" alt="V_{in}=V_{out}"/>), the two expressions for total energy are
equivalent.</p>
</section>
<section id="xc-approximations">
<h2><span class="section-number">8.9.6. </span>XC Approximations<a class="headerlink" href="#xc-approximations" title="Permalink to this headline">¶</a></h2>
<p>All the expressions above are exact (no approximation has been made so far).
Unfortunately, no one knows <img class="math" src="../_images/math/16e03bd005577d4b0798300d1f79094502af4461.svg" alt="\epsilon_{xc}({\bf r}';n)"/> exactly (yet). As such,
various approximations for it exist.</p>
<section id="lda">
<h3>LDA<a class="headerlink" href="#lda" title="Permalink to this headline">¶</a></h3>
<p>The most
simple approximation is the <em>local density approximation</em> (LDA), for which the
xc energy density <img class="math" src="../_images/math/7eef5235dfd75d6592856ca9b9066dcaac5280b2.svg" alt="\epsilon_{xc}"/> at <img class="math" src="../_images/math/7eee83f9346c3cb54c6309166a5f4fc0af20db5a.svg" alt="\bf r"/> is taken as that of a homogeneous
electron gas (the nuclei are replaced by a uniform positively charged
background, density <img class="math" src="../_images/math/d20f6fb7a8b659308ccf4917db49d2b1a65633ff.svg" alt="n=\rm const"/>) with the same local density:</p>
<div class="math">
<p><img src="../_images/math/f79ac5fac4fcac6554d8b9825c689758cdfe7c11.svg" alt="\epsilon_{xc}({\bf r};n)\approx\epsilon_{xc}^{LD}(n({\bf r}))"/></p>
</div><p>The xc potential <img class="math" src="../_images/math/2a2363ad82e068fe1efe4e633e66e48dce0d3efd.svg" alt="V_{xc}"/> defined by <a class="reference internal" href="#equation-vxcpot">(8.9.3.4)</a> is then</p>
<div class="math">
<p><img src="../_images/math/4c1697e25da2925d00c1f82360041d9799141f3b.svg" alt="V_{xc}({\bf r};n)={\delta E_{xc}[n]\over\delta n({\bf r})}= \epsilon_{xc}({\bf r};n)+ \int n({\bf r}'){\delta \epsilon_{xc}({\bf r}';n)\over\delta n({\bf r})}\d^3r'"/></p>
</div><p>which in the LDA becomes</p>
<div class="math" id="equation-vxcld">
<p><span class="eqno">(8.9.6.1)<a class="headerlink" href="#equation-vxcld" title="Permalink to this equation">¶</a></span><img src="../_images/math/0077dae004e9eeb78acb1ea248a314180c10f204.svg" alt="V_{xc}({\bf r};n) =\epsilon_{xc}^{LD}(n)+n{\d \epsilon_{xc}^{LD}(n)\over \d n}= {\d \over \d n}\left(n\epsilon_{xc}^{LD}(n)\right)= V_{xc}^{LD}(n)"/></p>
</div><p>The xc energy density <img class="math" src="../_images/math/c06b060dc6c593a43404f5a28ca8bc80afa41767.svg" alt="\epsilon_{xc}^{LD}"/> of the homogeneous gas can be
computed exactly:</p>
<div class="math">
<p><img src="../_images/math/e894f13f74b36d519c0a7d20828a5ee0c39f44f7.svg" alt="\epsilon_{xc}^{LD}(n)=\epsilon_x^{LD}(n)+\epsilon_c^{LD}(n)"/></p>
</div><p>where the <img class="math" src="../_images/math/f5d95309f3276a9ad5d032457726173f97d47f17.svg" alt="\epsilon_x^{LD}"/> is the electron gas exchange term given
by</p>
<div class="math">
<p><img src="../_images/math/b6e8d3f64afc9330a50e9f984767bc7701fad03f.svg" alt="\epsilon_x^{LD}(n)=-{3\over4\pi}(3\pi^2 n)^{1\over3}"/></p>
</div><p>the rest of <img class="math" src="../_images/math/c06b060dc6c593a43404f5a28ca8bc80afa41767.svg" alt="\epsilon_{xc}^{LD}"/> is hidden in <img class="math" src="../_images/math/14a45e40dc97810fed06cdc63d38ee47c7d0fff2.svg" alt="\epsilon_c^{LD}(n)"/> for which
there doesn’t exist an analytic formula, but the correlation energies are known
exactly from quantum Monte Carlo (QMC) calculations by Ceperley and
Alder <a class="reference internal" href="#pickett" id="id4"><span>[pickett]</span></a>. The energies were fitted by Vosko, Wilkes and Nussair
(VWN) with <img class="math" src="../_images/math/14a45e40dc97810fed06cdc63d38ee47c7d0fff2.svg" alt="\epsilon_c^{LD}(n)"/> and they got accurate results with errors less
than <img class="math" src="../_images/math/e1af548e8a99337b4b2c1b7fe052cdec726feee8.svg" alt="0.05\rm\,mRy"/> in <img class="math" src="../_images/math/42eacfdfb7b809edff4e784205e13e77f471f9cb.svg" alt="\epsilon_c^{LD}"/>, which means that <img class="math" src="../_images/math/14a45e40dc97810fed06cdc63d38ee47c7d0fff2.svg" alt="\epsilon_c^{LD}(n)"/>
is virtually known exactly. VWN result:</p>
<div class="math">
<p><img src="../_images/math/ba4ef955785d0301860dfac4fe0a1df200f50c5f.svg" alt="\epsilon_c^{LD}(n)\approx {A\over2}\left\{ \ln\left(y^2\over Y(y)\right)+{2b\over Q}\arctan\left(Q\over 2y+b\right)+ \right.

\left. -{by_0\over Y(y_0)}\left[\ln\left((y-y_0)^2\over Y(y)\right) +{2(b+2y_0)\over Q}\arctan\left(Q\over 2y+b\right) \right] \right\}"/></p>
</div><p>where <img class="math" src="../_images/math/b632b8049c6b7ce682e050af7ddc4eb8fffa0545.svg" alt="y=\sqrt{r_s}"/>, <img class="math" src="../_images/math/a456dd059cd0b962e133bed8b83b65e130941fc3.svg" alt="Y(y)=y^2+by+c"/>, <img class="math" src="../_images/math/876b601351f19286673b2f91059ea4b010cb8ddb.svg" alt="Q=\sqrt{4c-b^2}"/>, <img class="math" src="../_images/math/71f9b7945bbdebe3c01613c736db6f5a5b8929db.svg" alt="y_0=-0.10498"/>,
<img class="math" src="../_images/math/1b2502b7690cffc028895a0a8c959677aae23f0b.svg" alt="b=3.72744"/>, <img class="math" src="../_images/math/5461ca661a08da31f5a1c1139157230503ed7caf.svg" alt="c=12.9352"/> (note that the value of <img class="math" src="../_images/math/126df75c6af8ea7f4b2fd80e7c903eb6be492525.svg" alt="c"/> is wrong in
<a class="reference internal" href="#pickett" id="id5"><span>[pickett]</span></a>), <img class="math" src="../_images/math/13880a5097741a80c295e355962834aa83dcc9a6.svg" alt="A=0.0621814"/> and <img class="math" src="../_images/math/2c337e57e04bead45494a9713e566f9ab70c30e6.svg" alt="r_s"/> is the electron gas
parameter, which gives the mean distance between electrons (in atomic units):</p>
<div class="math">
<p><img src="../_images/math/6b36bfe276420cb0136e8a37aaf3281bcdd186ae.svg" alt="r_s=\left(3\over4\pi n\right)^{1\over3}"/></p>
</div><p>The xc potential is then computed from <a class="reference internal" href="#equation-vxcld">(8.9.6.1)</a>:</p>
<div class="math">
<p><img src="../_images/math/ea7f9f5ed6800b6148bf38849aa8d6ea30b68789.svg" alt="V_{xc}^{LD}=V_x^{LD}+V_c^{LD}

V_x^{LD}=-{1\over\pi}(3\pi^2 n)^{1\over3} = {4\over 3}\epsilon_x^{LD}

V_c^{LD}={A\over2}\left\{ \ln\left(y^2\over Y(y)\right)+{2b\over Q}\arctan\left(Q\over 2y+b\right)+ \right.

\left. -{by_0\over Y(y_0)}\left[\ln\left((y-y_0)^2\over Y(y)\right) +{2(b+2y_0)\over Q}\arctan\left(Q\over 2y+b\right) \right] \right\}+

-{A\over6}{c(y-y_0)-by_0y\over (y-y_0)Y(y)}"/></p>
</div><p>Some people also use Perdew and Zunger formulas, but they give essentially the
same results. The LDA, although very simple, is surprisingly successful. More
sophisticated approximations exist, for example the generalized gradient
approximation (GGA), which sometimes gives better results than the LDA, but is
not perfect either. Other options include orbital-dependent (implicit) density
functionals or a linear response type functionals, but this topic is still
evolving. The conclusion is, that the LDA is a good approximation to start
with, and only when we are not satisfied, we will have to try some more
accurate and modern approximation.</p>
</section>
<section id="rlda">
<h3>RLDA<a class="headerlink" href="#rlda" title="Permalink to this headline">¶</a></h3>
<p>Relativistic corrections to the energy-density functional (RLDA) were proposed
by MacDonald and Vosko:</p>
<div class="math">
<p><img src="../_images/math/f80827813ca0e7305c51d54aec0851727cb3b355.svg" alt="\epsilon_x^{RLD}(n) = \epsilon_x^{LD}(n)R

R = 1-{3\over2}\left(\beta\mu-\ln(\beta+\mu)\over\beta^2\right)^2
= 1-{3\over2} A^2"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/5324fd579d51a525b4f691d9ab5772aaf5fa127e.svg" alt="\mu=\sqrt{1+\beta^2}

\beta={(3\pi^2n)^{1\over3}\over c} = -{4\pi\over 3c} \epsilon_x^{LD}

A = {\beta\mu-\log(\beta+\mu)\over\beta^2}"/></p>
</div><p>We now calculate <img class="math" src="../_images/math/e0039d6c96fd6dd999c5a0944cbbaea9a7c70503.svg" alt="V_x^{RLD}"/>:</p>
<div class="math" id="equation-rlda">
<p><span class="eqno">(8.9.6.2)<a class="headerlink" href="#equation-rlda" title="Permalink to this equation">¶</a></span><img src="../_images/math/5f97d6f18d16f67a71d1936a35a80523ee512dad.svg" alt="V_x^{RLD}
=\epsilon_x^{LD}R+n{\d \epsilon_x^{LD}R\over\d n}=

=\epsilon_x^{LD}R+n{\d \epsilon_x^{LD}\over\d n}R
    +n\epsilon_x^{LD}{\d R\over\d n}
    =

=\epsilon_x^{LD}R+n{\d \epsilon_x^{LD}\over\d n}R
    +n\epsilon_x^{LD}{\d R\over\d \beta}{\d\beta\over\d n}"/></p>
</div><p>where the derivative <img class="math" src="../_images/math/b588a30b8745b393875796db03a1ad7b4f1b2923.svg" alt="{\d\beta\over\d n}"/> can be evaluated as follows:</p>
<div class="math">
<p><img src="../_images/math/7a3db951577ddac68d9577165457c1bc8cc44ada.svg" alt="{\d \beta\over\d n}
    = {\d \over \d n}{(3\pi^2n)^{1\over3}\over c}
    = {1 \over 3n}{(3\pi^2n)^{1\over3}\over c}
    = {\beta\over 3n}"/></p>
</div><p>And <img class="math" src="../_images/math/6cad625fb31662fa596c44918911c1a722f1943c.svg" alt="{\d \epsilon_x^{LD}\over\d n}"/> in exactly the same manner:</p>
<div class="math">
<p><img src="../_images/math/145c2fc8fa27b495c97a430e7d8fa882c24c8c45.svg" alt="{\d \epsilon_x^{LD}\over\d n} = ... = {\epsilon_x^{LD}\over 3n}"/></p>
</div><p>So we can write</p>
<div class="math">
<p><img src="../_images/math/515ffcbb46f8343202c4d7b4242e41fb14541c42.svg" alt="V_x^{RLD}
=\epsilon_x^{LD}R+n{\d \epsilon_x^{LD}\over\d n}R
    +n\epsilon_x^{LD}{\d R\over\d \beta}{\d\beta\over\d n}
=

=\epsilon_x^{LD}R+n{\epsilon_x^{LD}\over 3n}R
    +n\epsilon_x^{LD}{\d R\over\d \beta}{\beta\over 3n}
=

=
{4\over3}\epsilon_x^{LD}R+{1\over3}\epsilon_x^{LD}{\d R\over\d\beta}\beta
=

=
{4\over3}\epsilon_x^{LD}\left(R+{1\over4}\beta{\d R\over\d\beta}\right)
=

=
V_x^{LD}\left(R+{1\over4}\beta{\d R\over\d\beta}\right)"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/127674ba225256e6507651ed6e3e9b60ddcdc006.svg" alt="{\d R\over\d \beta}= -{3\over 2} 2 A A' = -3AA'
=

=-6 A \left({1\over\mu} - {A\over\beta}\right)"/></p>
</div><p>where we used the derivative of <img class="math" src="../_images/math/0efaf357c46035173ea6ebcdf0bddc81fc984264.svg" alt="A(\beta)"/>, which after a tedious, but
straightforward differentiation is:</p>
<div class="math">
<p><img src="../_images/math/e79db2de26a1f1d0d138810055eccafafb5f6822.svg" alt="A'(\beta) = \cdots = 2\left({1\over\mu} - {A\over\beta}\right)"/></p>
</div><p>Plugging this back in, we get:</p>
<div class="math">
<p><img src="../_images/math/aaa190dacb14a5d9ccd94e4f648c23cbe5fb6e7d.svg" alt="V_x^{RLD} = V_x^{LD}\left(R+{1\over4}\beta{\d R\over\d\beta}\right)
=

=
V_x^{LD}\left(1-{3\over 2}A^2 +{1\over4}\beta(-6A)
\left({1\over\mu} - {A\over\beta}\right)
\right)
=

=
V_x^{LD}\left(1-{3\over 2}A^2 + {6\over4} A^2-{6\over4}\beta {A\over\mu}
\right)
=

=
V_x^{LD}\left(1-{3\over2}{\beta\over\mu} A
\right)
=

=
V_x^{LD}\left(1-{3\over2}{\beta\over\mu} \left(
    \beta\mu - \log(\beta+\mu) \over \beta^2\right)
\right)
=

=
V_x^{LD}\left(1-{3\over2} \left(
    \beta\mu - \log(\beta+\mu) \over \beta\mu\right)
\right)
=

= V_x^{LD}\left({3\log(\beta+\mu) \over 2\beta\mu}-\half\right)"/></p>
</div><p>For <img class="math" src="../_images/math/5d2cc0b1f2cc475ee48df0e1950af43de2c47d79.svg" alt="c\to\infty"/> we get <img class="math" src="../_images/math/4f7ed735b7b556e9c676b2882b52f36486943fad.svg" alt="\beta\to0"/>, <img class="math" src="../_images/math/c72e9ab93ff047310643b6c06dd20e81b35db40f.svg" alt="R\to1"/> and <img class="math" src="../_images/math/711d59b71360924feb3c7fcac0fcb9002a2e5468.svg" alt="V_x^{RLD}\to
{4\over3}\epsilon_x^{LD}=V_x^{LD}"/> as expected, because</p>
<div class="math">
<p><img src="../_images/math/9b440b2f0a3c4324db6c012475946476c7bc6515.svg" alt="\lim_{\beta\to0}{\beta\sqrt{1+\beta^2}-\ln(\beta+\sqrt{1+\beta^2})\over \beta^2} = 0"/></p>
</div><p>Code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">limit</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">)</span>
<span class="go">beta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span><span class="p">((</span><span class="n">beta</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">beta</span><span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</section>
</section>
<section id="radial-dft-problem">
<h2><span class="section-number">8.9.7. </span>Radial DFT Problem<a class="headerlink" href="#radial-dft-problem" title="Permalink to this headline">¶</a></h2>
<section id="kohn-sham-equations">
<h3>Kohn-Sham Equations<a class="headerlink" href="#kohn-sham-equations" title="Permalink to this headline">¶</a></h3>
<p>For spherically symmetric potentials, we write all eigenfunctions as:</p>
<div class="math">
<p><img src="../_images/math/f401ec97a9d87d1641e4e3e4128f47195df66ef8.svg" alt="\psi_{nlm} = R_{nl} Y_{lm}"/></p>
</div><p>and we need to solve the following Kohn-Sham equations:</p>
<div class="math">
<p><img src="../_images/math/1aa207d5043ff403c3326e95f6b8d4a88ae5a17d.svg" alt="-{1\over2}R_{nl}'' - {1\over r}R_{nl}' +
    \left(V + {l(l+1)R\over2 r^2}\right)R_{nl} = \epsilon_{nl} R_{nl}"/></p>
</div><p>With normalization:</p>
<div class="math">
<p><img src="../_images/math/c27b241d815869d275c7539b2e52b39f0f77ef7a.svg" alt="\int R_{nl}^2 \,r^2 \,\d r = 1"/></p>
</div><p>For Schroedinger equation, the charge density is calculated by adding all “(n,
l, m)” states together, counting each one twice (for spin up and spin
down):</p>
<div class="math">
<p><img src="../_images/math/7e0f96929579f73000308864512a40383fe7539e.svg" alt="n({\bf r}) = \sum_{nlm}2|\psi_{nlm}|^2
    = \sum_{nlm}R_{nl}^2 2|Y_{lm}|^2
    = \sum_{nl}R_{nl}^2 2\sum_m|Y_{lm}|^2
    = {1\over 4\pi}\sum_{nl}f_{nl} R_{nl}^2"/></p>
</div><p>where we have introduced the occupation numbers <img class="math" src="../_images/math/82a627d0a6e0550b22108d3371081a9173ccb01c.svg" alt="f_{nl}"/> by</p>
<div class="math">
<p><img src="../_images/math/2789298dfb14ade486a89cda53746c94d9a26361.svg" alt="f_{nl} = 4\pi\,2\sum_m |Y_{lm}|^2"/></p>
</div><p>Normalization of the charge density is:</p>
<div class="math">
<p><img src="../_images/math/9e0ff6264c3d7c9a936560332fabf8e2cc74df38.svg" alt="Z = \int n({\bf r}) \d^3 x
    = \int n(r) \, r^2\d\Omega \d r
    = 4\pi\int n(r) \, r^2 \d r
    =

    = 4\pi\int {1\over 4\pi} \sum_{nl} f_{nl} R_{nl}^2\, r^2\d\Omega \d r
    =

    = \sum_{nl} f_{nl}\int R_{nl}^2\, r^2 \d r
    =

    = \sum_{nl} f_{nl}"/></p>
</div><p>So we can see, that it must hold:</p>
<div class="math">
<p><img src="../_images/math/c8440a7077277368cc2960bb91a4cce7f6a90626.svg" alt="\sum_{nl} f_{nl} = Z"/></p>
</div><p>where <img class="math" src="../_images/math/4d4777c1527da833f8c49f243f0aedbd3544134a.svg" alt="Z"/> is the atomic number (number of electrons), and as such, <img class="math" src="../_images/math/82a627d0a6e0550b22108d3371081a9173ccb01c.svg" alt="f_{nl}"/> are
indeed the occupation numbers (integers). The factor <img class="math" src="../_images/math/43e0f66b987c9aa473b58c117d91dbc89fe2029d.svg" alt="4\pi"/> is
explicitly factored out, as it cancels with the spherical harmonics:
assuming all <img class="math" src="../_images/math/48a9c60c07ae3ec80c744cabf47cee915e5d6e98.svg" alt="m"/> states are occupied, this can be simplified to:</p>
<div class="math">
<p><img src="../_images/math/8545fc46435f986b82e98018534539ab9c7f2e65.svg" alt="f_{nl} = 4\pi\,2\sum_m |Y_{lm}|^2
    = 4\pi\,2{2l+1\over 4\pi}
    = 2(2l+1)"/></p>
</div><p>We can also use this machinery to prescribe “chemical occupation numbers”, that
don’t necessarily correspond to the DFT ground state. For example for <img class="math" src="../_images/math/5398360f28c0328534b7fd075c6c91c98c4c24e4.svg" alt="U"/> atom
we get:</p>
<div class="math">
<p><img src="../_images/math/bf23f5af18320569522b00f2b55ee0b83e58e7bc.svg" alt="f_{1l} = 2 (2l+1)

f_{2l} = 2 (2l+1)

f_{3l} = 2 (2l+1)

f_{4l} = 2 (2l+1)

f_{5l} = 2 (2l+1)\quad\quad l\le2

f_{53} = 3

f_{60} = 2

f_{61} = 6

f_{62} = 1

f_{70} = 2"/></p>
</div><p>By summing all these <img class="math" src="../_images/math/82a627d0a6e0550b22108d3371081a9173ccb01c.svg" alt="f_{nl}"/>, we get 92 as expected:</p>
<div class="math">
<p><img src="../_images/math/72cd0d84960886e929d1927d075676270dde1f16.svg" alt="\sum_{nl} f_{nl} = 2 + (2+6) + (2+6+10) + (2+6+10+14) + (2+6+10) +

    + 3 + 2 + 6 + 1 + 2 = 92"/></p>
</div><p>But this isn’t the DFT ground state, because some KS energies are skipped, for
example there is only one state for <img class="math" src="../_images/math/ad63a90729ab7e76ef41dc49539a80a26bdd627c.svg" alt="n=6"/>, <img class="math" src="../_images/math/ba3887d336ca860e9cd91ccdcb31b44107d27135.svg" alt="l=2"/>, but there are nine more
states with the same energy — instead two more states are occupied in <img class="math" src="../_images/math/60ce3ce2c6137b18d58b32ccb3b7720340093f58.svg" alt="n=7"/>,
<img class="math" src="../_images/math/92aca8897586f5ad72da2a00a97d2475519f39c1.svg" alt="l=0"/>, but those have higher energy. So this corresponds to excited DFT state,
strictly speaking not physically valid in the DFT formalism, but in practice
this approach is often used. One can also prescribe fractional occupation
numbers (in the Dirac case).</p>
</section>
<section id="poisson-equation">
<h3>Poisson Equation<a class="headerlink" href="#poisson-equation" title="Permalink to this headline">¶</a></h3>
<p>Poisson equation becomes:</p>
<div class="math">
<p><img src="../_images/math/7a9d09ce1337a97f46e8b0f86af8877e356d7700.svg" alt="V_H''(r) + {2\over r} V_H'(r) = -4\pi n(r)"/></p>
</div></section>
<section id="id6">
<h3>Total Energy<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>The total energy is given by:</p>
<div class="math">
<p><img src="../_images/math/425c7889cf14304726e1fc6767c9f85156c4e39f.svg" alt="E[n]= T_s[n]+E_H[n]+E_{xc}[n]+V[n]"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/0e91f1977eb32460ff4b58a3bf4d3fb19e35b39d.svg" alt="T_s[n] = \sum_{nl} f_{nl}\epsilon_{nl}
    -\int (V_H(r) + V_{xc}(r) + v(r))_{in} n(r) \d^3 r
    =

    = \sum_{nl} f_{nl}\epsilon_{nl}
        -\int \left(V_H(r) + V_{xc}(r) -{Z\over r}\right)_{in} n(r) \d^3 r

E_H[n] = \half\int V_H(r) n(r) \d^3r

E_{xc}[n]=\int \epsilon_{xc}(r;n) n(r) \d^3r

V[n]=\int v(r) n(r) \d^3r = -\int {Z\over r} n(r) \d^3r"/></p>
</div><p>doing the integrals a bit we get:</p>
<div class="math">
<p><img src="../_images/math/1120c1dd76b126f9bf8c8491b106cb2591fce1f3.svg" alt="T_s[n] = \sum_{nl} f_{nl}\epsilon_{nl}
        -4\pi\int \left(V_H(r) + V_{xc}(r) -{Z\over r}\right)_{in} n(r)
            r^2\,\d r

E_H[n] = 2\pi\int V_H(r) n(r)r^2\, \d r

E_{xc}[n]=4\pi\int \epsilon_{xc}(r;n) n(r)r^2\, \d r

V[n]=-4\pi \int {Z\over r} n(r)r^2\, \d r
    =-4\pi Z \int n(r)r\, \d r"/></p>
</div><p>We can also express everything using the charge density <img class="math" src="../_images/math/b21e03badb62d42ad1436ba6d0fef539e69ba684.svg" alt="\rho(r) = -n(r)"/>:</p>
<div class="math">
<p><img src="../_images/math/459d8565d0807848aa1973a8a9089604ccf4d826.svg" alt="T_s[n] = \sum_{nl} f_{nl}\epsilon_{nl}
        +4\pi\int \left(V_H(r) + V_{xc}(r) -{Z\over r}\right)_{in} \rho(r)
            r^2\,\d r

E_H[n] = -2\pi\int V_H(r) \rho(r)r^2\, \d r

E_{xc}[n]=-4\pi\int \epsilon_{xc}(r;n) \rho(r)r^2\, \d r

V[n]=4\pi \int {Z\over r} \rho(r)r^2\, \d r
    =4\pi Z \int \rho(r)r\, \d r"/></p>
</div></section>
</section>
<section id="dft-as-a-nonlinear-problem">
<h2><span class="section-number">8.9.8. </span>DFT As a Nonlinear Problem<a class="headerlink" href="#dft-as-a-nonlinear-problem" title="Permalink to this headline">¶</a></h2>
<p>The task is to find such a charge density <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/>, so that all the equations below
hold (e.g. are self-consistent):</p>
<div class="math">
<p><img src="../_images/math/3f65891a009c575b147421b3f412d92199cf03d6.svg" alt="V = -{Z\over r} + V_H + V_{xc}

\left(-\nabla^2+V\right)\phi_m = \epsilon_m\phi_m,\quad\quad m = 1, 2, \dots, 4

n = \sum_{m=1}^4 \phi_m^2

V_{xc} = f(n)

\nabla^2 V_H = -4\pi n"/></p>
</div><p>This is a standard nonlinear problem, except that the Jacobian is dense, as
shown below.</p>
<section id="reformulation">
<h3>Reformulation<a class="headerlink" href="#reformulation" title="Permalink to this headline">¶</a></h3>
<p>Let’s write everything in terms of <img class="math" src="../_images/math/5911a94afcb1d3a163a13df5aea54642234bd527.svg" alt="\phi_m(x)"/> explicitly:</p>
<div class="math">
<p><img src="../_images/math/af3278f7fd570849751b086ff38c912d2b2e8ecb.svg" alt="n(x) = \sum_{m=1}^4 \phi_m^2(x)

V_{xc}(x) = f(n(x)) = f\left( \sum_{m=1}^4\phi_m^2(x) \right)

V_H(x) = \int_\Omega {n(x')\over|x' - x|}\d x'=
\int_\Omega {
\sum_{m=1}^4 \phi_m^2(x')
\over|x' - x|}\d x'

V(x) = -{Z\over r} + V_H(x) + V_{xc}(x)=

=-{Z\over r}+
\int_\Omega {
\sum_{m=1}^4 \phi_m^2(x')
\over|x' - x|}\d x'
+f\left( \sum_{m=1}^4\phi_m^2(x) \right)"/></p>
</div><p>Now we can write everything as just one (nonlinear)
equation:</p>
<div class="math">
<p><img src="../_images/math/72056de3a50058ba3e4587a149c904bc7874fec9.svg" alt="\left(-\nabla^2
-{Z\over r}+
\int_\Omega {
\sum_{m=1}^4 \phi_m^2(x')
\over|x' - x|}\d x'
+f\left( \sum_{m=1}^4\phi_m^2(x) \right)
\right)\phi_n = \epsilon_n\phi_n,\quad\quad n = 1, 2, \dots, 4"/></p>
</div></section>
<section id="fe-discretization">
<h3>FE Discretization<a class="headerlink" href="#fe-discretization" title="Permalink to this headline">¶</a></h3>
<p>The correspondig discrete problem has the form</p>
<div class="math">
<p><img src="../_images/math/23916b871bbf62e5a9da5988943a52bbca692b2f.svg" alt="\int_\Omega \nabla\phi_n(x)\cdot\nabla v_i(x)+\left[
-{Z\over r}+
\int_\Omega {
\sum_{m=1}^4 \phi_m^2(x')
\over|x' - x|}\d x'
+f\left( \sum_{m=1}^4\phi_m^2(x) \right)
\right]
\phi_n(x) v_i(x)  \d x=

=\int_\Omega
\epsilon_n\phi_n(x) v_i(x) \d x,\quad\quad n = 1, 2, \dots, 4;\quad
i = 1, 2, \dots, N"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/b77a2db71bea53c53957f2ffaae3791a9b069882.svg" alt="\phi_n = \phi_n({\bf Y}^{(n)}) = \sum_{j=1}^N y_j^{(n)} v_j(x)"/></p>
</div><p>Here <img class="math" src="../_images/math/0142987c321201092772d4482edd9607fec1e996.svg" alt="{\bf Y}^{(n)} = (y_1^{(n)}, y_2^{(n)}, \dots, y_N^{(n)})^T"/> is the vector
of unknown coefficients for the <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/>-th wavefunction <img class="math" src="../_images/math/6638be491ce9bd0ef44e362929d77266bbc84cec.svg" alt="\phi_n(x)"/>. Our equation
can then be written in the compact form</p>
<div class="math">
<p><img src="../_images/math/4f8ed6cf3f81f7e46e2ab704bbc453e2e2e5b581.svg" alt="{\bf F}({\bf Y}^{(n)}) = {\bf 0},\quad\quad n = 1, 2, \dots, 4"/></p>
</div><p>where <img class="math" src="../_images/math/1f1b1ec05bd487f55efb2f19fc7dace84c527ff4.svg" alt="{\bf F} = (F_1, F_2, \dots, F_N)^T"/> with</p>
<div class="math">
<p><img src="../_images/math/2a8ca111c56c05b464499e5b22d4ea795b7e7e20.svg" alt="F_i({\bf Y}^{(n)}) =
\int_\Omega \nabla\phi_n(x)\cdot\nabla v_i(x)+\left[
-{Z\over r}+
\int_\Omega {
\sum_{m=1}^4 \phi_m^2(x')
\over|x' - x|}\d x'
+f\left( \sum_{m=1}^4\phi_m^2(x) \right)
\right]
\phi_n(x) v_i(x)  \d x-

-\int_\Omega
\epsilon_n\phi_n(x) v_i(x) \d x"/></p>
</div></section>
<section id="jacobian">
<h3>Jacobian<a class="headerlink" href="#jacobian" title="Permalink to this headline">¶</a></h3>
<p>The Jacobi matrix has the elements:</p>
<div class="math">
<p><img src="../_images/math/2715b542de55862dcddb3cd7c53bd196cfa7e60b.svg" alt="J_{ik} = {\partial F_i\over\partial y_k^{(s)}}"/></p>
</div><p>The only possible dense term is:</p>
<div class="math">
<p><img src="../_images/math/461d86ad196a2c7945a8ab56c884b804af69996c.svg" alt="{\partial\over\partial y_k^{(s)}}\int_\Omega \int_\Omega {
\sum_{m=1}^4 \phi_m^2(x')
\over|x' - x|}\d x'\,\phi_n(x) v_i(x) \d x =

=
{\partial\over\partial y_k^{(s)}}\int_\Omega \int_\Omega {
\sum_{m=1}^4 \left(\sum_{j=1}^N y_j^{(m)} v_j(x')\right)^2
\over|x' - x|}\d x'\, \left(\sum_{j=1}^N y_j^{(n)} v_j(x)\right)  v_i(x) \d x =

=
\int_\Omega \int_\Omega {
2 \left(\sum_{j=1}^N y_j^{(s)} v_j(x')\right)v_k(x')
\over|x' - x|}\d x'\, \left(\sum_{j=1}^N y_j^{(n)} v_j(x)\right)  v_i(x) \d x +

+
\int_\Omega \int_\Omega {
\sum_{m=1}^4 \left(\sum_{j=1}^N y_j^{(m)} v_j(x')\right)^2
\over|x' - x|}\d x'\, \delta_{ns}v_k(x)  v_i(x) \d x"/></p>
</div><p>Now we can see that we have in there the following term:</p>
<div class="math">
<p><img src="../_images/math/243d46b270bf5f4edc9694665430212ff91dbc3c.svg" alt="\int_\Omega \int_\Omega {v_k(x') v_i(x)\over |x'-x|}\d x'\d x"/></p>
</div><p>which is dense in <img class="math" src="../_images/math/a8ee49c50e5a314ed03f072c9287ee7b49940337.svg" alt="(ki)"/>, as can be easily seen be fixing <img class="math" src="../_images/math/26e02951ffb851bd3a9b32dd1e10e6de935a0c7f.svg" alt="i"/> and writing</p>
<div class="math">
<p><img src="../_images/math/13852d89c00416b71e54b5fd932716738bbdfdc6.svg" alt="\int_\Omega \int_\Omega {v_k(x')\over |x'-x|}\d x' v_i(x)\d x"/></p>
</div><p>so for each <img class="math" src="../_images/math/0dabd76e82ded83eabfba509508649f4b47ca55e.svg" alt="k"/> there is some contribution from the integral <img class="math" src="../_images/math/857d9bc39b623ff11fb47ec75b30b661c2b6bcfb.svg" alt="\int_\Omega
{v_k(x')\over |x'-x|}\d x'"/> for such <img class="math" src="../_images/math/74d80b1f8754374202dc72f351096af63dd5da6c.svg" alt="x"/> where <img class="math" src="../_images/math/d007f4c1a614e6ac35eb5a7b820ae0b46ac04b00.svg" alt="v_i(x)"/> is nonzero, thus
making the Jacobian <img class="math" src="../_images/math/8eec2b4bb7908a313d35a984bd94ca3a0e27d243.svg" alt="J_{ik}"/> dense.</p>
</section>
</section>
<section id="thomas-fermi-dirac-theory">
<h2><span class="section-number">8.9.9. </span>Thomas-Fermi-Dirac Theory<a class="headerlink" href="#thomas-fermi-dirac-theory" title="Permalink to this headline">¶</a></h2>
<p>There are two ways to derive equations for Thomas-Fermi-Dirac theory. One way
is to start from grand potential and derive all equations from it. The other
way is to start with low level equations and build our way up. Will start with
the former.</p>
<section id="top-down-approach">
<h3>Top Down Approach<a class="headerlink" href="#top-down-approach" title="Permalink to this headline">¶</a></h3>
<p>We start with a grand potential for fermions:</p>
<div class="math">
<p><img src="../_images/math/8470aa896884355832a511b48923c81e4509cb10.svg" alt="\Omega[\beta, \mu]
= -\sum_i {1\over\beta}
    \log\left(\sum_{N=0}^1 e^{-\beta\left(N\epsilon_i - N\mu\right)}\right)
        =

= -\sum_i {1\over\beta}
    \log\left(1 + e^{-\beta\left(\epsilon_i - \mu\right)}\right)
        =

= -{1\over\beta}
    \int \int {2\d^3 x \d^3 p \over (2\pi)^3} \log\left(1 +
        e^{-\beta\left({p^2\over 2} + V({\bf x}) - \mu\right)}\right)
        -E_{ee} - {1\over3}E_{xc} =

= -{2\over\beta}
    \int \d^3 x \int_0^\infty{ 4\pi p^2 \d p \over (2\pi)^3} \log\left(1 +
        e^{-\beta\left({p^2\over 2} + V({\bf x}) - \mu\right)}\right)
        -E_{ee} - {1\over3}E_{xc} =

= -{1\over \pi^2 \beta}
    \int \d^3 x \int_0^\infty p^2 \log\left(1 +
        e^{-\beta\left({p^2\over 2} + V({\bf x}) - \mu\right)}\right) \d p
        -E_{ee} - {1\over3}E_{xc} =

= -{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
    \int \d^3 x \int_0^\infty {u^{3\over2} \over
        1 + e^{u-\beta\left(\mu-V({\bf x})\right)}} \d u
            -E_{ee} - {1\over3}E_{xc} =

= -{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
    \int I_{3\over2}\left(\beta\left(\mu-V({\bf x})\right)\right) \,\d^3 x
    -E_{ee} - {1\over3}E_{xc} =

= -{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
    \int I_{3\over2}\left(\beta\left(\mu-V({\bf x})\right)\right) \,\d^3 x
    -E_{ee} - {1\over3}E_{xc}"/></p>
</div><p>The potential
<img class="math" src="../_images/math/18b08f0b3ee18cee0ca368df31a7a4f0c903aeb0.svg" alt="V({\bf x}) = V_{en}({\bf x}) + V_{ee}({\bf x}) + V_{xc}({\bf x})"/>
is the total potential that the electrons experience (it contains nuclear,
Hartree, and XC terms) and <img class="math" src="../_images/math/8dca4b5b66523d6702ae79973498d9961092711c.svg" alt="E_{ee}"/> is the Hartree energy:</p>
<div class="math">
<p><img src="../_images/math/999fd64736ae9787aa5387ce1aa9c44cfe824dde.svg" alt="E_{en} = \int n_e({\bf x}) V_{en}({\bf x})\,\d^3 x\,,

E_{ee}
    = \half \int n_e(\mathbf{x}) V_{ee}(\mathbf{x}) \d^3 x\,,

E_{xc} = {3\over 4}\int n_e({\bf x}) V_{xc}({\bf x})\,\d^3 x\,."/></p>
</div><p>For simplicity, we assume here that <img class="math" src="../_images/math/2a2363ad82e068fe1efe4e633e66e48dce0d3efd.svg" alt="V_{xc}"/> only contains the exchange of the
homogeneous electron gas. For a general XC functional, the relation is
nonlinear and one must simply numerically calculate the XC energy density
<img class="math" src="../_images/math/ae4c93c2c013ccd9c17d71aee99f7feb4e9d39e4.svg" alt="e_{xc}({\bf x})"/> and calculate the XC energy using:</p>
<div class="math">
<p><img src="../_images/math/feff935454d15d7935b7c2e0b8e553cbed513f18.svg" alt="E_{xc} = \int n_e({\bf x}) e_{xc}({\bf x})\,\d^3 x\,."/></p>
</div><p>In our case here, we have <img class="math" src="../_images/math/a1b7c226f648e00cb073588f9b6aaeb132fe04e1.svg" alt="e_{xc} = {3\over4}V_{xc}({\bf x})"/>, which is only
true for the exchange in homogeneous electron gas. Otherwise the relation is
nonlinear. In the general case, the correction that must be applied is:</p>
<div class="math">
<p><img src="../_images/math/8402ed8c5eedfff392c07b64e42bdffb258fba51.svg" alt="E_{en} + E_{ee} + E_{xc} - \int n_e({\bf x}) V({\bf x})\,\d^3 x =

= \int n_e({\bf x})\left(
    (e_{en}-V_{en})
    +(e_{ee}-V_{ee})
    +(e_{xc}-V_{xc})
    \right)\,\d^3 x =

= \int n_e({\bf x})\left(
    0
    +\left(\half V_{ee}-V_{ee}\right)
    +\left({3\over 4}V_{xc}-V_{xc}\right)
    \right)\,\d^3 x =

= \int n_e({\bf x})\left(
    -\half V_{ee}
    -{1\over 4}V_{xc}
    \right)\,\d^3 x =

= -\half\int n_e({\bf x}) V_{ee} \d^3 x
- {1\over 3}{3\over 4}\int n_e({\bf x}) V_{xc} \d^3 x =

= -E_{ee} - {1\over 3} E_{xc}"/></p>
</div><p>The density is a functional derivative with respect to
<img class="math" src="../_images/math/ad1b5e1523a12eb371617b6364fa0be5af2d4520.svg" alt="\mu"/>:</p>
<div class="math">
<p><img src="../_images/math/30ec3454d65819a90648e75c95eb8d6bf2b20ea8.svg" alt="n_e({\bf x}) = - {\delta \Omega[\beta, \mu] \over \delta \mu}
    = {2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
        {\partial \over \partial \mu}
            I_{3\over2}\left(\beta\left(\mu-V({\bf x})\right)\right)
    = {2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
        \beta {3\over 2} I_{1\over2}
            \left(\beta\left(\mu-V({\bf x})\right)\right) =

    = {\sqrt2 \over \pi^2 \beta^{3\over2}} I_{1\over2}
            \left(\beta\left(\mu-V({\bf x})\right)\right)"/></p>
</div><p>By defining the function <img class="math" src="../_images/math/57eaa68ed26f1e467b3458656be4ac30376004f1.svg" alt="\Phi(n_e({\bf x}))"/>:</p>
<div class="math">
<p><img src="../_images/math/46d12d09d61184073be2dfcc1e0eeb28872c5243.svg" alt="\Phi(n_e({\bf x})) = \beta\left(\mu-V({\bf x})\right)
    = I_{1\over2}^{-1}\left(
            {\pi^2 \beta^{3\over2} \over \sqrt 2} n_e({\bf x})
        \right)"/></p>
</div><p>we can express the grand potential using <img class="math" src="../_images/math/f73adb4ed205ccdaddc84c1d4ed9ba3d3bc7c673.svg" alt="n_e"/> as follows:</p>
<div class="math">
<p><img src="../_images/math/b0120b876b2e1b5080a04c8d10f7d1d59800ec6a.svg" alt="\Omega[\beta, n_e]
    = -{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
        \int I_{3\over2}(\Phi(n_e({\bf x}))) \, \d^3 x
      - \half \int n_e(\mathbf{x}) V_{ee}(\mathbf{x}) \d^3
      - {1\over 4} \int n_e(\mathbf{x}) V_{xc}(\mathbf{x}) \d^3 x\,."/></p>
</div><p>Now we can calculate the free energy:</p>
<div class="math">
<p><img src="../_images/math/8bd4541cd3f6a12e09f1961cb821f42a369c5f49.svg" alt="F_e[\beta, n_e] = \Omega[\beta, n_e] + \mu N
    = \Omega[\beta, n_e] + \mu \int n_e({\bf x}) \,\d^3 x =

    = \int \left(-{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
          I_{3\over2}(\Phi(n_e({\bf x})))
        + \mu n_e({\bf x})
        - n_e(\mathbf{x}) \left(
            \half V_{ee}(\mathbf{x})
            +{1\over 4} V_{xc}(\mathbf{x})
            \right)
            \right)\d^3 x =

    = \int \left(-{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
          I_{3\over2}(\Phi(n_e({\bf x})))
        + {1\over \beta} n_e({\bf x}) \Phi(n_e({\bf x}))
            + n_e({\bf x}) V({\bf x})
            - n_e(\mathbf{x}) \left(
                \half V_{ee}(\mathbf{x})
                +{1\over 4} V_{xc}(\mathbf{x})
                \right)
            \right)\d^3 x =

    = \int \left(-{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
          I_{3\over2}(\Phi(n_e({\bf x})))
        + {1\over \beta} n_e({\bf x}) \Phi(n_e({\bf x}))
            + n_e({\bf x})\left( V_{en}({\bf x})
              +\half V_{ee}(\mathbf{x})
              + {3\over 4} V_{xc}(\mathbf{x}) \right)
            \right)\d^3 x\,,"/></p>
</div><p>where we used the fact that <img class="math" src="../_images/math/2677df8f73e3c9ff513f2420f5c0dcbe02b7d3dc.svg" alt="\mu = {1\over \beta} \Phi(n_e({\bf x})) + V({\bf
x})"/>, i.e. the left hand side <img class="math" src="../_images/math/ad1b5e1523a12eb371617b6364fa0be5af2d4520.svg" alt="\mu"/> is a constant, thus the sum of the terms on
the right hand side is also constant (even though the individual terms are
not).</p>
<p>We can calculate the entropy
<img class="math" src="../_images/math/74b0ea8c513d49ae321fc0fe31dc43e4cfd5d36d.svg" alt="S=-\left(\partial\Omega\over\partial T\right)_{V,\mu}"/> as follows:</p>
<div class="math">
<p><img src="../_images/math/e297caa805bdc7190c64100fecaf1350ebfbf1f3.svg" alt="TS
    =-T \left(\partial\Omega\over\partial T\right)_{V,\mu} =

    =\beta \left(\partial\Omega\over\partial \beta\right)_{V,\mu} =

    =\beta {\partial\over\partial \beta}\left(
        -{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
        \int I_{3\over2}(\Phi(n_e({\bf x}))) \, \d^3 x
        - E_{ee} - {1\over3}E_{xc}
    \right) =

    =\beta {\partial\over\partial \beta}\left(
        -{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
        \int I_{3\over2}(\Phi(n_e({\bf x}))) \, \d^3 x
    \right) =

    =\beta \left(
        {5\over2}{2\sqrt2 \over 3 \pi^2 \beta^{7\over2}}
        \int I_{3\over2}(\Phi(n_e({\bf x}))) \, \d^3 x
        -{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
        \int {3\over2} I_{1\over2}(\Phi(n_e({\bf x})))
            {\partial\Phi(n_e({\bf x}))\over\partial\beta}
        \, \d^3 x
    \right) =

    =\beta \left(
        {5\over2}{2\sqrt2 \over 3 \pi^2 \beta^{7\over2}}
        \int I_{3\over2}(\Phi(n_e({\bf x}))) \, \d^3 x
        -{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
        \int {3\over2} I_{1\over2}(\Phi(n_e({\bf x})))
            (\mu-V({\bf x}))
        \, \d^3 x
    \right) =

    = {5\over2}{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
        \int I_{3\over2}(\Phi(n_e({\bf x}))) \, \d^3 x
        - \int n_e({\bf x}) (\mu-V({\bf x})) \, \d^3 x =

    = {5\over3}{\sqrt2 \over \pi^2 \beta^{5\over2}}
        \int I_{3\over2}(\Phi(n_e({\bf x}))) \, \d^3 x
        -\mu N + E_{en}+2E_{ee} + {4\over 3}E_{xc}"/></p>
</div><p>The total energy is then equal to:</p>
<div class="math">
<p><img src="../_images/math/2f884b51d9ec611e6aab204d315245ffd59d578e.svg" alt="E = \Omega + \mu N + TS =

    = \left(-{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
        \int I_{3\over2}(\Phi(n_e({\bf x}))) \, \d^3 x
        - E_{ee} - {1\over3}E_{xc}\right)
        + \mu N
        +{5\over3}{\sqrt2 \over \pi^2 \beta^{5\over2}}
        \int I_{3\over2}(\Phi(n_e({\bf x}))) \, \d^3 x
        -\mu N + E_{en}+2E_{ee} + {4\over 3}E_{xc} =

    = {\sqrt2 \over \pi^2 \beta^{5\over2}}
        \int I_{3\over2}(\Phi(n_e({\bf x}))) \, \d^3 x
        + E_{en} + E_{ee} + E_{xc}"/></p>
</div><p>From which we can see that the kinetic energy <img class="math" src="../_images/math/6daf483f0bf5787ed3725425bb9e97f297268458.svg" alt="E_{kin}"/> is equal to:</p>
<div class="math">
<p><img src="../_images/math/e2b4191bcb33702a8690b8e7b60d9d156477071a.svg" alt="E_{kin} = E - (E_{en} + E_{ee} + E_{xc}) =

    = {\sqrt2 \over \pi^2 \beta^{5\over2}}
        \int I_{3\over2}(\Phi(n_e({\bf x}))) \, \d^3 x"/></p>
</div><p>The relation between the total energy and free energy can be also written as:</p>
<div class="math">
<p><img src="../_images/math/ab78fc881d648d2d9352d13bcaba93077402696f.svg" alt="E = F + TS = F +
    \beta \left(\partial\Omega\over\partial \beta\right)_{V,\mu} =

    = F + \beta \left(\partial F\over\partial \beta\right)_{V,\mu}
    = \left(\partial (\beta F)\over\partial \beta\right)_{V,\mu}"/></p>
</div><p>But it gives the same result as we obtained above.</p>
<p>To determine the kinetic part of the free energy, we set all potentials equal
to zero (<img class="math" src="../_images/math/d5df4cfaa2af9810d000ab030f59d81929551d8d.svg" alt="V({\bf x}) = V_{en}({\bf x}) = V_{ee}({\bf x}) = V_{xc}({\bf x}) =
0"/>) and obtain:</p>
<div class="math">
<p><img src="../_images/math/57706c296223e093d37475df4b54ac8b4f23f8ef.svg" alt="F_{kin}[\beta, n_e]
    = \int \left(-{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
          I_{3\over2}(\Phi(n_e({\bf x})))
        + {1\over \beta} n_e({\bf x}) \Phi(n_e({\bf x}))
            \right)\d^3 x\,."/></p>
</div><p>If the potentials are zero, then the pressure can be calculated
from:</p>
<div class="math">
<p><img src="../_images/math/0b8507b2f23b5dabbc6513519ea1d1a1d7378d88.svg" alt="P = -{1\over V}\Omega[\beta, n_e]
    = {2\sqrt2 \over 3 \pi^2 \beta^{5\over2}V}
        \int I_{3\over2}(\Phi(n_e({\bf x}))) \,\d^3 x =

= {2\sqrt2 \over 3 \pi^2 \beta^{5\over2}V}
        \int I_{3\over2}(\beta\mu) \,\d^3 x
= {2\sqrt2 \over 3 \pi^2 \beta^{5\over2}} I_{3\over2}(\beta\mu) \,."/></p>
</div><p>If the potentials are not zero, then one can calculate the pressure using:</p>
<div class="math">
<p><img src="../_images/math/40e3227cd0d4f25d2c0de1acbdc6aa419e6f9bd4.svg" alt="P = - \left(\partial\Omega\over\partial V\right)_{\mu,T}
    = - \left(\partial F\over\partial V\right)_{T,N} =

    = - {\partial \over\partial V} \int f \d^3 x =

    = - \left[f+e_{ee}\right]_b
        - \int {\partial f\over\partial n_e}
          {\partial n_e\over\partial V}
          \d^3 x =

    = - \left[f+e_{ee}\right]_b
        - \mu \int {\partial n_e\over\partial V} \d^3 x =

    = - \left[f+e_{ee}\right]_b
        + \mu [n_e]_b =

    = \left[(-f)-e_{ee}+\mu n_e \right]_b =

    = \left[\left({2\over3}e_{kin} + e_{ee} + {1\over3}e_{xc}-\mu n_e\right)
        -e_{ee}+\mu n_e \right]_b =

    = \left[{2\over3}e_{kin} + {1\over3}e_{xc}\right]_b =

    = {1\over 3V} \int_b \left( {2\over3}e_{kin} + {1\over3}e_{xc}
        \right) {\bf x}\cdot{\bf n}\,\d S =

    = {1\over 3V} \int \left( {2\over3}e_{kin} + {1\over3}e_{xc}
        \right) \nabla\cdot{\bf x}\,\d^3 x
        +
    {1\over 3V} \int {\bf x}\cdot\nabla \left(
        {2\over3}e_{kin} + {1\over3}e_{xc}
        \right) \,\d^3 x =

    = {1\over 3V} (2E_{kin} + E_{xc})
        +
    {1\over 3V} \int {\bf x}\cdot \left(
        -n_e({\bf x})\nabla V({\bf x})
        + \nabla{1\over3}e_{xc}
        \right) \,\d^3 x =

    = {1\over 3V} (2E_{kin} + E_{xc})
        +
    {1\over 3V} (E_{en}+E_{ee}) =

    = {1\over 3V}(2E_{kin} + E_{en} + E_{ee} + E_{xc})"/></p>
</div><p>Summary:</p>
<div class="math">
<p><img src="../_images/math/50a0c85628ea4055613cb7e6ae6825c95c9d1e63.svg" alt="\Omega = -{2\over 3} E_{kin} - E_{ee} - {1\over3}E_{xc}

F_e = \Omega + \mu N = -{2\over 3} E_{kin} - E_{ee} - {1\over3}E_{xc}
    + \mu N

TS = {5\over3} E_{kin} + E_{en} + 2 E_{ee} + {4\over3}E_{xc} - \mu N

E = F + TS = \Omega + \mu N + TS = E_{kin} + E_{en} + E_{ee} + E_{xc}\,,"/></p>
</div><p>where:</p>
<div class="math">
<p><img src="../_images/math/22d7aa664c4fee4e9009d0724e09dffa9cda57ad.svg" alt="E_{kin} = {\sqrt2 \over \pi^2 \beta^{5\over2}}
        \int I_{3\over2}(\Phi(n_e({\bf x}))) \, \d^3 x

E_{en} = \int n_e({\bf x}) V_{en}({\bf x})\, \d^3 x

E_{ee} = \half \int n_e({\bf x}) V_{ee}({\bf x})\, \d^3 x

E_{xc} = {3\over4}\int n_e({\bf x}) V_{xc}({\bf x})\, \d^3 x

n_e({\bf x}) = {\sqrt2 \over \pi^2 \beta^{3\over2}}
        I_{1\over2}\left( \beta\left(\mu-V({\bf x})\right) \right)

\Phi(n_e({\bf x})) = \beta\left(\mu-V({\bf x})\right)
    = I_{1\over2}^{-1}\left(
            {\pi^2 \beta^{3\over2} \over \sqrt 2} n_e({\bf x})
        \right)

N = \int n_e({\bf x})\, \d^3 x

\mu = {1\over \beta} \Phi(n_e({\bf x})) + V({\bf x})"/></p>
</div><p>and <img class="math" src="../_images/math/b7c2fcf604aa1af8f7e287d69c25efa0f9de053a.svg" alt="\mu N"/> is calculated as follows:</p>
<div class="math">
<p><img src="../_images/math/7c69b8fb11cdeefdd4d858c1d5a5b6aec69bbe74.svg" alt="\mu N = \int \mu n_e({\bf x})\, \d^3 x =

    = {1\over \beta} \int \Phi(n_e({\bf x})) n_e({\bf x})\, \d^3 x
        + \int V({\bf x}) n_e({\bf x})\, \d^3 x =

    = {1\over \beta} \int \Phi(n_e({\bf x})) n_e({\bf x})\, \d^3 x
        + E_{en} + 2 E_{ee} + {4\over3} E_{xc} \,."/></p>
</div><p>So <img class="math" src="../_images/math/eb8a40186d17a6cb72e94f383680c31d4b48066e.svg" alt="F_e"/> can also be expressed as:</p>
<div class="math">
<p><img src="../_images/math/ce14cdf697da91caf607ff60a53b6926c37eae25.svg" alt="F_e = -{2\over 3} E_{kin} - E_{ee} - {1\over3}E_{xc} + \mu N =

    = -{2\over 3} E_{kin}
       + {1\over \beta} \int \Phi(n_e({\bf x})) n_e({\bf x})\, \d^3 x
        + E_{en} + E_{ee} + E_{xc} \,."/></p>
</div></section>
<section id="bottom-up-approach">
<h3>Bottom Up Approach<a class="headerlink" href="#bottom-up-approach" title="Permalink to this headline">¶</a></h3>
<p>The other way to derive these equations is to use the following considerations.
The number of states in a box of side <img class="math" src="../_images/math/961a0c55563970ae0b0074c740f76046460c654a.svg" alt="L"/> is given by:</p>
<div class="math">
<p><img src="../_images/math/c5db04ed01610aa8b9c986bfd6d9b73f18a3d49c.svg" alt="N = \int {\d^3 p \over h^3} 2 L^3
  = \int {\d^3 p \over (2\pi\hbar)^3} 2 L^3
  = \int {\d^3 p \over (2\pi)^3} 2 L^3
  = \int_0^{p_f} {4\pi p^2 \d p\over (2\pi)^3} 2 L^3
  = {L^3\over\pi^2} \int_0^{p_f} p^2 \d p"/></p>
</div><p>We use atomic units, so <img class="math" src="../_images/math/9cb7577b37923c9d883ffa5f48b96fd27f013400.svg" alt="\hbar=1"/>.
The electronic particle density is:</p>
<div class="math" id="equation-tf-low">
<p><span class="eqno">(8.9.9.1)<a class="headerlink" href="#equation-tf-low" title="Permalink to this equation">¶</a></span><img src="../_images/math/cb6d9031ad6557db0ce5780483943671a01017ec.svg" alt="n_e({\bf x}) = {N \over L^3}
  = {1\over\pi^2} \int_0^{p_f} p^2 \d p
  = {p_f^3 \over 3\pi^2}
  = {\left[2(E_f - V({\bf x}))\right]^{3\over2} \over 3\pi^2}"/></p>
</div><p>where we used the relation for Fermi energy <img class="math" src="../_images/math/749a34a32d916b3e1bf4375da92829acdb3175eb.svg" alt="E_f = {p_f^2\over 2} + V({\bf
x})"/>. The potential <img class="math" src="../_images/math/953fdb67a1328a6981ecc6dd187bdc4c58a41077.svg" alt="V({\bf x})"/> is the total potential that the electrons
experience (it contains Hartree, nuclear and XC terms).
At finite temperature <img class="math" src="../_images/math/932c246c410f1e03fc9d418f01d825c13c4d0442.svg" alt="T"/> we need to use the Fermi distribution and this
generalizes to:</p>
<div class="math">
<p><img src="../_images/math/b5095b928cbcc9af07cc3cb915675201ce266e85.svg" alt="n_e({\bf x})
  = {1\over\pi^2} \int_0^{\infty} {p^2 \d p \over
        e^{\beta(E-\mu)} + 1}"/></p>
</div><p>Now we use the relation <img class="math" src="../_images/math/ac758c804906d49575bb148c9bfd32926e706c71.svg" alt="E = {p^2\over 2} + V({\bf x})"/> and substitutions
<img class="math" src="../_images/math/6c6a4df88c0274e046105b3a84252e6bf87f4145.svg" alt="\epsilon={p^2\over 2}"/>, <img class="math" src="../_images/math/3af00c2c708630f7b4c7c796892053dd912b8ee5.svg" alt="y = \beta \epsilon"/> to rewrite this using the
<a class="reference internal" href="../math/other.html#fermi-integral"><span class="std std-ref">Fermi-Dirac Integral</span></a>:</p>
<div class="math">
<p><img src="../_images/math/db17170f8212e51218b13bd857bcde874200380a.svg" alt="n_e({\bf x})
  = {1\over\pi^2} \int_0^{\infty} {p^2 \d p \over
        e^{\beta(E-\mu)} + 1}
  = {1\over\pi^2} \int_0^{\infty} {p^2 \d p \over
        e^{\beta({p^2\over 2} + V({\bf x})-\mu)} + 1}
  = {\sqrt 2\over\pi^2} \int_0^{\infty} {\sqrt\epsilon \d \epsilon \over
        e^{\beta(\epsilon + V({\bf x})-\mu)} + 1}
  =

  = {\sqrt 2\over\pi^2 \beta^{3\over2}} \int_0^{\infty} {\sqrt y \d y \over
        e^{y - \beta(\mu - V({\bf x}))} + 1}
  = {\sqrt 2\over\pi^2 \beta^{3\over2}}
        I_{1\over2}\left(\beta(\mu - V({\bf x}))\right)"/></p>
</div><p>At low temperature (<img class="math" src="../_images/math/1f06104312488711f7d1f744495f2e83779f23d0.svg" alt="T\to0"/>) we have
<img class="math" src="../_images/math/714177fe22f91fb9a9803456d931f969f1cb0e60.svg" alt="\beta \to \infty"/>, <img class="math" src="../_images/math/0bccce644bf5d187b23e9324f47b683877be0999.svg" alt="I_{1\over2}(x) \to {2\over3} x^{3\over 2}"/> and we obtain:</p>
<div class="math">
<p><img src="../_images/math/b5acdffdc42014b55d2bc206898c568aaa622f86.svg" alt="n_e({\bf x}) \to
  {2\sqrt 2\over 3\pi^2 \beta^{3\over2}}
        \left(\beta(\mu - V({\bf x}))\right)^{3\over2}
  ={\left[2(\mu - V({\bf x}))\right]^{3\over2} \over 3\pi^2}"/></p>
</div><p>Identical with <a class="reference internal" href="#equation-tf-low">(8.9.9.1)</a>. We can see that the chemical potential <img class="math" src="../_images/math/ad1b5e1523a12eb371617b6364fa0be5af2d4520.svg" alt="\mu"/>
becomes the Fermi energy <img class="math" src="../_images/math/f15dd1be4bb8641a1713a3eed23e6ecd75287419.svg" alt="E_f"/> in the limit <img class="math" src="../_images/math/1f06104312488711f7d1f744495f2e83779f23d0.svg" alt="T\to0"/>. In the finite-temperature
case, <img class="math" src="../_images/math/ad1b5e1523a12eb371617b6364fa0be5af2d4520.svg" alt="\mu"/> is determined from the normalization condition for the number of
electrons <img class="math" src="../_images/math/d4fb8efa128c4d0f6faa0fa4afce07a0463795e2.svg" alt="N"/>:</p>
<div class="math">
<p><img src="../_images/math/a4c8069cfe034f0511f68f39a4cacba4a7159e4c.svg" alt="N = \int n_e({\bf x})\, d^3 x"/></p>
</div><p>The kinetic energy is</p>
<div class="math">
<p><img src="../_images/math/d8804dc3e59a7b21d74f2380dace2cbdb45bf49a.svg" alt="E_{kin} = \int \d^3 x \int 2 {\d^3p\over (2\pi)^3} {p^2\over 2}
    {1\over e^{\beta(E-\mu)}+1}
=

= \int \d^3 x \int_0^\infty 2 {4\pi p^2 \d p\over (2\pi)^3} {p^2\over 2}
    {1\over e^{\beta(E-\mu)}+1} =

= \int \d^3 x \int_0^\infty 2 {4\pi \sqrt 2\sqrt \epsilon \d \epsilon \over
    (2\pi)^3} \epsilon {1\over e^{\beta(\epsilon + V({\bf x})-\mu)}+1} =

= {\sqrt 2 \over \pi^2} \int \d^3 x \int_0^\infty
    {\epsilon^{3\over2} \d \epsilon \over
    e^{\beta(\epsilon + V({\bf x})-\mu)}+1} =

= {\sqrt 2 \over \pi^2 \beta^{5\over2}} \int \d^3 x \int_0^\infty
    {y^{3\over2} \d y \over e^{y - \beta(\mu -V({\bf x}))}+1} =

= {\sqrt 2 \over \pi^2 \beta^{5\over2}}
    \int I_{3\over2}\left(\beta(\mu - V({\bf x}))\right) \d^3 x"/></p>
</div><p>From the last formula it can be shown that the kinetic energy is equal to</p>
<div class="math">
<p><img src="../_images/math/18ef87c1707264af45ca4444fb05b2e84f1f2347.svg" alt="E_{kin} = {3\over 2} P V - {1\over 2} E_{en} - {1\over 2} E_{ee}"/></p>
</div><p>The potential energy is equal to:</p>
<div class="math">
<p><img src="../_images/math/c36831f9373bfd6ac01d23970a56486a8bbba228.svg" alt="E_{pot} = E_{en} + E_{ee}"/></p>
</div><p>The internal energy <img class="math" src="../_images/math/b612343772caac6cfb5771ef755ef11f37d794f2.svg" alt="E"/> is equal to:</p>
<div class="math">
<p><img src="../_images/math/045cb8c806e73da40fcfb88e3996afc3dd919ab2.svg" alt="E = E_{kin} + E_{pot}
    = E_{kin} + E_{en} + E_{ee} =

    = {3\over 2} P V + {1\over 2} E_{en} + {1\over 2} E_{ee}"/></p>
</div><p>The entropy <img class="math" src="../_images/math/802402937724139288418cbbd3d6f444d8e1a151.svg" alt="S"/> is equal to:</p>
<div class="math">
<p><img src="../_images/math/c08ddbd70583f03f3da4c143f2711f057fc315d8.svg" alt="TS
   = -{1\over\beta}
     \sum_i [n_i\log n_i + (1-n_i)\log(1-n_i)] =

   = -{1\over\beta}
     \sum_i \left[n_i\log\left(n_i\over 1-n_i\right)
        + \log(1-n_i)\right] =

   =  \left[\sum_i n_i\epsilon_i\right]
   +
    \left[-\sum_i n_i \mu\right]
   +
        \left[-{1\over\beta} \sum_i\log(1-n_i)\right] =

   = \left[E_{kin} + E_{en} + 2 E_{ee}\right]
    +
    \left[-\mu N\right]
    +
    \left[{2\over3}E_{kin}\right]
    =

   = {5\over3}E_{kin} + E_{en} + 2 E_{ee} -\mu N =

   = {5\over2}P V + {1\over6}E_{en} + {7\over6}E_{ee} -\mu N"/></p>
</div><p>where <img class="math" src="../_images/math/eb065e3d358e6ca3f7b567311ad10f4101f69eb2.svg" alt="n_i={1\over1+e^{\beta(\epsilon_i-\mu)}}"/> is the number of states at
energy <img class="math" src="../_images/math/5f43fd2698b451c7e71ce748a21170359148ae9d.svg" alt="\epsilon_i"/>. We used the following calculation expressing one of the
sums in terms of the kinetic energy:</p>
<div class="math">
<p><img src="../_images/math/b3e7d7fea83194b24206abb6bf934a633ffef20a.svg" alt="-{1\over\beta} \sum_i\log(1-n_i) =

    = -{1\over\beta}\int {2\d^3 x \d^3 p\over (2\pi)^3}
        \log {e^{\beta(E-\mu)}\over 1+e^{\beta(E-\mu)}} =

    = -{\sqrt 2\over \pi^2 \beta^{5\over2}}\int \d^3 x \int_0^\infty
        \sqrt{y}\, \d y
        \log {e^{y-\beta(\mu-V({\bf x}))}\over
            1+e^{y-\beta(\mu-V({\bf x}))}} =

    = -{\sqrt 2\over \pi^2 \beta^{5\over2}}\int \d^3 x \left[
        -{2\over3}\int_0^\infty {y^{3\over2} \d y \over
            1+e^{y-\beta(\mu-V({\bf x}))}} \right] =

    = {2\over 3}{\sqrt 2\over \pi^2 \beta^{5\over2}}\int
        I_{3\over2}\left(\beta(\mu-V({\bf x}))\right) \d^3 x =

    = {2\over 3} E_{kin} \,,"/></p>
</div><p>where we used <img class="math" src="../_images/math/809909c55c30bb0a72143f22634965b35a14618a.svg" alt="E={p^2\over2}+V({\bf x})"/>.</p>
<p>The free energy is equal to:</p>
<div class="math">
<p><img src="../_images/math/ed35e1bd6fee2154300625d9c4cb6d11142285cc.svg" alt="F = E - TS = -{2\over3}E_{kin} - E_{ee} + \mu N =

    = -PV + {1\over3}E_{en} - {2\over3}E_{ee} +\mu N"/></p>
</div><p>The grand potential is equal to:</p>
<div class="math">
<p><img src="../_images/math/c61825f1802fc4ad3af942b9278b2ff903156e2e.svg" alt="\Omega = F - \mu N = -{2\over3}E_{kin} - E_{ee} =

    = -PV + {1\over3}E_{en} - {2\over3}E_{ee}"/></p>
</div><p>We can now express the free energy functional <img class="math" src="../_images/math/5b40fffa1abe349d56d457d6c0a9af842ee33f24.svg" alt="F_e[\beta, n_e]"/> as a function
of the density:</p>
<div class="math">
<p><img src="../_images/math/4fb087eedc9b89b6480d3157da6b9bfc13f30604.svg" alt="F_e[\beta, n_e] = -{2\over3}E_{kin} - E_{ee} + \mu N =

    = \int \left(-{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
          I_{3\over2}(\Phi(n_e({\bf x})))
          -\half n_e({\bf x}) V_{ee}({\bf x})
        + \mu n_e({\bf x}) \right)\d^3 x =

    = \int \left(-{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
          I_{3\over2}(\Phi(n_e({\bf x})))
          -\half n_e({\bf x}) V_{ee}({\bf x})
        + {1\over \beta} n_e({\bf x}) \Phi(n_e({\bf x}))
            + n_e({\bf x}) V({\bf x}) \right)\d^3 x =

    = \int \left(-{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
          I_{3\over2}(\Phi(n_e({\bf x})))
          -\half n_e({\bf x}) V_{ee}({\bf x})
        + {1\over \beta} n_e({\bf x}) \Phi(n_e({\bf x}))
            + n_e({\bf x}) (V_{en}({\bf x}) + V_{ee}({\bf x})
                + V_{xc}({\bf x}))
              \right)\d^3 x =

    = \int \left(-{2\sqrt2 \over 3 \pi^2 \beta^{5\over2}}
          I_{3\over2}(\Phi(n_e({\bf x})))
        + {1\over \beta} n_e({\bf x}) \Phi(n_e({\bf x}))
            + n_e({\bf x}) (V_{en}({\bf x}) +\half V_{ee}({\bf x})
                + V_{xc}({\bf x}))
              \right)\d^3 x =

    = \left( -{2\over3}E_{kin}
        + \int {1\over \beta} n_e({\bf x}) \Phi(n_e({\bf x}))\, \d^3 x
          \right)
        + E_{en} + E_{ee} + E_{xc}"/></p>
</div></section>
</section>
<section id="orbital-free-density-functional-theory">
<h2><span class="section-number">8.9.10. </span>Orbital Free Density Functional Theory<a class="headerlink" href="#orbital-free-density-functional-theory" title="Permalink to this headline">¶</a></h2>
<p>The orbital-free electronic free energy is given by:</p>
<div class="math">
<p><img src="../_images/math/96f8e741e9a1a721af2f3541a36548e102ca72a2.svg" alt="F_e[n_e] = T_0[n_e] + U_{en}[n_e] + U_{ee}[n_e] + F_{xc}[n_e]\,,"/></p>
</div><p>where the kinetic energy can be written in a few different equivalent ways as</p>
<div class="math">
<p><img src="../_images/math/e777d1fd6ab6b0ca922f2ac64affc83d76e15f25.svg" alt="T_0[n_e] =

= {\sqrt 2\over\pi^2 \beta^{5\over2}}
  \int \left(
            I_{1\over2}\left(\beta(\mu - V({\bf x}))\right)
\beta(\mu-V({\bf x})) -
{2\over 3} I_{3\over2}(\beta(\mu-V({\bf x})))
\right) \d^3 x =

= {1\over\beta} \int \left(
n_e(\mathbf{x}) \beta(\mu-V({\bf x})) -
{2\sqrt2\over 3\pi^2 \beta^{3\over2}} I_{3\over2}(\beta(\mu-V({\bf x})))
\right) \d^3 x =

= {1\over\beta} \int \left(
n_e(\mathbf{x}) \Phi(n_e(\mathbf{x})) -
{2\sqrt2\over 3\pi^2 \beta^{3\over2}} I_{3\over2}(\Phi(n_e(\mathbf{x})))
\right) \d^3 x =

= {1\over\beta} \int \left(
n_e(\mathbf{x}) I_{1\over2}^{-1}(y) -
{2n_e(\mathbf{x})\over 3 y} I_{3\over2}(I_{1\over2}^{-1}(y))
\right) \d^3 x =

= {1\over\beta} \int
n_e(\mathbf{x}) \left( I_{1\over2}^{-1}(y) -
{2\over 3 y} I_{3\over2}(I_{1\over2}^{-1}(y))\right)
\d^3 x =

={1\over\beta} \int n_e(\mathbf{x}) f(y) \d^3 x\,;\quad\quad
y={\pi^2\over\sqrt2}\beta^{3\over2} n_e\,,"/></p>
</div><p>where <img class="math" src="../_images/math/ec7e2c184fd173f643c79629ab7831d592ecf3c4.svg" alt="f(y)"/> is a special function of one variable, composed of a
<a class="reference internal" href="../math/other.html#fermi-integral"><span class="std std-ref">Fermi-Dirac Integral</span></a> of order <img class="math" src="../_images/math/cfa4563345ddec71893b180dc57497684a912c36.svg" alt="3\over2"/> and its inverse of order <img class="math" src="../_images/math/f48171cfc7dc2e3458d24ad0a652ede5f3bd6d09.svg" alt="1\over2"/>:</p>
<div class="math">
<p><img src="../_images/math/88d2ddc862167212da5abaabb7f42ea4c2ff1098.svg" alt="f(y) = I_{1\over2}^{-1}(y) - {2\over 3 y} I_{3\over2}(I_{1\over2}^{-1}(y))"/></p>
</div><p>the electron-nuclei term has the form</p>
<div class="math">
<p><img src="../_images/math/1936a3232f993a44676260bbfe8dd0f86a725a2c.svg" alt="U_{en}[n_e]
    = \int {n_e(\mathbf{x}) n_n(\mathbf{x}')\over
        |\mathbf{x} - \mathbf{x}'|}\d^3 x\d^3 x'
    = \int n_e(\mathbf{x}) V_{en}(\mathbf{x}) \d^3 x\,,"/></p>
</div><p>The electron-electron (Hartree) term takes the form:</p>
<div class="math">
<p><img src="../_images/math/b137655d17d65697c3479bc8aa92ee788de7896c.svg" alt="U_{ee}[n_e]
    = \half \int {n_e(\mathbf{x}) n_e(\mathbf{x}')\over
        |\mathbf{x} - \mathbf{x}'|}\d^3 x\d^3 x'
    = \half \int n_e(\mathbf{x}) V_{ee}(\mathbf{x}) \d^3 x\,,"/></p>
</div><p>and the exchange and correlation functional <img class="math" src="../_images/math/4a5fe65c5039ff1028fd46a0415eef4ddb56c413.svg" alt="F_{xc}[n_e]"/> is given by
the Perdew-Zunger LDA:</p>
<div class="math">
<p><img src="../_images/math/943b36a8e6c5a4b3e14269a8d785e822c3722d5e.svg" alt="F_{xc}[n_e]
    = \int n_e(\mathbf{x}) \epsilon_{xc}^{LD}(n_e) \d^3 x\,,"/></p>
</div><p><img class="math" src="../_images/math/57f12d915ec4539feabcc7af07e0415e1eb33ebe.svg" alt="n_e(\mathbf{x})"/> is the (positive) electron density,
<img class="math" src="../_images/math/4ab04e0fa2c74c549b48b6c52fdb9888aa25c8c2.svg" alt="n_n(\mathbf{x})"/> is the (positive) nuclei density.</p>
<p>We minimize this free energy under the condition of particle conservation. The
constrained functional is (we use <img class="math" src="../_images/math/36c040b0f606c99a2f635f8dfeeaa9feac87b89c.svg" alt="n\equiv n_e"/> from now on):</p>
<div class="math">
<p><img src="../_images/math/bb2373aae1fca78f69b9002d6ea5f237ca15aa9e.svg" alt="\Omega[n] = F_e[n] - \epsilon \left(\int n(\mathbf{x}) \d^3 x - N\right)"/></p>
</div><p>The variational solution is:</p>
<div class="math">
<p><img src="../_images/math/2500c728b6988fa5b3114c148bd3f616370a939e.svg" alt="{\delta \Omega[n] \over \delta n} = 0"/></p>
</div><p>Or:</p>
<div class="math" id="equation-of-dft0">
<p><span class="eqno">(8.9.10.1)<a class="headerlink" href="#equation-of-dft0" title="Permalink to this equation">¶</a></span><img src="../_images/math/669f05019508a6c4942cf2bf057820c818382353.svg" alt="{\delta F_e[n] \over \delta n} = \epsilon"/></p>
</div><p>Finally we get:</p>
<div class="math" id="equation-of-dft">
<p><span class="eqno">(8.9.10.2)<a class="headerlink" href="#equation-of-dft" title="Permalink to this equation">¶</a></span><img src="../_images/math/ca75822c1620c797a2d4d99ee618c3a2e4772da2.svg" alt="H[n] \equiv {\delta F_e[n] \over \delta n} =
{\delta T_0[n] \over \delta n}
+ {\delta U_{en}[n] \over \delta n}
+ {\delta U_{ee}[n] \over \delta n}
+ {\delta F_{xc}[n] \over \delta n}
= \epsilon"/></p>
</div><p>The individual terms are:</p>
<div class="math">
<p><img src="../_images/math/dfef9f8c7a4305f993791df92e71b55a1cfc269c.svg" alt="{\delta T_0[n] \over \delta n} =
    {1\over\beta} \left( f(y) + n(\mathbf{x}) {\d f(y) \over \d y}
    {\pi^2\over\sqrt2}\beta^{3\over2} \right)"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/860ed3ea0ffacf80c562d571fc7d26bcf54195ef.svg" alt="{\delta U_{en}[n] \over \delta n}
    = \int {n_n(\mathbf{x}')\over
        |\mathbf{x} - \mathbf{x}'|}\d^3 x'
    \equiv V_{en}(\mathbf{x})"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/549e9569adfb7124330b6963bab483b63885b8c5.svg" alt="{\delta U_{ee}[n] \over \delta n}
    = \int {n(\mathbf{x}')\over
        |\mathbf{x} - \mathbf{x}'|}\d^3 x'
    \equiv V_{ee}(\mathbf{x})"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/bbf16a4e867224affb8ebbc1f326c26371a6b9c6.svg" alt="{\delta F_{xc}[n] \over \delta n}
    = \epsilon_{xc}^{LD}(n) + n(\mathbf{x})
        {\d \epsilon_{xc}^{LD}(n) \over \d n}
    \equiv V_{xc}(\mathbf{x})"/></p>
</div><p>All together the Hamiltonian is:</p>
<div class="math">
<p><img src="../_images/math/992c941a1a6e23782d2f49a36f5b0b2212f8adcc.svg" alt="H[n] =
    {1\over\beta} \left( f(y) + n(\mathbf{x}) {\d f(y) \over \d y}
    {\pi^2\over\sqrt2}\beta^{3\over2} \right)
    +
    V_{en}(\mathbf{x})
    +
    V_{ee}(\mathbf{x})
    +
    V_{xc}(\mathbf{x})"/></p>
</div><p>We can also introduce an artificial orbital <img class="math" src="../_images/math/58cd5e6397345575168e7bafa9aea670d00035b0.svg" alt="\psi(\mathbf{x})"/> as follows:</p>
<div class="math">
<p><img src="../_images/math/a82c946bafe0c45b08909f57882c1be9e3d13b0e.svg" alt="n(\mathbf{x}) = \psi^2(\mathbf{x})"/></p>
</div><p>and minimize <img class="math" src="../_images/math/c7080a6364482c5654d3e33992a59f803f887a7a.svg" alt="\Omega"/> with respect to <img class="math" src="../_images/math/324a74caf91c8857598cd0ad4b7cae90eccaffb1.svg" alt="\psi"/>:</p>
<div class="math">
<p><img src="../_images/math/b4106ae151a3ec56fa6a0e012cd01de0c1084b0a.svg" alt="{\delta \Omega[n] \over \delta \psi} = 0 \,."/></p>
</div><p>We will use tilde to denote functions in terms of <img class="math" src="../_images/math/324a74caf91c8857598cd0ad4b7cae90eccaffb1.svg" alt="\psi"/>. So <img class="math" src="../_images/math/9faf649018cfff2a89e0f1667eaf825525d3e557.svg" alt="\Omega[n] =
\Omega[\psi^2] = \tilde \Omega[\psi]"/>.
Using the relation</p>
<div class="math">
<p><img src="../_images/math/21fc7c08088e75a28a24a751ccaa740e0750f81c.svg" alt="{\delta \over \delta \psi}
    = {\d n \over \d \psi} {\delta \over \delta n}
    = 2 \psi {\delta \over \delta n}"/></p>
</div><p>we obtain:</p>
<div class="math">
<p><img src="../_images/math/33e93014504bc1f67496ebc9884fee8448641b83.svg" alt="{\delta \Omega[n] \over \delta \psi}
    = 2 \psi {\delta \Omega[n] \over \delta n} = 0 \,."/></p>
</div><p>So the equation <a class="reference internal" href="#equation-of-dft0">(8.9.10.1)</a> gets multiplied by <img class="math" src="../_images/math/b61dfeaa4e79b3c0e0f0262b0aa8730fb1f55855.svg" alt="2\psi"/>:</p>
<div class="math">
<p><img src="../_images/math/db07ffe3b7b56d67cb272cc8ab3b0b51c9ad326f.svg" alt="2\psi {\delta F_e[n] \over \delta n} = 2\epsilon \psi"/></p>
</div><p>as well as the equation <a class="reference internal" href="#equation-of-dft">(8.9.10.2)</a>:</p>
<div class="math">
<p><img src="../_images/math/7d67229929bbf99c6f9f666cc238b5413f0069c2.svg" alt="\tilde H[\psi] \equiv {\delta \tilde F_e[\psi] \over \delta \psi}
    = {\delta F_e[n] \over \delta \psi}
    = 2 \psi {\delta F_e[n] \over \delta n}
    = 2 H[n] \psi
    = 2\epsilon \psi"/></p>
</div><p>So the Hamiltonian <img class="math" src="../_images/math/feea33f063ba04b9fa2388c4b347d3dac2af9c7d.svg" alt="H[n]"/> expressed using <img class="math" src="../_images/math/5c45fb6adda786f45a82cb89041788334858d777.svg" alt="n"/> and the Hamiltonian
<img class="math" src="../_images/math/08fe0b6ee5124dec338cae143f4fd7e6e573ea86.svg" alt="\tilde H[\psi]"/> expressed using <img class="math" src="../_images/math/324a74caf91c8857598cd0ad4b7cae90eccaffb1.svg" alt="\psi"/> are related by
<img class="math" src="../_images/math/18a6e3763d524e93610cb89aa981d278908d91ec.svg" alt="\tilde H[\psi] = 2 H[n] \psi"/>.</p>
<section id="free-energy-minimization">
<h3>Free Energy Minimization<a class="headerlink" href="#free-energy-minimization" title="Permalink to this headline">¶</a></h3>
<p>For clarity, we will be using <img class="math" src="../_images/math/feea33f063ba04b9fa2388c4b347d3dac2af9c7d.svg" alt="H[n]"/> from equation <a class="reference internal" href="#equation-of-dft">(8.9.10.2)</a> as our main
quantity, but we will also write the final relations using <img class="math" src="../_images/math/08fe0b6ee5124dec338cae143f4fd7e6e573ea86.svg" alt="\tilde H[\psi]"/> for
completeness.</p>
<p>We start with some initial guess for <img class="math" src="../_images/math/e7e3eef37b037fed21d98a91e6e6c950b9b4a532.svg" alt="\ket{\psi}"/> (it must be normalized
as <img class="math" src="../_images/math/236d043b1a3b8acccd66dc88cb597cb0cfdab539.svg" alt="\braket{\psi | \psi}=N"/>).
Let’s calculate <img class="math" src="../_images/math/e3bdfae3da1309e77d714d255f6a26b4724b0e8b.svg" alt="\epsilon"/>:</p>
<div class="math">
<p><img src="../_images/math/1aeacf7eab233e63459dc318ea2de3ffcd4c9581.svg" alt="H[n] = \epsilon

H[n]\ket{\psi} = \epsilon\ket{\psi}

\braket{\psi | H[n] | \psi} = \epsilon\braket{\psi | \psi}

\braket{\psi | H[n] | \psi} = \epsilon N

\epsilon = {1\over N} \braket{\psi | H[n] | \psi}
    \equiv {1\over N} \int H[n] \psi^2(\mathbf{x}) \d^3 x
    = {1\over 2N} \int \tilde H[\psi] \psi(\mathbf{x}) \d^3 x"/></p>
</div><p>We calculate the steepest-descent (SD) vector <img class="math" src="../_images/math/27e7f6ff1905580863576a229898d7bd0de2d075.svg" alt="\ket{\chi}"/>:</p>
<div class="math">
<p><img src="../_images/math/1999d6e220c9a60afd9a71db758b23eefa304cb0.svg" alt="\ket{\chi} = 2(\epsilon - H[n])\ket{\psi}
    \equiv 2\epsilon \ket{\psi} - \ket{\tilde H[\psi]}"/></p>
</div><p>The conjugate-gradient (CG) vector <img class="math" src="../_images/math/ab28e9cbc8ab2f2dbf42ad2699dae2189790e041.svg" alt="\ket{\varphi}"/> is calculated as:</p>
<div class="math">
<p><img src="../_images/math/f258fa4357a505426f89d320bbc5f983daec40e2.svg" alt="\ket{\varphi} = \ket{\chi} + {\braket{\chi | \chi} \over
    \braket{\chi_{k-1} | \chi_{k-1}}} \ket{\varphi}"/></p>
</div><p>To satisfy the normalization constraint of <img class="math" src="../_images/math/e7e3eef37b037fed21d98a91e6e6c950b9b4a532.svg" alt="\ket{\psi}"/>, the CG vector is
further orthogonalized to <img class="math" src="../_images/math/e7e3eef37b037fed21d98a91e6e6c950b9b4a532.svg" alt="\ket{\psi}"/> and normalized to <img class="math" src="../_images/math/d4fb8efa128c4d0f6faa0fa4afce07a0463795e2.svg" alt="N"/> (this step is one
particular, but not the only way to impose the normalization constraint):</p>
<div class="math">
<p><img src="../_images/math/184a9d39e542af8187b5a95cb89f485d1d65abaf.svg" alt="\ket{\varphi'} = \left(1 - {1\over N} \ket{\psi}\bra{\psi}\right)
    \ket{\varphi}

\ket{\varphi''} = \sqrt{N \over \braket{\varphi' | \varphi'}} \,
    \ket{\varphi'}"/></p>
</div><p>That is, now <img class="math" src="../_images/math/8e246665c0c23969bcbe5626a922e6c61014eded.svg" alt="\braket{\varphi'' | \psi}=0"/> and
<img class="math" src="../_images/math/97b5695a8dc3ae2121e9e06092ec29aaecd968d5.svg" alt="\braket{\varphi'' | \varphi''} = N"/>.
The new CG vector <img class="math" src="../_images/math/fe92a274a3e8f15cd3944a54547ccc84972f997d.svg" alt="\ket{\psi_{k+1}}"/> is then updated as usual in CG by
<img class="math" src="../_images/math/c1fa8f23ba5e46f4e5e6f51fa79ec378c993878f.svg" alt="\ket{\psi} + \alpha \ket{\varphi''}"/>, but then it must be normalized.
As such, equivalently, it is updated by a linear combination
of <img class="math" src="../_images/math/e7e3eef37b037fed21d98a91e6e6c950b9b4a532.svg" alt="\ket{\psi}"/> and <img class="math" src="../_images/math/879092d400ba60240c94c78b3e0ee0d7b6ff2be2.svg" alt="\ket{\varphi''}"/>:</p>
<div class="math">
<p><img src="../_images/math/919b365ec6aa587d3f599d9ce459a2d0357d9e21.svg" alt="\ket{\psi_{k+1}} = a \ket{\psi} + b \ket{\varphi''}"/></p>
</div><p>such that it remains normalized:</p>
<div class="math">
<p><img src="../_images/math/50fda396925c55616439ab50867098ab817387d1.svg" alt="\braket{\psi_{k+1} | \psi_{k+1}}
    = (a \bra{\psi} + b \bra{\varphi''})
    (a \ket{\psi} + b \ket{\varphi''})
    = (a^2 + b^2) N = N"/></p>
</div><p>So <img class="math" src="../_images/math/176491867d42bcba67e7d0fe56094e8fdd8807fe.svg" alt="a"/>, <img class="math" src="../_images/math/de059b8e0317d9f56bbfd2567f5d09337bc3901c.svg" alt="b"/> are any real numbers satisfying the equation <img class="math" src="../_images/math/51faba76e869eff2881becf311e9a2706879ec4d.svg" alt="a^2+b^2=1"/>, whose
parametric solution is <img class="math" src="../_images/math/0b3d3e6adbff014848bac5bacc95a917d90d6e09.svg" alt="a=\cos\theta"/>, <img class="math" src="../_images/math/f56df114f2ef8c5beabe98c6913cf1f251505e3f.svg" alt="b=\sin\theta"/> with <img class="math" src="../_images/math/5b1e68b5e26038283f6bc79d5010c6d1bf93364d.svg" alt="0 \le \theta &lt;
2\pi"/>:</p>
<div class="math">
<p><img src="../_images/math/ebcf6ff6e44ecfe524012627477a66f4c811acef.svg" alt="\ket{\psi_{k+1}} = \cos\theta \ket{\psi} + \sin\theta \ket{\varphi''}"/></p>
</div><p>where <img class="math" src="../_images/math/6fb7931886034ccad92f96457979b906fad8ea0c.svg" alt="\theta"/> is determined by minimizing the free energy <img class="math" src="../_images/math/a4fffefe5602c273311b37f6bfb0b53e81d06e81.svg" alt="F_e[\psi_{k+1}]"/> as
a function of <img class="math" src="../_images/math/6fb7931886034ccad92f96457979b906fad8ea0c.svg" alt="\theta"/>.</p>
</section>
</section>
<section id="references">
<h2><span class="section-number">8.9.11. </span>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="citation">
<dt class="label" id="dft"><span class="brackets">DFT</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>,<a href="#id3">3</a>)</span></dt>
<dd><ol class="upperalpha simple" start="18">
<li><ol class="upperalpha simple" start="13">
<li><p>Dreizler, E. K. U. Gross: Density functional theory: an approach to the quantum many-body problem</p></li>
</ol>
</li>
</ol>
</dd>
<dt class="label" id="pickett"><span class="brackets">pickett</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id5">2</a>)</span></dt>
<dd><ol class="upperalpha simple" start="23">
<li><ol class="upperalpha simple" start="5">
<li><p>Pickett, Pseudopotential methods in condensed matter applications, Computer Physics reports, Volume 9, Issue 3, April 1989, Pages 115-197, ISSN 0167-7977, DOI: 10.1016/0167-7977(89)90002-6. (<a class="reference external" href="http://www.sciencedirect.com/science/article/B6X3V-46R02CR-1J/2/804d9ecaa49469aa5e1050dc007f4a61">http://www.sciencedirect.com/science/article/B6X3V-46R02CR-1J/2/804d9ecaa49469aa5e1050dc007f4a61</a>)</p></li>
</ol>
</li>
</ol>
</dd>
</dl>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">8.9. Density Functional Theory (DFT)</a><ul>
<li><a class="reference internal" href="#many-body-schrodinger-equation">8.9.1. Many Body Schrödinger Equation</a></li>
<li><a class="reference internal" href="#the-hohenberg-kohn-theorem">8.9.2. The Hohenberg-Kohn Theorem</a></li>
<li><a class="reference internal" href="#the-kohn-sham-equations">8.9.3. The Kohn-Sham Equations</a></li>
<li><a class="reference internal" href="#the-xc-term">8.9.4. The XC Term</a></li>
<li><a class="reference internal" href="#total-energy">8.9.5. Total Energy</a></li>
<li><a class="reference internal" href="#xc-approximations">8.9.6. XC Approximations</a><ul>
<li><a class="reference internal" href="#lda">LDA</a></li>
<li><a class="reference internal" href="#rlda">RLDA</a></li>
</ul>
</li>
<li><a class="reference internal" href="#radial-dft-problem">8.9.7. Radial DFT Problem</a><ul>
<li><a class="reference internal" href="#kohn-sham-equations">Kohn-Sham Equations</a></li>
<li><a class="reference internal" href="#poisson-equation">Poisson Equation</a></li>
<li><a class="reference internal" href="#id6">Total Energy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dft-as-a-nonlinear-problem">8.9.8. DFT As a Nonlinear Problem</a><ul>
<li><a class="reference internal" href="#reformulation">Reformulation</a></li>
<li><a class="reference internal" href="#fe-discretization">FE Discretization</a></li>
<li><a class="reference internal" href="#jacobian">Jacobian</a></li>
</ul>
</li>
<li><a class="reference internal" href="#thomas-fermi-dirac-theory">8.9.9. Thomas-Fermi-Dirac Theory</a><ul>
<li><a class="reference internal" href="#top-down-approach">Top Down Approach</a></li>
<li><a class="reference internal" href="#bottom-up-approach">Bottom Up Approach</a></li>
</ul>
</li>
<li><a class="reference internal" href="#orbital-free-density-functional-theory">8.9.10. Orbital Free Density Functional Theory</a><ul>
<li><a class="reference internal" href="#free-energy-minimization">Free Energy Minimization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">8.9.11. References</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="radial.html"
                          title="previous chapter"><span class="section-number">8.8. </span>Radial Schrödinger and Dirac Equations</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="fermi.html"
                          title="next chapter"><span class="section-number">8.10. </span>Ideal Fermi Gas</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/quantum/dft.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="fermi.html" title="8.10. Ideal Fermi Gas"
             >next</a> |</li>
        <li class="right" >
          <a href="radial.html" title="8.8. Radial Schrödinger and Dirac Equations"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Theoretical Physics Reference 0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="main.html" ><span class="section-number">8. </span>Quantum Field Theory and Quantum Mechanics</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">8.9. </span>Density Functional Theory (DFT)</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
  </body>
</html>